var $original,MCK_COOKIE_DOMAIN,oModal="",sentryConfig=MCK_THIRD_PARTY_INTEGRATION.sentry;"undefined"!=typeof jQuery&&($original=jQuery.noConflict(!0),$=$original,jQuery=$original,"function"==typeof $.fn.modal&&(oModal=$.fn.modal.noConflict(!0),$.fn.modal=oModal,jQuery.fn.modal=oModal)),function(f){if("undefined"!=typeof Applozic)throw new Error(" Kommunicate script is already loaded, please check if you're loading it more than once.")}(window);var applozicSideBox=new ApplozicSidebox,scriptCounter=0;function ApplozicSidebox(){var f=[{name:"applozic-min-js",url:"https://cdn.kommunicate.io/applozic/applozic.chat-6.1.min.js",alternateUrl:MCK_STATICPATH+"/js/app/applozic.chat-6.1.min.js"},{name:"maps",url:"https://maps.google.com/maps/api/js?libraries=places",googleApiKey:void 0!==applozic._globals&&applozic._globals.googleApiKey?applozic._globals.googleApiKey:"AIzaSyCrBIGg8X4OnG4raKqqIC3tpSIPWE-bhwI"}],T=[{name:"mck-sidebox",url:"https://cdn.kommunicate.io/a43c165/kommunicate.a43c165.min.css"}],L=[{name:"locationPicker",url:MCK_STATICPATH+"/lib/js/locationpicker.jquery.min.js"},{name:"emojiLibrary",url:MCK_STATICPATH+"/lib/js/mck-emojis.min.js"}];function loadExternalFiles(T){try{if(applozic._globals.excludeGoogleMap&&"maps"===T.name)return void++scriptCounter;var L=document.getElementsByTagName("head")[0],K=document.createElement("script");K.async=!1,K.type="text/javascript",T&&T.crossOrigin&&(K.crossOrigin=T.crossOrigin),"maps"===T.name?K.src=T.url+"&key="+T.googleApiKey:K.src=T.url,K.readyState?K.onreadystatechange=function(){"loaded"!==K.readyState&&"complete"!==K.readyState||(K.onreadystatechange=null,++scriptCounter>=f.length&&mckinitPlugin())}:K.onload=function(){++scriptCounter>=f.length&&mckinitPlugin()},K.onerror=function(T){!function handleFileLoadError(T){if(T&&T.target&&T.target.src){var L=f.filter((function(f){return f.url==T.target.src}))[0];L&&(L.url=L.alternateUrl,loadExternalFiles(L))}}(T)},L.appendChild(K)}catch(f){}}function mckinitPlugin(){$original||"undefined"==typeof jQuery||($original=jQuery.noConflict(!0),$=$original,jQuery=$original,"function"==typeof $.fn.modal&&(oModal=$.fn.modal.noConflict(!0),$.fn.modal=oModal,jQuery.fn.modal=oModal));try{for(var f in T)T[f]&&mckLoadStyle(T[f].url);var K=new XMLHttpRequest;K.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var f=document.getElementsByTagName("body")[0];f.insertAdjacentHTML("beforeend",this.responseText);var T=function addScriptInsideHtml(){var f=String((function detectBrowserAndMakeUiVisible(){function showAfterLoad(){document.getElementById("mck-sidebox").style.visibility="visible",document.getElementById("mck-loc-box").style.visibility="visible",document.getElementById("mck-gm-search-box").style.visibility="visible"}-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?showAfterLoad():!!parent.document.getElementById("kommunicate-widget-iframe")?window.parent.document.addEventListener("kmInitilized",(function(){showAfterLoad()}),!1):window.addEventListener("kmInitilized",(function(){showAfterLoad()}),!1)}))+"detectBrowserAndMakeUiVisible();",T=document.createElement("script");return T.innerHTML=f,T}();f.appendChild(T),function mckInitPluginScript(){try{var f=applozic._globals;for(var T in MCK_COOKIE_DOMAIN=KommunicateUtils.findCookieDomain(document.domain),L){var K=L[T];"locationPicker"===K.name?f.locShare&&mckLoadScript(K.url):"emojiLibrary"===K.name?f.emojilibrary&&mckLoadScript(K.url,null,!0):mckLoadScript(K.url)}!function mckLoadAppScript(){var f=KommunicateUtils.getRandomId();try{!function getApplicationSettings(f){var T={};applozic._globals.appId&&(T.appId=applozic._globals.appId),applozic._globals.widgetPlatformUrl&&(T.widgetPlatformUrl=applozic._globals.widgetPlatformUrl);var L=KM_PLUGIN_SETTINGS.kommunicateApiUrl+"/users/v2/chat/plugin/settings"+KommunicateUtils.formatParams(T),K=new XMLHttpRequest;K.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var L=JSON.parse(this.responseText);!T.appId&&T.widgetPlatformUrl&&L.response&&(applozic._globals.appId=L.response.applicationId),function mckInitSidebox(f,T){try{var L=applozic._globals,K=f.chatWidget,U=null!=L.disableChatWidget?L.disableChatWidget:K.disableChatWidget,P=K.allowedDomains,G=parent.window.location.hostname.toLowerCase(),isSubDomain=function(f){return G==f||G.length>f.length&&G.substr(G.length-f.length-1)=="."+f},B=Array.isArray(P)&&P.length&&!P.some(isSubDomain),z=KommunicateConstants.KOMMUNICATE_DOMAINS.some(isSubDomain);if((U||B)&&!z)return parent.window&&parent.window.removeKommunicateScripts(),!1;(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(sentryConfig.enabled=!1),sentryConfig.enabled&&function loadErrorTracking(f){var T=parent.document.getElementById("kommunicate-widget-iframe"),L=T?T.getAttribute("data-url"):parent.window.location.href;f=KommunicateUtils.getCookie(KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID)||f;try{Sentry.init({dsn:sentryConfig.dsn,release:KommunicateConstants.KM_WIDGET_RELEASE_VERSION}),Sentry.configureScope((function(T){T.setTag("applicationId",applozic._globals.appId),T.setTag("userId",f),T.setTag("url",L),T.setUser({id:applozic._globals.appId})}))}catch(f){}}(T);var H=L.sessionTimeout;null==H&&(H=K&&K.sessionTimeout),L.appSettings=$applozic.extend(!0,f,L.appSettings),L.agentId=L.appSettings.agentId,L.agentName=L.appSettings.agentName,L.widgetSettings=K,L.customerCreatedAt=L.appSettings.customerCreatedAt,L.collectFeedback=L.appSettings.collectFeedback,L.chatPopupMessage=L.appSettings.chatPopupMessage;var q=K&&void 0!==K.pseudonymsEnabled?K.pseudonymsEnabled:KM_PLUGIN_SETTINGS.pseudoNameEnabled;L.metadata="object"==typeof L.metadata?L.metadata:{},L.fileUpload=L.fileUpload||K&&K.fileUpload,L.connectSocketOnWidgetClick=null!=L.connectSocketOnWidgetClick?L.connectSocketOnWidgetClick:K&&K.connectSocketOnWidgetClick,L.voiceInput=null!=L.voiceInput?L.voiceInput:K&&K.voiceInput,L.voiceOutput=null!=L.voiceOutput?L.voiceOutput:K&&K.voiceOutput,L.attachment=null!=L.attachment?L.attachment:K&&K.attachment,L.hidePostCTA=null!=L.hidePostCTA?L.hidePostCTA:K&&K.hidePostCTA,KommunicateUtils.deleteDataFromKmSession("settings");q=K&&void 0!==K.pseudonymsEnabled?K.pseudonymsEnabled:KM_PLUGIN_SETTINGS.pseudoNameEnabled;if(L.metadata="object"==typeof L.metadata?L.metadata:{},L.fileUpload=L.fileUpload||K&&K.fileUpload,L.connectSocketOnWidgetClick=null!=L.connectSocketOnWidgetClick?L.connectSocketOnWidgetClick:K&&K.connectSocketOnWidgetClick,L.voiceInput=null!=L.voiceInput?L.voiceInput:K&&K.voiceInput,L.voiceOutput=null!=L.voiceOutput?L.voiceOutput:K&&K.voiceOutput,L.attachment=null!=L.attachment?L.attachment:K&&K.attachment,L.hidePostCTA=null!=L.hidePostCTA?L.hidePostCTA:K&&K.hidePostCTA,L.capturePhoto=null!=L.capturePhoto?L.capturePhoto:K&&K.capturePhoto,L.captureVideo=null!=L.captureVideo?L.captureVideo:K&&K.captureVideo,KommunicateUtils.deleteDataFromKmSession("settings"),null!=H&&!L.preLeadCollection&&!L.askUserDetails){!function logoutAfterSessionExpiry(f){var T;applozic._globals.appId&&(T=KommunicateUtils.getItemFromLocalStorage(applozic._globals.appId));var L=T&&T.sessionEndTime-T.sessionStartTime;T&&null!=f&&L>f&&(KommunicateUtils.deleteUserCookiesOnLogout(),sessionStorage.removeItem("kommunicate"),KommunicateUtils.removeItemFromLocalStorage(applozic._globals.appId),ALStorage.clearSessionStorageElements(),KommunicateUtils.removeItemFromLocalStorage("mckActiveConversationInfo"));window.addEventListener("beforeunload",(function(f){var T=KommunicateUtils.getItemFromLocalStorage(applozic._globals.appId)||{};T.sessionEndTime=(new Date).getTime(),KommunicateUtils.setItemToLocalStorage(applozic._globals.appId,T)}))}(H);var V=KommunicateUtils.getItemFromLocalStorage(applozic._globals.appId)||{};!V.sessionStartTime&&(V.sessionStartTime=(new Date).getTime()),V.sessionTimeout=H,KommunicateUtils.setItemToLocalStorage(applozic._globals.appId,V)}if("kommunicate"==applozic.PRODUCT_ID){var W=KommunicateUtils.getCookie(KommunicateConstants.COOKIES.ACCESS_TOKEN),J=KommunicateUtils.getCookie(KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID),ee=KommunicateUtils.getCookie(KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_USERNAME),te=!L.userId;L.userId=te?J||T:L.userId;var ae=te?q?ee||f.userName:"":L.userName;ae&&(L.userName=ae),te&&q&&(L.metadata.KM_PSEUDO_USER=JSON.stringify({pseudoName:"true",hidden:"true"})),te&&W&&(L.accessToken=window.atob(W)),function saveUserCookies(f){KommunicateUtils.setCookie({name:KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID,value:f.userId,expiresInDays:30,domain:MCK_COOKIE_DOMAIN}),KommunicateUtils.setCookie({name:KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_USERNAME,value:f.userName||"",expiresInDays:30,domain:MCK_COOKIE_DOMAIN}),f.preLeadCollection||f.appSettings.collectLead||f.askUserDetails||KommunicateUtils.setCookie({name:KommunicateConstants.COOKIES.IS_USER_ID_FOR_LEAD_COLLECTION,value:!1,expiresInDays:30,domain:MCK_COOKIE_DOMAIN});if(f.accessToken){var T=window.btoa(f.accessToken);KommunicateUtils.setCookie({name:KommunicateConstants.COOKIES.ACCESS_TOKEN,value:T||"",expiresInDays:30,domain:MCK_COOKIE_DOMAIN})}}(L)}void 0!==L&&(L.ojq=$original,L.obsm=oModal,$applozic.fn.applozic(L)),function preLoadLauncherIcon(f){if(f&&f.widgetImageLink){var T=new Image;T.onload=function(){preLoadLauncherIconInterval()},T.src=f.widgetImageLink}else preLoadLauncherIconInterval()}(K)}catch(f){return"function"==typeof MCK_ONINIT&&MCK_ONINIT("error"),!1}}(L.response,f)}},K.open("GET",L,!0),K.send(T)}(f)}catch(f){return"function"==typeof MCK_ONINIT&&MCK_ONINIT("error"),!1}}()}catch(f){return"function"==typeof MCK_ONINIT&&MCK_ONINIT("error"),!1}}()}},K.open("GET","https://cdn.kommunicate.io/a43c165/mck-sidebox.a43c165.html",!0),K.send(null)}catch(f){return"function"==typeof MCK_ONINIT&&MCK_ONINIT("error"),!1}}function mckLoadStyle(f){var T=document.getElementsByTagName("head")[0],L=document.createElement("link");L.type="text/css",L.rel="stylesheet",L.href=f,T.appendChild(L)}function mckLoadScript(f,T,L){try{var K=document.getElementsByTagName("body")[0],U=document.createElement("script");U.type="text/javascript",U.src=f,U.crossOrigin="anonymous",L&&U.removeAttribute("crossOrigin"),T&&(U.readyState?U.onreadystatechange=function(){"loaded"!==U.readyState&&"complete"!==U.readyState||(U.onreadystatechange=null,T())}:U.onload=function(){T()}),K.appendChild(U)}catch(f){return"function"==typeof MCK_ONINIT&&MCK_ONINIT("error"),!1}}function preLoadLauncherIconInterval(){var f=setInterval((function(){document.getElementById("mck-sidebox-launcher")&&(document.getElementById("mck-sidebox-launcher").classList.remove("n-vis"),document.getElementById("mck-sidebox-launcher").classList.add("km-launcher-animation"),clearInterval(f))}),100)}this.load=function(){try{if("kommunicate"==applozic.PRODUCT_ID){if(void 0===applozic._globals.locShare)applozic._globals.locShare=!1;else if("string"==typeof applozic._globals.locShare)throw new Error("locShare should be a boolean value");if(void 0===applozic._globals.excludeGoogleMap)applozic._globals.excludeGoogleMap=!applozic._globals.locShare;else if("string"==typeof applozic._globals.excludeGoogleMap)throw new Error("excludeGoogleMap should be a boolean value")}for(var T in f){loadExternalFiles(f[T])}}catch(f){return"function"==typeof MCK_ONINIT&&MCK_ONINIT("error"),!1}}}applozicSideBox.load(),function(f){function e(T,L,K,U){var B={data:U||(L?L.data:{}),_wrap:L?L._wrap:null,tmpl:null,parent:L||null,nodes:[],calls:p,nest:c,wrap:d,html:u,update:m};return T&&f.extend(B,T,{nodes:[],parent:L}),K&&(B.tmpl=K,B._ctnt=B._ctnt||B.tmpl(f,B),B.key=++z,(q.length?G:P)[z]=B),B}function n(T,L,U){var P,G=U?f.map(U,(function(f){return"string"==typeof f?T.key?f.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+K+'="'+T.key+'" $2'):f:n(f,T,f._ctnt)})):T;return L?G:((G=G.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,(function(T,L,K,U){s(P=f(K).get()),L&&(P=o(L).concat(P)),U&&(P=P.concat(o(U)))})),P||o(G))}function o(T){var L=document.createElement("div");return L.innerHTML=T,f.makeArray(L.childNodes)}function i(T){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+f.trim(T).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,(function(T,L,K,U,P,G,B){var z,H,q,V=f.tmpl.tag[K];if(!V)throw"Template command not found: "+K;return z=V._default||[],G&&!/\w$/.test(P)&&(P+=G,G=""),P?(P=a(P),B=B?","+a(B)+")":G?")":"",H=G?P.indexOf(".")>-1?P+G:"("+P+").call($item"+B:P,q=G?H:"(typeof("+P+")==='function'?("+P+").call($item):("+P+"))"):q=H=z.$1||"null",U=a(U),"');"+V[L?"close":"open"].split("$notnull_1").join(P?"typeof("+P+")!=='undefined' && ("+P+")!=null":"true").split("$1a").join(q).split("$1").join(H).split("$2").join(U?U.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,(function(f,T,L,K){return(K=K?","+K+")":L?")":"")?"("+T+").call($item"+K:f})):z.$2||"")+"_.push('"}))+"');}return _;")}function r(T,L){T._wrap=n(T,!0,f.isArray(L)?L:[U.test(L)?L:f(L).html()]).join("")}function a(f){return f?f.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function s(T){function o(T){function o(f){B=J[f+=W]=J[f]||e(B,P[B.parent.key+W]||B.parent,null,!0)}var L,U,B,q,V=T;if(q=T.getAttribute(K)){for(;V.parentNode&&1===(V=V.parentNode).nodeType&&!(L=V.getAttribute(K)););L!==q&&(V=V.parentNode?11===V.nodeType?0:V.getAttribute(K)||0:0,(B=P[q])||((B=e(B=G[q],P[V]||G[V],null,!0)).key=++z,P[z]=B),H&&o(q)),T.removeAttribute(K)}else H&&(B=f.data(T,"tmplItem"))&&(o(B.key),P[B.key]=B,V=(V=f.data(T.parentNode,"tmplItem"))?V.key:0);if(B){for(U=B;U&&U.key!=V;)U.nodes.push(T),U=U.parent;delete B._ctnt,delete B._wrap,f.data(T,"tmplItem",B)}}var L,U,B,q,V,W="_"+H,J={};for(B=0,q=T.length;q>B;B++)if(1===(L=T[B]).nodeType){for(V=(U=L.getElementsByTagName("*")).length-1;V>=0;V--)o(U[V]);o(L)}}function p(f,T,L,K){return f?void q.push({_:f,tmpl:T,item:this,data:L,options:K}):q.pop()}function c(T,L,K){return f.tmpl(f.template(T),L,K,this)}function d(T,L){var K=T.options||{};return K.wrapped=L,f.tmpl(f.template(T.tmpl),T.data,K,T.item)}function u(T,L){var K=this._wrap;return f.map(f(f.isArray(K)?K.join(""):K).filter(T||"*"),(function(f){return L?f.innerText||f.textContent:f.outerHTML||function l(f){var T=document.createElement("div");return T.appendChild(f.cloneNode(!0)),T.innerHTML}(f)}))}function m(){var T=this.nodes;f.tmpl(null,null,null,this).insertBefore(T[0]),f(T).remove()}var T,L=f.fn.domManip,K="_tmplitem",U=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{! /,P={},G={},B={key:0,data:{}},z=0,H=0,q=[];f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(L,K){f.fn[L]=function(U){var G,B,z,q,V=[],W=f(U),J=1===this.length&&this[0].parentNode;if(T=P||{},J&&11===J.nodeType&&1===J.childNodes.length&&1===W.length)W[K](this[0]),V=this;else{for(B=0,z=W.length;z>B;B++)H=B,G=(B>0?this.clone(!0):this).get(),f.fn[K].apply(f(W[B]),G),V=V.concat(G);H=0,V=this.pushStack(V,L,W.selector)}return q=T,T=null,f.tmpl.complete(q),V}})),f.fn.extend({tmpl:function(T,L,K){return f.tmpl(this[0],T,L,K)},tmplItem:function(){return f.tmplItem(this[0])},template:function(T){return f.template(T,this[0])},domManip:function(K,U,G){if(K[0]&&K[0].nodeType){for(var B,z=f.makeArray(arguments),q=K.length,V=0;q>V&&!(B=f.data(K[V++],"tmplItem")););q>1&&(z[0]=[f.makeArray(K)]),B&&H&&(z[2]=function(T){f.tmpl.afterManip(this,T,G)}),L.apply(this,z)}else L.apply(this,arguments);return H=0,!T&&f.tmpl.complete(P),this}}),f.extend({tmpl:function(T,L,K,U){var z,H=!U;if(H)U=B,T=f.template[T]||f.template(null,T),G={};else if(!T)return T=U.tmpl,P[U.key]=U,U.nodes=[],U.wrapped&&r(U,U.wrapped),f(n(U,null,U.tmpl(f,U)));return T?("function"==typeof L&&(L=L.call(U||{})),K&&K.wrapped&&r(K,K.wrapped),z=f.isArray(L)?f.map(L,(function(f){return f?e(K,U,T,f):null})):[e(K,U,T,L)],H?f(n(U,null,z)):z):[]},tmplItem:function(T){var L;for(T instanceof f&&(T=T[0]);T&&1===T.nodeType&&!(L=f.data(T,"tmplItem"))&&(T=T.parentNode););return L||B},template:function(T,L){return L?("string"==typeof L?L=i(L):L instanceof f&&(L=L[0]||{}),L.nodeType&&(L=f.data(L,"tmpl")||f.data(L,"tmpl",i(L.innerHTML))),"string"==typeof T?f.template[T]=L:L):T?"string"!=typeof T?f.template(null,T):f.template[T]||f.template(null,U.test(T)?T:f(T)):null},encode:function(f){return(""+f).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),f.extend(f.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){P={}},afterManip:function(T,L,K){var U=11===L.nodeType?f.makeArray(L.childNodes):1===L.nodeType?[L]:[];K.call(T,L),s(U),H++}})}(jQuery),function(f){function e(T,L,K,U){var B={data:U||(L?L.data:{}),_wrap:L?L._wrap:null,tmpl:null,parent:L||null,nodes:[],calls:p,nest:c,wrap:d,html:u,update:m};return T&&f.extend(B,T,{nodes:[],parent:L}),K&&(B.tmpl=K,B._ctnt=B._ctnt||B.tmpl(f,B),B.key=++z,(q.length?G:P)[z]=B),B}function n(T,L,U){var P,G=U?f.map(U,(function(f){return"string"==typeof f?T.key?f.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+K+'="'+T.key+'" $2'):f:n(f,T,f._ctnt)})):T;return L?G:((G=G.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,(function(T,L,K,U){s(P=f(K).get()),L&&(P=o(L).concat(P)),U&&(P=P.concat(o(U)))})),P||o(G))}function o(T){var L=document.createElement("div");return L.innerHTML=T,f.makeArray(L.childNodes)}function i(T){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+f.trim(T).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,(function(T,L,K,U,P,G,B){var z,H,q,V=f.tmpl.tag[K];if(!V)throw"Template command not found: "+K;return z=V._default||[],G&&!/\w$/.test(P)&&(P+=G,G=""),P?(P=a(P),B=B?","+a(B)+")":G?")":"",H=G?P.indexOf(".")>-1?P+G:"("+P+").call($item"+B:P,q=G?H:"(typeof("+P+")==='function'?("+P+").call($item):("+P+"))"):q=H=z.$1||"null",U=a(U),"');"+V[L?"close":"open"].split("$notnull_1").join(P?"typeof("+P+")!=='undefined' && ("+P+")!=null":"true").split("$1a").join(q).split("$1").join(H).split("$2").join(U?U.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,(function(f,T,L,K){return(K=K?","+K+")":L?")":"")?"("+T+").call($item"+K:f})):z.$2||"")+"_.push('"}))+"');}return _;")}function r(T,L){T._wrap=n(T,!0,f.isArray(L)?L:[U.test(L)?L:f(L).html()]).join("")}function a(f){return f?f.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function s(T){function o(T){function o(f){B=J[f+=W]=J[f]||e(B,P[B.parent.key+W]||B.parent,null,!0)}var L,U,B,q,V=T;if(q=T.getAttribute(K)){for(;V.parentNode&&1===(V=V.parentNode).nodeType&&!(L=V.getAttribute(K)););L!==q&&(V=V.parentNode?11===V.nodeType?0:V.getAttribute(K)||0:0,(B=P[q])||((B=e(B=G[q],P[V]||G[V],null,!0)).key=++z,P[z]=B),H&&o(q)),T.removeAttribute(K)}else H&&(B=f.data(T,"tmplItem"))&&(o(B.key),P[B.key]=B,V=(V=f.data(T.parentNode,"tmplItem"))?V.key:0);if(B){for(U=B;U&&U.key!=V;)U.nodes.push(T),U=U.parent;delete B._ctnt,delete B._wrap,f.data(T,"tmplItem",B)}}var L,U,B,q,V,W="_"+H,J={};for(B=0,q=T.length;q>B;B++)if(1===(L=T[B]).nodeType){for(V=(U=L.getElementsByTagName("*")).length-1;V>=0;V--)o(U[V]);o(L)}}function p(f,T,L,K){return f?void q.push({_:f,tmpl:T,item:this,data:L,options:K}):q.pop()}function c(T,L,K){return f.tmpl(f.template(T),L,K,this)}function d(T,L){var K=T.options||{};return K.wrapped=L,f.tmpl(f.template(T.tmpl),T.data,K,T.item)}function u(T,L){var K=this._wrap;return f.map(f(f.isArray(K)?K.join(""):K).filter(T||"*"),(function(f){return L?f.innerText||f.textContent:f.outerHTML||function l(f){var T=document.createElement("div");return T.appendChild(f.cloneNode(!0)),T.innerHTML}(f)}))}function m(){var T=this.nodes;f.tmpl(null,null,null,this).insertBefore(T[0]),f(T).remove()}var T,L=f.fn.domManip,K="_tmplitem",U=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{! /,P={},G={},B={key:0,data:{}},z=0,H=0,q=[];f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(L,K){f.fn[L]=function(U){var G,B,z,q,V=[],W=f(U),J=1===this.length&&this[0].parentNode;if(T=P||{},J&&11===J.nodeType&&1===J.childNodes.length&&1===W.length)W[K](this[0]),V=this;else{for(B=0,z=W.length;z>B;B++)H=B,G=(B>0?this.clone(!0):this).get(),f.fn[K].apply(f(W[B]),G),V=V.concat(G);H=0,V=this.pushStack(V,L,W.selector)}return q=T,T=null,f.tmpl.complete(q),V}})),f.fn.extend({tmpl:function(T,L,K){return f.tmpl(this[0],T,L,K)},tmplItem:function(){return f.tmplItem(this[0])},template:function(T){return f.template(T,this[0])},domManip:function(K,U,G){if(K[0]&&K[0].nodeType){for(var B,z=f.makeArray(arguments),q=K.length,V=0;q>V&&!(B=f.data(K[V++],"tmplItem")););q>1&&(z[0]=[f.makeArray(K)]),B&&H&&(z[2]=function(T){f.tmpl.afterManip(this,T,G)}),L.apply(this,z)}else L.apply(this,arguments);return H=0,!T&&f.tmpl.complete(P),this}}),f.extend({tmpl:function(T,L,K,U){var z,H=!U;if(H)U=B,T=f.template[T]||f.template(null,T),G={};else if(!T)return T=U.tmpl,P[U.key]=U,U.nodes=[],U.wrapped&&r(U,U.wrapped),f(n(U,null,U.tmpl(f,U)));return T?("function"==typeof L&&(L=L.call(U||{})),K&&K.wrapped&&r(K,K.wrapped),z=f.isArray(L)?f.map(L,(function(f){return f?e(K,U,T,f):null})):[e(K,U,T,L)],H?f(n(U,null,z)):z):[]},tmplItem:function(T){var L;for(T instanceof f&&(T=T[0]);T&&1===T.nodeType&&!(L=f.data(T,"tmplItem"))&&(T=T.parentNode););return L||B},template:function(T,L){return L?("string"==typeof L?L=i(L):L instanceof f&&(L=L[0]||{}),L.nodeType&&(L=f.data(L,"tmpl")||f.data(L,"tmpl",i(L.innerHTML))),"string"==typeof T?f.template[T]=L:L):T?"string"!=typeof T?f.template(null,T):f.template[T]||f.template(null,U.test(T)?T:f(T)):null},encode:function(f){return(""+f).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),f.extend(f.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){P={}},afterManip:function(T,L,K){var U=11===L.nodeType?f.makeArray(L.childNodes):1===L.nodeType?[L]:[];K.call(T,L),s(U),H++}})}(jQuery),function(f){function e(T,L){return this.each((function(){var K=f(this),U=K.data("bs.mck-box"),P=f.extend({},n.DEFAULTS,K.data(),"object"==typeof T&&T);U||K.data("bs.mck-box",U=new n(this,P)),"string"==typeof T?U[T](L):P.show&&U.show(L)}))}var n=function(T,L){this.options=L,this.$body=f(document.body),this.$element=f(T),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".mck-box-content").load(this.options.remote,f.proxy((function(){this.$element.trigger("loaded.bs.mck-box")}),this))};n.VERSION="3.3.2",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(f){return this.isShown?this.hide():this.show(f)},n.prototype.show=function(T){var L=this,K=f.Event("show.bs.mck-box",{relatedTarget:T});this.$element.css("display","block"),this.isShown||K.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("mck-box-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.mck-box",'[data-dismiss="mckbox"]',f.proxy(this.hide,this)),this.backdrop((function(){var K=f.support.transition&&L.$element.hasClass("fade");L.$element.parent().length||L.$element.appendTo(L.$body),L.$element.show().scrollTop(0),L.options.backdrop&&L.adjustBackdrop(),L.adjustDialog(),K&&L.$element[0].offsetWidth,L.$element.addClass("in").attr("aria-hidden",!1),L.enforceFocus();var U=f.Event("shown.bs.mck-box",{relatedTarget:T});K?L.$element.find(".mck-box-dialog").one("bsTransitionEnd",(function(){L.$element.trigger("focus").trigger(U)})).emulateTransitionEnd(n.TRANSITION_DURATION):L.$element.trigger("focus").trigger(U)})))},n.prototype.hide=function(T){T&&T.preventDefault(),T=f.Event("hide.bs.mck-box"),this.$element.css("display","none"),this.isShown&&!T.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),f(document).off("focusin.bs.mck-box"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.mck-box"),f.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",f.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){f(document).off("focusin.bs.mck-box").on("focusin.bs.mck-box",f.proxy((function(f){this.$element[0]===f.target||this.$element.has(f.target).length||this.$element.trigger("focus")}),this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.mck-box",f.proxy((function(f){}),this)):this.isShown||this.$element.off("keydown.dismiss.bs.mck-box")},n.prototype.resize=function(){this.isShown?f(window).on("resize.bs.mck-box",f.proxy(this.handleUpdate,this)):f(window).off("resize.bs.mck-box")},n.prototype.hideModal=function(){var f=this;this.$element.hide(),this.backdrop((function(){f.$body.removeClass("mck-box-open"),f.resetAdjustments(),f.resetScrollbar(),f.$element.trigger("hidden.bs.mck-box")}))},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(T){var L=this,K=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var U=f.support.transition&&K;if(this.$backdrop=f('<div class="mck-box-backdrop '+K+'" />').prependTo(this.$element).on("click.dismiss.bs.mck-box",f.proxy((function(f){f.target===f.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))}),this)),U&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!T)return;U?this.$backdrop.one("bsTransitionEnd",T).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):T()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){L.removeBackdrop(),T&&T()};f.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):a()}else T&&T()},n.prototype.handleUpdate=function(){this.options.backdrop&&this.adjustBackdrop(),this.adjustDialog()},n.prototype.adjustBackdrop=function(){this.$backdrop.css("height",0).css("height",this.$element[0].scrollHeight)},n.prototype.adjustDialog=function(){var f=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&f?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!f?this.scrollbarWidth:""})},n.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},n.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var f=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",f+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},n.prototype.measureScrollbar=function(){var f=document.createElement("div");f.className="modal-scrollbar-measure",this.$body.append(f);var T=f.offsetWidth-f.clientWidth;return this.$body[0].removeChild(f),T};var T=f.fn.mckModal;f.fn.mckModal=e,f.fn.mckModal.Constructor=n,f.fn.mckModal.noConflict=function(){return f.fn.mckModal=T,this},f(document).on("click.bs.mck-box.data-api",'[data-toggle="mckbox"]',(function(T){var L=f(this),K=L.attr("href"),U=f(L.attr("data-target")||K&&K.replace(/.*(?=#[^\s]+$)/,"")),P=U.data("bs.mck-box")?"toggle":f.extend({remote:!/#/.test(K)&&K},U.data(),L.data());L.is("a")&&T.preventDefault(),U.one("show.bs.mck-box",(function(f){f.isDefaultPrevented()||U.one("hidden.bs.mck-box",(function(){L.is(":visible")&&L.trigger("focus")}))})),e.call(U,P,this)}))}(jQuery),function(f,T){function n(T){T&&3===T.which||(f(L).remove(),f(K).each((function(){var L=f(this),K=o(L),U={relatedTarget:this};K.hasClass("open")&&(K.trigger(T=f.Event("hide.bs.mck-dropdown",U)),T.isDefaultPrevented()||(L.attr("aria-expanded","false"),K.removeClass("open").trigger("hidden.bs.mck-dropdown",U)))})))}function o(T){var L=T.attr("data-target");L||(L=(L=T.attr("href"))&&/#[A-Za-z]/.test(L)&&L.replace(/.*(?=#[^\s]*$)/,""));var K=L&&f(L);return K&&K.length?K:T.parent()}var L=".mck-dropdown-backdrop",K='[data-toggle="mckdropdown"]',l=function(T){f(T).on("click.bs.mck-dropdown",this.toggle)};l.VERSION="3.3.2",l.prototype.toggle=function(L){var K=f(this);if(!K.is(".disabled, :disabled")){var U=o(K),P=U.hasClass("open");if(n(),!P){"ontouchstart"in T.documentElement&&!U.closest(".navbar-nav").length&&f('<div class="mck-dropdown-backdrop"/>').insertAfter(f(this)).on("click",n);var G={relatedTarget:this};if(U.trigger(L=f.Event("show.bs.mck-dropdown",G)),L.isDefaultPrevented())return;K.trigger("focus").attr("aria-expanded","true"),U.toggleClass("open").trigger("shown.bs.mck-dropdown",G)}return!1}},l.prototype.keydown=function(T){if(/(38|40|27|32)/.test(T.which)&&!/input|textarea/i.test(T.target.tagName)){var L=f(this);if(T.preventDefault(),T.stopPropagation(),!L.is(".disabled, :disabled")){var U=o(L),P=U.hasClass("open");if(!P&&27!=T.which||P&&27==T.which)return 27==T.which&&U.find(K).trigger("focus"),L.trigger("click");var G=" li:not(.divider):visible a",B=U.find('[role="menu"]'+G+', [role="listbox"]'+G);if(B.length){var z=B.index(T.target);38==T.which&&z>0&&z--,40==T.which&&z<B.length-1&&z++,~z||(z=0),B.eq(z).trigger("focus")}}}};var U=f.fn.mckDropdown;f.fn.mckDropdown=function i(T){return this.each((function(){var L=f(this),K=L.data("bs.mck-dropdown");K||L.data("bs.mck-dropdown",K=new l(this)),"string"==typeof T&&K[T].call(L)}))},f.fn.mckDropdown.Constructor=l,f.fn.mckDropdown.noConflict=function(){return f.fn.mckDropdown=U,this},f(T).on("click.bs.mck-dropdown.data-api",n).on("click.bs.mck-dropdown.data-api",".mck-dropdown form",(function(f){f.stopPropagation()})).on("click.bs.mck-dropdown.data-api",K,l.prototype.toggle).on("keydown.bs.mck-dropdown.data-api",K,l.prototype.keydown).on("keydown.bs.mck-dropdown.data-api",'[role="menu"]',l.prototype.keydown).on("keydown.bs.mck-dropdown.data-api",'[role="listbox"]',l.prototype.keydown)}(jQuery,document),function(f){var t=function(T,L){this.$element=f(T),this.options=f.extend({},f.fn.mcktypeahead.defaults,L),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=f(this.options.menu).appendTo(this.options.wrapper),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var f=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(f)).change(),this.hide()},updater:function(f){return f},show:function(){var T=f.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.hasClass("mck-auto-suggest-menu")?(this.$menu.css({bottom:"50px",left:"0px"}),this.$menu.show(),this.shown=!0,this):(this.$menu.css({top:T.top+T.height,left:T.left}),this.$menu.show(),this.shown=!0,this)},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(T){var L;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(L=f.isFunction(this.source)?this.source(this.query,f.proxy(this.process,this)):this.source)?this.process(L):this},process:function(T){var L=this;return T=f.grep(T,(function(f){return L.matcher(f)})),(T=this.sorter(T)).length?this.render(T.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(f){return~f.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(f){for(var T,L=[],K=[],U=[];T=f.shift();)T.toLowerCase().indexOf(this.query.toLowerCase())?~T.indexOf(this.query)?K.push(T):U.push(T):L.push(T);return L.concat(K,U)},highlighter:function(f){var T=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return f.replace(new RegExp("("+T+")","ig"),(function(f,T){return"<strong>"+T+"</strong>"}))},render:function(T){var L=this;return(T=f(T).map((function(T,K){return(T=f(L.options.item).attr("data-value",K)).find("a").html(L.highlighter(K)),T[0]}))).first().addClass("active"),this.$menu.html(T),this},next:function(T){var L=this.$menu.find(".active").removeClass("active").next();L.length||(L=f(this.$menu.find("li")[0])),L.addClass("active")},prev:function(f){var T=this.$menu.find(".active").removeClass("active").prev();T.length||(T=this.$menu.find("li").last()),T.addClass("active")},listen:function(){this.$element.on("blur",f.proxy(this.blur,this)).on("keypress",f.proxy(this.keypress,this)).on("keyup",f.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",f.proxy(this.keydown,this)),this.$menu.on("click",f.proxy(this.click,this)).on("mouseenter","li",f.proxy(this.mouseenter,this))},eventSupported:function(f){var T=f in this.$element;return T||(this.$element.setAttribute(f,"return;"),T="function"==typeof this.$element[f]),T},move:function(f){if(this.shown){switch(f.keyCode){case 9:case 13:if(!this.shown)return;this.select();break;case 27:f.preventDefault();break;case 38:f.preventDefault(),this.prev();break;case 40:f.preventDefault(),this.next()}f.stopPropagation()}},keydown:function(T){this.suppressKeyPressRepeat=!~f.inArray(T.keyCode,[40,38,9,13,27]),this.move(T)},keypress:function(f){this.suppressKeyPressRepeat||this.move(f)},keyup:function(f){switch(f.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}f.stopPropagation(),f.preventDefault()},blur:function(f){var T=this;setTimeout((function(){T.hide()}),150)},click:function(f){f.stopPropagation(),f.preventDefault(),this.select(),$applozic("#mck-text-box").submit()},mouseenter:function(T){this.$menu.find(".active").removeClass("active"),f(T.currentTarget).addClass("active")}},f.fn.mcktypeahead=function(T){return this.each((function(){var L=f(this),K=L.data("mcktypeahead"),U="object"==typeof T&&T;K||L.data("mcktypeahead",K=new t(this,U)),"string"==typeof T&&K[T]()}))},f.fn.mcktypeahead.defaults={source:[],items:8,wrapper:"body",menu:'<ul class="mcktypeahead mck-dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},f.fn.mcktypeahead.Constructor=t,f(document).on("focus.mcktypeahead.data-api",'[data-provide="mcktypeahead"]',(function(T){var L=f(this);L.data("mcktypeahead")||(T.preventDefault(),L.mcktypeahead(L.data()))}))}(window.jQuery),function(){var e=function(){this.init()};e.prototype={init:function(){var T=this||f;return T._counter=1e3,T._html5AudioPool=[],T.html5PoolSize=10,T._codecs={},T._howls=[],T._muted=!1,T._volume=1,T._canPlayEvent="canplaythrough",T._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,T.masterGain=null,T.noAudio=!1,T.usingWebAudio=!0,T.autoSuspend=!0,T.ctx=null,T.autoUnlock=!0,T._setup(),T},volume:function(T){var L=this||f;if(T=parseFloat(T),L.ctx||_(),void 0!==T&&T>=0&&T<=1){if(L._volume=T,L._muted)return L;L.usingWebAudio&&L.masterGain.gain.setValueAtTime(T,f.ctx.currentTime);for(var K=0;K<L._howls.length;K++)if(!L._howls[K]._webAudio)for(var U=L._howls[K]._getSoundIds(),P=0;P<U.length;P++){var G=L._howls[K]._soundById(U[P]);G&&G._node&&(G._node.volume=G._volume*T)}return L}return L._volume},mute:function(T){var L=this||f;L.ctx||_(),L._muted=T,L.usingWebAudio&&L.masterGain.gain.setValueAtTime(T?0:L._volume,f.ctx.currentTime);for(var K=0;K<L._howls.length;K++)if(!L._howls[K]._webAudio)for(var U=L._howls[K]._getSoundIds(),P=0;P<U.length;P++){var G=L._howls[K]._soundById(U[P]);G&&G._node&&(G._node.muted=!!T||G._muted)}return L},unload:function(){for(var T=this||f,L=T._howls.length-1;L>=0;L--)T._howls[L].unload();return T.usingWebAudio&&T.ctx&&void 0!==T.ctx.close&&(T.ctx.close(),T.ctx=null,_()),T},codecs:function(T){return(this||f)._codecs[T.replace(/^x-/,"")]},_setup:function(){var T=this||f;if(T.state=T.ctx&&T.ctx.state||"suspended",T._autoSuspend(),!T.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(T._canPlayEvent="canplay")}catch(f){T.noAudio=!0}else T.noAudio=!0;try{(new Audio).muted&&(T.noAudio=!0)}catch(f){}return T.noAudio||T._setupCodecs(),T},_setupCodecs:function(){var T=this||f,L=null;try{L="undefined"!=typeof Audio?new Audio:null}catch(f){return T}if(!L||"function"!=typeof L.canPlayType)return T;var K=L.canPlayType("audio/mpeg;").replace(/^no$/,""),U=T._navigator&&T._navigator.userAgent.match(/OPR\/([0-6].)/g),P=U&&parseInt(U[0].split("/")[1],10)<33;return T._codecs={mp3:!(P||!K&&!L.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!K,opus:!!L.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!L.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!L.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!L.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!L.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!L.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(L.canPlayType("audio/x-m4a;")||L.canPlayType("audio/m4a;")||L.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(L.canPlayType("audio/x-mp4;")||L.canPlayType("audio/mp4;")||L.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!L.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!L.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!L.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(L.canPlayType("audio/x-flac;")||L.canPlayType("audio/flac;")).replace(/^no$/,"")},T},_unlockAudio:function(){var T=this||f;if(!T._audioUnlocked&&T.ctx){T._audioUnlocked=!1,T.autoUnlock=!1,T._mobileUnloaded||44100===T.ctx.sampleRate||(T._mobileUnloaded=!0,T.unload()),T._scratchBuffer=T.ctx.createBuffer(1,1,22050);var o=function(f){for(var L=0;L<T.html5PoolSize;L++)try{var K=new Audio;K._unlocked=!0,T._releaseHtml5Audio(K)}catch(f){T.noAudio=!0}for(L=0;L<T._howls.length;L++)if(!T._howls[L]._webAudio)for(var U=T._howls[L]._getSoundIds(),P=0;P<U.length;P++){var G=T._howls[L]._soundById(U[P]);G&&G._node&&!G._node._unlocked&&(G._node._unlocked=!0,G._node.load())}T._autoResume();var B=T.ctx.createBufferSource();B.buffer=T._scratchBuffer,B.connect(T.ctx.destination),void 0===B.start?B.noteOn(0):B.start(0),"function"==typeof T.ctx.resume&&T.ctx.resume(),B.onended=function(){B.disconnect(0),T._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0);for(var f=0;f<T._howls.length;f++)T._howls[f]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),T}},_obtainHtml5Audio:function(){var T=this||f;if(T._html5AudioPool.length)return T._html5AudioPool.pop();var L=(new Audio).play();return L&&"undefined"!=typeof Promise&&(L instanceof Promise||"function"==typeof L.then)&&L.catch((function(){})),new Audio},_releaseHtml5Audio:function(T){var L=this||f;return T._unlocked&&L._html5AudioPool.push(T),L},_autoSuspend:function(){var T=this;if(T.autoSuspend&&T.ctx&&void 0!==T.ctx.suspend&&f.usingWebAudio){for(var L=0;L<T._howls.length;L++)if(T._howls[L]._webAudio)for(var K=0;K<T._howls[L]._sounds.length;K++)if(!T._howls[L]._sounds[K]._paused)return T;return T._suspendTimer&&clearTimeout(T._suspendTimer),T._suspendTimer=setTimeout((function(){T.autoSuspend&&(T._suspendTimer=null,T.state="suspending",T.ctx.suspend().then((function(){T.state="suspended",T._resumeAfterSuspend&&(delete T._resumeAfterSuspend,T._autoResume())})))}),3e4),T}},_autoResume:function(){var T=this;if(T.ctx&&void 0!==T.ctx.resume&&f.usingWebAudio)return"running"===T.state&&T._suspendTimer?(clearTimeout(T._suspendTimer),T._suspendTimer=null):"suspended"===T.state?(T.ctx.resume().then((function(){T.state="running";for(var f=0;f<T._howls.length;f++)T._howls[f]._emit("resume")})),T._suspendTimer&&(clearTimeout(T._suspendTimer),T._suspendTimer=null)):"suspending"===T.state&&(T._resumeAfterSuspend=!0),T}};var f=new e,o=function(f){f.src&&0!==f.src.length&&this.init(f)};o.prototype={init:function(T){var L=this;return f.ctx||_(),L._autoplay=T.autoplay||!1,L._format="string"!=typeof T.format?T.format:[T.format],L._html5=T.html5||!1,L._muted=T.mute||!1,L._loop=T.loop||!1,L._pool=T.pool||5,L._preload="boolean"!=typeof T.preload||T.preload,L._rate=T.rate||1,L._sprite=T.sprite||{},L._src="string"!=typeof T.src?T.src:[T.src],L._volume=void 0!==T.volume?T.volume:1,L._xhrWithCredentials=T.xhrWithCredentials||!1,L._duration=0,L._state="unloaded",L._sounds=[],L._endTimers={},L._queue=[],L._playLock=!1,L._onend=T.onend?[{fn:T.onend}]:[],L._onfade=T.onfade?[{fn:T.onfade}]:[],L._onload=T.onload?[{fn:T.onload}]:[],L._onloaderror=T.onloaderror?[{fn:T.onloaderror}]:[],L._onplayerror=T.onplayerror?[{fn:T.onplayerror}]:[],L._onpause=T.onpause?[{fn:T.onpause}]:[],L._onplay=T.onplay?[{fn:T.onplay}]:[],L._onstop=T.onstop?[{fn:T.onstop}]:[],L._onmute=T.onmute?[{fn:T.onmute}]:[],L._onvolume=T.onvolume?[{fn:T.onvolume}]:[],L._onrate=T.onrate?[{fn:T.onrate}]:[],L._onseek=T.onseek?[{fn:T.onseek}]:[],L._onunlock=T.onunlock?[{fn:T.onunlock}]:[],L._onresume=[],L._webAudio=f.usingWebAudio&&!L._html5,void 0!==f.ctx&&f.ctx&&f.autoUnlock&&f._unlockAudio(),f._howls.push(L),L._autoplay&&L._queue.push({event:"play",action:function(){L.play()}}),L._preload&&L.load(),L},load:function(){var T=this,L=null;if(!f.noAudio){"string"==typeof T._src&&(T._src=[T._src]);for(var K=0;K<T._src.length;K++){var U,P;if(T._format&&T._format[K])U=T._format[K];else{if("string"!=typeof(P=T._src[K])){T._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(U=/^data:audio\/([^;,]+);/i.exec(P))||(U=/\.([^.]+)$/.exec(P.split("?",1)[0])),U&&(U=U[1].toLowerCase())}if(U&&f.codecs(U)){L=T._src[K];break}}return L?(T._src=L,T._state="loading","https:"===window.location.protocol&&"http:"===L.slice(0,5)&&(T._html5=!0,T._webAudio=!1),new t(T),T._webAudio&&a(T),T):void T._emit("loaderror",null,"No codec support for selected audio sources.")}T._emit("loaderror",null,"No audio support.")},play:function(T,L){var K=this,U=null;if("number"==typeof T)U=T,T=null;else{if("string"==typeof T&&"loaded"===K._state&&!K._sprite[T])return null;if(void 0===T&&(T="__default",!K._playLock)){for(var P=0,G=0;G<K._sounds.length;G++)K._sounds[G]._paused&&!K._sounds[G]._ended&&(P++,U=K._sounds[G]._id);1===P?T=null:U=null}}var B=U?K._soundById(U):K._inactiveSound();if(!B)return null;if(U&&!T&&(T=B._sprite||"__default"),"loaded"!==K._state){B._sprite=T,B._ended=!1;var z=B._id;return K._queue.push({event:"play",action:function(){K.play(z)}}),z}if(U&&!B._paused)return L||K._loadQueue("play"),B._id;K._webAudio&&f._autoResume();var H=Math.max(0,B._seek>0?B._seek:K._sprite[T][0]/1e3),q=Math.max(0,(K._sprite[T][0]+K._sprite[T][1])/1e3-H),V=1e3*q/Math.abs(B._rate),W=K._sprite[T][0]/1e3,J=(K._sprite[T][0]+K._sprite[T][1])/1e3,ee=!(!B._loop&&!K._sprite[T][2]);B._sprite=T,B._ended=!1;var m=function(){B._paused=!1,B._seek=H,B._start=W,B._stop=J,B._loop=ee};if(!(H>=J)){var te=B._node;if(K._webAudio){var h=function(){K._playLock=!1,m(),K._refreshBuffer(B);var T=B._muted||K._muted?0:B._volume;te.gain.setValueAtTime(T,f.ctx.currentTime),B._playStart=f.ctx.currentTime,void 0===te.bufferSource.start?B._loop?te.bufferSource.noteGrainOn(0,H,86400):te.bufferSource.noteGrainOn(0,H,q):B._loop?te.bufferSource.start(0,H,86400):te.bufferSource.start(0,H,q),V!==1/0&&(K._endTimers[B._id]=setTimeout(K._ended.bind(K,B),V)),L||setTimeout((function(){K._emit("play",B._id),K._loadQueue()}),0)};"running"===f.state?h():(K._playLock=!0,K.once("resume",h),K._clearTimer(B._id))}else{var y=function(){te.currentTime=H,te.muted=B._muted||K._muted||f._muted||te.muted,te.volume=B._volume*f.volume(),te.playbackRate=B._rate;try{var U=te.play();if(U&&"undefined"!=typeof Promise&&(U instanceof Promise||"function"==typeof U.then)?(K._playLock=!0,m(),U.then((function(){K._playLock=!1,te._unlocked=!0,L||(K._emit("play",B._id),K._loadQueue())})).catch((function(){K._playLock=!1,K._emit("playerror",B._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),B._ended=!0,B._paused=!0}))):L||(K._playLock=!1,m(),K._emit("play",B._id),K._loadQueue()),te.playbackRate=B._rate,te.paused)return void K._emit("playerror",B._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==T||B._loop?K._endTimers[B._id]=setTimeout(K._ended.bind(K,B),V):(K._endTimers[B._id]=function(){K._ended(B),te.removeEventListener("ended",K._endTimers[B._id],!1)},te.addEventListener("ended",K._endTimers[B._id],!1))}catch(f){K._emit("playerror",B._id,f)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===te.src&&(te.src=K._src,te.load());var ae=window&&window.ejecta||!te.readyState&&f._navigator.isCocoonJS;if(te.readyState>=3||ae)y();else{K._playLock=!0;var A=function(){y(),te.removeEventListener(f._canPlayEvent,A,!1)};te.addEventListener(f._canPlayEvent,A,!1),K._clearTimer(B._id)}}return B._id}K._ended(B)},pause:function(f){var T=this;if("loaded"!==T._state||T._playLock)return T._queue.push({event:"pause",action:function(){T.pause(f)}}),T;for(var L=T._getSoundIds(f),K=0;K<L.length;K++){T._clearTimer(L[K]);var U=T._soundById(L[K]);if(U&&!U._paused&&(U._seek=T.seek(L[K]),U._rateSeek=0,U._paused=!0,T._stopFade(L[K]),U._node))if(T._webAudio){if(!U._node.bufferSource)continue;void 0===U._node.bufferSource.stop?U._node.bufferSource.noteOff(0):U._node.bufferSource.stop(0),T._cleanBuffer(U._node)}else isNaN(U._node.duration)&&U._node.duration!==1/0||U._node.pause();arguments[1]||T._emit("pause",U?U._id:null)}return T},stop:function(f,T){var L=this;if("loaded"!==L._state||L._playLock)return L._queue.push({event:"stop",action:function(){L.stop(f)}}),L;for(var K=L._getSoundIds(f),U=0;U<K.length;U++){L._clearTimer(K[U]);var P=L._soundById(K[U]);P&&(P._seek=P._start||0,P._rateSeek=0,P._paused=!0,P._ended=!0,L._stopFade(K[U]),P._node&&(L._webAudio?P._node.bufferSource&&(void 0===P._node.bufferSource.stop?P._node.bufferSource.noteOff(0):P._node.bufferSource.stop(0),L._cleanBuffer(P._node)):isNaN(P._node.duration)&&P._node.duration!==1/0||(P._node.currentTime=P._start||0,P._node.pause(),P._node.duration===1/0&&L._clearSound(P._node))),T||L._emit("stop",P._id))}return L},mute:function(T,L){var K=this;if("loaded"!==K._state||K._playLock)return K._queue.push({event:"mute",action:function(){K.mute(T,L)}}),K;if(void 0===L){if("boolean"!=typeof T)return K._muted;K._muted=T}for(var U=K._getSoundIds(L),P=0;P<U.length;P++){var G=K._soundById(U[P]);G&&(G._muted=T,G._interval&&K._stopFade(G._id),K._webAudio&&G._node?G._node.gain.setValueAtTime(T?0:G._volume,f.ctx.currentTime):G._node&&(G._node.muted=!!f._muted||T),K._emit("mute",G._id))}return K},volume:function(){var T,L,K,U=this,P=arguments;if(0===P.length)return U._volume;if(1===P.length||2===P.length&&void 0===P[1]?U._getSoundIds().indexOf(P[0])>=0?L=parseInt(P[0],10):T=parseFloat(P[0]):P.length>=2&&(T=parseFloat(P[0]),L=parseInt(P[1],10)),!(void 0!==T&&T>=0&&T<=1))return(K=L?U._soundById(L):U._sounds[0])?K._volume:0;if("loaded"!==U._state||U._playLock)return U._queue.push({event:"volume",action:function(){U.volume.apply(U,P)}}),U;void 0===L&&(U._volume=T),L=U._getSoundIds(L);for(var G=0;G<L.length;G++)(K=U._soundById(L[G]))&&(K._volume=T,P[2]||U._stopFade(L[G]),U._webAudio&&K._node&&!K._muted?K._node.gain.setValueAtTime(T,f.ctx.currentTime):K._node&&!K._muted&&(K._node.volume=T*f.volume()),U._emit("volume",K._id));return U},fade:function(T,L,K,U){var P=this;if("loaded"!==P._state||P._playLock)return P._queue.push({event:"fade",action:function(){P.fade(T,L,K,U)}}),P;T=parseFloat(T),L=parseFloat(L),K=parseFloat(K),P.volume(T,U);for(var G=P._getSoundIds(U),B=0;B<G.length;B++){var z=P._soundById(G[B]);if(z){if(U||P._stopFade(G[B]),P._webAudio&&!z._muted){var H=f.ctx.currentTime,q=H+K/1e3;z._volume=T,z._node.gain.setValueAtTime(T,H),z._node.gain.linearRampToValueAtTime(L,q)}P._startFadeInterval(z,T,L,K,G[B],void 0===U)}}return P},_startFadeInterval:function(f,T,L,K,U,P){var G=this,B=T,z=L-T,H=Math.abs(z/.01),q=Math.max(4,H>0?K/H:K),V=Date.now();f._fadeTo=L,f._interval=setInterval((function(){var U=(Date.now()-V)/K;V=Date.now(),B+=z*U,B=Math.max(0,B),B=Math.min(1,B),B=Math.round(100*B)/100,G._webAudio?f._volume=B:G.volume(B,f._id,!0),P&&(G._volume=B),(L<T&&B<=L||L>T&&B>=L)&&(clearInterval(f._interval),f._interval=null,f._fadeTo=null,G.volume(L,f._id),G._emit("fade",f._id))}),q)},_stopFade:function(T){var L=this,K=L._soundById(T);return K&&K._interval&&(L._webAudio&&K._node.gain.cancelScheduledValues(f.ctx.currentTime),clearInterval(K._interval),K._interval=null,L.volume(K._fadeTo,T),K._fadeTo=null,L._emit("fade",T)),L},loop:function(){var f,T,L,K=this,U=arguments;if(0===U.length)return K._loop;if(1===U.length){if("boolean"!=typeof U[0])return!!(L=K._soundById(parseInt(U[0],10)))&&L._loop;f=U[0],K._loop=f}else 2===U.length&&(f=U[0],T=parseInt(U[1],10));for(var P=K._getSoundIds(T),G=0;G<P.length;G++)(L=K._soundById(P[G]))&&(L._loop=f,K._webAudio&&L._node&&L._node.bufferSource&&(L._node.bufferSource.loop=f,f&&(L._node.bufferSource.loopStart=L._start||0,L._node.bufferSource.loopEnd=L._stop)));return K},rate:function(){var T,L,K,U=this,P=arguments;if(0===P.length)L=U._sounds[0]._id;else if(1===P.length){var G=U._getSoundIds(),B=G.indexOf(P[0]);B>=0?L=parseInt(P[0],10):T=parseFloat(P[0])}else 2===P.length&&(T=parseFloat(P[0]),L=parseInt(P[1],10));if("number"!=typeof T)return(K=U._soundById(L))?K._rate:U._rate;if("loaded"!==U._state||U._playLock)return U._queue.push({event:"rate",action:function(){U.rate.apply(U,P)}}),U;void 0===L&&(U._rate=T),L=U._getSoundIds(L);for(var z=0;z<L.length;z++)if(K=U._soundById(L[z])){U.playing(L[z])&&(K._rateSeek=U.seek(L[z]),K._playStart=U._webAudio?f.ctx.currentTime:K._playStart),K._rate=T,U._webAudio&&K._node&&K._node.bufferSource?K._node.bufferSource.playbackRate.setValueAtTime(T,f.ctx.currentTime):K._node&&(K._node.playbackRate=T);var H=U.seek(L[z]),q=(U._sprite[K._sprite][0]+U._sprite[K._sprite][1])/1e3-H,V=1e3*q/Math.abs(K._rate);!U._endTimers[L[z]]&&K._paused||(U._clearTimer(L[z]),U._endTimers[L[z]]=setTimeout(U._ended.bind(U,K),V)),U._emit("rate",K._id)}return U},seek:function(){var T,L,K=this,U=arguments;if(0===U.length)L=K._sounds[0]._id;else if(1===U.length){var P=K._getSoundIds(),G=P.indexOf(U[0]);G>=0?L=parseInt(U[0],10):K._sounds.length&&(L=K._sounds[0]._id,T=parseFloat(U[0]))}else 2===U.length&&(T=parseFloat(U[0]),L=parseInt(U[1],10));if(void 0===L)return K;if("loaded"!==K._state||K._playLock)return K._queue.push({event:"seek",action:function(){K.seek.apply(K,U)}}),K;var B=K._soundById(L);if(B){if(!("number"==typeof T&&T>=0)){if(K._webAudio){var z=K.playing(L)?f.ctx.currentTime-B._playStart:0,H=B._rateSeek?B._rateSeek-B._seek:0;return B._seek+(H+z*Math.abs(B._rate))}return B._node.currentTime}var q=K.playing(L);q&&K.pause(L,!0),B._seek=T,B._ended=!1,K._clearTimer(L),K._webAudio||!B._node||isNaN(B._node.duration)||(B._node.currentTime=T);var l=function(){K._emit("seek",L),q&&K.play(L,!0)};if(q&&!K._webAudio){var c=function(){K._playLock?setTimeout(c,0):l()};setTimeout(c,0)}else l()}return K},playing:function(f){var T=this;if("number"==typeof f){var L=T._soundById(f);return!!L&&!L._paused}for(var K=0;K<T._sounds.length;K++)if(!T._sounds[K]._paused)return!0;return!1},duration:function(f){var T=this,L=T._duration,K=T._soundById(f);return K&&(L=T._sprite[K._sprite][1]/1e3),L},state:function(){return this._state},unload:function(){for(var L=this,K=L._sounds,U=0;U<K.length;U++)K[U]._paused||L.stop(K[U]._id),L._webAudio||(L._clearSound(K[U]._node),K[U]._node.removeEventListener("error",K[U]._errorFn,!1),K[U]._node.removeEventListener(f._canPlayEvent,K[U]._loadFn,!1),f._releaseHtml5Audio(K[U]._node)),delete K[U]._node,L._clearTimer(K[U]._id);var P=f._howls.indexOf(L);P>=0&&f._howls.splice(P,1);var G=!0;for(U=0;U<f._howls.length;U++)if(f._howls[U]._src===L._src||L._src.indexOf(f._howls[U]._src)>=0){G=!1;break}return T&&G&&delete T[L._src],f.noAudio=!1,L._state="unloaded",L._sounds=[],L=null,null},on:function(f,T,L,K){var U=this["_on"+f];return"function"==typeof T&&U.push(K?{id:L,fn:T,once:K}:{id:L,fn:T}),this},off:function(f,T,L){var K=this,U=K["_on"+f],P=0;if("number"==typeof T&&(L=T,T=null),T||L)for(P=0;P<U.length;P++){var G=L===U[P].id;if(T===U[P].fn&&G||!T&&G){U.splice(P,1);break}}else if(f)K["_on"+f]=[];else{var B=Object.keys(K);for(P=0;P<B.length;P++)0===B[P].indexOf("_on")&&Array.isArray(K[B[P]])&&(K[B[P]]=[])}return K},once:function(f,T,L){return this.on(f,T,L,1),this},_emit:function(f,T,L){for(var K=this,U=K["_on"+f],P=U.length-1;P>=0;P--)U[P].id&&U[P].id!==T&&"load"!==f||(setTimeout(function(f){f.call(this,T,L)}.bind(K,U[P].fn),0),U[P].once&&K.off(f,U[P].fn,U[P].id));return K._loadQueue(f),K},_loadQueue:function(f){var T=this;if(T._queue.length>0){var L=T._queue[0];L.event===f&&(T._queue.shift(),T._loadQueue()),f||L.action()}return T},_ended:function(T){var L=this,K=T._sprite;if(!L._webAudio&&T._node&&!T._node.paused&&!T._node.ended&&T._node.currentTime<T._stop)return setTimeout(L._ended.bind(L,T),100),L;var U=!(!T._loop&&!L._sprite[K][2]);if(L._emit("end",T._id),!L._webAudio&&U&&L.stop(T._id,!0).play(T._id),L._webAudio&&U){L._emit("play",T._id),T._seek=T._start||0,T._rateSeek=0,T._playStart=f.ctx.currentTime;var P=1e3*(T._stop-T._start)/Math.abs(T._rate);L._endTimers[T._id]=setTimeout(L._ended.bind(L,T),P)}return L._webAudio&&!U&&(T._paused=!0,T._ended=!0,T._seek=T._start||0,T._rateSeek=0,L._clearTimer(T._id),L._cleanBuffer(T._node),f._autoSuspend()),L._webAudio||U||L.stop(T._id,!0),L},_clearTimer:function(f){var T=this;if(T._endTimers[f]){if("function"!=typeof T._endTimers[f])clearTimeout(T._endTimers[f]);else{var L=T._soundById(f);L&&L._node&&L._node.removeEventListener("ended",T._endTimers[f],!1)}delete T._endTimers[f]}return T},_soundById:function(f){for(var T=this,L=0;L<T._sounds.length;L++)if(f===T._sounds[L]._id)return T._sounds[L];return null},_inactiveSound:function(){var f=this;f._drain();for(var T=0;T<f._sounds.length;T++)if(f._sounds[T]._ended)return f._sounds[T].reset();return new t(f)},_drain:function(){var f=this,T=f._pool,L=0,K=0;if(!(f._sounds.length<T)){for(K=0;K<f._sounds.length;K++)f._sounds[K]._ended&&L++;for(K=f._sounds.length-1;K>=0;K--){if(L<=T)return;f._sounds[K]._ended&&(f._webAudio&&f._sounds[K]._node&&f._sounds[K]._node.disconnect(0),f._sounds.splice(K,1),L--)}}},_getSoundIds:function(f){if(void 0===f){for(var T=[],L=0;L<this._sounds.length;L++)T.push(this._sounds[L]._id);return T}return[f]},_refreshBuffer:function(L){return L._node.bufferSource=f.ctx.createBufferSource(),L._node.bufferSource.buffer=T[this._src],L._panner?L._node.bufferSource.connect(L._panner):L._node.bufferSource.connect(L._node),L._node.bufferSource.loop=L._loop,L._loop&&(L._node.bufferSource.loopStart=L._start||0,L._node.bufferSource.loopEnd=L._stop||0),L._node.bufferSource.playbackRate.setValueAtTime(L._rate,f.ctx.currentTime),this},_cleanBuffer:function(T){var L=f._navigator&&f._navigator.vendor.indexOf("Apple")>=0;if(f._scratchBuffer&&T.bufferSource&&(T.bufferSource.onended=null,T.bufferSource.disconnect(0),L))try{T.bufferSource.buffer=f._scratchBuffer}catch(f){}return T.bufferSource=null,this},_clearSound:function(T){/MSIE |Trident\//.test(f._navigator&&f._navigator.userAgent)||(T.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var t=function(f){this._parent=f,this.init()};t.prototype={init:function(){var T=this,L=T._parent;return T._muted=L._muted,T._loop=L._loop,T._volume=L._volume,T._rate=L._rate,T._seek=0,T._paused=!0,T._ended=!0,T._sprite="__default",T._id=++f._counter,L._sounds.push(T),T.create(),T},create:function(){var T=this,L=T._parent,K=f._muted||T._muted||T._parent._muted?0:T._volume;return L._webAudio?(T._node=void 0===f.ctx.createGain?f.ctx.createGainNode():f.ctx.createGain(),T._node.gain.setValueAtTime(K,f.ctx.currentTime),T._node.paused=!0,T._node.connect(f.masterGain)):(T._node=f._obtainHtml5Audio(),T._errorFn=T._errorListener.bind(T),T._node.addEventListener("error",T._errorFn,!1),T._loadFn=T._loadListener.bind(T),T._node.addEventListener(f._canPlayEvent,T._loadFn,!1),T._node.src=L._src,T._node.preload="auto",T._node.volume=K*f.volume(),T._node.load()),T},reset:function(){var T=this,L=T._parent;return T._muted=L._muted,T._loop=L._loop,T._volume=L._volume,T._rate=L._rate,T._seek=0,T._rateSeek=0,T._paused=!0,T._ended=!0,T._sprite="__default",T._id=++f._counter,T},_errorListener:function(){var f=this;f._parent._emit("loaderror",f._id,f._node.error?f._node.error.code:0),f._node.removeEventListener("error",f._errorFn,!1)},_loadListener:function(){var T=this,L=T._parent;L._duration=Math.ceil(10*T._node.duration)/10,0===Object.keys(L._sprite).length&&(L._sprite={__default:[0,1e3*L._duration]}),"loaded"!==L._state&&(L._state="loaded",L._emit("load"),L._loadQueue()),T._node.removeEventListener(f._canPlayEvent,T._loadFn,!1)}};var T={},a=function(f){var L=f._src;if(T[L])return f._duration=T[L].duration,void d(f);if(/^data:[^;]+;base64,/.test(L)){for(var K=atob(L.split(",")[1]),U=new Uint8Array(K.length),P=0;P<K.length;++P)U[P]=K.charCodeAt(P);i(U.buffer,f)}else{var G=new XMLHttpRequest;G.open("GET",L,!0),G.withCredentials=f._xhrWithCredentials,G.responseType="arraybuffer",G.onload=function(){var T=(G.status+"")[0];"0"===T||"2"===T||"3"===T?i(G.response,f):f._emit("loaderror",null,"Failed loading audio file with status: "+G.status+".")},G.onerror=function(){f._webAudio&&(f._html5=!0,f._webAudio=!1,f._sounds=[],delete T[L],f.load())},u(G)}},u=function(f){try{f.send()}catch(T){f.onerror()}},i=function(L,K){var t=function(){K._emit("loaderror",null,"Decoding audio data failed.")},a=function(f){f&&K._sounds.length>0?(T[K._src]=f,d(K,f)):t()};"undefined"!=typeof Promise&&1===f.ctx.decodeAudioData.length?f.ctx.decodeAudioData(L).then(a).catch(t):f.ctx.decodeAudioData(L,a,t)},d=function(f,T){T&&!f._duration&&(f._duration=T.duration),0===Object.keys(f._sprite).length&&(f._sprite={__default:[0,1e3*f._duration]}),"loaded"!==f._state&&(f._state="loaded",f._emit("load"),f._loadQueue())},_=function(){if(f.usingWebAudio){try{"undefined"!=typeof AudioContext?f.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?f.ctx=new webkitAudioContext:f.usingWebAudio=!1}catch(T){f.usingWebAudio=!1}f.ctx||(f.usingWebAudio=!1);var T=/iP(hone|od|ad)/.test(f._navigator&&f._navigator.platform),L=f._navigator&&f._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),K=L?parseInt(L[1],10):null;if(T&&K&&K<9){var U=/safari/.test(f._navigator&&f._navigator.userAgent.toLowerCase());(f._navigator&&f._navigator.standalone&&!U||f._navigator&&!f._navigator.standalone&&!U)&&(f.usingWebAudio=!1)}f.usingWebAudio&&(f.masterGain=void 0===f.ctx.createGain?f.ctx.createGainNode():f.ctx.createGain(),f.masterGain.gain.setValueAtTime(f._muted?0:1,f.ctx.currentTime),f.masterGain.connect(f.ctx.destination)),f._setup()}};"function"==typeof define&&define.amd&&define([],(function(){return{Howler:f,Howl:o}})),"undefined"!=typeof exports&&(exports.Howler=f,exports.Howl=o),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=f,window.Howl=o,window.Sound=t):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=f,global.Howl=o,global.Sound=t)}();var tns=function(){Object.keys||(Object.keys=function(f){var T=[];for(var L in f)Object.prototype.hasOwnProperty.call(f,L)&&T.push(L);return T}),"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});var f=window,T=f.requestAnimationFrame||f.webkitRequestAnimationFrame||f.mozRequestAnimationFrame||f.msRequestAnimationFrame||function(f){return setTimeout(f,16)},L=window,K=L.cancelAnimationFrame||L.mozCancelAnimationFrame||function(f){clearTimeout(f)};function Hi(){for(var f,T,L,K=arguments[0]||{},U=1,P=arguments.length;U<P;U++)if(null!==(f=arguments[U]))for(T in f)K!==(L=f[T])&&void 0!==L&&(K[T]=L);return K}function ki(f){return 0<=["true","false"].indexOf(f)?JSON.parse(f):f}function Ri(f,T,L,K){if(K)try{f.setItem(T,L)}catch(f){}return L}function Ii(){var f=document,T=f.body;return T||((T=f.createElement("body")).fake=!0),T}var U=document.documentElement;function Pi(f){var T="";return f.fake&&(T=U.style.overflow,f.style.background="",f.style.overflow=U.style.overflow="hidden",U.appendChild(f)),T}function zi(f,T){f.fake&&(f.remove(),U.style.overflow=T,U.offsetHeight)}function Wi(f,T,L,K){"insertRule"in f?f.insertRule(T+"{"+L+"}",K):f.addRule(T,L,K)}function Fi(f){return("insertRule"in f?f.cssRules:f.rules).length}function qi(f,T,L){for(var K=0,U=f.length;K<U;K++)T.call(L,f[K],K)}var P="classList"in document.createElement("_"),G=P?function(f,T){return f.classList.contains(T)}:function(f,T){return 0<=f.className.indexOf(T)},B=P?function(f,T){G(f,T)||f.classList.add(T)}:function(f,T){G(f,T)||(f.className+=" "+T)},z=P?function(f,T){G(f,T)&&f.classList.remove(T)}:function(f,T){G(f,T)&&(f.className=f.className.replace(T,""))};function Qi(f,T){return f.hasAttribute(T)}function Xi(f,T){return f.getAttribute(T)}function r(f){return void 0!==f.item}function Yi(f,T){if(f=r(f)||f instanceof Array?f:[f],"[object Object]"===Object.prototype.toString.call(T))for(var L=f.length;L--;)for(var K in T)f[L].setAttribute(K,T[K])}function Ki(f,T){f=r(f)||f instanceof Array?f:[f];for(var L=(T=T instanceof Array?T:[T]).length,K=f.length;K--;)for(var U=L;U--;)f[K].removeAttribute(T[U])}function Ji(f){for(var T=[],L=0,K=f.length;L<K;L++)T.push(f[L]);return T}function Ui(f,T){"none"!==f.style.display&&(f.style.display="none")}function _i(f,T){"none"===f.style.display&&(f.style.display="")}function Zi(f){return"none"!==window.getComputedStyle(f).display}function $i(f){if("string"==typeof f){var T=[f],L=f.charAt(0).toUpperCase()+f.substr(1);["Webkit","Moz","ms","O"].forEach((function(K){"ms"===K&&"transform"!==f||T.push(K+L)})),f=T}for(var K=document.createElement("fakeelement"),U=(f.length,0);U<f.length;U++){var P=f[U];if(void 0!==K.style[P])return P}return!1}function ta(f,T){var L=!1;return/^Webkit/.test(f)?L="webkit"+T+"End":/^O/.test(f)?L="o"+T+"End":f&&(L=T.toLowerCase()+"end"),L}var H=!1;try{var q=Object.defineProperty({},"passive",{get:function(){H=!0}});window.addEventListener("test",null,q)}catch(f){}var V=!!H&&{passive:!0};function ea(f,T,L){for(var K in T){var U=0<=["touchstart","touchmove"].indexOf(K)&&!L&&V;f.addEventListener(K,T[K],U)}}function na(f,T){for(var L in T){var K=0<=["touchstart","touchmove"].indexOf(L)&&V;f.removeEventListener(L,T[L],K)}}function ia(){return{topics:{},on:function(f,T){this.topics[f]=this.topics[f]||[],this.topics[f].push(T)},off:function(f,T){if(this.topics[f])for(var L=0;L<this.topics[f].length;L++)if(this.topics[f][L]===T){this.topics[f].splice(L,1);break}},emit:function(f,T){T.type=f,this.topics[f]&&this.topics[f].forEach((function(L){L(T,f)}))}}}var aa=function(f){f=Hi({container:".slider",mode:"carousel",axis:"horizontal",items:1,gutter:0,edgePadding:0,fixedWidth:!1,autoWidth:!1,viewportMax:!1,slideBy:1,center:!1,controls:!0,controlsPosition:"top",controlsText:["prev","next"],controlsContainer:!1,prevButton:!1,nextButton:!1,nav:!0,navPosition:"top",navContainer:!1,navAsThumbnails:!1,arrowKeys:!1,speed:300,autoplay:!1,autoplayPosition:"top",autoplayTimeout:5e3,autoplayDirection:"forward",autoplayText:["start","stop"],autoplayHoverPause:!1,autoplayButton:!1,autoplayButtonOutput:!0,autoplayResetOnVisibility:!0,animateIn:"tns-fadeIn",animateOut:"tns-fadeOut",animateNormal:"tns-normal",animateDelay:!1,loop:!0,rewind:!1,autoHeight:!1,responsive:!1,lazyload:!1,lazyloadSelector:".tns-lazy-img",touch:!0,mouseDrag:!1,swipeAngle:15,nested:!1,preventActionWhenRunning:!1,preventScrollOnTouch:!1,freezable:!0,onInit:!1,useLocalStorage:!0},f||{});var L=document,U=window,P={ENTER:13,SPACE:32,LEFT:37,RIGHT:39},H={},q=f.useLocalStorage;if(q){var V=navigator.userAgent,W=new Date;try{(H=U.localStorage)?(H.setItem(W,W),q=H.getItem(W)==W,H.removeItem(W)):q=!1,q||(H={})}catch(f){q=!1}q&&(H.tnsApp&&H.tnsApp!==V&&["tC","tPL","tMQ","tTf","t3D","tTDu","tTDe","tADu","tADe","tTE","tAE"].forEach((function(f){H.removeItem(f)})),localStorage.tnsApp=V)}var J,ee,te,ae,ne,oe,ie,se=H.tC?ki(H.tC):Ri(H,"tC",function(){var f=document,T=Ii(),L=Pi(T),K=f.createElement("div"),U=!1;T.appendChild(K);try{for(var P,G="(10px * 10)",B=["calc"+G,"-moz-calc"+G,"-webkit-calc"+G],z=0;z<3;z++)if(P=B[z],K.style.width=P,100===K.offsetWidth){U=P.replace(G,"");break}}catch(f){}return T.fake?zi(T,L):K.remove(),U}(),q),re=H.tPL?ki(H.tPL):Ri(H,"tPL",function(){var f,T=document,L=Ii(),K=Pi(L),U=T.createElement("div"),P=T.createElement("div"),G="";U.className="tns-t-subp2",P.className="tns-t-ct";for(var B=0;B<70;B++)G+="<div></div>";return P.innerHTML=G,U.appendChild(P),L.appendChild(U),f=Math.abs(U.getBoundingClientRect().left-P.children[67].getBoundingClientRect().left)<2,L.fake?zi(L,K):U.remove(),f}(),q),ce=H.tMQ?ki(H.tMQ):Ri(H,"tMQ",(ee=document,ae=Pi(te=Ii()),ne=ee.createElement("div"),ie="@media all and (min-width:1px){.tns-mq-test{position:absolute}}",(oe=ee.createElement("style")).type="text/css",ne.className="tns-mq-test",te.appendChild(oe),te.appendChild(ne),oe.styleSheet?oe.styleSheet.cssText=ie:oe.appendChild(ee.createTextNode(ie)),J=window.getComputedStyle?window.getComputedStyle(ne).position:ne.currentStyle.position,te.fake?zi(te,ae):ne.remove(),"absolute"===J),q),le=H.tTf?ki(H.tTf):Ri(H,"tTf",$i("transform"),q),de=H.t3D?ki(H.t3D):Ri(H,"t3D",function(f){if(!f)return!1;if(!window.getComputedStyle)return!1;var T,L=document,K=Ii(),U=Pi(K),P=L.createElement("p"),G=9<f.length?"-"+f.slice(0,-9).toLowerCase()+"-":"";return G+="transform",K.insertBefore(P,null),P.style[f]="translate3d(1px,1px,1px)",T=window.getComputedStyle(P).getPropertyValue(G),K.fake?zi(K,U):P.remove(),void 0!==T&&0<T.length&&"none"!==T}(le),q),me=H.tTDu?ki(H.tTDu):Ri(H,"tTDu",$i("transitionDuration"),q),ue=H.tTDe?ki(H.tTDe):Ri(H,"tTDe",$i("transitionDelay"),q),pe=H.tADu?ki(H.tADu):Ri(H,"tADu",$i("animationDuration"),q),ge=H.tADe?ki(H.tADe):Ri(H,"tADe",$i("animationDelay"),q),ve=H.tTE?ki(H.tTE):Ri(H,"tTE",ta(me,"Transition"),q),fe=H.tAE?ki(H.tAE):Ri(H,"tAE",ta(pe,"Animation"),q),he=(U.console&&U.console.warn,["container","controlsContainer","prevButton","nextButton","navContainer","autoplayButton"]),ke={};if(he.forEach((function(T){if("string"==typeof f[T]){var K=f[T],U=L.querySelector(K);if(ke[T]=K,!U||!U.nodeName)return;f[T]=U}})),!(f.container.children.length<1)){var ye=f.responsive,Ce=f.nested,be="carousel"===f.mode;if(ye){0 in ye&&(f=Hi(f,ye[0]),delete ye[0]);var _e={};for(var Ee in ye){var Ie=ye[Ee];Ie="number"==typeof Ie?{items:Ie}:Ie,_e[Ee]=Ie}ye=_e,_e=null}if(be||function t(f){for(var T in f)be||("slideBy"===T&&(f[T]="page"),"edgePadding"===T&&(f[T]=!1),"autoHeight"===T&&(f[T]=!1)),"responsive"===T&&t(f[T])}(f),!be){f.axis="horizontal",f.slideBy="page",f.edgePadding=!1;var Te=f.animateIn,Ae=f.animateOut,Se=f.animateDelay,Me=f.animateNormal}var we,Le,xe="horizontal"===f.axis,Oe=L.createElement("div"),Ne=L.createElement("div"),Ke=f.container,Ue=Ke.parentNode,Re=Ke.outerHTML,De=Ke.children,Pe=De.length,Ge=sn(),Be=!1;ye&&Bn(),be&&(Ke.className+=" tns-vpfix");var Fe,ze,He,$e,qe,je,Ve,We=f.autoWidth,Ye=vn("fixedWidth"),Je=vn("edgePadding"),Qe=vn("gutter"),Xe=fn(),Ze=vn("center"),ot=We?1:Math.floor(vn("items")),lt=vn("slideBy"),ut=f.viewportMax||f.fixedWidthViewportWidth,gt=vn("arrowKeys"),vt=vn("speed"),ft=f.rewind,ht=!ft&&f.loop,Ct=vn("autoHeight"),_t=vn("controls"),Et=vn("controlsText"),Tt=vn("nav"),St=vn("touch"),wt=vn("mouseDrag"),xt=vn("autoplay"),Ot=vn("autoplayTimeout"),Nt=vn("autoplayText"),Kt=vn("autoplayHoverPause"),Dt=vn("autoplayResetOnVisibility"),Gt=(Ve=document.createElement("style"),document.querySelector("head").appendChild(Ve),Ve.sheet?Ve.sheet:Ve.styleSheet),Bt=f.lazyload,zt=(f.lazyloadSelector,[]),Wt=ht?(qe=function(){if(We||Ye&&!ut)return Pe-1;var T=Ye?"fixedWidth":"items",L=[];if((Ye||f[T]<Pe)&&L.push(f[T]),ye)for(var K in ye){var U=ye[K][T];U&&(Ye||U<Pe)&&L.push(U)}return L.length||L.push(0),Math.ceil(Ye?ut/Math.min.apply(null,L):Math.max.apply(null,L))}(),je=be?Math.ceil((5*qe-Pe)/2):4*qe-Pe,je=Math.max(qe,je),dn("edgePadding")?je+1:je):0,Yt=be?Pe+2*Wt:Pe+Wt,Jt=!(!Ye&&!We||ht),Qt=Ye?ni():null,Xt=!be||!ht,Zt=xe?"left":"top",oa="",sa="",ra=Ye?function(){return Ze&&!ht?Pe-1:Math.ceil(-Qt/(Ye+Qe))}:We?function(){for(var f=Yt;f--;)if(Fe[f]>=-Qt)return f}:function(){return Ze&&be&&!ht?Pe-1:ht||be?Math.max(0,Yt-Math.ceil(ot)):Yt-1},ca=on(vn("startIndex")),la=ca,da=(rn(),0),ma=We?null:ra(),ua=f.preventActionWhenRunning,pa=f.swipeAngle,ga=!pa||"?",va=!1,fa=f.onInit,ha=new ia,ka=" tns-slider tns-"+f.mode,ya=Ke.id||($e=window.tnsId,window.tnsId=$e?$e+1:1,"tns"+window.tnsId),Ca=vn("disable"),ba=!1,_a=f.freezable,Ea=!(!_a||We)&&Ln(),Ia=!1,Ta={click:fi,keydown:function(f){f=xi(f);var T=[P.LEFT,P.RIGHT].indexOf(f.keyCode);0<=T&&(0===T?ja.disabled||fi(f,-1):Va.disabled||fi(f,1))}},Aa={click:function(f){if(va){if(ua)return;si()}for(var T=bi(f=xi(f));T!==Qa&&!Qi(T,"data-nav");)T=T.parentNode;if(Qi(T,"data-nav")){var L=tn=Number(Xi(T,"data-nav")),K=Ye||We?L*Pe/Za:L*ot;ci(Ka?L:Math.min(Math.ceil(K),Pe-1),f),nn===L&&(io&&hi(),tn=-1)}},keydown:function(f){f=xi(f);var T=L.activeElement;if(Qi(T,"data-nav")){var K=[P.LEFT,P.RIGHT,P.ENTER,P.SPACE].indexOf(f.keyCode),U=Number(Xi(T,"data-nav"));0<=K&&(0===K?0<U&&gi(Ja[U-1]):1===K?U<Za-1&&gi(Ja[U+1]):ci(tn=U,f))}}},Sa={mouseover:function(){io&&(vi(),so=!0)},mouseout:function(){so&&(di(),so=!1)}},Ma={visibilitychange:function(){L.hidden?io&&(vi(),co=!0):co&&(di(),co=!1)}},wa={keydown:function(f){f=xi(f);var T=[P.LEFT,P.RIGHT].indexOf(f.keyCode);0<=T&&fi(f,0===T?-1:1)}},La={touchstart:Ti,touchmove:Ei,touchend:Ai,touchcancel:Ai},xa={mousedown:Ti,mousemove:Ei,mouseup:Ai,mouseleave:Ai},Oa=dn("controls"),Na=dn("nav"),Ka=!!We||f.navAsThumbnails,Ua=dn("autoplay"),Ra=dn("touch"),Da=dn("mouseDrag"),Pa="tns-slide-active",Ga="tns-complete",Ba={load:function(f){zn(bi(f))},error:function(f){var T;T=bi(f),B(T,"failed"),Wn(T)}},Fa="force"===f.preventScrollOnTouch;if(Oa)var za,Ha,$a=f.controlsContainer,qa=f.controlsContainer?f.controlsContainer.outerHTML:"",ja=f.prevButton,Va=f.nextButton,Wa=f.prevButton?f.prevButton.outerHTML:"",Ya=f.nextButton?f.nextButton.outerHTML:"";if(Na)var Ja,Qa=f.navContainer,Xa=f.navContainer?f.navContainer.outerHTML:"",Za=We?Pe:Li(),en=0,tn=-1,nn=ln(),eo=nn,to="tns-nav-active",ao="Carousel Page ",no=" (Current Slide)";if(Ua)var oo,io,so,ro,co,lo="forward"===f.autoplayDirection?1:-1,mo=f.autoplayButton,uo=f.autoplayButton?f.autoplayButton.outerHTML:"",po=["<span class='tns-visually-hidden'>"," animation</span>"];if(Ra||Da)var go,vo,fo={},ho={},ko=!1,yo=xe?function(f,T){return f.x-T.x}:function(f,T){return f.y-T.y};We||an(Ca||Ea),le&&(Zt=le,oa="translate",de?(oa+=xe?"3d(":"3d(0px, ",sa=xe?", 0px, 0px)":", 0px)"):(oa+=xe?"X(":"Y(",sa=")")),be&&(Ke.className=Ke.className.replace("tns-vpfix","")),function(){(dn("gutter"),Oe.className="tns-outer",Ne.className="tns-inner",Oe.id=ya+"-ow",Ne.id=ya+"-iw",""===Ke.id&&(Ke.id=ya),ka+=re||We?" tns-subpixel":" tns-no-subpixel",ka+=se?" tns-calc":" tns-no-calc",We&&(ka+=" tns-autowidth"),ka+=" tns-"+f.axis,Ke.className+=ka,be?((we=L.createElement("div")).id=ya+"-mw",we.className="tns-ovh",Oe.appendChild(we),we.appendChild(Ne)):Oe.appendChild(Ne),Ct)&&((we||Ne).className+=" tns-ah");if(Ue.insertBefore(Oe,Ke),Ne.appendChild(Ke),qi(De,(function(f,T){B(f,"tns-item"),f.id||(f.id=ya+"-item"+T),!be&&Me&&B(f,Me),Yi(f,{"aria-hidden":"true",tabindex:"-1"})})),Wt){for(var T=L.createDocumentFragment(),K=L.createDocumentFragment(),U=Wt;U--;){var P=U%Pe,G=De[P].cloneNode(!0);if(Ki(G,"id"),K.insertBefore(G,K.firstChild),be){var z=De[Pe-1-P].cloneNode(!0);Ki(z,"id"),T.appendChild(z)}}Ke.insertBefore(T,Ke.firstChild),Ke.appendChild(K),De=Ke.children}}(),function(){if(!be)for(var T=ca,L=ca+Math.min(Pe,ot);T<L;T++){var K=De[T];K.style.left=100*(T-ca)/ot+"%",B(K,Te),z(K,Me)}if(xe&&(re||We?(Wi(Gt,"#"+ya+" > .tns-item","font-size:"+U.getComputedStyle(De[0]).fontSize+";",Fi(Gt)),Wi(Gt,"#"+ya,"font-size:0;",Fi(Gt))):be&&qi(De,(function(f,T){var L;f.style.marginLeft=(L=T,se?se+"("+100*L+"% / "+Yt+")":100*L/Yt+"%")}))),ce){if(me){var P=we&&f.autoHeight?xn(f.speed):"";Wi(Gt,"#"+ya+"-mw",P,Fi(Gt))}P=pn(f.edgePadding,f.gutter,f.fixedWidth,f.speed,f.autoHeight),Wi(Gt,"#"+ya+"-iw",P,Fi(Gt)),be&&(P=xe&&!We?"width:"+mn(f.fixedWidth,f.gutter,f.items)+";":"",me&&(P+=xn(vt)),Wi(Gt,"#"+ya,P,Fi(Gt))),P=xe&&!We?hn(f.fixedWidth,f.gutter,f.items):"",f.gutter&&(P+=yn(f.gutter)),be||(me&&(P+=xn(vt)),pe&&(P+=bn(vt))),P&&Wi(Gt,"#"+ya+" > .tns-item",P,Fi(Gt))}else{Gn(),Ne.style.cssText=pn(Je,Qe,Ye,Ct),be&&xe&&!We&&(Ke.style.width=mn(Ye,Qe,ot));P=xe&&!We?hn(Ye,Qe,ot):"";Qe&&(P+=yn(Qe)),P&&Wi(Gt,"#"+ya+" > .tns-item",P,Fi(Gt))}if(ye&&ce)for(var G in ye){G=parseInt(G);var H=ye[G],q=(P="",""),V="",W="",J="",ee=We?null:vn("items",G),te=vn("fixedWidth",G),ae=vn("speed",G),ne=vn("edgePadding",G),oe=vn("autoHeight",G),ie=vn("gutter",G);me&&we&&vn("autoHeight",G)&&"speed"in H&&(q="#"+ya+"-mw{"+xn(ae)+"}"),("edgePadding"in H||"gutter"in H)&&(V="#"+ya+"-iw{"+pn(ne,ie,te,ae,oe)+"}"),be&&xe&&!We&&("fixedWidth"in H||"items"in H||Ye&&"gutter"in H)&&(W="width:"+mn(te,ie,ee)+";"),me&&"speed"in H&&(W+=xn(ae)),W&&(W="#"+ya+"{"+W+"}"),("fixedWidth"in H||Ye&&"gutter"in H||!be&&"items"in H)&&(J+=hn(te,ie,ee)),"gutter"in H&&(J+=yn(ie)),!be&&"speed"in H&&(me&&(J+=xn(ae)),pe&&(J+=bn(ae))),J&&(J="#"+ya+" > .tns-item{"+J+"}"),(P=q+V+W+J)&&Gt.insertRule("@media (min-width: "+G/16+"em) {"+P+"}",Gt.cssRules.length)}}(),Cn();var Co=ht?be?function(){var f=da,T=ma;f+=lt,T-=lt,Je?(f+=1,T-=1):Ye&&(Xe+Qe)%(Ye+Qe)&&(T-=1),Wt&&(T<ca?ca-=Pe:ca<f&&(ca+=Pe))}:function(){if(ma<ca)for(;da+Pe<=ca;)ca-=Pe;else if(ca<da)for(;ca<=ma-Pe;)ca+=Pe}:function(){ca=Math.max(da,Math.min(ma,ca))},bo=be?function(){var f,T,L,K,U,P,G,B,z,H,q;ti(Ke,""),me||!vt?(ri(),vt&&Zi(Ke)||si()):(f=Ke,T=Zt,L=oa,K=sa,U=ii(),P=vt,G=si,B=Math.min(P,10),z=0<=U.indexOf("%")?"%":"px",U=U.replace(z,""),H=Number(f.style[T].replace(L,"").replace(K,"").replace(z,"")),q=(U-H)/P*B,setTimeout((function t(){P-=B,H+=q,f.style[T]=L+H+z+K,0<P?setTimeout(t,B):G()}),B)),xe||Ni()}:function(){zt=[];var f={};f[ve]=f[fe]=si,na(De[la],f),ea(De[ca],f),oi(la,Te,Ae,!0),oi(ca,Me,Te),ve&&fe&&vt&&Zi(Ke)||si()};return{version:"2.9.2",getInfo:Si,events:ha,goTo:ci,play:function(){xt&&!io&&(mi(),ro=!1)},pause:function(){io&&(hi(),ro=!0)},isOn:Be,updateSliderHeight:Xn,refresh:Cn,destroy:function(){if(Gt.disabled=!0,Gt.ownerNode&&Gt.ownerNode.remove(),na(U,{resize:An}),gt&&na(L,wa),$a&&na($a,Ta),Qa&&na(Qa,Aa),na(Ke,Sa),na(Ke,Ma),mo&&na(mo,{click:yi}),xt&&clearInterval(oo),be&&ve){var T={};T[ve]=si,na(Ke,T)}St&&na(Ke,La),wt&&na(Ke,xa);var K=[Re,qa,Wa,Ya,Xa,uo];for(var P in he.forEach((function(T,L){var U="container"===T?Oe:f[T];if("object"==typeof U){var P=!!U.previousElementSibling&&U.previousElementSibling,G=U.parentNode;U.outerHTML=K[L],f[T]=P?P.nextElementSibling:G.firstElementChild}})),he=Te=Ae=Se=Me=xe=Oe=Ne=Ke=Ue=Re=De=Pe=Le=Ge=We=Ye=Je=Qe=Xe=ot=lt=ut=gt=vt=ft=ht=Ct=Gt=Bt=Fe=zt=Wt=Yt=Jt=Qt=Xt=Zt=oa=sa=ra=ca=la=da=ma=pa=ga=va=fa=ha=ka=ya=Ca=ba=_a=Ea=Ia=Ta=Aa=Sa=Ma=wa=La=xa=Oa=Na=Ka=Ua=Ra=Da=Pa=Ga=Ba=ze=_t=Et=$a=qa=ja=Va=za=Ha=Tt=Qa=Xa=Ja=Za=en=tn=nn=eo=to=ao=no=xt=Ot=lo=Nt=Kt=mo=uo=Dt=po=oo=io=so=ro=co=fo=ho=go=ko=vo=yo=St=wt=null,this)"rebuild"!==P&&(this[P]=null);Be=!1},rebuild:function(){return aa(Hi(f,ke))}}}function an(f){f&&(_t=Tt=St=wt=gt=xt=Kt=Dt=!1)}function rn(){for(var f=be?ca-Wt:ca;f<0;)f+=Pe;return f%Pe+1}function on(f){return f=f?Math.max(0,Math.min(ht?Pe-1:Pe-ot,f)):0,be?f+Wt:f}function un(f){for(null==f&&(f=ca),be&&(f-=Wt);f<0;)f+=Pe;return Math.floor(f%Pe)}function ln(){var f,T=un();return f=Ka?T:Ye||We?Math.ceil((T+1)*Za/Pe-1):Math.floor(T/ot),!ht&&be&&ca===ma&&(f=Za-1),f}function sn(){return U.innerWidth||L.documentElement.clientWidth||L.body.clientWidth}function cn(f){return"top"===f?"afterbegin":"beforeend"}function fn(){var f=Je?2*Je-Qe:0;return function t(f){var T,K,U=L.createElement("div");return f.appendChild(U),K=(T=U.getBoundingClientRect()).right-T.left,U.remove(),K||t(f.parentNode)}(Ue)-f}function dn(T){if(f[T])return!0;if(ye)for(var L in ye)if(ye[L][T])return!0;return!1}function vn(T,L){if(null==L&&(L=Ge),"items"===T&&Ye)return Math.floor((Xe+Qe)/(Ye+Qe))||1;var K=f[T];if(ye)for(var U in ye)L>=parseInt(U)&&T in ye[U]&&(K=ye[U][T]);return"slideBy"===T&&"page"===K&&(K=vn("items")),be||"slideBy"!==T&&"items"!==T||(K=Math.floor(K)),K}function pn(f,T,L,K,U){var P="";if(void 0!==f){var G=f;T&&(G-=T),P=xe?"margin: 0 "+G+"px 0 "+f+"px;":"margin: "+f+"px 0 "+G+"px 0;"}else if(T&&!L){var B="-"+T+"px";P="margin: 0 "+(xe?B+" 0 0":"0 "+B+" 0")+";"}return!be&&U&&me&&K&&(P+=xn(K)),P}function mn(f,T,L){return f?(f+T)*Yt+"px":se?se+"("+100*Yt+"% / "+L+")":100*Yt/L+"%"}function hn(f,T,L){var K;if(f)K=f+T+"px";else{be||(L=Math.floor(L));var U=be?Yt:L;K=se?se+"(100% / "+U+")":100/U+"%"}return K="width:"+K,"inner"!==Ce?K+";":K+" !important;"}function yn(f){var T="";return!1!==f&&(T=(xe?"padding-":"margin-")+(xe?"right":"bottom")+": "+f+"px;"),T}function gn(f,T){var L=f.substring(0,f.length-T).toLowerCase();return L&&(L="-"+L+"-"),L}function xn(f){return gn(me,18)+"transition-duration:"+f/1e3+"s;"}function bn(f){return gn(pe,17)+"animation-duration:"+f/1e3+"s;"}function Cn(){if(dn("autoHeight")||We||!xe){var f=Ke.querySelectorAll("img");qi(f,(function(f){var T=f.src;T&&T.indexOf("data:image")<0?(ea(f,Ba),f.src="",f.src=T,B(f,"loading")):Bt||zn(f)})),T((function(){jn(Ji(f),(function(){ze=!0}))})),!We&&xe&&(f=Fn(ca,Math.min(ca+ot-1,Yt-1))),Bt?wn():T((function(){jn(Ji(f),wn)}))}else be&&ai(),Tn(),En()}function wn(){if(We){var f=ht?ca:Pe-1;!function t(){De[f-1].getBoundingClientRect().right.toFixed(2)===De[f].getBoundingClientRect().left.toFixed(2)?Mn():setTimeout((function(){t()}),16)}()}else Mn()}function Mn(){xe&&!We||(Yn(),We?(Qt=ni(),_a&&(Ea=Ln()),ma=ra(),an(Ca||Ea)):Ni()),be&&ai(),Tn(),En()}function Tn(){if(Kn(),Oe.insertAdjacentHTML("afterbegin",'<div class="tns-liveregion tns-visually-hidden" aria-live="polite" aria-atomic="true">slide <span class="current">'+Rn()+"</span>  of "+Pe+"</div>"),He=Oe.querySelector(".tns-liveregion .current"),Ua){var T=xt?"stop":"start";mo?Yi(mo,{"data-action":T}):f.autoplayButtonOutput&&(Oe.insertAdjacentHTML(cn(f.autoplayPosition),'<button data-action="'+T+'">'+po[0]+T+po[1]+Nt[0]+"</button>"),mo=Oe.querySelector("[data-action]")),mo&&ea(mo,{click:yi}),xt&&(mi(),Kt&&ea(Ke,Sa),Dt&&ea(Ke,Ma))}if(Na){if(Qa)Yi(Qa,{"aria-label":"Carousel Pagination"}),qi(Ja=Qa.children,(function(f,T){Yi(f,{"data-nav":T,tabindex:"-1","aria-label":ao+(T+1),"aria-controls":ya})}));else{for(var L="",K=Ka?"":'style="display:none"',U=0;U<Pe;U++)L+='<button data-nav="'+U+'" tabindex="-1" aria-controls="'+ya+'" '+K+' aria-label="'+ao+(U+1)+'"></button>';L='<div class="tns-nav" aria-label="Carousel Pagination">'+L+"</div>",Oe.insertAdjacentHTML(cn(f.navPosition),L),Qa=Oe.querySelector(".tns-nav"),Ja=Qa.children}if(Bi(),me){var P=me.substring(0,me.length-18).toLowerCase(),G="transition: all "+vt/1e3+"s";P&&(G="-"+P+"-"+G),Wi(Gt,"[aria-controls^="+ya+"-item]",G,Fi(Gt))}Yi(Ja[nn],{"aria-label":ao+(nn+1)+no}),Ki(Ja[nn],"tabindex"),B(Ja[nn],to),ea(Qa,Aa)}Oa&&($a||ja&&Va||(Oe.insertAdjacentHTML(cn(f.controlsPosition),'<div class="tns-controls" aria-label="Carousel Navigation" tabindex="0"><button data-controls="prev" tabindex="-1" aria-controls="'+ya+'">'+Et[0]+'</button><button data-controls="next" tabindex="-1" aria-controls="'+ya+'">'+Et[1]+"</button></div>"),$a=Oe.querySelector(".tns-controls")),ja&&Va||(ja=$a.children[0],Va=$a.children[1]),f.controlsContainer&&Yi($a,{"aria-label":"Carousel Navigation",tabindex:"0"}),(f.controlsContainer||f.prevButton&&f.nextButton)&&Yi([ja,Va],{"aria-controls":ya,tabindex:"-1"}),(f.controlsContainer||f.prevButton&&f.nextButton)&&(Yi(ja,{"data-controls":"prev"}),Yi(Va,{"data-controls":"next"})),za=Un(ja),Ha=Un(Va),$n(),$a?ea($a,Ta):(ea(ja,Ta),ea(Va,Ta))),Sn()}function En(){if(be&&ve){var T={};T[ve]=si,ea(Ke,T)}St&&ea(Ke,La,f.preventScrollOnTouch),wt&&ea(Ke,xa),gt&&ea(L,wa),"inner"===Ce?ha.on("outerResized",(function(){Nn(),ha.emit("innerLoaded",Si())})):(ye||Ye||We||Ct||!xe)&&ea(U,{resize:An}),Ct&&("outer"===Ce?ha.on("innerLoaded",qn):Ca||qn()),Pn(),Ca?Hn():Ea&&Dn(),ha.on("indexChanged",Vn),"inner"===Ce&&ha.emit("innerLoaded",Si()),"function"==typeof fa&&fa(Si()),Be=!0}function An(f){T((function(){Nn(xi(f))}))}function Nn(T){if(Be){"outer"===Ce&&ha.emit("outerResized",Si(T)),Ge=sn();var K,U=Le,P=!1;ye&&(Bn(),(K=U!==Le)&&ha.emit("newBreakpointStart",Si(T)));var G,H,q,V,W=ot,J=Ca,ee=Ea,te=gt,ae=_t,ne=Tt,oe=St,ie=wt,se=xt,re=Kt,le=Dt,de=ca;if(K){var me=Ye,ue=Ct,pe=Et,ge=Ze,ve=Nt;if(!ce)var fe=Qe,he=Je}if(gt=vn("arrowKeys"),_t=vn("controls"),Tt=vn("nav"),St=vn("touch"),Ze=vn("center"),wt=vn("mouseDrag"),xt=vn("autoplay"),Kt=vn("autoplayHoverPause"),Dt=vn("autoplayResetOnVisibility"),K&&(Ca=vn("disable"),Ye=vn("fixedWidth"),vt=vn("speed"),Ct=vn("autoHeight"),Et=vn("controlsText"),Nt=vn("autoplayText"),Ot=vn("autoplayTimeout"),ce||(Je=vn("edgePadding"),Qe=vn("gutter"))),an(Ca),Xe=fn(),xe&&!We||Ca||(Yn(),xe||(Ni(),P=!0)),(Ye||We)&&(Qt=ni(),ma=ra()),(K||Ye)&&(ot=vn("items"),lt=vn("slideBy"),(H=ot!==W)&&(Ye||We||(ma=ra()),Co())),K&&Ca!==J&&(Ca?Hn():function(){if(ba){if(Gt.disabled=!1,Ke.className+=ka,ai(),ht)for(var f=Wt;f--;)be&&_i(De[f]),_i(De[Yt-f-1]);if(!be)for(var T=ca,L=ca+Pe;T<L;T++){var K=De[T],U=T<ca+ot?Te:Me;K.style.left=100*(T-ca)/ot+"%",B(K,U)}On(),ba=!1}}()),_a&&(K||Ye||We)&&(Ea=Ln())!==ee&&(Ea?(ri(ii(on(0))),Dn()):(function(){if(Ia){if(Je&&ce&&(Ne.style.margin=""),Wt)for(var f="tns-transparent",T=Wt;T--;)be&&z(De[T],f),z(De[Yt-T-1],f);On(),Ia=!1}}(),P=!0)),an(Ca||Ea),xt||(Kt=Dt=!1),gt!==te&&(gt?ea(L,wa):na(L,wa)),_t!==ae&&(_t?$a?_i($a):(ja&&_i(ja),Va&&_i(Va)):$a?Ui($a):(ja&&Ui(ja),Va&&Ui(Va))),Tt!==ne&&(Tt?_i(Qa):Ui(Qa)),St!==oe&&(St?ea(Ke,La,f.preventScrollOnTouch):na(Ke,La)),wt!==ie&&(wt?ea(Ke,xa):na(Ke,xa)),xt!==se&&(xt?(mo&&_i(mo),io||ro||mi()):(mo&&Ui(mo),io&&hi())),Kt!==re&&(Kt?ea(Ke,Sa):na(Ke,Sa)),Dt!==le&&(Dt?ea(L,Ma):na(L,Ma)),K){if(Ye===me&&Ze===ge||(P=!0),Ct!==ue&&(Ct||(Ne.style.height="")),_t&&Et!==pe&&(ja.innerHTML=Et[0],Va.innerHTML=Et[1]),mo&&Nt!==ve){var ke=xt?1:0,_e=mo.innerHTML,Ee=_e.length-ve[ke].length;_e.substring(Ee)===ve[ke]&&(mo.innerHTML=_e.substring(0,Ee)+Nt[ke])}}else Ze&&(Ye||We)&&(P=!0);if((H||Ye&&!We)&&(Za=Li(),Bi()),(G=ca!==de)?(ha.emit("indexChanged",Si()),P=!0):H?G||Vn():(Ye||We)&&(Pn(),Kn(),kn()),H&&!be&&function(){for(var f=ca+Math.min(Pe,ot),T=Yt;T--;){var L=De[T];ca<=T&&T<f?(B(L,"tns-moving"),L.style.left=100*(T-ca)/ot+"%",B(L,Te),z(L,Me)):L.style.left&&(L.style.left="",B(L,Me),z(L,Te)),z(L,Ae)}setTimeout((function(){qi(De,(function(f){z(f,"tns-moving")}))}),300)}(),!Ca&&!Ea){if(K&&!ce&&(Ct===autoheightTem&&vt===speedTem||Gn(),Je===he&&Qe===fe||(Ne.style.cssText=pn(Je,Qe,Ye,vt,Ct)),xe)){be&&(Ke.style.width=mn(Ye,Qe,ot));var Ie=hn(Ye,Qe,ot)+yn(Qe);V=Fi(q=Gt)-1,"deleteRule"in q?q.deleteRule(V):q.removeRule(V),Wi(Gt,"#"+ya+" > .tns-item",Ie,Fi(Gt))}Ct&&qn(),P&&(ai(),la=ca)}K&&ha.emit("newBreakpointEnd",Si(T))}}function Ln(){if(!Ye&&!We)return Pe<=(Ze?ot-(ot-1)/2:ot);var f=Ye?(Ye+Qe)*Pe:Fe[Pe],T=Je?Xe+2*Je:Xe+Qe;return Ze&&(T-=Ye?(Xe-Ye)/2:(Xe-(Fe[ca+1]-Fe[ca]-Qe))/2),f<=T}function Bn(){for(var f in Le=0,ye)(f=parseInt(f))<=Ge&&(Le=f)}function Sn(){!xt&&mo&&Ui(mo),!Tt&&Qa&&Ui(Qa),_t||($a?Ui($a):(ja&&Ui(ja),Va&&Ui(Va)))}function On(){xt&&mo&&_i(mo),Tt&&Qa&&_i(Qa),_t&&($a?_i($a):(ja&&_i(ja),Va&&_i(Va)))}function Dn(){if(!Ia){if(Je&&(Ne.style.margin="0px"),Wt)for(var f="tns-transparent",T=Wt;T--;)be&&B(De[T],f),B(De[Yt-T-1],f);Sn(),Ia=!0}}function Hn(){if(!ba){if(Gt.disabled=!0,Ke.className=Ke.className.replace(ka.substring(1),""),Ki(Ke,["style"]),ht)for(var f=Wt;f--;)be&&Ui(De[f]),Ui(De[Yt-f-1]);if(xe&&be||Ki(Ne,["style"]),!be)for(var T=ca,L=ca+Pe;T<L;T++){var K=De[T];Ki(K,["style"]),z(K,Te),z(K,Me)}Sn(),ba=!0}}function kn(){var f=Rn();He.innerHTML!==f&&(He.innerHTML=f)}function Rn(){var f=In(),T=f[0]+1,L=f[1]+1;return T===L?T+"":T+" to "+L}function In(f){null==f&&(f=ii());var T,L,K,U=ca;if(Ze||Je?(We||Ye)&&(L=-(parseFloat(f)+Je),K=L+Xe+2*Je):We&&(L=Fe[ca],K=L+Xe),We)Fe.forEach((function(f,P){P<Yt&&((Ze||Je)&&f<=L+.5&&(U=P),.5<=K-f&&(T=P))}));else{if(Ye){var P=Ye+Qe;Ze||Je?(U=Math.floor(L/P),T=Math.ceil(K/P-1)):T=U+Math.ceil(Xe/P)-1}else if(Ze||Je){var G=ot-1;if(Ze?(U-=G/2,T=ca+G/2):T=ca+G,Je){var B=Je*ot/Xe;U-=B,T+=B}U=Math.floor(U),T=Math.ceil(T)}else T=U+ot-1;U=Math.max(U,0),T=Math.min(T,Yt-1)}return[U,T]}function Pn(){Bt&&!Ca&&Fn.apply(null,In()).forEach((function(f){if(!G(f,Ga)){var T={};T[ve]=function(f){f.stopPropagation()},ea(f,T),ea(f,Ba),f.src=Xi(f,"data-src");var L=Xi(f,"data-srcset");L&&(f.srcset=L),B(f,"loading")}}))}function zn(f){B(f,"loaded"),Wn(f)}function Wn(f){B(f,"tns-complete"),z(f,"loading"),na(f,Ba)}function Fn(f,T){for(var L=[];f<=T;)qi(De[f].querySelectorAll("img"),(function(f){L.push(f)})),f++;return L}function qn(){var f=Fn.apply(null,In());T((function(){jn(f,Xn)}))}function jn(f,L){return ze?L():(f.forEach((function(T,L){G(T,Ga)&&f.splice(L,1)})),f.length?void T((function(){jn(f,L)})):L())}function Vn(){Pn(),Kn(),kn(),$n(),function(){if(Tt&&(nn=0<=tn?tn:ln(),tn=-1,nn!==eo)){var f=Ja[eo],T=Ja[nn];Yi(f,{tabindex:"-1","aria-label":ao+(eo+1)}),z(f,to),Yi(T,{"aria-label":ao+(nn+1)+no}),Ki(T,"tabindex"),B(T,to),eo=nn}}()}function Gn(){be&&Ct&&(we.style[me]=vt/1e3+"s")}function Qn(f,T){for(var L=[],K=f,U=Math.min(f+T,Yt);K<U;K++)L.push(De[K].offsetHeight);return Math.max.apply(null,L)}function Xn(){var f=Ct?Qn(ca,ot):Qn(Wt,Pe),T=we||Ne;T.style.height!==f&&(T.style.height=f+"px")}function Yn(){Fe=[0];var f=xe?"left":"top",T=xe?"right":"bottom",L=De[0].getBoundingClientRect()[f];qi(De,(function(K,U){U&&Fe.push(K.getBoundingClientRect()[f]-L),U===Yt-1&&Fe.push(K.getBoundingClientRect()[T]-L)}))}function Kn(){var f=In(),T=f[0],L=f[1];qi(De,(function(f,K){T<=K&&K<=L?Qi(f,"aria-hidden")&&(Ki(f,["aria-hidden","tabindex"]),B(f,Pa)):Qi(f,"aria-hidden")||(Yi(f,{"aria-hidden":"true",tabindex:"-1"}),z(f,Pa))}))}function Jn(f){return f.nodeName.toLowerCase()}function Un(f){return"button"===Jn(f)}function _n(f){return"true"===f.getAttribute("aria-disabled")}function Zn(f,T,L){f?T.disabled=L:T.setAttribute("aria-disabled",L.toString())}function $n(){if(_t&&!ft&&!ht){var f=za?ja.disabled:_n(ja),T=Ha?Va.disabled:_n(Va),L=ca<=da,K=!ft&&ma<=ca;L&&!f&&Zn(za,ja,!0),!L&&f&&Zn(za,ja,!1),K&&!T&&Zn(Ha,Va,!0),!K&&T&&Zn(Ha,Va,!1)}}function ti(f,T){me&&(f.style[me]=T)}function ei(f){return null==f&&(f=ca),We?(Xe-(Je?Qe:0)-(Fe[f+1]-Fe[f]-Qe))/2:Ye?(Xe-Ye)/2:(ot-1)/2}function ni(){var f=Xe+(Je?Qe:0)-(Ye?(Ye+Qe)*Yt:Fe[Yt]);return Ze&&!ht&&(f=Ye?-(Ye+Qe)*(Yt-1)-ei():ei(Yt-1)-Fe[Yt-1]),0<f&&(f=0),f}function ii(f){var T;if(null==f&&(f=ca),xe&&!We)if(Ye)T=-(Ye+Qe)*f,Ze&&(T+=ei());else{var L=le?Yt:ot;Ze&&(f-=ei()),T=100*-f/L}else T=-Fe[f],Ze&&We&&(T+=ei());return Jt&&(T=Math.max(T,Qt)),T+(!xe||We||Ye?"px":"%")}function ai(f){ti(Ke,"0s"),ri(f)}function ri(f){null==f&&(f=ii()),Ke.style[Zt]=oa+f+sa}function oi(f,T,L,K){var U=f+ot;ht||(U=Math.min(U,Yt));for(var P=f;P<U;P++){var G=De[P];K||(G.style.left=100*(P-ca)/ot+"%"),Se&&ue&&(G.style[ue]=G.style[ge]=Se*(P-f)/1e3+"s"),z(G,T),B(G,L),K&&zt.push(G)}}function ui(f,T){Xt&&Co(),(ca!==la||T)&&(ha.emit("indexChanged",Si()),ha.emit("transitionStart",Si()),Ct&&qn(),io&&f&&0<=["click","keydown"].indexOf(f.type)&&hi(),va=!0,bo())}function li(f){return f.toLowerCase().replace(/-/g,"")}function si(f){if(be||va){if(ha.emit("transitionEnd",Si(f)),!be&&0<zt.length)for(var T=0;T<zt.length;T++){var L=zt[T];L.style.left="",ge&&ue&&(L.style[ge]="",L.style[ue]=""),z(L,Ae),B(L,Me)}if(!f||!be&&f.target.parentNode===Ke||f.target===Ke&&li(f.propertyName)===li(Zt)){if(!Xt){var K=ca;Co(),ca!==K&&(ha.emit("indexChanged",Si()),ai())}"inner"===Ce&&ha.emit("innerLoaded",Si()),va=!1,la=ca}}}function ci(f,T){if(!Ea)if("prev"===f)fi(T,-1);else if("next"===f)fi(T,1);else{if(va){if(ua)return;si()}var L=un(),K=0;if("first"===f?K=-L:"last"===f?K=be?Pe-ot-L:Pe-1-L:("number"!=typeof f&&(f=parseInt(f)),isNaN(f)||(T||(f=Math.max(0,Math.min(Pe-1,f))),K=f-L)),!be&&K&&Math.abs(K)<ot){var U=0<K?1:-1;K+=da<=ca+K-Pe?Pe*U:2*Pe*U*-1}ca+=K,be&&ht&&(ca<da&&(ca+=Pe),ma<ca&&(ca-=Pe)),un(ca)!==un(la)&&ui(T)}}function fi(f,T){if(va){if(ua)return;si()}var L;if(!T){for(var K=bi(f=xi(f));K!==$a&&[ja,Va].indexOf(K)<0;)K=K.parentNode;var U=[ja,Va].indexOf(K);0<=U&&(L=!0,T=0===U?-1:1)}if(ft){if(ca===da&&-1===T)return void ci("last",f);if(ca===ma&&1===T)return void ci("first",f)}T&&(ca+=lt*T,We&&(ca=Math.floor(ca)),ui(L||f&&"keydown"===f.type?f:null))}function di(){oo=setInterval((function(){fi(null,lo)}),Ot),io=!0}function vi(){clearInterval(oo),io=!1}function pi(f,T){Yi(mo,{"data-action":f}),mo.innerHTML=po[0]+f+po[1]+T}function mi(){di(),mo&&pi("stop",Nt[1])}function hi(){vi(),mo&&pi("start",Nt[0])}function yi(){io?(hi(),ro=!0):(mi(),ro=!1)}function gi(f){f.focus()}function xi(f){return Ci(f=f||U.event)?f.changedTouches[0]:f}function bi(f){return f.target||U.event.srcElement}function Ci(f){return 0<=f.type.indexOf("touch")}function wi(f){f.preventDefault?f.preventDefault():f.returnValue=!1}function Mi(){return P=ho.y-fo.y,G=ho.x-fo.x,T=Math.atan2(P,G)*(180/Math.PI),K=!1,90-(L=pa)<=(U=Math.abs(90-Math.abs(T)))?K="horizontal":U<=L&&(K="vertical"),K===f.axis;var T,L,K,U,P,G}function Ti(f){if(va){if(ua)return;si()}xt&&io&&vi(),ko=!0,vo&&(K(vo),vo=null);var T=xi(f);ha.emit(Ci(f)?"touchStart":"dragStart",Si(f)),!Ci(f)&&0<=["img","a"].indexOf(Jn(bi(f)))&&wi(f),ho.x=fo.x=T.clientX,ho.y=fo.y=T.clientY,be&&(go=parseFloat(Ke.style[Zt].replace(oa,"")),ti(Ke,"0s"))}function Ei(f){if(ko){var L=xi(f);ho.x=L.clientX,ho.y=L.clientY,be?vo||(vo=T((function(){!function t(f){if(ga){if(K(vo),ko&&(vo=T((function(){t(f)}))),"?"===ga&&(ga=Mi()),ga){!Fa&&Ci(f)&&(Fa=!0);try{f.type&&ha.emit(Ci(f)?"touchMove":"dragMove",Si(f))}catch(f){}var L=go,U=yo(ho,fo);if(!xe||Ye||We)L+=U,L+="px";else L+=le?U*ot*100/((Xe+Qe)*Yt):100*U/(Xe+Qe),L+="%";Ke.style[Zt]=oa+L+sa}}else ko=!1}(f)}))):("?"===ga&&(ga=Mi()),ga&&(Fa=!0)),Fa&&f.preventDefault()}}function Ai(L){if(ko){vo&&(K(vo),vo=null),be&&ti(Ke,""),ko=!1;var U=xi(L);ho.x=U.clientX,ho.y=U.clientY;var P=yo(ho,fo);if(Math.abs(P)){if(!Ci(L)){var G=bi(L);ea(G,{click:function t(f){wi(f),na(G,{click:t})}})}be?vo=T((function(){if(xe&&!We){var f=-P*ot/(Xe+Qe);f=0<P?Math.floor(f):Math.ceil(f),ca+=f}else{var T=-(go+P);if(T<=0)ca=da;else if(T>=Fe[Yt-1])ca=ma;else for(var K=0;K<Yt&&T>=Fe[K];)T>Fe[ca=K]&&P<0&&(ca+=1),K++}ui(L,P),ha.emit(Ci(L)?"touchEnd":"dragEnd",Si(L))})):ga&&fi(L,0<P?-1:1)}}"auto"===f.preventScrollOnTouch&&(Fa=!1),pa&&(ga="?"),xt&&!io&&di()}function Ni(){(we||Ne).style.height=Fe[ca+ot]-Fe[ca]+"px"}function Li(){var f=Ye?(Ye+Qe)*Pe/Xe:Pe/ot;return Math.min(Math.ceil(f),Pe)}function Bi(){if(Tt&&!Ka&&Za!==en){var f=en,T=Za,L=_i;for(Za<en&&(f=Za,T=en,L=Ui);f<T;)L(Ja[f]),f++;en=Za}}function Si(f){return{container:Ke,slideItems:De,navContainer:Qa,navItems:Ja,controlsContainer:$a,hasControls:Oa,prevButton:ja,nextButton:Va,items:ot,slideBy:lt,cloneCount:Wt,slideCount:Pe,slideCountNew:Yt,index:ca,indexCached:la,displayIndex:rn(),navCurrentIndex:nn,navCurrentIndexCached:eo,pages:Za,pagesCached:en,sheet:Gt,isOn:Be,event:f||{}}}};return aa}();!function defineMustache(f,T){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?T(exports):"function"==typeof define&&define.amd?define(["exports"],T):(f.Mustache={},T(f.Mustache))}(this,(function mustacheFactory(f){var T=Object.prototype.toString,L=Array.isArray||function isArrayPolyfill(f){return"[object Array]"===T.call(f)};function isFunction(f){return"function"==typeof f}function escapeRegExp(f){return f.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function hasProperty(f,T){return null!=f&&"object"==typeof f&&T in f}var K=RegExp.prototype.test;var U=/\S/;function isWhitespace(f){return!function testRegExp(f,T){return K.call(f,T)}(U,f)}var P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var G=/\s*/,B=/\s+/,z=/\s*=/,H=/\s*\}/,q=/#|\^|\/|>|\{|&|=|!/;function Scanner(f){this.string=f,this.tail=f,this.pos=0}function Context(f,T){this.view=f,this.cache={".":this.view},this.parent=T}function Writer(){this.cache={}}Scanner.prototype.eos=function eos(){return""===this.tail},Scanner.prototype.scan=function scan(f){var T=this.tail.match(f);if(!T||0!==T.index)return"";var L=T[0];return this.tail=this.tail.substring(L.length),this.pos+=L.length,L},Scanner.prototype.scanUntil=function scanUntil(f){var T,L=this.tail.search(f);switch(L){case-1:T=this.tail,this.tail="";break;case 0:T="";break;default:T=this.tail.substring(0,L),this.tail=this.tail.substring(L)}return this.pos+=T.length,T},Context.prototype.push=function push(f){return new Context(f,this)},Context.prototype.lookup=function lookup(f){var T,L,K,U=this.cache;if(U.hasOwnProperty(f))T=U[f];else{for(var P,G,B,z=this,H=!1;z;){if(f.indexOf(".")>0)for(P=z.view,G=f.split("."),B=0;null!=P&&B<G.length;)B===G.length-1&&(H=hasProperty(P,G[B])||(L=P,K=G[B],null!=L&&"object"!=typeof L&&L.hasOwnProperty&&L.hasOwnProperty(K))),P=P[G[B++]];else P=z.view[f],H=hasProperty(z.view,f);if(H){T=P;break}z=z.parent}U[f]=T}return isFunction(T)&&(T=T.call(this.view)),T},Writer.prototype.clearCache=function clearCache(){this.cache={}},Writer.prototype.parse=function parse(T,K){var U=this.cache,P=T+":"+(K||f.tags).join(":"),V=U[P];return null==V&&(V=U[P]=function parseTemplate(T,K){if(!T)return[];var U,P,V,W=[],J=[],ee=[],te=!1,ae=!1;function stripSpace(){if(te&&!ae)for(;ee.length;)delete J[ee.pop()];else ee=[];te=!1,ae=!1}function compileTags(f){if("string"==typeof f&&(f=f.split(B,2)),!L(f)||2!==f.length)throw new Error("Invalid tags: "+f);U=new RegExp(escapeRegExp(f[0])+"\\s*"),P=new RegExp("\\s*"+escapeRegExp(f[1])),V=new RegExp("\\s*"+escapeRegExp("}"+f[1]))}compileTags(K||f.tags);for(var ne,oe,ie,se,re,ce,le=new Scanner(T);!le.eos();){if(ne=le.pos,ie=le.scanUntil(U))for(var de=0,me=ie.length;de<me;++de)isWhitespace(se=ie.charAt(de))?ee.push(J.length):ae=!0,J.push(["text",se,ne,ne+1]),ne+=1,"\n"===se&&stripSpace();if(!le.scan(U))break;if(te=!0,oe=le.scan(q)||"name",le.scan(G),"="===oe?(ie=le.scanUntil(z),le.scan(z),le.scanUntil(P)):"{"===oe?(ie=le.scanUntil(V),le.scan(H),le.scanUntil(P),oe="&"):ie=le.scanUntil(P),!le.scan(P))throw new Error("Unclosed tag at "+le.pos);if(re=[oe,ie,ne,le.pos],J.push(re),"#"===oe||"^"===oe)W.push(re);else if("/"===oe){if(!(ce=W.pop()))throw new Error('Unopened section "'+ie+'" at '+ne);if(ce[1]!==ie)throw new Error('Unclosed section "'+ce[1]+'" at '+ne)}else"name"===oe||"{"===oe||"&"===oe?ae=!0:"="===oe&&compileTags(ie)}if(ce=W.pop())throw new Error('Unclosed section "'+ce[1]+'" at '+le.pos);return function nestTokens(f){for(var T,L=[],K=L,U=[],P=0,G=f.length;P<G;++P)switch((T=f[P])[0]){case"#":case"^":K.push(T),U.push(T),K=T[4]=[];break;case"/":U.pop()[5]=T[2],K=U.length>0?U[U.length-1][4]:L;break;default:K.push(T)}return L}(function squashTokens(f){for(var T,L,K=[],U=0,P=f.length;U<P;++U)(T=f[U])&&("text"===T[0]&&L&&"text"===L[0]?(L[1]+=T[1],L[3]=T[3]):(K.push(T),L=T));return K}(J))}(T,K)),V},Writer.prototype.render=function render(f,T,L,K){var U=this.parse(f,K),P=T instanceof Context?T:new Context(T);return this.renderTokens(U,P,L,f,K)},Writer.prototype.renderTokens=function renderTokens(f,T,L,K,U){for(var P,G,B,z="",H=0,q=f.length;H<q;++H)B=void 0,"#"===(G=(P=f[H])[0])?B=this.renderSection(P,T,L,K):"^"===G?B=this.renderInverted(P,T,L,K):">"===G?B=this.renderPartial(P,T,L,U):"&"===G?B=this.unescapedValue(P,T):"name"===G?B=this.escapedValue(P,T):"text"===G&&(B=this.rawValue(P)),void 0!==B&&(z+=B);return z},Writer.prototype.renderSection=function renderSection(f,T,K,U){var P=this,G="",B=T.lookup(f[1]);if(B){if(L(B))for(var z=0,H=B.length;z<H;++z)G+=this.renderTokens(f[4],T.push(B[z]),K,U);else if("object"==typeof B||"string"==typeof B||"number"==typeof B)G+=this.renderTokens(f[4],T.push(B),K,U);else if(isFunction(B)){if("string"!=typeof U)throw new Error("Cannot use higher-order sections without the original template");null!=(B=B.call(T.view,U.slice(f[3],f[5]),(function subRender(f){return P.render(f,T,K)})))&&(G+=B)}else G+=this.renderTokens(f[4],T,K,U);return G}},Writer.prototype.renderInverted=function renderInverted(f,T,K,U){var P=T.lookup(f[1]);if(!P||L(P)&&0===P.length)return this.renderTokens(f[4],T,K,U)},Writer.prototype.renderPartial=function renderPartial(f,T,L,K){if(L){var U=isFunction(L)?L(f[1]):L[f[1]];return null!=U?this.renderTokens(this.parse(U,K),T,L,U):void 0}},Writer.prototype.unescapedValue=function unescapedValue(f,T){var L=T.lookup(f[1]);if(null!=L)return L},Writer.prototype.escapedValue=function escapedValue(T,L){var K=L.lookup(T[1]);if(null!=K)return f.escape(K)},Writer.prototype.rawValue=function rawValue(f){return f[1]},f.name="mustache.js",f.version="3.0.1",f.tags=["{{","}}"];var V=new Writer;return f.clearCache=function clearCache(){return V.clearCache()},f.parse=function parse(f,T){return V.parse(f,T)},f.render=function render(f,T,K,U){if("string"!=typeof f)throw new TypeError('Invalid template! Template should be a "string" but "'+function typeStr(f){return L(f)?"array":typeof f}(f)+'" was given as the first argument for mustache#render(template, view, partials)');return V.render(f,T,K,U)},f.to_html=function to_html(T,L,K,U){var P=f.render(T,L,K);if(!isFunction(U))return P;U(P)},f.escape=function escapeHtml(f){return String(f).replace(/[&<>"'`=\/]/g,(function fromEntityMap(f){return P[f]}))},f.Scanner=Scanner,f.Context=Context,f.Writer=Writer,f}));var Sentry=function(f){var n=function(f,T){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,T){f.__proto__=T}||function(f,T){for(var L in T)T.hasOwnProperty(L)&&(f[L]=T[L])})(f,T)};function r(f,T){function e(){this.constructor=f}n(f,T),f.prototype=null===T?Object.create(T):(e.prototype=T.prototype,new e)}var T,L,K,e=function(){return(e=Object.assign||function(f){for(var T,L=1,K=arguments.length;L<K;L++)for(var U in T=arguments[L])Object.prototype.hasOwnProperty.call(T,U)&&(f[U]=T[U]);return f}).apply(this,arguments)};function o(f,T){var L="function"==typeof Symbol&&f[Symbol.iterator];if(!L)return f;var K,U,P=L.call(f),G=[];try{for(;(void 0===T||T-- >0)&&!(K=P.next()).done;)G.push(K.value)}catch(f){U={error:f}}finally{try{K&&!K.done&&(L=P.return)&&L.call(P)}finally{if(U)throw U.error}}return G}function u(){for(var f=[],T=0;T<arguments.length;T++)f=f.concat(o(arguments[T]));return f}!function(f){f[f.None=0]="None",f[f.Error=1]="Error",f[f.Debug=2]="Debug",f[f.Verbose=3]="Verbose"}(T||(T={})),(L=f.Severity||(f.Severity={})).Fatal="fatal",L.Error="error",L.Warning="warning",L.Log="log",L.Info="info",L.Debug="debug",L.Critical="critical",function(f){f.fromString=function(T){switch(T){case"debug":return f.Debug;case"info":return f.Info;case"warn":case"warning":return f.Warning;case"error":return f.Error;case"fatal":return f.Fatal;case"critical":return f.Critical;case"log":default:return f.Log}}}(f.Severity||(f.Severity={})),(K=f.Status||(f.Status={})).Unknown="unknown",K.Skipped="skipped",K.Success="success",K.RateLimit="rate_limit",K.Invalid="invalid",K.Failed="failed",function(f){f.fromHttpCode=function(T){return T>=200&&T<300?f.Success:429===T?f.RateLimit:T>=400&&T<500?f.Invalid:T>=500?f.Failed:f.Unknown}}(f.Status||(f.Status={}));var U=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(f,T){return f.__proto__=T,f}:function(f,T){for(var L in T)f.hasOwnProperty(L)||(f[L]=T[L]);return f}),P=function(f){function n(T){var L=this.constructor,K=f.call(this,T)||this;return K.message=T,K.name=L.prototype.constructor.name,U(K,L.prototype),K}return r(n,f),n}(Error);function v(f){switch(Object.prototype.toString.call(f)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return E(f,Error)}}function l(f){return"[object ErrorEvent]"===Object.prototype.toString.call(f)}function d(f){return"[object DOMError]"===Object.prototype.toString.call(f)}function p(f){return"[object String]"===Object.prototype.toString.call(f)}function y(f){return null===f||"object"!=typeof f&&"function"!=typeof f}function m(f){return"[object Object]"===Object.prototype.toString.call(f)}function b(f){return"undefined"!=typeof Event&&E(f,Event)}function w(f){return"undefined"!=typeof Element&&E(f,Element)}function g(f){return Boolean(f&&f.then&&"function"==typeof f.then)}function E(f,T){try{return f instanceof T}catch(f){return!1}}function x(f,T){return void 0===T&&(T=0),"string"!=typeof f||0===T||f.length<=T?f:f.substr(0,T)+"..."}function j(f,T){if(!Array.isArray(f))return"";for(var L=[],K=0;K<f.length;K++){var U=f[K];try{L.push(String(U))}catch(f){L.push("[value cannot be serialized]")}}return L.join(T)}function k(f,T){return!!p(f)&&(L=T,"[object RegExp]"===Object.prototype.toString.call(L)?T.test(f):"string"==typeof T&&-1!==f.indexOf(T));var L}function S(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}var G={};function O(){return S()?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:G}function _(){var f=O(),T=f.crypto||f.msCrypto;if(void 0!==T&&T.getRandomValues){var L=new Uint16Array(8);T.getRandomValues(L),L[3]=4095&L[3]|16384,L[4]=16383&L[4]|32768;var e=function(f){for(var T=f.toString(16);T.length<4;)T="0"+T;return T};return e(L[0])+e(L[1])+e(L[2])+e(L[3])+e(L[4])+e(L[5])+e(L[6])+e(L[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(f){var T=16*Math.random()|0;return("x"===f?T:3&T|8).toString(16)}))}function D(f){if(!f)return{};var T=f.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!T)return{};var L=T[6]||"",K=T[8]||"";return{host:T[4],path:T[5],protocol:T[2],relative:T[5]+L+K}}function R(f){if(f.message)return f.message;if(f.exception&&f.exception.values&&f.exception.values[0]){var T=f.exception.values[0];return T.type&&T.value?T.type+": "+T.value:T.type||T.value||f.event_id||"<unknown>"}return f.event_id||"<unknown>"}function I(f){var T=O();if(!("console"in T))return f();var L=T.console,K={};["debug","info","warn","error","log","assert"].forEach((function(f){f in T.console&&L[f].__sentry_original__&&(K[f]=L[f],L[f]=L[f].__sentry_original__)}));var U=f();return Object.keys(K).forEach((function(f){L[f]=K[f]})),U}function N(f,T,L){f.exception=f.exception||{},f.exception.values=f.exception.values||[],f.exception.values[0]=f.exception.values[0]||{},f.exception.values[0].value=f.exception.values[0].value||T||"",f.exception.values[0].type=f.exception.values[0].type||L||"Error"}function C(f,T){void 0===T&&(T={});try{f.exception.values[0].mechanism=f.exception.values[0].mechanism||{},Object.keys(T).forEach((function(L){f.exception.values[0].mechanism[L]=T[L]}))}catch(f){}}function M(f){try{for(var T=f,L=[],K=0,U=0,P=" > ".length,G=void 0;T&&K++<5&&!("html"===(G=A(T))||K>1&&U+L.length*P+G.length>=80);)L.push(G),U+=G.length,T=T.parentNode;return L.reverse().join(" > ")}catch(f){return"<unknown>"}}function A(f){var T,L,K,U,P,G=f,B=[];if(!G||!G.tagName)return"";if(B.push(G.tagName.toLowerCase()),G.id&&B.push("#"+G.id),(T=G.className)&&p(T))for(L=T.split(/\s+/),P=0;P<L.length;P++)B.push("."+L[P]);var z=["type","name","title","alt"];for(P=0;P<z.length;P++)K=z[P],(U=G.getAttribute(K))&&B.push("["+K+'="'+U+'"]');return B.join("")}var B=Date.now(),z=0,H={now:function(){var f=Date.now()-B;return f<z&&(f=z),z=f,f},timeOrigin:B},q=function(){if(S())try{return(f=module,"perf_hooks",f.require("perf_hooks")).performance}catch(f){return H}var f,T=O().performance;return T&&T.now?(void 0===T.timeOrigin&&(T.timeOrigin=T.timing&&T.timing.navigationStart||B),T):H}();function F(){return(q.timeOrigin+q.now())/1e3}function X(f,T){if(!T)return 6e4;var L=parseInt(""+T,10);if(!isNaN(L))return 1e3*L;var K=Date.parse(""+T);return isNaN(K)?6e4:K-f}var V="<anonymous>";function $(f){try{return f&&"function"==typeof f&&f.name||V}catch(f){return V}}var W=O(),J="Sentry Logger ",ee=function(){function t(){this.t=!1}return t.prototype.disable=function(){this.t=!1},t.prototype.enable=function(){this.t=!0},t.prototype.log=function(){for(var f=[],T=0;T<arguments.length;T++)f[T]=arguments[T];this.t&&I((function(){W.console.log(J+"[Log]: "+f.join(" "))}))},t.prototype.warn=function(){for(var f=[],T=0;T<arguments.length;T++)f[T]=arguments[T];this.t&&I((function(){W.console.warn(J+"[Warn]: "+f.join(" "))}))},t.prototype.error=function(){for(var f=[],T=0;T<arguments.length;T++)f[T]=arguments[T];this.t&&I((function(){W.console.error(J+"[Error]: "+f.join(" "))}))},t}();W.__SENTRY__=W.__SENTRY__||{};var te,ae=W.__SENTRY__.logger||(W.__SENTRY__.logger=new ee),ne=function(){function t(){this.i="function"==typeof WeakSet,this.o=this.i?new WeakSet:[]}return t.prototype.memoize=function(f){if(this.i)return!!this.o.has(f)||(this.o.add(f),!1);for(var T=0;T<this.o.length;T++)if(this.o[T]===f)return!0;return this.o.push(f),!1},t.prototype.unmemoize=function(f){if(this.i)this.o.delete(f);else for(var T=0;T<this.o.length;T++)if(this.o[T]===f){this.o.splice(T,1);break}},t}();function Q(f,T,L){if(T in f){var K=f[T],U=L(K);if("function"==typeof U)try{U.prototype=U.prototype||{},Object.defineProperties(U,{__sentry_original__:{enumerable:!1,value:K}})}catch(f){}f[T]=U}}function Y(f){if(v(f)){var T=f,L={message:T.message,name:T.name,stack:T.stack};for(var K in T)Object.prototype.hasOwnProperty.call(T,K)&&(L[K]=T[K]);return L}if(b(f)){var U=f,P={};P.type=U.type;try{P.target=w(U.target)?M(U.target):Object.prototype.toString.call(U.target)}catch(f){P.target="<unknown>"}try{P.currentTarget=w(U.currentTarget)?M(U.currentTarget):Object.prototype.toString.call(U.currentTarget)}catch(f){P.currentTarget="<unknown>"}for(var K in"undefined"!=typeof CustomEvent&&E(f,CustomEvent)&&(P.detail=U.detail),U)Object.prototype.hasOwnProperty.call(U,K)&&(P[K]=U);return P}return f}function tt(f,T,L){void 0===T&&(T=3),void 0===L&&(L=102400);var K=et(f,T);return function Z(f){return function(f){return~-encodeURI(f).split(/%..|./).length}(JSON.stringify(f))}(K)>L?tt(f,T-1,L):K}function nt(f,T){return"domain"===T&&f&&"object"==typeof f&&f.u?"[Domain]":"domainEmitter"===T?"[DomainEmitter]":"undefined"!=typeof global&&f===global?"[Global]":"undefined"!=typeof window&&f===window?"[Window]":"undefined"!=typeof document&&f===document?"[Document]":m(L=f)&&"nativeEvent"in L&&"preventDefault"in L&&"stopPropagation"in L?"[SyntheticEvent]":"number"==typeof f&&f!=f?"[NaN]":void 0===f?"[undefined]":"function"==typeof f?"[Function: "+$(f)+"]":f;var L}function et(f,T){try{return JSON.parse(JSON.stringify(f,(function(f,L){return function rt(f,T,L,K){if(void 0===L&&(L=1/0),void 0===K&&(K=new ne),0===L)return function(f){var T=Object.prototype.toString.call(f);if("string"==typeof f)return f;if("[object Object]"===T)return"[Object]";if("[object Array]"===T)return"[Array]";var L=nt(f);return y(L)?L:T}(T);if(null!=T&&"function"==typeof T.toJSON)return T.toJSON();var U=nt(T,f);if(y(U))return U;var P=Y(T),G=Array.isArray(T)?[]:{};if(K.memoize(T))return"[Circular ~]";for(var B in P)Object.prototype.hasOwnProperty.call(P,B)&&(G[B]=rt(B,P[B],L-1,K));return K.unmemoize(T),G}(f,L,T)})))}catch(f){return"**non-serializable**"}}function it(f,T){void 0===T&&(T=40);var L=Object.keys(Y(f));if(L.sort(),!L.length)return"[object has no keys]";if(L[0].length>=T)return x(L[0],T);for(var K=L.length;K>0;K--){var U=L.slice(0,K).join(", ");if(!(U.length>T))return K===L.length?U:x(U,T)}return""}!function(f){f.PENDING="PENDING",f.RESOLVED="RESOLVED",f.REJECTED="REJECTED"}(te||(te={}));var oe=function(){function t(f){var T=this;this.s=te.PENDING,this.h=[],this.v=function(f){T.l(te.RESOLVED,f)},this.p=function(f){T.l(te.REJECTED,f)},this.l=function(f,L){T.s===te.PENDING&&(g(L)?L.then(T.v,T.p):(T.s=f,T.m=L,T.g()))},this.j=function(f){T.h=T.h.concat(f),T.g()},this.g=function(){if(T.s!==te.PENDING){var f=T.h.slice();T.h=[],f.forEach((function(f){f.done||(T.s===te.RESOLVED&&f.onfulfilled&&f.onfulfilled(T.m),T.s===te.REJECTED&&f.onrejected&&f.onrejected(T.m),f.done=!0)}))}};try{f(this.v,this.p)}catch(f){this.p(f)}}return t.prototype.toString=function(){return"[object SyncPromise]"},t.resolve=function(f){return new t((function(T){T(f)}))},t.reject=function(f){return new t((function(T,L){L(f)}))},t.all=function(f){return new t((function(T,L){if(Array.isArray(f))if(0!==f.length){var K=f.length,U=[];f.forEach((function(f,P){t.resolve(f).then((function(f){U[P]=f,0==(K-=1)&&T(U)})).then(null,L)}))}else T([]);else L(new TypeError("Promise.all requires an array as input."))}))},t.prototype.then=function(f,T){var L=this;return new t((function(K,U){L.j({done:!1,onfulfilled:function(T){if(f)try{return void K(f(T))}catch(f){return void U(f)}else K(T)},onrejected:function(f){if(T)try{return void K(T(f))}catch(f){return void U(f)}else U(f)}})}))},t.prototype.catch=function(f){return this.then((function(f){return f}),f)},t.prototype.finally=function(f){var T=this;return new t((function(L,K){var U,P;return T.then((function(T){P=!1,U=T,f&&f()}),(function(T){P=!0,U=T,f&&f()})).then((function(){P?K(U):L(U)}))}))},t}(),ie=function(){function t(f){this.k=f,this.S=[]}return t.prototype.isReady=function(){return void 0===this.k||this.length()<this.k},t.prototype.add=function(f){var T=this;return this.isReady()?(-1===this.S.indexOf(f)&&this.S.push(f),f.then((function(){return T.remove(f)})).then(null,(function(){return T.remove(f).then(null,(function(){}))})),f):oe.reject(new P("Not adding Promise due to buffer limit reached."))},t.prototype.remove=function(f){return this.S.splice(this.S.indexOf(f),1)[0]},t.prototype.length=function(){return this.S.length},t.prototype.drain=function(f){var T=this;return new oe((function(L){var K=setTimeout((function(){f&&f>0&&L(!1)}),f);oe.all(T.S).then((function(){clearTimeout(K),L(!0)})).then(null,(function(){L(!0)}))}))},t}();function ct(){if(!("fetch"in O()))return!1;try{return new Headers,new Request(""),new Response,!0}catch(f){return!1}}function at(f){return f&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(f.toString())}function st(){if(!ct())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch(f){return!1}}var se,re=O(),ce={},le={};function pt(f){f&&"string"==typeof f.type&&"function"==typeof f.callback&&(ce[f.type]=ce[f.type]||[],ce[f.type].push(f.callback),function dt(f){if(!le[f])switch(le[f]=!0,f){case"console":"console"in re&&["debug","info","warn","error","log","assert"].forEach((function(f){f in re.console&&Q(re.console,f,(function(T){return function(){for(var L=[],K=0;K<arguments.length;K++)L[K]=arguments[K];yt("console",{args:L,level:f}),T&&Function.prototype.apply.call(T,re.console,L)}}))}));break;case"dom":"document"in re&&(re.document.addEventListener("click",jt("click",yt.bind(null,"dom")),!1),re.document.addEventListener("keypress",kt(yt.bind(null,"dom")),!1),["EventTarget","Node"].forEach((function(f){var T=re[f]&&re[f].prototype;T&&T.hasOwnProperty&&T.hasOwnProperty("addEventListener")&&(Q(T,"addEventListener",(function(f){return function(T,L,K){return L&&L.handleEvent?("click"===T&&Q(L,"handleEvent",(function(f){return function(T){return jt("click",yt.bind(null,"dom"))(T),f.call(this,T)}})),"keypress"===T&&Q(L,"handleEvent",(function(f){return function(T){return kt(yt.bind(null,"dom"))(T),f.call(this,T)}}))):("click"===T&&jt("click",yt.bind(null,"dom"),!0)(this),"keypress"===T&&kt(yt.bind(null,"dom"))(this)),f.call(this,T,L,K)}})),Q(T,"removeEventListener",(function(f){return function(T,L,K){var U=L;try{U=U&&(U.__sentry_wrapped__||U)}catch(f){}return f.call(this,T,U,K)}})))})));break;case"xhr":!function(){if("XMLHttpRequest"in re){var f=XMLHttpRequest.prototype;Q(f,"open",(function(f){return function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];var K=this,U=T[1];K.__sentry_xhr__={method:p(T[0])?T[0].toUpperCase():T[0],url:T[1]},p(U)&&"POST"===K.__sentry_xhr__.method&&U.match(/sentry_key/)&&(K.__sentry_own_request__=!0);var o=function(){if(4===K.readyState){try{K.__sentry_xhr__&&(K.__sentry_xhr__.status_code=K.status)}catch(f){}yt("xhr",{args:T,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:K})}};return"onreadystatechange"in K&&"function"==typeof K.onreadystatechange?Q(K,"onreadystatechange",(function(f){return function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];return o(),f.apply(K,T)}})):K.addEventListener("readystatechange",o),f.apply(K,T)}})),Q(f,"send",(function(f){return function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];return yt("xhr",{args:T,startTimestamp:Date.now(),xhr:this}),f.apply(this,T)}}))}}();break;case"fetch":(function(){if(!ct())return!1;var f=O();if(at(f.fetch))return!0;var T=!1,L=f.document;if(L&&"function"==typeof L.createElement)try{var K=L.createElement("iframe");K.hidden=!0,L.head.appendChild(K),K.contentWindow&&K.contentWindow.fetch&&(T=at(K.contentWindow.fetch)),L.head.removeChild(K)}catch(f){ae.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",f)}return T})()&&Q(re,"fetch",(function(f){return function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];var K={args:T,fetchData:{method:mt(T),url:bt(T)},startTimestamp:Date.now()};return yt("fetch",e({},K)),f.apply(re,T).then((function(f){return yt("fetch",e({},K,{endTimestamp:Date.now(),response:f})),f}),(function(f){throw yt("fetch",e({},K,{endTimestamp:Date.now(),error:f})),f}))}}));break;case"history":!function(){if(L=(T=(f=O()).chrome)&&T.app&&T.app.runtime,K="history"in f&&!!f.history.pushState&&!!f.history.replaceState,!L&&K){var f,T,L,K,U=re.onpopstate;re.onpopstate=function(){for(var f=[],T=0;T<arguments.length;T++)f[T]=arguments[T];var L=re.location.href,K=se;if(se=L,yt("history",{from:K,to:L}),U)return U.apply(this,f)},Q(re.history,"pushState",o),Q(re.history,"replaceState",o)}function o(f){return function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];var K=T.length>2?T[2]:void 0;if(K){var U=se,P=String(K);se=P,yt("history",{from:U,to:P})}return f.apply(this,T)}}}();break;case"error":pe=re.onerror,re.onerror=function(f,T,L,K,U){return yt("error",{column:K,error:U,line:L,msg:f,url:T}),!!pe&&pe.apply(this,arguments)};break;case"unhandledrejection":ge=re.onunhandledrejection,re.onunhandledrejection=function(f){return yt("unhandledrejection",f),!ge||ge.apply(this,arguments)};break;default:ae.warn("unknown instrumentation type:",f)}}(f.type))}function yt(f,T){var L,K;if(f&&ce[f])try{for(var U=function i(f){var T="function"==typeof Symbol&&f[Symbol.iterator],L=0;return T?T.call(f):{next:function(){return f&&L>=f.length&&(f=void 0),{value:f&&f[L++],done:!f}}}}(ce[f]||[]),P=U.next();!P.done;P=U.next()){var G=P.value;try{G(T)}catch(T){ae.error("Error while triggering instrumentation handler.\nType: "+f+"\nName: "+$(G)+"\nError: "+T)}}}catch(f){L={error:f}}finally{try{P&&!P.done&&(K=U.return)&&K.call(U)}finally{if(L)throw L.error}}}function mt(f){return void 0===f&&(f=[]),"Request"in re&&E(f[0],Request)&&f[0].method?String(f[0].method).toUpperCase():f[1]&&f[1].method?String(f[1].method).toUpperCase():"GET"}function bt(f){return void 0===f&&(f=[]),"string"==typeof f[0]?f[0]:"Request"in re&&E(f[0],Request)?f[0].url:String(f[0])}var de,me,ue=0;function jt(f,T,L){return void 0===L&&(L=!1),function(K){de=void 0,K&&me!==K&&(me=K,ue&&clearTimeout(ue),L?ue=setTimeout((function(){T({event:K,name:f})})):T({event:K,name:f}))}}function kt(f){return function(T){var L;try{L=T.target}catch(f){return}var K=L&&L.tagName;K&&("INPUT"===K||"TEXTAREA"===K||L.isContentEditable)&&(de||jt("input",f)(T),clearTimeout(de),de=setTimeout((function(){de=void 0}),1e3))}}var pe=null,ge=null,ve=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w\.-]+)(?::(\d+))?\/(.+)/,fe=function(){function t(f){"string"==typeof f?this.T(f):this.O(f),this._()}return t.prototype.toString=function(f){void 0===f&&(f=!1);var T=this,L=T.host,K=T.path,U=T.pass,P=T.port,G=T.projectId;return T.protocol+"://"+T.user+(f&&U?":"+U:"")+"@"+L+(P?":"+P:"")+"/"+(K?K+"/":K)+G},t.prototype.T=function(f){var T=ve.exec(f);if(!T)throw new P("Invalid Dsn");var L=o(T.slice(1),6),K=L[0],U=L[1],G=L[2],B=void 0===G?"":G,z=L[3],H=L[4],q=void 0===H?"":H,V="",W=L[5],J=W.split("/");if(J.length>1&&(V=J.slice(0,-1).join("/"),W=J.pop()),W){var ee=W.match(/^\d+/);ee&&(W=ee[0])}this.O({host:z,pass:B,path:V,projectId:W,port:q,protocol:K,user:U})},t.prototype.O=function(f){this.protocol=f.protocol,this.user=f.user,this.pass=f.pass||"",this.host=f.host,this.port=f.port||"",this.path=f.path||"",this.projectId=f.projectId},t.prototype._=function(){var f=this;if(["protocol","user","host","projectId"].forEach((function(T){if(!f[T])throw new P("Invalid Dsn: "+T+" missing")})),!this.projectId.match(/^\d+$/))throw new P("Invalid Dsn: Invalid projectId "+this.projectId);if("http"!==this.protocol&&"https"!==this.protocol)throw new P("Invalid Dsn: Invalid protocol "+this.protocol);if(this.port&&isNaN(parseInt(this.port,10)))throw new P("Invalid Dsn: Invalid port "+this.port)},t}(),he=function(){function t(){this.D=!1,this.R=[],this.I=[],this.N=[],this.C={},this.M={},this.A={},this.q={}}return t.prototype.addScopeListener=function(f){this.R.push(f)},t.prototype.addEventProcessor=function(f){return this.I.push(f),this},t.prototype.U=function(){var f=this;this.D||(this.D=!0,setTimeout((function(){f.R.forEach((function(T){T(f)})),f.D=!1})))},t.prototype.L=function(f,T,L,K){var U=this;return void 0===K&&(K=0),new oe((function(P,G){var B=f[K];if(null===T||"function"!=typeof B)P(T);else{var z=B(e({},T),L);g(z)?z.then((function(T){return U.L(f,T,L,K+1).then(P)})).then(null,G):U.L(f,z,L,K+1).then(P).then(null,G)}}))},t.prototype.setUser=function(f){return this.C=f||{},this.U(),this},t.prototype.setTags=function(f){return this.M=e({},this.M,f),this.U(),this},t.prototype.setTag=function(f,T){var L;return this.M=e({},this.M,((L={})[f]=T,L)),this.U(),this},t.prototype.setExtras=function(f){return this.A=e({},this.A,f),this.U(),this},t.prototype.setExtra=function(f,T){var L;return this.A=e({},this.A,((L={})[f]=T,L)),this.U(),this},t.prototype.setFingerprint=function(f){return this.H=f,this.U(),this},t.prototype.setLevel=function(f){return this.F=f,this.U(),this},t.prototype.setTransactionName=function(f){return this.P=f,this.U(),this},t.prototype.setTransaction=function(f){return this.setTransactionName(f)},t.prototype.setContext=function(f,T){var L;return this.q=e({},this.q,((L={})[f]=T,L)),this.U(),this},t.prototype.setSpan=function(f){return this.X=f,this.U(),this},t.prototype.getSpan=function(){return this.X},t.prototype.getTransaction=function(){var f=this.getSpan();if(f&&f.spanRecorder&&f.spanRecorder.spans[0])return f.spanRecorder.spans[0]},t.clone=function(f){var T=new t;return f&&(T.N=u(f.N),T.M=e({},f.M),T.A=e({},f.A),T.q=e({},f.q),T.C=f.C,T.F=f.F,T.X=f.X,T.P=f.P,T.H=f.H,T.I=u(f.I)),T},t.prototype.update=function(f){if(!f)return this;if("function"==typeof f){var T=f(this);return T instanceof t?T:this}return f instanceof t?(this.M=e({},this.M,f.M),this.A=e({},this.A,f.A),this.q=e({},this.q,f.q),f.C&&(this.C=f.C),f.F&&(this.F=f.F),f.H&&(this.H=f.H)):m(f)&&(f=f,this.M=e({},this.M,f.tags),this.A=e({},this.A,f.extra),this.q=e({},this.q,f.contexts),f.user&&(this.C=f.user),f.level&&(this.F=f.level),f.fingerprint&&(this.H=f.fingerprint)),this},t.prototype.clear=function(){return this.N=[],this.M={},this.A={},this.C={},this.q={},this.F=void 0,this.P=void 0,this.H=void 0,this.X=void 0,this.U(),this},t.prototype.addBreadcrumb=function(f,T){var L=e({timestamp:F()},f);return this.N=void 0!==T&&T>=0?u(this.N,[L]).slice(-T):u(this.N,[L]),this.U(),this},t.prototype.clearBreadcrumbs=function(){return this.N=[],this.U(),this},t.prototype.W=function(f){f.fingerprint=f.fingerprint?Array.isArray(f.fingerprint)?f.fingerprint:[f.fingerprint]:[],this.H&&(f.fingerprint=f.fingerprint.concat(this.H)),f.fingerprint&&!f.fingerprint.length&&delete f.fingerprint},t.prototype.applyToEvent=function(f,T){return this.A&&Object.keys(this.A).length&&(f.extra=e({},this.A,f.extra)),this.M&&Object.keys(this.M).length&&(f.tags=e({},this.M,f.tags)),this.C&&Object.keys(this.C).length&&(f.user=e({},this.C,f.user)),this.q&&Object.keys(this.q).length&&(f.contexts=e({},this.q,f.contexts)),this.F&&(f.level=this.F),this.P&&(f.transaction=this.P),this.X&&(f.contexts=e({trace:this.X.getTraceContext()},f.contexts)),this.W(f),f.breadcrumbs=u(f.breadcrumbs||[],this.N),f.breadcrumbs=f.breadcrumbs.length>0?f.breadcrumbs:void 0,this.L(u(Rt(),this.I),f,T)},t}();function Rt(){var f=O();return f.__SENTRY__=f.__SENTRY__||{},f.__SENTRY__.globalEventProcessors=f.__SENTRY__.globalEventProcessors||[],f.__SENTRY__.globalEventProcessors}function It(f){Rt().push(f)}var ke=function(){function t(f,T,L){void 0===T&&(T=new he),void 0===L&&(L=3),this.$=L,this.B=[],this.B.push({client:f,scope:T}),this.bindClient(f)}return t.prototype.G=function(f){for(var T,L=[],K=1;K<arguments.length;K++)L[K-1]=arguments[K];var U=this.getStackTop();U&&U.client&&U.client[f]&&(T=U.client)[f].apply(T,u(L,[U.scope]))},t.prototype.isOlderThan=function(f){return this.$<f},t.prototype.bindClient=function(f){this.getStackTop().client=f,f&&f.setupIntegrations&&f.setupIntegrations()},t.prototype.pushScope=function(){var f=this.getStack(),T=f.length>0?f[f.length-1].scope:void 0,L=he.clone(T);return this.getStack().push({client:this.getClient(),scope:L}),L},t.prototype.popScope=function(){return void 0!==this.getStack().pop()},t.prototype.withScope=function(f){var T=this.pushScope();try{f(T)}finally{this.popScope()}},t.prototype.getClient=function(){return this.getStackTop().client},t.prototype.getScope=function(){return this.getStackTop().scope},t.prototype.getStack=function(){return this.B},t.prototype.getStackTop=function(){return this.B[this.B.length-1]},t.prototype.captureException=function(f,T){var L=this.J=_(),K=T;if(!T){var U=void 0;try{throw new Error("Sentry syntheticException")}catch(f){U=f}K={originalException:f,syntheticException:U}}return this.G("captureException",f,e({},K,{event_id:L})),L},t.prototype.captureMessage=function(f,T,L){var K=this.J=_(),U=L;if(!L){var P=void 0;try{throw new Error(f)}catch(f){P=f}U={originalException:f,syntheticException:P}}return this.G("captureMessage",f,T,e({},U,{event_id:K})),K},t.prototype.captureEvent=function(f,T){var L=this.J=_();return this.G("captureEvent",f,e({},T,{event_id:L})),L},t.prototype.lastEventId=function(){return this.J},t.prototype.addBreadcrumb=function(f,T){var L=this.getStackTop();if(L.scope&&L.client){var K=L.client.getOptions&&L.client.getOptions()||{},U=K.beforeBreadcrumb,P=void 0===U?null:U,G=K.maxBreadcrumbs,B=void 0===G?100:G;if(!(B<=0)){var z=F(),H=e({timestamp:z},f),q=P?I((function(){return P(H,T)})):H;null!==q&&L.scope.addBreadcrumb(q,Math.min(B,100))}}},t.prototype.setUser=function(f){var T=this.getStackTop();T.scope&&T.scope.setUser(f)},t.prototype.setTags=function(f){var T=this.getStackTop();T.scope&&T.scope.setTags(f)},t.prototype.setExtras=function(f){var T=this.getStackTop();T.scope&&T.scope.setExtras(f)},t.prototype.setTag=function(f,T){var L=this.getStackTop();L.scope&&L.scope.setTag(f,T)},t.prototype.setExtra=function(f,T){var L=this.getStackTop();L.scope&&L.scope.setExtra(f,T)},t.prototype.setContext=function(f,T){var L=this.getStackTop();L.scope&&L.scope.setContext(f,T)},t.prototype.configureScope=function(f){var T=this.getStackTop();T.scope&&T.client&&f(T.scope)},t.prototype.run=function(f){var T=At(this);try{f(this)}finally{At(T)}},t.prototype.getIntegration=function(f){var T=this.getClient();if(!T)return null;try{return T.getIntegration(f)}catch(T){return ae.warn("Cannot retrieve integration "+f.id+" from the current Hub"),null}},t.prototype.startSpan=function(f){return this.V("startSpan",f)},t.prototype.startTransaction=function(f){return this.V("startTransaction",f)},t.prototype.traceHeaders=function(){return this.V("traceHeaders")},t.prototype.V=function(f){for(var T=[],L=1;L<arguments.length;L++)T[L-1]=arguments[L];var K=Mt().__SENTRY__;if(K&&K.extensions&&"function"==typeof K.extensions[f])return K.extensions[f].apply(this,T);ae.warn("Extension method "+f+" couldn't be found, doing nothing.")},t}();function Mt(){var f=O();return f.__SENTRY__=f.__SENTRY__||{extensions:{},hub:void 0},f}function At(f){var T=Mt(),L=Lt(T);return Ht(T,f),L}function qt(){var f=Mt();return Ut(f)&&!Lt(f).isOlderThan(3)||Ht(f,new ke),S()?function(f){try{var T=Mt().__SENTRY__;if(!T||!T.extensions||!T.extensions.domain)return Lt(f);var L=T.extensions.domain.active;if(!L)return Lt(f);if(!Ut(L)||Lt(L).isOlderThan(3)){var K=Lt(f).getStackTop();Ht(L,new ke(K.client,he.clone(K.scope)))}return Lt(L)}catch(T){return Lt(f)}}(f):Lt(f)}function Ut(f){return!!(f&&f.__SENTRY__&&f.__SENTRY__.hub)}function Lt(f){return f&&f.__SENTRY__&&f.__SENTRY__.hub||(f.__SENTRY__=f.__SENTRY__||{},f.__SENTRY__.hub=new ke),f.__SENTRY__.hub}function Ht(f,T){return!!f&&(f.__SENTRY__=f.__SENTRY__||{},f.__SENTRY__.hub=T,!0)}function Ft(f){for(var T=[],L=1;L<arguments.length;L++)T[L-1]=arguments[L];var K=qt();if(K&&K[f])return K[f].apply(K,u(T));throw new Error("No hub defined or "+f+" was not found on the hub, please open a bug report.")}function captureException(f,T){var L;try{throw new Error("Sentry syntheticException")}catch(f){L=f}return Ft("captureException",f,{captureContext:T,originalException:f,syntheticException:L})}function Pt(f){Ft("withScope",f)}var ye=function(){function t(f){this.dsn=f,this.K=new fe(f)}return t.prototype.getDsn=function(){return this.K},t.prototype.getBaseApiEndpoint=function(){var f=this.K,T=f.protocol?f.protocol+":":"",L=f.port?":"+f.port:"";return T+"//"+f.host+L+(f.path?"/"+f.path:"")+"/api/"},t.prototype.getStoreEndpoint=function(){return this.Y("store")},t.prototype.Z=function(){return this.Y("envelope")},t.prototype.Y=function(f){return""+this.getBaseApiEndpoint()+this.K.projectId+"/"+f+"/"},t.prototype.getStoreEndpointWithUrlEncodedAuth=function(){return this.getStoreEndpoint()+"?"+this.tt()},t.prototype.getEnvelopeEndpointWithUrlEncodedAuth=function(){return this.Z()+"?"+this.tt()},t.prototype.tt=function(){var f,T={sentry_key:this.K.user,sentry_version:"7"};return f=T,Object.keys(f).map((function(T){return encodeURIComponent(T)+"="+encodeURIComponent(f[T])})).join("&")},t.prototype.getStoreEndpointPath=function(){var f=this.K;return(f.path?"/"+f.path:"")+"/api/"+f.projectId+"/store/"},t.prototype.getRequestHeaders=function(f,T){var L=this.K,K=["Sentry sentry_version=7"];return K.push("sentry_client="+f+"/"+T),K.push("sentry_key="+L.user),L.pass&&K.push("sentry_secret="+L.pass),{"Content-Type":"application/json","X-Sentry-Auth":K.join(", ")}},t.prototype.getReportDialogEndpoint=function(f){void 0===f&&(f={});var T=this.K,L=this.getBaseApiEndpoint()+"embed/error-page/",K=[];for(var U in K.push("dsn="+T.toString()),f)if("user"===U){if(!f.user)continue;f.user.name&&K.push("name="+encodeURIComponent(f.user.name)),f.user.email&&K.push("email="+encodeURIComponent(f.user.email))}else K.push(encodeURIComponent(U)+"="+encodeURIComponent(f[U]));return K.length?L+"?"+K.join("&"):L},t}(),Ce=[];var be,_e=function(){function t(f,T){this.nt={},this.rt=!1,this.et=new f(T),this.it=T,T.dsn&&(this.ot=new fe(T.dsn))}return t.prototype.captureException=function(f,T,L){var K=this,U=T&&T.event_id;return this.rt=!0,this.ut().eventFromException(f,T).then((function(f){U=K.captureEvent(f,T,L)})),U},t.prototype.captureMessage=function(f,T,L,K){var U=this,P=L&&L.event_id;return this.rt=!0,(y(f)?this.ut().eventFromMessage(""+f,T,L):this.ut().eventFromException(f,L)).then((function(f){P=U.captureEvent(f,L,K)})),P},t.prototype.captureEvent=function(f,T,L){var K=this,U=T&&T.event_id;return this.rt=!0,this.ct(f,T,L).then((function(f){U=f&&f.event_id,K.rt=!1})).then(null,(function(f){ae.error(f),K.rt=!1})),U},t.prototype.getDsn=function(){return this.ot},t.prototype.getOptions=function(){return this.it},t.prototype.flush=function(f){var T=this;return this.at(f).then((function(L){return clearInterval(L.interval),T.ut().getTransport().close(f).then((function(f){return L.ready&&f}))}))},t.prototype.close=function(f){var T=this;return this.flush(f).then((function(f){return T.getOptions().enabled=!1,f}))},t.prototype.setupIntegrations=function(){this.st()&&(this.nt=function $t(f){var T={};return function(f){var T=f.defaultIntegrations&&u(f.defaultIntegrations)||[],L=f.integrations,K=[];if(Array.isArray(L)){var U=L.map((function(f){return f.name})),P=[];T.forEach((function(f){-1===U.indexOf(f.name)&&-1===P.indexOf(f.name)&&(K.push(f),P.push(f.name))})),L.forEach((function(f){-1===P.indexOf(f.name)&&(K.push(f),P.push(f.name))}))}else"function"==typeof L?(K=L(T),K=Array.isArray(K)?K:[K]):K=u(T);var G=K.map((function(f){return f.name}));return-1!==G.indexOf("Debug")&&K.push.apply(K,u(K.splice(G.indexOf("Debug"),1))),K}(f).forEach((function(f){T[f.name]=f,function(f){-1===Ce.indexOf(f.name)&&(f.setupOnce(It,qt),Ce.push(f.name),ae.log("Integration installed: "+f.name))}(f)})),T}(this.it))},t.prototype.getIntegration=function(f){try{return this.nt[f.id]||null}catch(T){return ae.warn("Cannot retrieve integration "+f.id+" from the current Client"),null}},t.prototype.at=function(f){var T=this;return new oe((function(L){var K=0,U=0;clearInterval(U),U=setInterval((function(){T.rt?(K+=1,f&&K>=f&&L({interval:U,ready:!1})):L({interval:U,ready:!0})}),1)}))},t.prototype.ut=function(){return this.et},t.prototype.st=function(){return!1!==this.getOptions().enabled&&void 0!==this.ot},t.prototype.ft=function(f,T,L){var K=this,U=this.getOptions().normalizeDepth,P=void 0===U?3:U,G=e({},f,{event_id:f.event_id||(L&&L.event_id?L.event_id:_()),timestamp:f.timestamp||F()});this.ht(G),this.vt(G);var B=T;L&&L.captureContext&&(B=he.clone(B).update(L.captureContext));var z=oe.resolve(G);return B&&(z=B.applyToEvent(G,L)),z.then((function(f){return"number"==typeof P&&P>0?K.lt(f,P):f}))},t.prototype.lt=function(f,T){if(!f)return null;var L=e({},f,f.breadcrumbs&&{breadcrumbs:f.breadcrumbs.map((function(f){return e({},f,f.data&&{data:et(f.data,T)})}))},f.user&&{user:et(f.user,T)},f.contexts&&{contexts:et(f.contexts,T)},f.extra&&{extra:et(f.extra,T)});return f.contexts&&f.contexts.trace&&(L.contexts.trace=f.contexts.trace),L},t.prototype.ht=function(f){var T=this.getOptions(),L=T.environment,K=T.release,U=T.dist,P=T.maxValueLength,G=void 0===P?250:P;void 0===f.environment&&void 0!==L&&(f.environment=L),void 0===f.release&&void 0!==K&&(f.release=K),void 0===f.dist&&void 0!==U&&(f.dist=U),f.message&&(f.message=x(f.message,G));var B=f.exception&&f.exception.values&&f.exception.values[0];B&&B.value&&(B.value=x(B.value,G));var z=f.request;z&&z.url&&(z.url=x(z.url,G))},t.prototype.vt=function(f){var T=f.sdk,L=Object.keys(this.nt);T&&L.length>0&&(T.integrations=L)},t.prototype.dt=function(f){this.ut().sendEvent(f)},t.prototype.ct=function(f,T,L){var K=this,U=this.getOptions(),P=U.beforeSend,G=U.sampleRate;if(!this.st())return oe.reject("SDK not enabled, will not send event.");var B="transaction"===f.type;return!B&&"number"==typeof G&&Math.random()>G?oe.reject("This event has been sampled, will not send event."):new oe((function(U,G){K.ft(f,L,T).then((function(f){if(null!==f){var L=f;if(T&&T.data&&!0===T.data.__sentry__||!P||B)return K.dt(L),void U(L);var z=P(f,T);if(void 0===z)ae.error("`beforeSend` method has to return `null` or a valid event.");else if(g(z))K.pt(z,U,G);else{if(null===(L=z))return ae.log("`beforeSend` returned `null`, will not send event."),void U(null);K.dt(L),U(L)}}else G("An event processor returned null, will not send event.")})).then(null,(function(f){K.captureException(f,{data:{__sentry__:!0},originalException:f}),G("Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: "+f)}))}))},t.prototype.pt=function(f,T,L){var K=this;f.then((function(f){null!==f?(K.dt(f),T(f)):L("`beforeSend` returned `null`, will not send event.")})).then(null,(function(f){L("beforeSend rejected with "+f)}))},t}(),Ee=function(){function n(){}return n.prototype.sendEvent=function(T){return oe.resolve({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:f.Status.Skipped})},n.prototype.close=function(f){return oe.resolve(!0)},n}(),Ie=function(){function t(f){this.it=f,this.it.dsn||ae.warn("No DSN provided, backend will not do anything."),this.yt=this.bt()}return t.prototype.bt=function(){return new Ee},t.prototype.eventFromException=function(f,T){throw new P("Backend has to implement `eventFromException` method")},t.prototype.eventFromMessage=function(f,T,L){throw new P("Backend has to implement `eventFromMessage` method")},t.prototype.sendEvent=function(f){this.yt.sendEvent(f).then(null,(function(f){ae.error("Error while sending event: "+f)}))},t.prototype.getTransport=function(){return this.yt},t}();function Vt(f,T){var L="transaction"===f.type,K={body:JSON.stringify(f),url:L?T.getEnvelopeEndpointWithUrlEncodedAuth():T.getStoreEndpointWithUrlEncodedAuth()};if(L){var U=JSON.stringify({event_id:f.event_id,sent_at:new Date(1e3*F()).toISOString()})+"\n"+JSON.stringify({type:f.type})+"\n"+K.body;K.body=U}return K}var Te=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(){be=Function.prototype.toString,Function.prototype.toString=function(){for(var f=[],T=0;T<arguments.length;T++)f[T]=arguments[T];var L=this.__sentry_original__||this;return be.apply(L,f)}},t.id="FunctionToString",t}(),Ae=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],Se=function(){function t(f){void 0===f&&(f={}),this.it=f,this.name=t.id}return t.prototype.setupOnce=function(){It((function(f){var T=qt();if(!T)return f;var L=T.getIntegration(t);if(L){var K=T.getClient(),U=K?K.getOptions():{},P=L.wt(U);if(L.gt(f,P))return null}return f}))},t.prototype.gt=function(f,T){return this.Et(f,T)?(ae.warn("Event dropped due to being internal Sentry Error.\nEvent: "+R(f)),!0):this.xt(f,T)?(ae.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+R(f)),!0):this.jt(f,T)?(ae.warn("Event dropped due to being matched by `denyUrls` option.\nEvent: "+R(f)+".\nUrl: "+this.kt(f)),!0):!this.St(f,T)&&(ae.warn("Event dropped due to not being matched by `allowUrls` option.\nEvent: "+R(f)+".\nUrl: "+this.kt(f)),!0)},t.prototype.Et=function(f,T){if(!T.ignoreInternal)return!1;try{return f&&f.exception&&f.exception.values&&f.exception.values[0]&&"SentryError"===f.exception.values[0].type||!1}catch(f){return!1}},t.prototype.xt=function(f,T){return!(!T.ignoreErrors||!T.ignoreErrors.length)&&this.Tt(f).some((function(f){return T.ignoreErrors.some((function(T){return k(f,T)}))}))},t.prototype.jt=function(f,T){if(!T.denyUrls||!T.denyUrls.length)return!1;var L=this.kt(f);return!!L&&T.denyUrls.some((function(f){return k(L,f)}))},t.prototype.St=function(f,T){if(!T.allowUrls||!T.allowUrls.length)return!0;var L=this.kt(f);return!L||T.allowUrls.some((function(f){return k(L,f)}))},t.prototype.wt=function(f){return void 0===f&&(f={}),{allowUrls:u(this.it.whitelistUrls||[],this.it.allowUrls||[],f.whitelistUrls||[],f.allowUrls||[]),denyUrls:u(this.it.blacklistUrls||[],this.it.denyUrls||[],f.blacklistUrls||[],f.denyUrls||[]),ignoreErrors:u(this.it.ignoreErrors||[],f.ignoreErrors||[],Ae),ignoreInternal:void 0===this.it.ignoreInternal||this.it.ignoreInternal}},t.prototype.Tt=function(f){if(f.message)return[f.message];if(f.exception)try{var T=f.exception.values&&f.exception.values[0]||{},L=T.type,K=void 0===L?"":L,U=T.value,P=void 0===U?"":U;return[""+P,K+": "+P]}catch(T){return ae.error("Cannot extract message for event "+R(f)),[]}return[]},t.prototype.kt=function(f){try{if(f.stacktrace){var T=f.stacktrace.frames;return T&&T[T.length-1].filename||null}if(f.exception){var L=f.exception.values&&f.exception.values[0].stacktrace&&f.exception.values[0].stacktrace.frames;return L&&L[L.length-1].filename||null}return null}catch(T){return ae.error("Cannot extract url for event "+R(f)),null}},t.id="InboundFilters",t}(),Me=Object.freeze({FunctionToString:Te,InboundFilters:Se}),we=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Le=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js))(?::(\d+))?(?::(\d+))?\s*$/i,xe=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Oe=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ne=/\((\S*)(?::(\d+))(?::(\d+))\)/;function cn(f){var T=null,L=f&&f.framesToPop;try{if(T=function(f){if(!f||!f.stacktrace)return null;for(var T,L=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,K=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\))? in (.*):\s*$/i,U=f.stacktrace.split("\n"),P=[],G=0;G<U.length;G+=2){var B=null;(T=L.exec(U[G]))?B={url:T[2],func:T[3],args:[],line:+T[1],column:null}:(T=K.exec(U[G]))&&(B={url:T[6],func:T[3]||T[4],args:T[5]?T[5].split(","):[],line:+T[1],column:+T[2]}),B&&(!B.func&&B.line&&(B.func="?"),P.push(B))}return P.length?{message:sn(f),name:f.name,stack:P}:null}(f))return an(T,L)}catch(f){}try{if(T=function(f){if(!f||!f.stack)return null;for(var T,L,K,U=[],P=f.stack.split("\n"),G=0;G<P.length;++G){if(L=we.exec(P[G])){var B=L[2]&&0===L[2].indexOf("native");L[2]&&0===L[2].indexOf("eval")&&(T=Ne.exec(L[2]))&&(L[2]=T[1],L[3]=T[2],L[4]=T[3]),K={url:L[2]&&0===L[2].indexOf("address at ")?L[2].substr("address at ".length):L[2],func:L[1]||"?",args:B?[L[2]]:[],line:L[3]?+L[3]:null,column:L[4]?+L[4]:null}}else if(L=xe.exec(P[G]))K={url:L[2],func:L[1]||"?",args:[],line:+L[3],column:L[4]?+L[4]:null};else{if(!(L=Le.exec(P[G])))continue;L[3]&&L[3].indexOf(" > eval")>-1&&(T=Oe.exec(L[3]))?(L[1]=L[1]||"eval",L[3]=T[1],L[4]=T[2],L[5]=""):0!==G||L[5]||void 0===f.columnNumber||(U[0].column=f.columnNumber+1),K={url:L[3],func:L[1]||"?",args:L[2]?L[2].split(","):[],line:L[4]?+L[4]:null,column:L[5]?+L[5]:null}}!K.func&&K.line&&(K.func="?"),U.push(K)}return U.length?{message:sn(f),name:f.name,stack:U}:null}(f))return an(T,L)}catch(f){}return{message:sn(f),name:f&&f.name,stack:[],failed:!0}}function an(f,T){try{return e({},f,{stack:f.stack.slice(T)})}catch(T){return f}}function sn(f){var T=f&&f.message;return T?T.error&&"string"==typeof T.error.message?T.error.message:T:"No error message"}function hn(f){var T=ln(f.stack),L={type:f.name,value:f.message};return T&&T.length&&(L.stacktrace={frames:T}),void 0===L.type&&""===L.value&&(L.value="Unrecoverable error caught"),L}function vn(f){return{exception:{values:[hn(f)]}}}function ln(f){if(!f||!f.length)return[];var T=f,L=T[0].func||"",K=T[T.length-1].func||"";return-1===L.indexOf("captureMessage")&&-1===L.indexOf("captureException")||(T=T.slice(1)),-1!==K.indexOf("sentryWrapped")&&(T=T.slice(0,-1)),T.slice(0,50).map((function(f){return{colno:null===f.column?void 0:f.column,filename:f.url||T[0].url,function:f.func||"?",in_app:!0,lineno:null===f.line?void 0:f.line}})).reverse()}function dn(f,T,L){var K,U;if(void 0===L&&(L={}),l(f)&&f.error)return vn(cn(f=f.error));if(d(f)||(U=f,"[object DOMException]"===Object.prototype.toString.call(U))){var P=f,G=P.name||(d(P)?"DOMError":"DOMException"),B=P.message?G+": "+P.message:G;return N(K=pn(B,T,L),B),K}return v(f)?K=vn(cn(f)):m(f)||b(f)?(C(K=function(f,T,L){var K={exception:{values:[{type:b(f)?f.constructor.name:L?"UnhandledRejection":"Error",value:"Non-Error "+(L?"promise rejection":"exception")+" captured with keys: "+it(f)}]},extra:{__serialized__:tt(f)}};if(T){var U=ln(cn(T).stack);K.stacktrace={frames:U}}return K}(f,T,L.rejection),{synthetic:!0}),K):(N(K=pn(f,T,L),""+f,void 0),C(K,{synthetic:!0}),K)}function pn(f,T,L){void 0===L&&(L={});var K={message:f};if(L.attachStacktrace&&T){var U=ln(cn(T).stack);K.stacktrace={frames:U}}return K}var Ke=function(){function t(f){this.options=f,this.S=new ie(30),this.Ot=new ye(this.options.dsn),this.url=this.Ot.getStoreEndpointWithUrlEncodedAuth()}return t.prototype.sendEvent=function(f){throw new P("Transport Class has to implement `sendEvent` method")},t.prototype.close=function(f){return this.S.drain(f)},t}(),Ue=O(),Re=function(T){function e(){var f=null!==T&&T.apply(this,arguments)||this;return f._t=new Date(Date.now()),f}return r(e,T),e.prototype.sendEvent=function(T){var L=this;if(new Date(Date.now())<this._t)return Promise.reject({event:T,reason:"Transport locked till "+this._t+" due to too many requests.",status:429});var K=Vt(T,this.Ot),U={body:K.body,method:"POST",referrerPolicy:st()?"origin":""};return void 0!==this.options.fetchParameters&&Object.assign(U,this.options.fetchParameters),void 0!==this.options.headers&&(U.headers=this.options.headers),this.S.add(new oe((function(T,P){Ue.fetch(K.url,U).then((function(K){var U=f.Status.fromHttpCode(K.status);if(U!==f.Status.Success){if(U===f.Status.RateLimit){var G=Date.now();L._t=new Date(G+X(G,K.headers.get("Retry-After"))),ae.warn("Too many requests, backing off till: "+L._t)}P(K)}else T({status:U})})).catch(P)})))},e}(Ke),De=function(T){function e(){var f=null!==T&&T.apply(this,arguments)||this;return f._t=new Date(Date.now()),f}return r(e,T),e.prototype.sendEvent=function(T){var L=this;if(new Date(Date.now())<this._t)return Promise.reject({event:T,reason:"Transport locked till "+this._t+" due to too many requests.",status:429});var K=Vt(T,this.Ot);return this.S.add(new oe((function(T,U){var P=new XMLHttpRequest;for(var G in P.onreadystatechange=function(){if(4===P.readyState){var K=f.Status.fromHttpCode(P.status);if(K!==f.Status.Success){if(K===f.Status.RateLimit){var G=Date.now();L._t=new Date(G+X(G,P.getResponseHeader("Retry-After"))),ae.warn("Too many requests, backing off till: "+L._t)}U(P)}else T({status:K})}},P.open("POST",K.url),L.options.headers)L.options.headers.hasOwnProperty(G)&&P.setRequestHeader(G,L.options.headers[G]);P.send(K.body)})))},e}(Ke),Pe=Object.freeze({BaseTransport:Ke,FetchTransport:Re,XHRTransport:De}),Ge=function(T){function i(){return null!==T&&T.apply(this,arguments)||this}return r(i,T),i.prototype.bt=function(){if(!this.it.dsn)return T.prototype.bt.call(this);var f=e({},this.it.transportOptions,{dsn:this.it.dsn});return this.it.transport?new this.it.transport(f):ct()?new Re(f):new De(f)},i.prototype.eventFromException=function(T,L){var K=dn(T,L&&L.syntheticException||void 0,{attachStacktrace:this.it.attachStacktrace});return C(K,{handled:!0,type:"generic"}),K.level=f.Severity.Error,L&&L.event_id&&(K.event_id=L.event_id),oe.resolve(K)},i.prototype.eventFromMessage=function(T,L,K){void 0===L&&(L=f.Severity.Info);var U=pn(T,K&&K.syntheticException||void 0,{attachStacktrace:this.it.attachStacktrace});return U.level=L,K&&K.event_id&&(U.event_id=K.event_id),oe.resolve(U)},i}(Ie),Be=0;function jn(){return Be>0}function kn(f,T,L){if(void 0===T&&(T={}),"function"!=typeof f)return f;try{if(f.__sentry__)return f;if(f.__sentry_wrapped__)return f.__sentry_wrapped__}catch(T){return f}var sentryWrapped=function(){var K=Array.prototype.slice.call(arguments);try{L&&"function"==typeof L&&L.apply(this,arguments);var U=K.map((function(f){return kn(f,T)}));return f.handleEvent?f.handleEvent.apply(this,U):f.apply(this,U)}catch(f){throw Be+=1,setTimeout((function(){Be-=1})),Pt((function(L){L.addEventProcessor((function(f){var L=e({},f);return T.mechanism&&(N(L,void 0,void 0),C(L,T.mechanism)),L.extra=e({},L.extra,{arguments:K}),L})),captureException(f)})),f}};try{for(var K in f)Object.prototype.hasOwnProperty.call(f,K)&&(sentryWrapped[K]=f[K])}catch(f){}f.prototype=f.prototype||{},sentryWrapped.prototype=f.prototype,Object.defineProperty(f,"__sentry_wrapped__",{enumerable:!1,value:sentryWrapped}),Object.defineProperties(sentryWrapped,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:f}});try{Object.getOwnPropertyDescriptor(sentryWrapped,"name").configurable&&Object.defineProperty(sentryWrapped,"name",{get:function(){return f.name}})}catch(f){}return sentryWrapped}var Fe=function(){function n(f){this.name=n.id,this.Dt=!1,this.Rt=!1,this.it=e({onerror:!0,onunhandledrejection:!0},f)}return n.prototype.setupOnce=function(){Error.stackTraceLimit=50,this.it.onerror&&(ae.log("Global Handler attached: onerror"),this.It()),this.it.onunhandledrejection&&(ae.log("Global Handler attached: onunhandledrejection"),this.Nt())},n.prototype.It=function(){var f=this;this.Dt||(pt({callback:function(T){var L=T.error,K=qt(),U=K.getIntegration(n),P=L&&!0===L.__sentry_own_request__;if(U&&!jn()&&!P){var G=K.getClient(),B=y(L)?f.Ct(T.msg,T.url,T.line,T.column):f.Mt(dn(L,void 0,{attachStacktrace:G&&G.getOptions().attachStacktrace,rejection:!1}),T.url,T.line,T.column);C(B,{handled:!1,type:"onerror"}),K.captureEvent(B,{originalException:L})}},type:"error"}),this.Dt=!0)},n.prototype.Nt=function(){var T=this;this.Rt||(pt({callback:function(L){var K=L;try{"reason"in L?K=L.reason:"detail"in L&&"reason"in L.detail&&(K=L.detail.reason)}catch(f){}var U=qt(),P=U.getIntegration(n),G=K&&!0===K.__sentry_own_request__;if(!P||jn()||G)return!0;var B=U.getClient(),z=y(K)?T.At(K):dn(K,void 0,{attachStacktrace:B&&B.getOptions().attachStacktrace,rejection:!0});z.level=f.Severity.Error,C(z,{handled:!1,type:"onunhandledrejection"}),U.captureEvent(z,{originalException:K})},type:"unhandledrejection"}),this.Rt=!0)},n.prototype.Ct=function(f,T,L,K){var U,P=l(f)?f.message:f;if(p(P)){var G=P.match(/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i);G&&(U=G[1],P=G[2])}var B={exception:{values:[{type:U||"Error",value:P}]}};return this.Mt(B,T,L,K)},n.prototype.At=function(f){return{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+f}]}}},n.prototype.Mt=function(f,T,L,K){f.exception=f.exception||{},f.exception.values=f.exception.values||[],f.exception.values[0]=f.exception.values[0]||{},f.exception.values[0].stacktrace=f.exception.values[0].stacktrace||{},f.exception.values[0].stacktrace.frames=f.exception.values[0].stacktrace.frames||[];var U=isNaN(parseInt(K,10))?void 0:K,P=isNaN(parseInt(L,10))?void 0:L,G=p(T)&&T.length>0?T:function(){try{return document.location.href}catch(f){return""}}();return 0===f.exception.values[0].stacktrace.frames.length&&f.exception.values[0].stacktrace.frames.push({colno:U,filename:G,function:"?",in_app:!0,lineno:P}),f},n.id="GlobalHandlers",n}(),ze=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],He=function(){function t(f){this.name=t.id,this.it=e({XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0},f)}return t.prototype.qt=function(f){return function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];var K=T[0];return T[0]=kn(K,{mechanism:{data:{function:$(f)},handled:!0,type:"instrument"}}),f.apply(this,T)}},t.prototype.Ut=function(f){return function(T){return f.call(this,kn(T,{mechanism:{data:{function:"requestAnimationFrame",handler:$(f)},handled:!0,type:"instrument"}}))}},t.prototype.Lt=function(f){var T=O(),L=T[f]&&T[f].prototype;L&&L.hasOwnProperty&&L.hasOwnProperty("addEventListener")&&(Q(L,"addEventListener",(function(T){return function(L,K,U){try{"function"==typeof K.handleEvent&&(K.handleEvent=kn(K.handleEvent.bind(K),{mechanism:{data:{function:"handleEvent",handler:$(K),target:f},handled:!0,type:"instrument"}}))}catch(f){}return T.call(this,L,kn(K,{mechanism:{data:{function:"addEventListener",handler:$(K),target:f},handled:!0,type:"instrument"}}),U)}})),Q(L,"removeEventListener",(function(f){return function(T,L,K){var U=L;try{U&&U.__sentry__&&f.call(this,T,U.__sentry_original__,K)}catch(f){}return f.call(this,T,U,K)}})))},t.prototype.Ht=function(f){return function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];var K=this;return["onload","onerror","onprogress","onreadystatechange"].forEach((function(f){f in K&&"function"==typeof K[f]&&Q(K,f,(function(T){var L={mechanism:{data:{function:f,handler:$(T)},handled:!0,type:"instrument"}};return T.__sentry_original__&&(L.mechanism.data.handler=$(T.__sentry_original__)),kn(T,L)}))})),f.apply(this,T)}},t.prototype.setupOnce=function(){var f=O();this.it.setTimeout&&Q(f,"setTimeout",this.qt.bind(this)),this.it.setInterval&&Q(f,"setInterval",this.qt.bind(this)),this.it.requestAnimationFrame&&Q(f,"requestAnimationFrame",this.Ut.bind(this)),this.it.XMLHttpRequest&&"XMLHttpRequest"in f&&Q(XMLHttpRequest.prototype,"send",this.Ht.bind(this)),this.it.eventTarget&&(Array.isArray(this.it.eventTarget)?this.it.eventTarget:ze).forEach(this.Lt.bind(this))},t.id="TryCatch",t}(),$e=function(){function n(f){this.name=n.id,this.it=e({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},f)}return n.prototype.addSentryBreadcrumb=function(f){this.it.sentry&&qt().addBreadcrumb({category:"sentry."+("transaction"===f.type?"transaction":"event"),event_id:f.event_id,level:f.level,message:R(f)},{event:f})},n.prototype.Ft=function(T){var L={category:"console",data:{arguments:T.args,logger:"console"},level:f.Severity.fromString(T.level),message:j(T.args," ")};if("assert"===T.level){if(!1!==T.args[0])return;L.message="Assertion failed: "+(j(T.args.slice(1)," ")||"console.assert"),L.data.arguments=T.args.slice(1)}qt().addBreadcrumb(L,{input:T.args,level:T.level})},n.prototype.Pt=function(f){var T;try{T=f.event.target?M(f.event.target):M(f.event)}catch(f){T="<unknown>"}0!==T.length&&qt().addBreadcrumb({category:"ui."+f.name,message:T},{event:f.event,name:f.name})},n.prototype.Xt=function(f){if(f.endTimestamp){if(f.xhr.__sentry_own_request__)return;qt().addBreadcrumb({category:"xhr",data:f.xhr.__sentry_xhr__,type:"http"},{xhr:f.xhr})}},n.prototype.Wt=function(T){T.endTimestamp&&(T.fetchData.url.match(/sentry_key/)&&"POST"===T.fetchData.method||(T.error?qt().addBreadcrumb({category:"fetch",data:T.fetchData,level:f.Severity.Error,type:"http"},{data:T.error,input:T.args}):qt().addBreadcrumb({category:"fetch",data:e({},T.fetchData,{status_code:T.response.status}),type:"http"},{input:T.args,response:T.response})))},n.prototype.$t=function(f){var T=O(),L=f.from,K=f.to,U=D(T.location.href),P=D(L),G=D(K);P.path||(P=U),U.protocol===G.protocol&&U.host===G.host&&(K=G.relative),U.protocol===P.protocol&&U.host===P.host&&(L=P.relative),qt().addBreadcrumb({category:"navigation",data:{from:L,to:K}})},n.prototype.setupOnce=function(){var f=this;this.it.console&&pt({callback:function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];f.Ft.apply(f,u(T))},type:"console"}),this.it.dom&&pt({callback:function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];f.Pt.apply(f,u(T))},type:"dom"}),this.it.xhr&&pt({callback:function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];f.Xt.apply(f,u(T))},type:"xhr"}),this.it.fetch&&pt({callback:function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];f.Wt.apply(f,u(T))},type:"fetch"}),this.it.history&&pt({callback:function(){for(var T=[],L=0;L<arguments.length;L++)T[L]=arguments[L];f.$t.apply(f,u(T))},type:"history"})},n.id="Breadcrumbs",n}(),qe=function(){function t(f){void 0===f&&(f={}),this.name=t.id,this.Bt=f.key||"cause",this.k=f.limit||5}return t.prototype.setupOnce=function(){It((function(f,T){var L=qt().getIntegration(t);return L?L.Gt(f,T):f}))},t.prototype.Gt=function(f,T){if(!(f.exception&&f.exception.values&&T&&E(T.originalException,Error)))return f;var L=this.Jt(T.originalException,this.Bt);return f.exception.values=u(L,f.exception.values),f},t.prototype.Jt=function(f,T,L){if(void 0===L&&(L=[]),!E(f[T],Error)||L.length+1>=this.k)return L;var K=hn(cn(f[T]));return this.Jt(f[T],T,u([K],L))},t.id="LinkedErrors",t}(),je=O(),Ve=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(){It((function(f){if(qt().getIntegration(t)){if(!je.navigator||!je.location)return f;var T=f.request||{};return T.url=T.url||je.location.href,T.headers=T.headers||{},T.headers["User-Agent"]=je.navigator.userAgent,e({},f,{request:T})}return f}))},t.id="UserAgent",t}(),We=Object.freeze({GlobalHandlers:Fe,TryCatch:He,Breadcrumbs:$e,LinkedErrors:qe,UserAgent:Ve}),Ye="sentry.javascript.browser",Je=function(f){function n(T){return void 0===T&&(T={}),f.call(this,Ge,T)||this}return r(n,f),n.prototype.ft=function(T,L,K){return T.platform=T.platform||"javascript",T.sdk=e({},T.sdk,{name:Ye,packages:u(T.sdk&&T.sdk.packages||[],[{name:"npm:@sentry/browser",version:"5.19.1"}]),version:"5.19.1"}),f.prototype.ft.call(this,T,L,K)},n.prototype.dt=function(T){var L=this.getIntegration($e);L&&L.addSentryBreadcrumb(T),f.prototype.dt.call(this,T)},n.prototype.showReportDialog=function(f){void 0===f&&(f={});var T=O().document;if(T)if(this.st()){var L=f.dsn||this.getDsn();if(f.eventId)if(L){var K=T.createElement("script");K.async=!0,K.src=new ye(L).getReportDialogEndpoint(f),f.onLoad&&(K.onload=f.onLoad),(T.head||T.body).appendChild(K)}else ae.error("Missing `Dsn` option in showReportDialog call");else ae.error("Missing `eventId` option in showReportDialog call")}else ae.error("Trying to call showReportDialog with Sentry Client is disabled")},n}(_e),Qe=[new Se,new Te,new He,new $e,new Fe,new qe,new Ve],Xe={},Ze=O();Ze.Sentry&&Ze.Sentry.Integrations&&(Xe=Ze.Sentry.Integrations);var ot=e({},Xe,Me,We);return f.BrowserClient=Je,f.Hub=ke,f.Integrations=ot,f.SDK_NAME=Ye,f.SDK_VERSION="5.19.1",f.Scope=he,f.Transports=Pe,f.addBreadcrumb=function(f){Ft("addBreadcrumb",f)},f.addGlobalEventProcessor=It,f.captureEvent=function(f){return Ft("captureEvent",f)},f.captureException=captureException,f.captureMessage=function(f,T){var L;try{throw new Error(f)}catch(f){L=f}return Ft("captureMessage",f,"string"==typeof T?T:void 0,e({originalException:f,syntheticException:L},"string"!=typeof T?{captureContext:T}:void 0))},f.close=function(f){var T=qt().getClient();return T?T.close(f):oe.reject(!1)},f.configureScope=function(f){Ft("configureScope",f)},f.defaultIntegrations=Qe,f.flush=function(f){var T=qt().getClient();return T?T.flush(f):oe.reject(!1)},f.forceLoad=function(){},f.getCurrentHub=qt,f.getHubFromCarrier=Lt,f.init=function(f){if(void 0===f&&(f={}),void 0===f.defaultIntegrations&&(f.defaultIntegrations=Qe),void 0===f.release){var T=O();T.SENTRY_RELEASE&&T.SENTRY_RELEASE.id&&(f.release=T.SENTRY_RELEASE.id)}!function(f,T){!0===T.debug&&ae.enable();var L=qt(),K=new f(T);L.bindClient(K)}(Je,f)},f.lastEventId=function(){return qt().lastEventId()},f.makeMain=At,f.onLoad=function(f){f()},f.setContext=function(f,T){Ft("setContext",f,T)},f.setExtra=function(f,T){Ft("setExtra",f,T)},f.setExtras=function(f){Ft("setExtras",f)},f.setTag=function(f,T){Ft("setTag",f,T)},f.setTags=function(f){Ft("setTags",f)},f.setUser=function(f){Ft("setUser",f)},f.showReportDialog=function(f){void 0===f&&(f={}),f.eventId||(f.eventId=qt().lastEventId());var T=qt().getClient();T&&T.showReportDialog(f)},f.startTransaction=function(f){return Ft("startTransaction",e({},f))},f.withScope=Pt,f.wrap=function(f){return kn(f)()},f}({});function linkify(f,T,L,K,U){return relNoFollow="",U&&(relNoFollow=' rel="nofollow"'),f=(f=f.replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)(?:\([-A-Z0-9+&@#/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#/%=~_|$?!:,.]*\)|[A-Z0-9+&@#/%=~_|$])/gi,(function(f){var T;if(0==f.toLowerCase().indexOf("www.")){if(!L)return f;T="http://"+f}else T=f;return'<a href="'+T+'" target="'+K+'"'+relNoFollow+">"+f+"</a>"})),T&&(f=f.replace(/\B#(\w+)/g,"<a href="+T("$1")+' target="'+K+'"'+relNoFollow+">#$1</a>")),f}!function(f){f.fn.linkify=function(T){return this.each((function(){var L,K=f(this),U=!0,P="_self",G=!0;T&&("function"==typeof T?L=T:("function"==typeof T.hashtagUrlBuilder&&(L=T.hashtagUrlBuilder),"boolean"==typeof T.includeW3&&(U=T.includeW3),"string"==typeof T.target&&(P=T.target),"boolean"==typeof T.noFollow&&(G=T.noFollow))),K.html(f.map(K.contents(),(function(f,T){return 3==f.nodeType?linkify(f.data,L,U,P,G):f.outerHTML})).join(""))}))}}(jQuery),KommunicateConstants={KM_WIDGET_RELEASE_VERSION:"6.3",EVENT_IDS:{WELCOME_MESSAGE:"3",AWAY_MESSAGE:{KNOWN:"2",ANONYMOUS:"1"}},KOMMUNICATE_SESSION_KEY:"kommunicate",PRICING_PACKAGE:{STARTUP:101,PER_AGENT_MONTHLY:102,PER_AGENT_YEARLY:103,GROWTH_MONTHLY:104,ENTERPRISE_MONTHLY:105,ENTERPRISE_YEARLY:106,EARLY_BIRD_MONTHLY:107,EARLY_BIRD_YEARLY:108,TRIAL:111},BOT_PLATFORM:{DIALOGFLOW:"dialogflow",APIAI:"api.ai",AMAZONLEX:"amazonlex",RASA:"rasa",CUSTOM:"custom"},KM_NOTIFICATION_TONE_URL:"https://cdn.kommunicate.io/kommunicate/notification_tone.mp3",NOTIFICATION_RINGTONES:{default:"https://cdn.kommunicate.io/kommunicate/notification_tone.mp3",choose_me:"https://cdn.kommunicate.io/kommunicate/choose_me.mp3",eventually:"https://cdn.kommunicate.io/kommunicate/eventually.mp3",subtle:"https://cdn.kommunicate.io/kommunicate/subtle.mp3",intuition:"https://cdn.kommunicate.io/kommunicate/intuition.mp3",light:"https://cdn.kommunicate.io/kommunicate/light.mp3",open_ended:"https://cdn.kommunicate.io/kommunicate/open_ended.mp3"},KM_CHAT_POPUP_NOTIFICATION_URL:"https://cdn.kommunicate.io/kommunicate/chat-popup-notification-tone.mp3",CUSTOM_WIDGETS_SVG:{1:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 20"><path fill="#FFF" d="M21.25 18.48V7.31a7.3 7.3 0 0 0-7.3-7.3H7.31a7.3 7.3 0 1 0 0 14.6h7.2s.58.04.93.17c.34.12.71.42.71.42l4.44 3.66s.4.34.55.27c.15-.07.11-.65.11-.65zM7.51 8.8c0 .49-.42.88-.95.88-.52 0-.95-.4-.95-.88V5.67c0-.49.43-.88.95-.88.53 0 .95.4.95.88V8.8zm4.07 1.48c0 .49-.43.88-.95.88s-.95-.39-.95-.88v-6.1c0-.48.43-.88.95-.88s.95.4.95.88v6.1zm4.06-1.48c0 .49-.42.88-.95.88-.52 0-.94-.4-.94-.88V5.67c0-.49.42-.88.94-.88.53 0 .95.4.95.88V8.8z"/></svg>',2:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 18"><path fill="#FFF" d="M3.35 18a.48.48 0 0 1-.44-.3.47.47 0 0 1 .1-.5c.53-.53 1.49-1.82 2.12-3.21C1.95 12.61 0 10.19 0 7.58 0 3.4 4.93 0 11 0s11 3.4 11 7.58-4.93 7.58-11 7.58c-.4 0-.78-.02-1.16-.05A8.63 8.63 0 0 1 3.34 18z"/></svg>',3:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 17"><path fill="#FFF" d="M17.98 3.22h-6.65V1.64C11.33.78 10.64.1 9.78.1H1.56C.69.09 0 .78 0 1.64v7.67c0 .2.11.38.27.49a.61.61 0 0 0 .29.07c.08 0 .2-.03.26-.07l1.67-.96h1.47v4.65a2.03 2.03 0 0 0 2.02 2.02h10.7l2.5 1.42a.6.6 0 0 0 .26.07c.1 0 .2-.02.3-.07.17-.09.26-.29.26-.49V5.22c0-1.09-.91-2-2.02-2zm-14.02 2v2.51h-1.6c-.1 0-.2.03-.27.07l-.98.56V1.64c0-.24.2-.44.45-.44h8.22c.24 0 .44.2.44.44v1.58H5.96a2 2 0 0 0-2 2zM18.89 15.5l-1.78-1.02a.6.6 0 0 0-.27-.07H5.96a.92.92 0 0 1-.92-.91V5.22c0-.49.4-.9.92-.9h12.02c.49 0 .9.4.9.9V15.5z"/></svg>',4:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 17"><path fill="#FFF" d="M17.63 16.5a.37.37 0 0 0 .37-.38V.74a.38.38 0 0 0-.38-.37H.38A.38.38 0 0 0 0 .74v12c0 .2.17.38.38.38h12.5l4.52 3.3a.37.37 0 0 0 .23.08z"/></svg>'},RATINGS_SVG:{1:'<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 35 35"><g fill="none" fill-rule="evenodd"><path fill="#FFCC4D" d="M34.966 17.483c0 9.655-7.828 17.483-17.483 17.483C7.828 34.966 0 27.138 0 17.483 0 7.828 7.828 0 17.483 0c9.655 0 17.483 7.828 17.483 17.483"/> <path fill="#6F543A" d="M24.753 26.592c-.044-.173-1.134-4.253-7.27-4.253-6.137 0-7.227 4.08-7.27 4.253-.054.211.042.43.23.539.19.107.427.075.582-.075.018-.019 1.898-1.803 6.458-1.803 4.56 0 6.44 1.784 6.457 1.803a.49.49 0 0 0 .58.077.486.486 0 0 0 .233-.54M14.083 13.112c0 1.879-1.086 3.4-2.428 3.4-1.34 0-2.428-1.521-2.428-3.4 0-1.877 1.087-3.4 2.428-3.4 1.342 0 2.428 1.523 2.428 3.4M26.763 13.112c0 1.879-1.087 3.4-2.428 3.4s-2.428-1.521-2.428-3.4c0-1.877 1.087-3.4 2.428-3.4s2.428 1.523 2.428 3.4"/></g></svg>',5:'<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 35 35"><g fill="none" fill-rule="evenodd"><circle cx="17.497" cy="17.497" r="17.497" fill="#FFCC4D"/><g fill="#6F543A" transform="translate(8.089 8.713)"> <circle cx="4.411" cy="2.787" r="2.5"/><circle cx="14.411" cy="2.787" r="2.5"/><path d="M1.499 15.287h16.825c.783 0 .783-1 0-1H1.499c-.783 0-.783 1 0 1z"/></g></g></svg>',10:'<svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 35 35"> <g fill="none" fill-rule="evenodd"><path fill="#FFCC4D" d="M34.932 17.466c0 9.646-7.82 17.466-17.466 17.466S0 27.112 0 17.466 7.82 0 17.466 0s17.466 7.82 17.466 17.466"/><path fill="#6F543A" d="M17.466 20.377c-3.516 0-5.848-.41-8.733-.97-.659-.128-1.94 0-1.94 1.94 0 3.881 4.458 8.733 10.673 8.733 6.214 0 10.674-4.852 10.674-8.733 0-1.94-1.282-2.069-1.941-1.94-2.885.56-5.218.97-8.733.97"/><path fill="#FFF" d="M8.733 21.347s2.91.97 8.733.97c5.822 0 8.733-.97 8.733-.97s-1.94 3.881-8.733 3.881c-6.792 0-8.733-3.88-8.733-3.88"/><path fill="#6F543A" d="M14.07 13.1c0 1.876-1.086 3.396-2.426 3.396s-2.426-1.52-2.426-3.397c0-1.875 1.086-3.396 2.426-3.396s2.426 1.52 2.426 3.396M26.737 13.1c0 1.876-1.086 3.396-2.426 3.396s-2.426-1.52-2.426-3.397c0-1.875 1.086-3.396 2.426-3.396s2.426 1.52 2.426 3.396"/></g></svg>'},DEFAULT_AVATAR_IMAGE:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#e9e9e9" d="M12,0A12,12,0,1,0,24,12,12.0044,12.0044,0,0,0,12,0Zm0,3.6A3.6,3.6,0,1,1,8.4,7.2,3.5952,3.5952,0,0,1,12,3.6Zm0,17.04a8.6406,8.6406,0,0,1-7.2-3.864c.036-2.388,4.8-3.696,7.2-3.696,2.388,0,7.164,1.308,7.2,3.696A8.6406,8.6406,0,0,1,12,20.64Z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',RICH_MESSAGE_ICON:'<svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 23 22"><g fill="none" fill-rule="evenodd" opacity=".539" transform="translate(1 1)"><circle cx="6.455" cy="9" r="1" fill="#000" fill-rule="nonzero"/><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M14.636 16h-1.045l-3.136 4-3.137-4H.763C.342 16 0 15.673 0 15.27V4.36a4.287 4.287 0 0 1 1.356-3.091A4.69 4.69 0 0 1 4.6-.001h15.546c.421 0 .763.328.763.731V16h-6.273z"/><circle cx="10.455" cy="9" r="1" fill="#000" fill-rule="nonzero"/><circle cx="14.455" cy="9" r="1" fill="#000" fill-rule="nonzero"/></g></svg>',CONVERSATION_CLOSED_STATUS:"closed",CONVERSATION_RESOLVED_STATUS:"Resolved",CONVERSATION_OPEN_STATUS:"Open",CONVERSATION_WAITING_STATUS:"Waiting",MESSAGE_SOURCE:{DEVICE:0,WEB:1,ANDROID:2,IOS:3,PLATFORM:4,DESKTOP_BROWSER:5,MOBILE_BROWSER:6,MAIL_INTERCEPTOR:7},MESSAGE_CONTENT_TYPE:{DEFAULT:0,ATTACHMENT:1,LOCATION:2,TEXT_HTML:3,PRICE:4,IMAGELINK:5,HYPERLINK:6,CONTACT:7,AUDIO:8,VIDEO:9,NOTIFY_MESSAGE:10,HIDDEN_MESSAGE:11,RECEIVER_ONLY:12,BLOCK_NOTIFY_MESSAGE:13,AUDIO_VIDEO_CALL:102,MISSED_CALL:103},APPLOZIC_USER_ROLE_TYPE:{BOT:1,APPLICATION_ADMIN:2,USER:3,ADMIN:4,BUSINESS:5,APPLICATION_BROADCASTER:6,SUPPORT:7,APPLICATION_WEB_ADMIN:8,DEVELOPER:11},MESSAGE_TYPE:{INBOX:0,OUTBOX:1,DRAFT:2,OUTBOX_SENT_FROM_DEVICE:3,RECEIVED:4,SENT:5,CALL_INCOMING:6,CALL_OUTGOING:7},DEFAULT_PROFILE_IMAGE:{URL:"https://s3.amazonaws.com/kommunicate.io/default-avatar-image.png"},ACTIONABLE_MESSAGE_TEMPLATE:{ROOM_COUNT:"1",HOTEL_BOOKING_CARD:"2",LINK_BUTTON:"3",ROOM_DETAIL:"4",PASSENGER_DETAIL:"5",QUICK_REPLY:"6",LIST:"7",DIALOG_BOX:"8",IMAGE:"9",CARD_CAROUSEL:"10",GENERIC_BUTTONS:"11",FORM:"12",GENERIC_BUTTONS_V2:"13",VIDEO:"14"},FORM_SUPPORTED_FIELDS:["text","hidden","radio","checkbox","dropdown","textarea"],FORM_POST_BACK_MESSAGE_UNSUPPORTED_FIELDS:["password","hidden"],COOKIES:{KOMMUNICATE_LOGGED_IN_ID:"km_id",KOMMUNICATE_LOGGED_IN_USERNAME:"km_user_name",IS_USER_ID_FOR_LEAD_COLLECTION:"km_lead_collection",ACCESS_TOKEN:"km_ac_tn"},MESSAGE_CLUBBING:{TIME_FRAME:3e5},GROUP_TYPE:{VIRTUAL:0,PRIVATE:1,PUBLIC:2,SELLER:3,SELF:4,BROADCAST:5,OPEN:6,GROUP_OF_TWO:7,APPLOZIC_INTERNAL:8,APPLICATION_LEVEL:9,SUPPORT:10,SKIP_DELIVERED_READ:11,ANNOUNCEMENT_GROUP:12},SETTINGS:{KM_CHAT_CONTEXT:"KM_CHAT_CONTEXT",KM_USER_LANGUAGE_CODE:"kmUserLanguageCode",KM_USER_TIMEZONE:"kmUserTimezone"},AVAILABILITY_STATUS:{ONLINE:"online",OFFLINE:"offline"},POST_BACK_TO_BOT_PLATFORM:"postBackToBotPlatform",CHAT_POPUP_TEMPLATE:{HORIZONTAL:1,VERTICAL:2},GROUP_ROLE:{USER:0,ADMIN:1,MODERATOR_OR_BOT:2,MEMBER:3},POSITION:{LEFT:"left",RIGHT:"right"},KOMMUNICATE_DOMAINS:["kommunicate.io"],AWS_IMAGE_URL_EXPIRY_TIME:9e5,IMAGE_PLACEHOLDER_URL:"https://cdn.kommunicate.io/kommunicate/image-placeholder.png",FEEDBACK_API_STATUS:{INIT:1,RATED:2}},Kommunicate={settings:{},internetStatus:!0,_globals:kommunicate._globals,PRODUCT_ID:kommunicate.PRODUCT_ID},KommunicateUI={},KommunicateUtils={getCookie:function(f,T){for(var L=this.getCookiePrefix(),K=(T?f:L+f)+"=",U=decodeURIComponent(document.cookie).split(";"),P=0;P<U.length;P++){for(var G=U[P];" "==G.charAt(0);)G=G.substring(1);if(0==G.indexOf(K))return G.substring(K.length,G.length)}return""},setCookie:function(f){var T=this.getCookiePrefix(),L=f&&f.skipPrefix?f.name:T+f.name,K=f.value,U="/",P=void 0===f.secure?this.isHttpsEnabledConnection():f.secure,G=new Date("2038-01-19 04:14:07").toUTCString(),B=-1!=navigator.userAgent.indexOf("Chrome")&&-1!=navigator.vendor.indexOf("Google"),z=f.domain;if(f.path&&(U=f.path),f.expiresInDays){var H=new Date;G=new Date(H.setDate(H.getDate()+f.expiresInDays)).toUTCString()}document.cookie=L+"="+K+";expires="+G+";path="+U+(P?";secure":"")+(z?";domain="+z:"")+(B?";samesite=lax":"")},getCookiePrefix:function(){var f=KommunicateUtils.getDataFromKmSession("appOptions")||applozic._globals,T=KommunicateUtils.getSubDomain();return f&&f.domainKey&&(T=f.domainKey),T+"_"},isHttpsEnabledConnection:function(){return"https:"==parent.window.location.protocol},deleteCookie:function(f){var T=this.getCookiePrefix(),L=f&&f.skipPrefix?f.name:T+f.name,K=f.path||"/",U=void 0===f.secure?this.isHttpsEnabledConnection():f.secure,P=f.domain;document.cookie=L+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path="+K+(U?";secure":"")+(P?";domain="+P:"")},getRandomId:function(){for(var f="",T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",L=0;L<32;L++)f+=T.charAt(Math.floor(Math.random()*T.length));return f},getDataFromKmSession:function(f){if(KommunicateUtils.isSessionStorageAvailable()){var T=sessionStorage.getItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY);return T?JSON.parse(T)[f]:""}},storeDataIntoKmSession:function(f,T){if(KommunicateUtils.isSessionStorageAvailable()){var L="undefined"!=typeof sessionStorage&&sessionStorage.getItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY);(L=L?JSON.parse(L):{})[f]=T,"undefined"!=typeof sessionStorage&&sessionStorage.setItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY,JSON.stringify(L))}},deleteDataFromKmSession:function(f){if(KommunicateUtils.isSessionStorageAvailable()){var T="undefined"!=typeof sessionStorage&&sessionStorage.getItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY);delete(T=T?JSON.parse(T):{})[f],"undefined"!=typeof sessionStorage&&sessionStorage.setItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY,JSON.stringify(T))}},triggerCustomEvent:function(f,T,L){if((T="object"==typeof T?T:{}).bubbles=T.bubbles||!0,T.cancelable=T.cancelable||!0,-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0){var K="v2"===L?window.parent.document.createEvent("Event"):document.createEvent("Event");K.initEvent(f,T.bubbles,T.cancelable),"v2"===L?window.parent.document.dispatchEvent(K):window.dispatchEvent(K)}else("v2"===L?window.parent.document:window).dispatchEvent(new CustomEvent(f,{detail:T.data||{},bubbles:T.bubbles||!0,cancelable:T.cancelable||!0}))},getSettings:function(f){var T=KommunicateUtils.getDataFromKmSession("settings");return T=T||null,f&&T?T[f]:T||""},getItemFromLocalStorage:function(f){if(KommunicateUtils.isSessionStorageAvailable()){var T=localStorage.getItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY);return T?JSON.parse(T)[f]:""}},removeItemFromLocalStorage:function(f){if(KommunicateUtils.isSessionStorageAvailable()){var T=localStorage.getItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY);delete(T=T?JSON.parse(T):{})[f],localStorage.setItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY,JSON.stringify(T))}},setItemToLocalStorage:function(f,T){if(KommunicateUtils.isSessionStorageAvailable()){var L=localStorage.getItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY);(L=L?JSON.parse(L):{})[f]=T,localStorage.setItem(KommunicateConstants.KOMMUNICATE_SESSION_KEY,JSON.stringify(L))}},findCookieDomain:function(f){for(var T=0,L=f.split("."),K="km_"+(new Date).getTime();T<L.length-1&&-1==document.cookie.indexOf(K+"="+K);)f=L.slice(-1-++T).join("."),document.cookie=K+"="+K+";domain="+f+";";return document.cookie=K+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+f+";",f},getSubDomain:function(){var f=parent.window.location.hostname,T=MCK_COOKIE_DOMAIN.length;return f.substr(0,f.length-T)},deleteUserCookiesOnLogout:function(){KommunicateUtils.deleteCookie({name:KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID,domain:MCK_COOKIE_DOMAIN}),KommunicateUtils.deleteCookie({name:KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_USERNAME,domain:MCK_COOKIE_DOMAIN}),KommunicateUtils.deleteCookie({name:KommunicateConstants.COOKIES.IS_USER_ID_FOR_LEAD_COLLECTION,domain:MCK_COOKIE_DOMAIN}),KommunicateUtils.deleteCookie({name:KommunicateConstants.COOKIES.ACCESS_TOKEN,domain:MCK_COOKIE_DOMAIN})},isValidTimeZone:function(f){if(!Intl||!Intl.DateTimeFormat().resolvedOptions().timeZone)return!0;try{return Intl.DateTimeFormat(void 0,{timeZone:f}),!0}catch(f){return!1}},isActiveConversationNeedsToBeOpened:function(f,T){var L=KommunicateUtils.getCookie(KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID);return f&&void 0!==T&&T.appId==f.appId&&L==f.userId},isSessionStorageAvailable:function(){try{return void 0!==w.sessionStorage}catch(f){return!1}},isURL:function(f){return new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(f)},formatParams:function(f){return"?"+Object.keys(f).map((function(T){return T+"="+encodeURIComponent(f[T])})).join("&")}};var $applozic=jQuery.noConflict(!0);void 0!==$original&&($=$original,jQuery=$original,"function"==typeof $.fn.template?($applozic.fn.template=$.fn.template,jQuery.fn.template=$.fn.template):"function"==typeof $applozic.fn.template&&($.fn.template=$applozic.fn.template,jQuery.fn.template=$applozic.fn.template)),function(f){"use strict";"undefined"==typeof KMCommonUtils&&(f.KMCommonUtils={ajax:function(f){var T,L,K=function(){for(var f=1;f<arguments.length;f++)for(var T in arguments[f])arguments[f].hasOwnProperty(T)&&(arguments[0][T]=arguments[f][T]);return arguments[0]}({},{},f),U=new XMLHttpRequest,P=!0;(void 0!==K.async||f.async)&&(P=K.async);var G=K.type.toUpperCase();"GET"===G&&void 0!==K.data&&(K.url=K.url+"?"+K.data),U.open(G,K.url,P),"POST"!==G&&"GET"!==G||(L=void 0===K.contentType?"application/x-www-form-urlencoded; charset=UTF-8":K.contentType,U.setRequestHeader("Content-Type",L)),void 0===K.data?U.send():U.send(K.data),U.onreadystatechange=function(){if(U.readyState===XMLHttpRequest.DONE)if(200===U.status){var f=U.getResponseHeader("Content-Type");void 0!==f&&"null"!==f&&null!==f||(f=""),T=-1!=f.toLowerCase().indexOf("text/html")?U.responseXML:-1!=f.toLowerCase().indexOf("application/json")?JSON.parse(U.responseText):U.responseText,K.success(T)}else K.error(T)}}})}(window),function(f){"use strict";"undefined"==typeof KommunicateKB&&(f.KommunicateKB=function(){var f={},T="https://api.kommunicate.io",L="KOMMUNICATE";return f.init=function(f){T=f},f.getCategories=function(f){var T=f.data.appId,L=f.data.baseUrl+"/kb/category?applicationId="+T+"&status=published",K=new Object;try{KMCommonUtils.ajax({url:L,type:"get",success:function(T){K.status="success",K.data=T.data,f.success&&f.success(K)},error:function(T,L,U){K.status="error",f.error&&f.error(K)}})}catch(T){f.error(T)}},f.getArticles=function(T){try{var K=[];f.getFaqs({data:T.data,success:function(f){for(var U=0;U<f.data.length;U++){var P=f.data[U];K.push({articleId:P.id,title:P.name,description:P.content,status:P.status,body:P.content,source:L})}if(T.success){var G=new Object;G.status="success",G.data=K,T.success(G)}},error:function(f){"function"==typeof T.error&&T.error(f)}})}catch(f){T.error(f)}},f.getArticle=function(T){f.getFaq({data:T.data,success:function(f){var K=f.data.data[0],U={articleId:K.id,title:K.name,description:K.content,body:K.content,status:K.status,source:L};if(T.success){var P=new Object;P.status="success",P.data=U,T.success(P)}},error:function(f){T.error(f)}})},f.getFaqs=function(f){var L=T+"/kb/search?appId=:appId".replace(":appId",f.data.appId);f.data.query?L=L+"&query="+f.data.query:f.data.categoryName&&(L=T+"/kb?categoryName=:categoryName&applicationId=:appId&status=published&type=faq".replace(":appId",f.data.appId).replace(":categoryName",f.data.categoryName));var K=new Object;KMCommonUtils.ajax({url:L,async:void 0===f.async||f.async,type:"get",success:function(T){K.status="success",K.data=T.data,f.success&&f.success(K)},error:function(T,L,U){K.status="error",f.error&&f.error(K)}})},f.searchFaqs=function(f){var L={query:{bool:{must:{multi_match:{query:f.data.query,type:"phrase_prefix",fields:["content","name"]}},filter:{bool:{must:[{term:{"applicationId.keyword":f.data.appId}},{term:{"type.keyword":"faq"}},{term:{deleted:!1}},{term:{"status.keyword":"published"}}]}}}}},K=T+"/kb/_search",U=new Object;KMCommonUtils.ajax({url:K,async:void 0===f.async||f.async,type:"post",contentType:"application/json",data:JSON.stringify(L),success:function(T){U.status="success",U.data=T.data,f.success&&f.success(U)},error:function(T,L,K){U.status="error",f.error&&f.error(U)}})},f.getFaq=function(f){var L=new Object,K=T+"/kb/search?appId=:appId".replace(":appId",f.data.appId);f.data&&f.data.articleId&&(K+="&articleId="+f.data.articleId),KMCommonUtils.ajax({url:K,async:void 0===f.async||f.async,type:"get",success:function(T){L.status="success",L.data=T,f.success&&f.success(L)},error:function(T,K,U){L.status="error",f.error&&f.error(L)}})},f}())}(window),Kommunicate="undefined"==typeof Kommunicate?{}:Kommunicate,Kommunicate.defaultLabels={"input.message":"Type your message...","conversations.title":"Conversations","start.new":"Start New Conversation","search.contacts":"Contacts","search.groups":"Groups","char.limit.warn":"Keep your message within 256 characters to help the bot understand easily","limit.remove":"Remove","limit.characters":"characters","limit.remaining":"remaining","file.uploading.wait":"Please wait file is uploading.","empty.groups":"No groups yet!","empty.contacts":"No contacts yet!","empty.messages":"No messages yet!","no.more.messages":"No more messages!","empty.conversations":"No conversations yet!","no.more.conversations":"No more conversations!","search.placeholder":"Search...","location.placeholder":"Enter a location","create.group.title":"Create Group","members.title":"Members","add.members.title":"Add Member","remove.member":"Remove Member","change.role":"Change Role","group.info.update":"Update","group.info.updating":"Updating...","add.group.icon":"Add Group Icon","group.deleted":"Group has been deleted","change.group.icon":"Change Group Icon","group.title":"Group Title","group.type":"Group Type","group.create.submit":"Creating Group...",blocked:"You have blocked this user","group.chat.disabled":"You are no longer part of this group!","block.user.alert":"Are you sure you want to block this user?","unblock.user.alert":"Are you sure you want to unblock this user?","exit.group.alert":"Are you sure you want to exit this group?","remove.member.alert":"Are you sure you want to remove this member?","clear.messages.alert":"Are you sure you want to delete all the conversation?",typing:"typing...","is.typing":"is typing...",online:"Online",offline:"Offline","clear.messages":"Clear Messages",delete:"Delete",reply:"Reply",forward:"Forward",copy:"Copy","block.user":"Block User","unblock.user":"Unblock User","group.info.title":"Group Info","exit.group":"Exit Group","location.share.title":"Location Sharing","my.location":"My Location",send:"Send","send.message":"Send Message",smiley:"Emoji Picker",close:"Close",edit:"Edit",save:"Save","file.attachment":"Upload Attachment","file.attach.title":"Attach File","last.seen":"Last seen","last.seen.on":"Last seen on",hour:" hour",min:" min",yesterday:"yesterday",hours:" hours",mins:" mins","time.format.AM":"AM","time.format.PM":"PM","time.format.am":"am","time.format.pm":"pm","user.delete":"This user has been deleted",ago:"ago",admin:"Admin",user:"User",moderator:"Moderator",member:"Member",public:"Public",private:"Private",open:"Open",you:"You",away:"Away","closed.conversation.message":"This conversation has been marked as resolved. If you have other queries, just send a message here or start a new conversation.","search.faq":"Search in FAQs...","looking.for.something.else":"Looking for something else?","no-faq-found":"We are here to help.","faq-empty-state":"NO ARTICLES TO SHOW","talk.to.agent":"Talk to an agent","how.to.reachout":"How may we reach you?","email.error.alert":"It seems you have entered an invalid email","conversation.rated":"rated the conversation","offline.msg":"Uh oh! No internet connection. Please check your network settings and try again.","group.metadata":{CREATE_GROUP_MESSAGE:":adminName created group :groupName",REMOVE_MEMBER_MESSAGE:":adminName removed :userName",ADD_MEMBER_MESSAGE:":adminName added :userName",JOIN_MEMBER_MESSAGE:":userName joined",GROUP_NAME_CHANGE_MESSAGE:"Group name changed to :groupName",GROUP_ICON_CHANGE_MESSAGE:"Group icon changed",GROUP_LEFT_MESSAGE:":userName left",DELETED_GROUP_MESSAGE:":adminName deleted group",GROUP_USER_ROLE_UPDATED_MESSAGE:":userName is :role now",GROUP_META_DATA_UPDATED_MESSAGE:"",ALERT:"",HIDE:""},"lead.collection":{email:"Email",name:"Name",phone:"Contact Number",title:"Conversations",heading:"Before starting, we just need a few details so that we may serve you better",submit:"Start Conversation",option:"Please select",password:"Password",errorText:"Please enter your account password"},"csat.rating":{CONVERSATION_RATED:"You rated the conversation",RATE_CONVERSATION:"Rate your conversation",CONVERSATION_REVIEW_PLACEHOLDER:"Add a feedback (optional)",OTHER_QUERIES:"Have other queries? ",RESTART_CONVERSATION:"Restart this conversation",SUBMIT_RATING:"Submit your rating"},"page.title.on.new.message":"New message from ","emoji.hover.text":{poor:"Poor",great:"Great",average:"Average"},"rich.message":{"notification.preview":"Message"},"filter.conversation.list":{ALL_CONVERSATIONS:"All conversations",ACTIVE_CONVERSATIONS:"Active conversations",HIDE_RESOLVED:"Hide resolved",SHOW_RESOLVED:"Show resolved"},"rich.form":{errorText:"Please enter valid data"},"faq.query.message":{QUERY_REGARDING:"Hi, I have a query regarding",HELP_YOU:"Can you help me out?"},"time.stamp":{"sec.ago":"sec ago","secs.ago":"secs ago","min.ago":"min ago","mins.ago":"mins ago","hr.ago":"hr ago","hrs.ago":"hrs ago"},"voice.output":{location:{init:"A location has been shared with you.",lat:"Latitude is ",lon:"and Longitude is "},attachment:"You have an attachment."},"waiting.queue.message":{"contact.name":"In Queue...","header.text":"In queue...","first.Part":"You are currently","waiting.queue.number":"5","last.part":" in the waiting queue, our agents will get back to you shortly."},"conversation.header.dropdown":{CSAT_RATING_TEXT:"Rate this conversation",USER_OVERIDE_VOICE_OUTPUT_ON:"Turn on text to speech",USER_OVERIDE_VOICE_OUTPUT_OFF:"Turn off text to speech",RESET_CONVERSATION:"Reset conversation"}},Kommunicate.client={getGroupDetailByType:function(f,T){var L="type="+f.type+"&startIndex="+f.startIndex+"&limit="+f.limit;window.Applozic.ALApiService.ajax({url:MCK_BASE_URL+"/rest/ws/group/bytype",type:"get",data:L,contentType:"application/json",success:function(f){T(null,f)},error:function(f){T(f)}})},createConversation:function(f,T){var L=$applozic.extend(Kommunicate.getSettings("KM_CHAT_CONTEXT"),f.metadata?f.metadata.KM_CHAT_CONTEXT:{}),K=kommunicate._globals.userLocale,U={kmUserLocale:K?K.split("-")[0]:(window.navigator.language||window.navigator.userLanguage).split("-")[0]};L=$applozic.extend(L,U);var P={CREATE_GROUP_MESSAGE:"",REMOVE_MEMBER_MESSAGE:"",ADD_MEMBER_MESSAGE:"",JOIN_MEMBER_MESSAGE:"",GROUP_NAME_CHANGE_MESSAGE:"",GROUP_ICON_CHANGE_MESSAGE:"",GROUP_LEFT_MESSAGE:"",CONVERSATION_STATUS:-1,DELETED_GROUP_MESSAGE:"",GROUP_USER_ROLE_UPDATED_MESSAGE:"",GROUP_META_DATA_UPDATED_MESSAGE:"",CONVERSATION_ASSIGNEE:f.assignee||f.agentId,KM_CONVERSATION_TITLE:f.groupName,HIDE:"true",SKIP_ROUTING:!!f.skipRouting&&f.skipRouting,KM_CHAT_CONTEXT:JSON.stringify(L),GROUP_CREATION_URL:window.kommunicate.IFRAME_OVERRIDES?window.kommunicate.IFRAME_OVERRIDES.GROUP_CREATION_URL:parent.location.href,conversationMetadata:JSON.stringify(f.metadata)};void 0!==f.teamId&&(P.KM_TEAM_ID=f.teamId),f.metadata.KM_ORIGINAL_TITLE&&(P.KM_ORIGINAL_TITLE=!0),f.skipBotEvent&&(P.SKIP_BOT_EVENT=f.skipBotEvent),f.customWelcomeEvent&&(P.CUSTOM_WELCOME_EVENT=f.customWelcomeEvent),f.metadata&&f.metadata.WELCOME_MESSAGE&&(P.WELCOME_MESSAGE=f.metadata.WELCOME_MESSAGE);var G={groupName:f.groupName,type:f.type,admin:f.agentId,users:f.users,clientGroupId:f.clientGroupId,isMessage:f.isMessage,isInternal:f.isInternal,metadata:P,allowMessagesViaSocket:f.allowMessagesViaSocket||!1,callback:function(L){"success"===L.status&&L.data.clientGroupId?("function"==typeof T&&T(L.data.value),KommunicateUI.hideFaq(),KommunicateUI.showClosedConversationBanner(!1)):"error"===L.status&&f.clientGroupId&&"group already exists"===L.errorMessage&&(Kommunicate.openConversation(null,{clientGroupId:f.clientGroupId}),"function"==typeof T&&T(L))}};f.agentId&&P.SKIP_ROUTING&&(G.admin=f.agentId,G.users.push({userId:f.agentId,groupRole:1}),G.users.push({userId:"bot",groupRole:2})),$applozic.fn.applozic("createGroup",G)},getThirdPartySettings:function(f,T){$applozic.ajax({url:Kommunicate.getBaseUrl()+"/integration/settings/"+f.appId+"?type="+f.type,type:"get",contentType:"application/json",success:function(f){T(null,f)},error:function(f){T(f)}})}},Kommunicate="undefined"==typeof Kommunicate?{}:Kommunicate,Kommunicate.conversationHelper={status:{INITIAL:-1,OPEN:0,PROGRESS:1,CLOSED:2,SPAM:3,DUPLICATE:4,ARCHIVE:5,UNRESPONDED:6,WAITING:7},isConversationClosed:function(f){if(void 0!==f)return f.metadata&&f.metadata.CONVERSATION_STATUS==Kommunicate.conversationHelper.status.CLOSED}},Kommunicate="undefined"==typeof Kommunicate?{}:Kommunicate,Kommunicate.conversation={STATUS:Kommunicate.conversationHelper.status,processConversationOpenedFromList:function(f,T){if(!T){var L=f&&f.groupFeeds[0];KommunicateUI.showClosedConversationBanner(Kommunicate.conversationHelper.isConversationClosed(L))}}};var KOMMUNICATE_VERSION=window.kommunicate.version;"v2"===KOMMUNICATE_VERSION&&(parent.Kommunicate=window.Kommunicate),$applozic.extend(!0,Kommunicate,{getBaseUrl:function(){return KM_PLUGIN_SETTINGS.kommunicateApiUrl},setDefaultAgent:function(f){throw new Error("not implemented")},getConversationOfParticipent:function(f,T){if("function"!=typeof T)throw new Error("invalid callback! expected: Kommunicate.startNewConversation(options, callback) ");$applozic.ajax({url:Kommunicate.getBaseUrl()+"/conversations/participent/"+f.userId,type:"get",success:function(f){T(null,f)},error:function(f){T(f)}})},startConversation:function(f,T){if(kommunicateCommons.setWidgetStateOpen(!0),f="object"==typeof f?f:{},kmWidgetEvents.eventTracking(eventMapping.onStartNewConversation),!(f=Kommunicate.updateConversationDetail(f)).agentId&&!f.agentIds&&!f.teamId){var L=KommunicateUtils.getDataFromKmSession("appOptions")||applozic._globals;f.agentId=L.agentId}var K=[];if(f.agentIds)for(var U=0;U<f.agentIds.length;U++)K.push({userId:f.agentIds[U],groupRole:1});if(f.botIds)for(U=0;U<f.botIds.length;U++)K.push({userId:f.botIds[U],groupRole:2});var P=f.defaultGroupName||f.conversationTitle||f.groupName||kommunicate._globals.conversationTitle||kommunicate._globals.groupName||kommunicate._globals.agentId,G=f.defaultAssignee||f.assignee||f.agentId,B={};f.defaultGroupName&&(B.KM_ORIGINAL_TITLE=!0),"object"==typeof f.metadata&&"object"==typeof f.metadata.KM_CHAT_CONTEXT&&(B.KM_CHAT_CONTEXT=f.metadata.KM_CHAT_CONTEXT),f.WELCOME_MESSAGE&&(B.WELCOME_MESSAGE=f.WELCOME_MESSAGE),f.conversationMetadata&&"object"==typeof f.conversationMetadata&&(B=f.conversationMetadata);var z={groupName:P,type:10,agentId:f.agentId,assignee:G,users:K,clientGroupId:f.clientGroupId,isMessage:f.isMessage,isInternal:f.isInternal,skipRouting:f.skipRouting,skipBotEvent:f.skipBotEvent,customWelcomeEvent:f.customWelcomeEvent,metadata:B,teamId:f.teamId};if(IS_SOCKET_CONNECTED)Kommunicate.client.createConversation(z,T);else var H=setInterval((function(){IS_SOCKET_CONNECTED&&(Kommunicate.client.createConversation(z,T),clearInterval(H),q&&clearTimeout(q))}),500),q=setTimeout((function(){z.allowMessagesViaSocket=!0,Kommunicate.client.createConversation(z,T),clearInterval(H)}),3500)},updateConversationMetadata:function(f){if(f){if("[object Object]"==Object.prototype.toString.call(f)&&"[object Object]"==Object.prototype.toString.call(f.metadata)&&f.groupId&&f.metadata){var T=f.metadata;return Applozic.ALApiService.groupUpdate({data:{groupId:f.groupId,metadata:{conversationMetadata:JSON.stringify(T)}},success:function(f){},error:function(f){}})}throw new TypeError("updateConversationMetadata expects an object as an argument")}throw new Error("updateConversationMetadata expect an object but got null")},updateConversationDetail:function(f){var T=KommunicateUtils.getDataFromKmSession("settings");return null==T||(f.WELCOME_MESSAGE=f.WELCOME_MESSAGE||T.WELCOME_MESSAGE,f.defaultAssignee=f.assignee||T.defaultAssignee,f.agentIds=f.agentIds||T.defaultAgentIds,f.botIds=f.botIds||T.defaultBotIds,f.skipRouting=f.skipRouting||T.skipRouting,f.skipBotEvent=f.skipBotEvent||T.skipBotEvent,f.customWelcomeEvent=f.customWelcomeEvent||T.customWelcomeEvent,f.teamId=f.teamId||T.teamId),f},openConversationList:function(){kommunicateCommons.setWidgetStateOpen(!0),window.$applozic.fn.applozic("loadTab",""),KommunicateUI.showChat(),KommunicateUI.hideFaq()},openConversation:function(f,T){kommunicateCommons.setWidgetStateOpen(!0),f?window.$applozic.fn.applozic("loadGroupTab",f):T&&T.clientGroupId&&window.$applozic.fn.applozic("loadGroupTabByClientGroupId",T),KommunicateUI.hideFaq()},openDirectConversation:function(f){kommunicateCommons.setWidgetStateOpen(!0),window.$applozic.fn.applozic("loadTab",f),KommunicateUI.showChat(),KommunicateUI.hideFaq()},loadConversation:function(f,T){var L=(f.agentIds||[]).sort((function(f,T){return f.toLowerCase()<T.toLowerCase()?-1:f.toLowerCase()>T.toLowerCase()?1:0})),K=f.botIds||[];if(L.length<1){var U={code:"INVALID_PARAMETERS",message:"required parameter agentIds is missing."};return"function"==typeof T?T(U):void 0}var P=kommunicate._globals.userId||KommunicateUtils.getCookie(KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID),G=L.join("_"),B=K.join("_"),z=encodeURIComponent(B?[G,P,B].join("_"):[G,P].join("_"));if(z.length>256)return U={code:"MEMBER_LIMIT_EXCEEDS",message:"try adding fewer members"},"function"==typeof T?T(U):void 0;mckGroupService.getGroupFeed({clientGroupId:z,apzCallback:function(f){if("error"==f.status&&"AL-G-01"==f.code){var U=L.map((function(f){return{userId:f,groupRole:1}}));U.push({userId:"bot",groupRole:2}),U.push(K.map((function(f){return{userId:f,groupRole:2}})));var P={groupName:kommunicate._globals.conversationTitle||kommunicate._globals.groupName||kommunicate._globals.agentId,type:10,agentId:U[0].userId,users:U,clientGroupId:decodeURIComponent(z)};Kommunicate.client.createConversation(P,(function(f){if(T)return T(null,f)}))}else if("success"==f.status){var G=f.data.id;return $applozic.fn.applozic("loadGroupTab",G),T(null,f)}}})},createGroupName:function(f){return f.sort().join().replace(/,/g,"_").substring(0,250)},openLastConversation:function(f){var T=f,L=[],K=[];if(K.push(f.agentId),K.push(kommunicate._globals.userId),L.push({userId:f.agentId,groupRole:1}),L.push({userId:"bot",groupRole:2}),f.botIds)for(var U=0;U<f.botIds.length;U++)L.push({userId:f.botIds[U],groupRole:2}),K.push(f.botIds[U]);var P=Kommunicate.createGroupName(K),G={};G.groupName=P,G.callback=function(f){f.data.groups.length>0?Kommunicate.openConversation(f.data.groups[0].id):Kommunicate.startConversation(T,(function(f){}))},window.$applozic.fn.applozic("getGroupListByFilter",G)},createNewConversation:function(f,T){if("function"!=typeof T)throw new Error("invalid callback! expected: Kommunicate.startNewConversation(options, callback) ");var L={groupId:f.groupId,participantUserId:f.participantUserId,createdBy:f.participantUserId,defaultAgentId:f.defaultAgentId,applicationId:f.applicationId};$applozic.ajax({url:Kommunicate.getBaseUrl()+"/conversations",type:"post",data:JSON.stringify(L),contentType:"application/json",success:function(f){T(null,f)},error:function(f){T(f)}})},logout:function(){void 0!==window.$applozic&&void 0!==window.$applozic.fn&&void 0!==window.$applozic.fn.applozic&&window.$applozic.fn.applozic("logout"),KommunicateUtils.removeItemFromLocalStorage("mckActiveConversationInfo"),KommunicateUtils.deleteUserCookiesOnLogout(),parent.window&&parent.window.removeKommunicateScripts()},launchConversation:function(){window.$applozic.fn.applozic("mckLaunchSideboxChat")},triggerEvent:function(f,T){$applozic.ajax({url:Kommunicate.getBaseUrl()+"/applications/events?type="+f,type:"post",data:JSON.stringify({conversationId:T.groupId,applicationId:T.applicationId}),contentType:"application/json",success:function(f){},error:function(f){}})},updateUser:function(f){var T={data:f};window.$applozic.fn.applozic("updateUser",T)},getAwayMessage:function(f,T){$applozic.ajax({url:Kommunicate.getBaseUrl()+"/applications/"+f.applicationId+"/awaymessage?conversationId="+f.conversationId+"&languageCode="+f.languageCode,type:"get",contentType:"application/json",success:function(f){"function"==typeof T&&T(null,f)},error:function(f){"function"==typeof T&&T(f)}})},updateUserIdentity:function(f){window.$applozic.fn.applozic("updateUserIdentity",{newUserId:f,callback:function(T){KommunicateUtils.setCookie({name:KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID,value:f,expiresInDays:30,domain:MCK_COOKIE_DOMAIN}),"success"==T&&window.$applozic.fn.applozic("reInitialize",{userId:f})}})},isRichTextMessage:function(f){return f&&(f.hasOwnProperty("templateId")||300==f.contentType)},appendEmailToIframe:function(f){if((Kommunicate.isRichTextMessage(f.metadata)||3==f.contentType)&&7===f.source&&f.message){var T="km-iframe-"+f.groupId,L=document.getElementById(T),K=L.contentDocument||L.contentWindow.document;K.open(),K.write(f.message),K.close();for(var U=K.getElementsByTagName("a"),P=0;P<U.length;P++)U[P].setAttribute("target","_blank")}},isAttachment:function(f){return"object"==typeof f.fileMeta&&f.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.ATTACHMENT||f.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.LOCATION},getContainerTypeForRichMessage:function(f){var T=f.metadata,L="km-slick-container ";if(T.templateId==KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.CARD_CAROUSEL&&T.payload&&T.payload.length>1&&(L+="km-slider-multiple-cards-container"),T.templateId)switch(T.templateId){case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.HOTEL_BOOKING_CARD:case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.ROOM_DETAIL:case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.CARD_CAROUSEL:return L;case"6":return"km-border-less-container km-cta-multi-button-container";default:return"km-fixed-container"}else if(f.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.TEXT_HTML&&f.source==KommunicateConstants.MESSAGE_SOURCE.MAIL_INTERCEPTOR)return"km-fixed-container"},sendMessage:function(f){var T=$applozic("#mck-message-cell .mck-message-inner"),L=$applozic("#mck-msg-to");!0===T.data("isgroup")?f.groupId=L.val():f.to=L.val(),$applozic.fn.applozic("sendGroupMessage",f)},getRichTextMessageTemplate:function(f){var T=f.metadata;if(!T.templateId)return f.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.TEXT_HTML&&f.source==KommunicateConstants.MESSAGE_SOURCE.MAIL_INTERCEPTOR?Kommunicate.markup.getHtmlMessageMarkups(f):"";switch(T.templateId){case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.ROOM_COUNT:return Kommunicate.markup.getHotelRoomPaxInfoTemplate();case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.HOTEL_BOOKING_CARD:return Kommunicate.markup.getHotelCardContainerTemplate(JSON.parse(T.hotelList||"[]"),T.sessionId);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.LINK_BUTTON:return Kommunicate.markup.buttonContainerTemplate(T);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.PASSENGER_DETAIL:return Kommunicate.markup.getPassangerDetail(T);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.ROOM_DETAIL:return Kommunicate.markup.getRoomDetailsContainerTemplate(JSON.parse(T.hotelRoomDetail||"[]"),T.sessionId);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.QUICK_REPLY:return Kommunicate.markup.quickRepliesContainerTemplate(T,KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.QUICK_REPLY);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.LIST:return Kommunicate.markup.getListContainerMarkup(T);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.DIALOG_BOX:return Kommunicate.markup.getDialogboxContainer(T);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.IMAGE:return Kommunicate.markup.getImageContainer(T);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.CARD_CAROUSEL:return Kommunicate.markup.getCarouselMarkup(T);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.GENERIC_BUTTONS:case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.GENERIC_BUTTONS_V2:return Kommunicate.markup.getGenericButtonMarkup(T);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.FORM:return Kommunicate.markup.getActionableFormMarkup(T);case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.VIDEO:return Kommunicate.markup.getVideoMarkup(T);default:return""}},updateSettings:function(f){var T=typeof f;if("object"!=T)throw new error("update settings expects an object, found "+T);var L=KommunicateUtils.getDataFromKmSession("settings");for(var K in L=L||{},f)L[K]=f[K];KommunicateUtils.storeDataIntoKmSession("settings",L)},getSettings:function(f){return KommunicateUtils.getSettings(f)},updateChatContext:function(f){if("object"==typeof f){var T=KommunicateUtils.getSettings(KommunicateConstants.SETTINGS.KM_CHAT_CONTEXT)||{};for(var L in f)T[L]=f[L];Kommunicate.updateSettings({KM_CHAT_CONTEXT:T})}},updateUserLanguage:function(f){var T=KommunicateUtils.getSettings(KommunicateConstants.SETTINGS.KM_CHAT_CONTEXT)||{};T[KommunicateConstants.SETTINGS.KM_USER_LANGUAGE_CODE]=f,Kommunicate.updateChatContext(T)},setDefaultIframeConfigForOpenChat:function(f){!kommunicateCommons.checkIfDeviceIsHandheld()&&kommunicateCommons.modifyClassList({id:["mck-sidebox"]},"popup-enabled","");var T=parent.document.getElementById("kommunicate-widget-iframe"),L=T.contentDocument.getElementById("km-popup-close-button");T.style.width="",T.classList.remove("km-iframe-notification"),T.classList.remove("km-iframe-closed"),f?(T.classList.add("km-iframe-dimension-with-popup"),L&&(L.style.display="flex")):T.classList.add("km-iframe-dimension-no-popup"),T.classList.add("kommunicate-iframe-enable-media-query")},customizeWidgetCss:function(f){var T=document.createElement("style");T.type="text/css",T.innerHTML=f,document.getElementsByTagName("head")[0].appendChild(T)},subscribeToEvents:function(f){$applozic.fn.applozic("subscribeToEvents",f)},updateUserTimezone:function(f){if(KommunicateUtils.isValidTimeZone(f)){var T=KommunicateUtils.getSettings(KommunicateConstants.SETTINGS.KM_CHAT_CONTEXT)||{};T[KommunicateConstants.SETTINGS.KM_USER_TIMEZONE]=f,Kommunicate.updateChatContext(T)}},displayKommunicateWidget:function(f){var T=parent.document.getElementById("kommunicate-widget-iframe");f?T.classList.remove("kommunicate-hide-custom-iframe"):T.classList.add("kommunicate-hide-custom-iframe")},visibleMessage:function(f){return!(!f||!f.message&&(f.metadata.hasOwnProperty("KM_ASSIGN_TO")||f.metadata.hasOwnProperty("KM_ASSIGN_TEAM"))||f.type===KommunicateConstants.MESSAGE_TYPE.CALL_INCOMING||f.type===KommunicateConstants.MESSAGE_TYPE.CALL_OUTGOING||f.metadata&&"HIDDEN"===f.metadata.category||f.contentType===KommunicateConstants.MESSAGE_CONTENT_TYPE.AUDIO_VIDEO_CALL||f.metadata&&(f.metadata.KM_ASSIGN||f.metadata.KM_STATUS)||f.contentType===KommunicateConstants.MESSAGE_CONTENT_TYPE.NOTIFY_MESSAGE&&f.metadata&&(f.metadata.hasOwnProperty("KM_TRIGGER_EVENT")||"true"===f.metadata.hide))},hideMessage:function(f){if(f){for(var T=f.parentElement;!T.classList.contains("mck-msg-left");)T=T.parentElement;T.classList.add("n-vis")}},getAllSiblings:function(f){var T=[];if(!f||!f.parentNode)return T;for(var L=f.parentNode.firstChild;L;)1===L.nodeType&&L!==f&&T.push(L),L=L.nextSibling;return T}}),Kommunicate.markup={getSingleRoomPaxInfo:function(f){return'<div class = "km-single-pax-info">\n    <div class="km-room-title-text">ROOM '+(f=f||"1")+'</div>\n    <div class="km-room-selector">\n        <div>Guest :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>\n        <div id= "">\n            <input class ="km-decrement-guest-count" type="button" value="-" data-type="guest">\n            <input type="number" min="1" max="5" value="1" class="km-room-number-field" maxlength="1" disabled>\n            <input class ="km-increment-guest-count" type="button" value="+" data-type="guest">\n        </div>\n    </div>\n    <div class="km-person-selector n-vis">\n        <div class="km-children-text-lable">Children :<span>(1-12 yrs)</span></div>\n        <div>\n            <input class ="km-decrement-guest-count" type="button" value="-" data-type="children">\n            <input type="number" min="0" max="2" value="0" class="km-person-number-field" maxlength="1" disabled >\n            <input class ="km-increment-guest-count" type="button" value="+" data-type="children">\n        </div> \n    </div>\n</div>'},getHotelCardTemplate:function(f,T){var L={star1:"km-star-empty",star2:"km-star-empty",star3:"km-star-empty",star4:"km-star-empty",star5:"km-star-empty"};if(f.StarRating)for(var K=0;K<f.StarRating;K++)L["star"+(K+1)]="km-star-filled";var U=("INR"==f.Price.CurrencyCode?"&#x20B9;":f.Price.CurrencyCode)+" "+Math.ceil(1*f.Price.OfferedPrice);return'\n    <div class="km-single-card-message">\n        <div class="km-card-message-header">\n            <div class="km-card-message-image-continer"><img class ="km-card-message-img" src ='+f.HotelPicture+' />\n                    <div class="km-card-message-image-price-container">'+U+'</div>\n            </div>\n        </div>\n        <div class="km-card-message-body">\n            <h1 class="km-card-message-body-title">'+f.HotelName+'</h1>\n            <div class="km-card-message-body-ratings">\n                <span>\n                    <svg xmlns="http://www.w3.org/2000/svg"  height="24" viewBox="0 0 24 24" width="24" class="'+L.star1+'">\n                        <path d="M0 0h24v24H0z" fill="none"/>\n                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>\n                    </svg>\n                </span>\n                <span>\n                    <svg xmlns="http://www.w3.org/2000/svg"  height="24" viewBox="0 0 24 24" width="24" class="'+L.star2+'">\n                        <path d="M0 0h24v24H0z" fill="none"/>\n                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>\n                    </svg>\n                </span>\n                <span>\n                    <svg xmlns="http://www.w3.org/2000/svg"  height="24" viewBox="0 0 24 24" width="24" class="'+L.star3+'">\n                        <path d="M0 0h24v24H0z" fill="none"/>\n                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>\n                    </svg>\n                </span>\n                <span>\n                    <svg xmlns="http://www.w3.org/2000/svg"  height="24" viewBox="0 0 24 24" width="24" class="'+L.star4+'">\n                        <path d="M0 0h24v24H0z" fill="none"/>\n                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>\n                    </svg>\n                </span>\n                <span>\n                    <svg xmlns="http://www.w3.org/2000/svg"  height="24" viewBox="0 0 24 24" width="24" class="'+L.star5+'">\n                        <path d="M0 0h24v24H0z" fill="none"/>\n                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>\n                    </svg>\n                </span>\n            </div>\n            <div class="km-card-message-body-address">\n                <span class="km-card-message-body-address-icon">\n                    <svg xmlns="http://www.w3.org/2000/svg"  height="24" viewBox="0 0 24 24" width="24">\n                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>\n                        <path d="M0 0h24v24H0z" fill="none"/>\n                    </svg>\n                </span>'+f.HotelAddress+'\n            </div>\n        </div>\n        <div class="km-card-message-footer">\n            <button class="km-card-message-footer-button" data-resultindex= '+f.ResultIndex+" data-sessionid= "+T+" data-name= "+f.HotelName.replace(" ","_")+" > Get Room Details</button>\n        </div>\n    </div>"},getRoomDetailTemplate:function(f,T){var L="undefined"==f.NoOfGuest?1:f.NoOfGuest,K=f.DayRates.Amount?f.DayRates.Amount:f.Price.RoomPrice;return'<div class="km-single-card-message">\n                <div class="message received km-blocked-room">\n                    <div class="km-blocked-room-details">\n                    <div class="km-card-message-image-continer"><img class ="km-card-message-img" src='+f.HotelPicture+" alt="+f.HotelName+'></div>\n                        <div class="km-blocked-room-text-container">\n                            <div class="km-blocked-room-room-type">\n                                <span>Room Type: </span> <span> '+f.RoomTypeName+'</span>\n                            </div>\n                            <div class="km-blocked-room-guests">\n                                <span>Guests:</span><span>'+L+' </span>\n                            </div>\n                            <div class="km-blocked-room-price">\n                                <p>Price:<br><span>(Per Room Per Night)</span></p>\n\n                                <span>'+("INR"==f.Price.CurrencyCode?"&#x20B9;":f.Price.CurrencyCode)+" "+Math.ceil(K)+'</span>\n\n                            </div>\n                            <div class="km-blocked-room-sub-total">\n                                <p>Total:<br><span>(1 Room for '+f.NoOfNights+" Nights)</span></p>\n                                <span> "+("INR"==f.Price.CurrencyCode?"&#x20B9;":f.Price.CurrencyCode)+" "+Math.ceil(f.Price.RoomPrice)+' </span>\n                            </div>\n                        </div>\n                        <div class="km-blocked-room-button-container">\n                            <button class="km-block-room-button" data-sessionId= '+T+" data-roomIndex="+f.RoomIndex+" data-NoOfRooms="+f.NoOfRooms+" data-NoOfNights="+f.NoOfNights+" data-HotelName= "+f.HotelName.replace(" ","_")+" data-HotelResultIndex= "+f.HotelResultIndex+" >Book</button>\n                        </div>\n                    </div>\n                </div>\n            </div>"},getLinkPreviewTemplate:function(f,T){var L=f.data;if(L&&L.title)return'<div class="link-preview-wrapper"><div class="link-preview-image-div"><img class="link-preview-image" src="'+(L.images[0]||L.favicons[0])+'" alt="'+(L.siteName||L.title)+'"></div><div class="link-preview-content"><h5 class="link-preview-title link-preview-title-width"> '+(L.siteName||L.title)+'</h5><p class="link-preview-div-description">'+(L.description||L.title)+"</p></div></div>"},getButtonTemplate:function(f,T,L){return"link"==f.type?'<button aria-label="'+(f.replyText||f.name)+'" title= "'+(f.replyText||f.name)+'" class= "km-cta-button km-link-button km-custom-widget-text-color km-undecorated-link '+L+'  " data-url="'+encodeURI(f.url)+'  " data-metadata="'+f.replyMetadata+'" data-buttontype="button" data-target="'+Kommunicate.markup.getLinkTarget(f)+'" ">'+f.name+'<span><svg width="12" height="12" viewBox="0 0 12 12"><path class="km-custom-widget-stroke" fill="none" stroke="#5553B7" d="M8.111 5.45v2.839A.711.711 0 0 1 7.4 9H1.711A.711.711 0 0 1 1 8.289V2.6a.71.71 0 0 1 .711-.711H4.58M5.889 1h2.667C8.8 1 9 1.199 9 1.444v2.667m-.222-2.889L4.503 5.497" /></svg></span></button>':'<button aria-label="'+(f.replyText||f.action&&f.action.message||f.name)+'" title= "'+(f.replyText||f.action&&f.action.message||f.name)+'" data-metadata="'+f.replyMetadata+'" data-buttontype="submit" data-requesttype= "'+T+'" class="km-cta-button km-custom-widget-text-color  '+L+' ">'+f.name+"</button>"},getQuickRepliesTemplate:function(){return'\n            {{#payload}}\n                 <button aria-label="{{title}}" title=\'{{message}}\' class="km-quick-replies km-custom-widget-text-color {{buttonClass}} " data-metadata = "{{replyMetadata}}" data-languageCode = "{{updateLanguage}}" data-hidePostCTA="{{hidePostCTA}}">{{title}}</button>\n            {{/payload}}\n            '},getGenericSuggestedReplyButton:function(){return'<button aria-label="{{name}}" title=\'{{message}}\' class="km-quick-replies km-custom-widget-text-color {{buttonClass}} " data-metadata = "{{replyMetadata}}" data-languageCode = "{{action.updateLanguage}}" data-hidePostCTA="{{hidePostCTA}}">{{name}}</button>'},getPassangerDetail:function(f){return f.sessionId,'  <div class="km-guest-details-container km-rich-text-default-container">\n                <div class="km-guest-detail-form">\n                    <div class= "km-select-title">    \n                        <select name="title" class="km-title-select">\n                            <option value="0" disabled selected>Title *</option>\n                            <option value="Mr.">Mr.</option>\n                            <option value="Ms.">Ms.</option>\n                            <option value="Mrs.">Mrs.</option>\n                        </select>\n                    </div>\n                    <input type="number" name="age"  class="km-input km-age-input n-vis" placeholder="Age *" min="0" max="150">\n                    <input type="text" name="first-name"  class="km-input first-name-input km-pxinfo-btn-left" placeholder="First Name *"  required>\n                    <input type="text" name="middle-name"  class="km-input middle-name-input n-vis" placeholder="Middle Name (optional) ">\n                    <input type="text" name="last-name"  class="km-input last-name-input km-pxinfo-btn-left" placeholder="Last Name *"  required>\n                    <input type="email" name="email"  class="km-input e-mail-input km-pxinfo-btn-left" placeholder="Email Id *" required>\n                    <input type="text" name="contact-no"  class="km-input number-input km-pxinfo-btn-left" placeholder="Contact Number *" required >\n                    <div class= "km-mandatory-field-error n-vis"><span> All fields are mandatory.</span></div>\n                </div>\n                <div class="km-guest-button-container">\n                    <button class="km-add-more-rooms km-submit-person-detail" data-sessionid= '+f.sessionId+">Submit</button>\n                </div>\n            </div>\n            "},getListMarkup:function(){return'<div class="km-message km-received km-chat-faq-list km-list-container" style="">\n     <div class="km-faq-list--container"  >\n             <div class="km-faq-list--header">\n                     {{{headerImgSrc}}}\n                     <div class="km-faq-list--header_text-container">\n                                     {{{headerText}}}\n                         </div>\n         </div>\n         <div class="km-faq-list--body">\n             <div class="km-faq-list--body_list-container">\n                 <ul class="km-faq-list--body_list {{elementClass}}">\n                     {{#elements}}\n                     <li class ={{handlerClass}} data-type="{{dataType}}" data-hidePostCTA="{{hidePostCTA}}" data-metadata = "{{replyMetadata}}" data-reply = "{{dataReply}}" data-languageCode = "{{updateLanguage}}" data-articleid= "{{dataArticleId}}" data-source="{{source}}"> <a href={{href}} {{{target}}} class="km-undecorated-link km-custom-widget-text-color" >\n                             <div class="km-faq-list--body_img">\n                                     {{{imgSrc}}}\n                             </div>\n                         <div class="km-faq-list--body_que-ans">\n                                 <p class="km-faq-list--body_que">\n                                     {{title}}\n                                 </p>\n                                 <p class="km-faq-list--body_ans">\n                                     \n                                 \n                                 {{{description}}}\n                                 </p>\n                             </div>\n                         </a>\n                     </li>\n                     {{/elements}}\n                 \n                 </ul>\n             </div>\n         </div>\n         <div class="km-faq-list--footer">\n                 <div class="km-faq-list--footer_button-container">\n                    {{#buttons}}\n                        <button aria-label="{{name}}" class="{{buttonClass}} km-cta-button km-custom-widget-border-color km-custom-widget-text-color km-add-more-rooms {{handlerClass}} km-faq-list-link-button" data-type ="{{dataType}}" data-hidePostCTA="{{hidePostCTA}}" data-metadata = "{{replyMetadata}}" data-languageCode = "{{updateLanguage}}" data-url={{href}} type="button" data-target={{target}} data-reply="{{dataReply}}">{{name}}</button>\n                    {{/buttons}}  \n             </div>\n         </div>\n     </div>\n     </div>'},getDialogboxTemplate:function(){return'<div class="km-message km-received km-faq-answer">\n     <div class="km-faq-answer--container">\n         <div class="km-faq-answer--body">\n             <div class="km-faq-answer--body_container">\n                 <p class="km-faq-answer--body_que">{{title}}</p>\n                 <p class="km-faq-answer--body_ans"> {{{description}}} </p>\n             </div>\n         </div>\n         <div class="km-faq-answer--footer">\n             <div class="km-faq-answer--footer_button-text-container">\n                 <p>{{buttonLabel}}</p>\n                 {{#buttons}}\n                 <button aria-label="{{name}}" class="km-faq-dialog-button km-quick-replies km-add-more-rooms" data-reply="{{name}}" data-metadata ="{{replyMetadata}}">{{name}}</button>\n                {{/buttons}}\n             </div>\n         </div>\n     </div>\n </div>'},getImageTemplate:function(){return'<div>\n    {{#payload}}\n    <div class="km-image-template">\n       <img class="km-template-img" src="{{url}}"></img>\n       <div class="km-template-image-caption-wrapper">\n           <p class="km-template-img-caption">{{caption}}</p>\n       </div>\n   </div>\n   {{/payload}}\n   </div>'},getCarouselTemplate:function(){return'<div class="mck-msg-box-rich-text-container km-card-message-container  km-div-slider">\n            {{#payload}}\n            <div class="km-carousel-card-template">\n            <div class="km-carousel-card-header-container">\n            {{#url}}<a href = {{url}} target="_blank"><span class="km-carousel-url-container"></span></a>{{/url}}\n            <div class="km-carousel-card-header {{carouselHeaderClass}}">{{{header}}}</div>\n            <div class="km-carousel-card-content-wrapper {{carouselInfoWrapperClass}}">{{{info}}}</div>\n            </div>\n            <div class="km-carousel-card-footer"><div class="km-cta-multi-button-container">{{{footer}}}</div></div>\n            </div>\n            {{/payload}}\n        </div>'},getButtonListTemplate:function(){return'{{#buttons}}<button aria-label="{{action.payload.title}}" class="km-carousel-card-button {{{class}}}">{{action.payload.title}}</button>{{/buttons}}'},getCardHeaderTemplate:function(){return'<img class="{{headerImageClass}}" src="{{imgSrc}}"></img>\n            <div class="{{headerOverlayTextClass}}">{{overlayText}}</div>'},getCardInfoTemplate:function(){return'<div class="km-carousel-card-title-wrapper">\n                <div class="km-carousel-card-title">{{title}}</div>\n                <div class="km-carousel-card-title-extension">{{titleExt}}</div>\n            </div>\n            <div class="km-carousel-card-sub-title">{{subtitle}}</div>\n            <div class="{{cardDescriptionClass}}"><div class="km-carousel-card-description">{{description}}</div></div>'},getFormTemplate:function(){return'<div class="mck-msg-box-rich-text-container mck-form-template-container">\n                <form class="km-btn-hidden-form mck-actionable-form" action="{{actionUrl}}" method="post">\n                    <div class="mck-form-template-wrapper">\n                        {{#payload}}\n                            {{#.}}\n                                {{#supported}}\n                                    {{#radio}}\n                                        <p class="mck-radio-group-title">{{title}}</p>\n                                        <div class="mck-form-radio-wrapper">\n                                            {{#options}}\n                                                <div>\n                                                    <input type="{{type}}" name="{{name}}" value="{{value}}">\n                                                    <label for="{{label}}" class="mck-form-label"><b>{{label}}</b></label>   \n                                                </div>                                     \n                                            {{/options}}\n                                        </div>\n                                    {{/radio}}\n                                    {{#checkbox}}\n                                        <p class="mck-radio-group-title">{{title}}</p>\n                                        <div class="mck-form-radio-wrapper">\n                                            {{#options}}\n                                                <div>\n                                                    <input type="{{type}}" name="{{name}}" value="{{value}}">\n                                                    <label for="{{label}}" class="mck-form-label"><b>{{label}}</b></label>   \n                                                </div>                                     \n                                            {{/options}}\n                                        </div>\n                                    {{/checkbox}}\n                                    {{#text}}\n                                        <div class="mck-form-text-wrapper">\n                                            <label for="{{label}}" class="mck-form-label"><b>{{label}}</b></label>\n                                            <input type="{{type}}" placeholder="{{placeholder}}" name="{{label}}" data-regex="{{validation.regex}}" data-error-text="{{validation.errorText}}">\n                                            {{#validation}}\n                                                <span class="mck-form-error-text mck-form-error-{{className}}"></span>\n                                            {{/validation}}\n                                        </div>\n                                    {{/text}}\n                                    {{#textarea}}\n                                         <div class="mck-form-textarea-wrapper">\n                                            <label class="mck-form-label" for="{{name}}">{{title}}</label>\n                                            <textarea name="{{name}}" rows="{{rows}}" cols="{{cols}}" placeholder="{{placeholder}}" data-regex= "{{validation.regex}}" data-error-text="{{validation.errorText}}"></textarea>\n                                            {{#validation}}\n                                                <span class="mck-form-error-text mck-form-error-{{className}}"></span>\n                                            {{/validation}}\n                                        </div>\n                                    {{/textarea}}\n                                    {{#dropdown}}\n                                        <div class="mck-form-dropdown-wrapper">\n                                            <label for="{{name}}" class="mck-form-label">{{title}}</label><br>\n                                            <select name="{{name}}" data-error-text = "{{validation.errorText}}">\n                                                {{#options}}\n                                                    {{#selected}}{{#disabled}}\n                                                        <option value="{{value}}" selected disabled hidden>{{label}}</option>\n                                                    {{/disabled}}{{/selected}}\n                                                    {{#selected}}{{^disabled}}\n                                                        <option value="{{value}}" selected>{{label}}</option>\n                                                    {{/disabled}}{{/selected}}\n                                                    {{^selected}}\n                                                        <option value="{{value}}">{{label}}</option>\n                                                    {{/selected}}\n                                                {{/options}}    \n                                            </select>\n                                            {{#validation}}\n                                                <span class="mck-form-error-text mck-form-error-{{className}}"></span>\n                                            {{/validation}}\n                                        </div>\n                                    {{/dropdown}}\n                                    {{#hidden}}\n                                            <input type="{{type}}" name="{{name}}" value="{{value}}" >\n                                    {{/hidden}}\n                                {{/supported}}\n                                {{^supported}}\n                                    <div class="mck-form-text-wrapper">\n                                        <label for="{{label}}" class="mck-form-label"><b>{{label}}</b></label>\n                                        <input type="{{type}}" placeholder="{{placeholder}}" name="{{label}}" >\n                                    </div>\n                                {{/supported}}\n                            {{/.}}\n                        {{/payload}}\n                    </div>\n                        {{#buttons}}\n                            <button type="{{type}}" class="km-cta-button km-custom-widget-text-color km-custom-widget-border-color mck-form-submit-button" data-requesttype="{{requestType}}" title="{{message}}" data-post-back-to-kommunicate="{{postBackToKommunicate}}" data-post-back-as-message="{{postFormDataAsMessage}}">{{label}}</button>      \n                        {{/buttons}}   \n                </form>   \n            </div>'},getVideoTemplate:function(){return'<div class= "mck-rich-video-container">\n    {{#payload}}\n        {{#source}}\n            <iframe width="{{width||100%}}" height="{{height||250px}}" src="{{url}}" url="{{url}}" class= "mck-rich-video-iframe"></iframe>\n        {{/source}}\n        {{^source}}\n        <video width="{{width||100%}}" height="{{height||250px}}" controls class= "mck-rich-video">\n             <source src="{{url}}" type="{{type||\'\'}}">\n         </video>\n        {{/source}}\n        {{#caption}}\n        <div class="km-template-video-caption-wrapper" style="width:{{width||100%}};">\n           <p class="km-template-video-caption">{{caption}}</p>\n        </div>\n        {{/caption}}\n    {{/payload}}\n    </div>'},getFormDataMessageTemplate:function(f){var T="";return Object.keys(f).forEach((function(L){var K=f[L];K&&(T+="<span>"+L+" : "+K+"</span><br>")})),T}},Kommunicate.markup.buttonContainerTemplate=function(f){var T='<div class="km-cta-multi-button-container">',L=JSON.parse(f.payload),K=f.formData||"",U="km-add-more-rooms ";U+=1==L.length?"km-cta-button-1 km-custom-widget-border-color":2==L.length?"km-cta-button-2 km-custom-widget-border-color":"km-cta-button-many km-custom-widget-border-color";for(var P=f.requestType,G=0;G<L.length;G++)L[G].replyMetadata="object"==typeof L[G].replyMetadata?JSON.stringify(L[G].replyMetadata):L[G].replyMetadata,T+=Kommunicate.markup.getButtonTemplate(L[G],P,U),"link"!=L[G].type&&K&&(K=JSON.parse(K),Object.keys(K).length>0&&(T+=Kommunicate.markup.getFormMarkup(f)));return T+"</div>"},Kommunicate.markup.getFormMarkup=function(f){var T="string"==typeof f.payload?JSON.parse(f.payload):f.payload,L=T&&f.formData?JSON.parse(f.formData||"{}"):T.formData||"",K="";if(L){for(var U in K+="<form method ='post'  target='_blank' class= 'km-btn-hidden-form' action ="+(f.formAction||T.formAction)+">",L)L.hasOwnProperty(U)&&(K+='<input type="hidden" name ="'+U+'" value="'+L[U]+'" />');return K+"</form>"}},Kommunicate.markup.quickRepliesContainerTemplate=function(f,T){var L,K=JSON.parse(f.payload),U=kommunicate._globals.hidePostCTA;switch(T){case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.QUICK_REPLY:L="km-quick-rpy-btn km-custom-widget-border-color ";break;case KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.CARD_CAROUSEL:L="km-carousel-card-button km-carousel-card-quick-rpy-button "}T==KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.QUICK_REPLY&&(L+=1==K.length?"km-cta-button-1":2==K.length?"km-cta-button-2":"km-cta-button-many");for(var P=0;P<K.length;P++)K[P].replyMetadata="object"==typeof K[P].replyMetadata?JSON.stringify(K[P].replyMetadata):K[P].replyMetadata,K[P].buttonClass=L,K[P].hidePostCTA=U;return Mustache.to_html(Kommunicate.markup.getQuickRepliesTemplate(),{payload:K})},Kommunicate.markup.getHotelRoomPaxInfoTemplate=function(f){return'<div class = "km-rich-text-default-container">\n            <div class="km-room-person-selector-container">'+Kommunicate.markup.getSingleRoomPaxInfo(f)+'</div>\n            <hr>\n            <div class="km-add-room-button-container">\n                <button  class="km-add-more-rooms km-btn-add-more-rooms" data-roomcount=1>ADD ROOM</button>\n                <button class=" km-add-more-rooms km-done-button">DONE</button>\n            </div>\n        </div>'},Kommunicate.markup.getHotelCardContainerTemplate=function(f,T){for(var L="",K=0;K<f.length;K++)L+=Kommunicate.markup.getHotelCardTemplate(f[K],T);return'<div class="km-card-message-container  km-div-slider">'+L+"</div>"},Kommunicate.markup.getRoomDetailsContainerTemplate=function(f,T){for(var L=f.HotelRoomsDetails,K="",U=0;U<L.length;U++)K+=Kommunicate.markup.getRoomDetailTemplate(L[U],T);return'<div class="km-card-room-detail-container  km-div-slider">'+K+"</div>"},Kommunicate.markup.getListContainerMarkup=function(f){const T={link:"km-link-button",submit:""};if(f&&f.payload){var L=JSON.parse(f.payload);return L.headerImgSrc&&(L.headerImgSrc='<div class="km-faq-list--header_text-img"><img src= "'+L.headerImgSrc+'"  alt = "image" /></div>'),L.headerText&&(L.headerText='<p class="km-faq-list--header_text">'+L.headerText+"</p>"),L.elements&&L.elements.length?(L.elementClass="vis",L.elements=L.elements.map((function(f){return f.imgSrc&&(f.imgSrc='<img src ="'+f.imgSrc+'" />'),f.description&&(f.description=kommunicateCommons.removeHtmlTag(f.description)),f.action&&f.action.replyMetadata&&(f.replyMetadata="object"==typeof f.action.replyMetadata?JSON.stringify(f.action.replyMetadata):f.action.replyMetadata),f.action&&"link"==f.action.type?(f.href=f.action.url,0==f.action.openLinkInNewTab?f.target='target="_parent"':f.target='target="_blank"',f.hidePostCTA=!1):(f.href="javascript:void(0)",f.target="",f.action&&(f.updateLanguage=f.action.updateLanguage),f.hidePostCTA=kommunicate._globals.hidePostCTA),f.handlerClass="km-list-item-handler",f.action&&(f.dataType=f.action.type||"",f.dataReply=f.action.text||f.title||""),f.dataArticleId=f.articleId||"",f.dataSource=f.source||"",f}))):L.elementClass="n-vis",L.buttons&&L.buttons.length&&(L.buttons=L.buttons.map((function(f){return f.target=Kommunicate.markup.getLinkTarget(f.action),f.buttonClass=T[f.action.type],f.action&&f.action.replyMetadata&&(f.replyMetadata="object"==typeof f.action.replyMetadata?JSON.stringify(f.action.replyMetadata):f.action.replyMetadata),f.action&&(f.updateLanguage=f.action.updateLanguage),f.action&&"quick_reply"!=f.action.type&&"submit"!=f.action.type?f.href=encodeURI(f.action.url):(f.href="javascript:void(0)",f.handlerClass="km-list-button-item-handler"),"quick_reply"==f.action.type?f.hidePostCTA=kommunicate._globals.hidePostCTA:f.hidePostCTA=!1,f.dataType=f.action?f.action.type:"",f.dataReply=f.action&&f.action.text?f.action.text:f.name||"",f}))),Mustache.to_html(Kommunicate.markup.getListMarkup(),L)}return""},Kommunicate.markup.getDialogboxContainer=function(f){if(f&&f.payload){var T=JSON.parse(f.payload);return T.buttons.length>0&&T.buttons.forEach((function(f){f.replyMetadata="object"==typeof f.replyMetadata?JSON.stringify(f.replyMetadata):f.replyMetadata})),Mustache.to_html(Kommunicate.markup.getDialogboxTemplate(),T)}return""},Kommunicate.markup.getImageContainer=function(f){if(f&&f.payload){var T="string"==typeof f.payload?JSON.parse(f.payload):{};return f.payload=T,Mustache.to_html(Kommunicate.markup.getImageTemplate(),f)}return""},Kommunicate.markup.getHtmlMessageMarkups=function(f){return f&&f.source==KommunicateConstants.MESSAGE_SOURCE.MAIL_INTERCEPTOR?"<iframe class='km-mail-fixed-view' id=km-iframe-"+f.groupId+" ></iframe>":""},Kommunicate.markup.getActionableFormMarkup=function(f){var T={},L=!1;if(f&&f.payload){var K="string"==typeof f.payload?JSON.parse(f.payload):{};return f.payload=K,f.buttons=[],kommunicateCommons.isObject(f.payload[0].data)&&(f.payload=f.payload.map((function(f){for(var L in(T={}).type=f.type,f.data)f.data.hasOwnProperty(L)&&(T[L]=f.data[L]);return T}))),f.payload.forEach((function(T,K){if("submit"==T.type)L=kommunicateCommons.isObject(T.action),f.actionUrl=T.formAction||L&&T.action.formAction||"javascript:void(0);",f.requestType=T.requestType||L&&T.action.requestType,f.postBackToKommunicate=L&&T.action.postBackToKommunicate||!1,f.postFormDataAsMessage=L&&T.action.postFormDataAsMessage||!1,f.label=T.name||T.label,f.message=T.message||L&&T.action.message,f.payload[K].className="km-cta-button",f.buttons.push(T),f.payload.splice(K,1);else{f.payload[K].supported=-1!=KommunicateConstants.FORM_SUPPORTED_FIELDS.indexOf(T.type),f.payload[K][T.type]=!0;try{f.payload[K].className=(T.label||T.name).toLowerCase().replace(/ +/g,"")}catch(f){}}})),Mustache.to_html(Kommunicate.markup.getFormTemplate(),f)}},Kommunicate.markup.getCarouselMarkup=function(f){var T,L,K,U,P=[],G={},r=function(f){for(var T,L="",K=0;K<f.length;K++)if("quickReply"==f[K].action.type)f[K].action.payload.title=f[K].action.payload.title||f[K].name,f[K].action.payload=JSON.stringify([f[K].action.payload]),L=L.concat(Kommunicate.markup.quickRepliesContainerTemplate(f[K].action,KommunicateConstants.ACTIONABLE_MESSAGE_TEMPLATE.CARD_CAROUSEL));else if("link"==f[K].action.type||"submit"==f[K].action.type){"link"==f[K].action.type&&(f[K].action.payload.openLinkInNewTab=void 0===f[K].action.openLinkInNewTab||f[K].action.openLinkInNewTab),T=f[K].action.payload.requestType?f[K].action.payload.requestType:"",f[K].action.payload.type=f[K].action.type,f[K].action.payload.buttonClass="km-carousel-card-button",f[K].action.payload.name=f[K].name,L=L.concat(Kommunicate.markup.getButtonTemplate(f[K].action.payload,T,"km-carousel-card-button"));var U=f[K].action.payload.formData;f[K].action.payload.formAction&&(f[K].action.formAction=f[K].action.payload.formAction),f[K].action.payload=JSON.stringify([f[K].action.payload]),U&&(f[K].action.formData=JSON.stringify(U)),U&&(L=L.concat(Kommunicate.markup.getFormMarkup(f[K].action)))}return L};if(f&&f.payload){var B="string"==typeof f.payload?JSON.parse(f.payload):[];f.payload=B;for(var z=0;z<B.length;z++){var H=B[z];H.header&&(T=H.header.overlayText?H.header.imgSrc?"km-carousel-card-overlay-text ":"km-carousel-card-overlay-text  km-carousel-card-overlay-text-without-img":"n-vis"),K=H.header?H.header.imgSrc?"km-carousel-card-header-with-img":"km-carousel-card-header-without-img":"n-vis",U=H.header?"":"km-carousel-card-info-wrapper-without-header",U=H.buttons?U.concat(" km-carousel-card-info-wrapper-with-buttons"):"",H.header&&(L=H.header.imgSrc?"km-carousel-card-img":"n-vis"),H.header&&(H.header.headerOverlayTextClass=T),H.header&&(H.header.headerImageClass=L),H.cardDescriptionClass=H.description?"km-carousel-card-description-wrapper":"n-vis",G.carouselHeaderClass=K,G.carouselInfoWrapperClass=U,H.header&&(G.header=Kommunicate.markup.cardHeader(H.header)),G.info=Kommunicate.markup.cardInfo(H),H.buttons&&(G.footer=r(H.buttons)),P[z]=$applozic.extend([],G),P[z].url=H.url}}var q={payload:P};return Mustache.to_html(Kommunicate.markup.getCarouselTemplate(),q)},Kommunicate.markup.cardHeader=function(f){return Mustache.to_html(Kommunicate.markup.getCardHeaderTemplate(),f)},Kommunicate.markup.cardInfo=function(f){return Mustache.to_html(Kommunicate.markup.getCardInfoTemplate(),f)},Kommunicate.markup.getLinkTarget=function(f){return f.openLinkInNewTab=!(void 0!==f.openLinkInNewTab&&!f.openLinkInNewTab)||f.openLinkInNewTab,f.openLinkInNewTab?"_blank":"_parent"},Kommunicate.markup.getGenericButtonMarkup=function(f){for(var T=f.payload?JSON.parse(f.payload):[],L='<div class="km-cta-multi-button-container">',K=" km-custom-widget-border-color "+(1==T.length?"km-cta-button-1":2==T.length?"km-cta-button-2":"km-cta-button-many"),U=0;U<T.length;U++){var P=T[U];P.replyMetadata,P.replyMetadata=JSON.stringify(P.replyMetadata),!P.type&&P.action&&(P.type=P.action.type),!P.replyMetadata&&P.action&&P.action.replyMetadata&&kommunicateCommons.isObject(P.action.replyMetadata)&&(P.replyMetadata=JSON.stringify(P.action.replyMetadata)),P.hidePostCTA=!1,"link"==P.type||"submit"==P.type?(P.url=T[U].action.url||T[U].action.formAction,P.openLinkInNewTab=T[U].action.openLinkInNewTab,K+=K+" km-add-more-rooms",L+=Kommunicate.markup.getButtonTemplate(P,P.action.requestType,K),"submit"==P.type&&(L+=Kommunicate.markup.getFormMarkup({payload:P.action}))):"quickReply"==P.type||"suggestedReply"==P.type?(P.buttonClass="km-quick-rpy-btn "+K,P.message=P.action.message||P.name,"quickReply"==P.type&&(P.hidePostCTA=kommunicate._globals.hidePostCTA),L+=Mustache.to_html(Kommunicate.markup.getGenericSuggestedReplyButton(),P)):P.action&&P.action.type}return L+"</div>"},Kommunicate.markup.getVideoMarkup=function(f){if(f&&f.payload){for(var T="string"==typeof f.payload?JSON.parse(f.payload):{},L=0;L<T.length;L++){var K=T[L];K.width=K.width||"100%",K.height=K.height||"250px"}return f.payload=T,Mustache.to_html(Kommunicate.markup.getVideoTemplate(),f)}},Kommunicate.messageTemplate={getAttachmentTemplate:function(){return'<div class="mck-file-text mck-attachment {{attachmentClass}} notranslate mck-attachment-{{key}}" data-groupId="{{groupId}}" data-filemetakey="{{fileMetaKey}}" data-stopupload="{{fileMeta.stopUpload}}" data-filename="{{fileMeta.name}}" data-thumbnailUrl="{{fileMeta.thumbnailUrl}}"  data-filetype="{{fileMeta.contentType}}" data-fileurl="{{fileUrl}" data-filesize="{{fileMeta.size}}+" data-msgkey ="{{key}}"><div>{{{fileExpr}}}</div><div class="{{attachmentDownloadClass}}">{{{downloadMediaUrlExpr}}}</div></div>'},getAttachmentApplicationTemplate:function(f){return'<div class="km-attachment-wrapper mck-attachment {{attachmentClass}} notranslate mck-attachment-{{key}}" data-groupId="{{groupId}}" data-filemetakey="{{fileMetaKey}}" data-filename="{{fileMeta.name}}" data-thumbnailUrl="{{fileMeta.thumbnailUrl}}"  data-filetype="{{fileMeta.contentType}}" data-fileurl="{{fileUrl}" data-filesize="{{fileMeta.size}}+" data-msgkey ="{{key}}"><div class="mck-msg-box vis km-custom-widget-background-color" data-groupId="{{groupId}}" data-filemetakey="{{fileMetaKey}}">\n        <svg width="9" height="9" class="km-attachment-icon km-attachment-cancel-icon km-attachment-cancel-icon-{{key}} {{cancelIconClass}}" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.7338 0.275312C11.3788 -0.0796375 10.8055 -0.0796375 10.4505 0.275312L6 4.71672L1.54949 0.266213C1.19454 -0.0887375 0.621163 -0.0887375 0.266213 0.266213C-0.0887375 0.621163 -0.0887375 1.19454 0.266213 1.54949L4.71672 6L0.266213 10.4505C-0.0887375 10.8055 -0.0887375 11.3788 0.266213 11.7338C0.621163 12.0887 1.19454 12.0887 1.54949 11.7338L6 7.28328L10.4505 11.7338C10.8055 12.0887 11.3788 12.0887 11.7338 11.7338C12.0887 11.3788 12.0887 10.8055 11.7338 10.4505L7.28328 6L11.7338 1.54949C12.0796 1.20364 12.0796 0.621162 11.7338 0.275312Z" fill="white"/></svg>\n        <svg width="16" height="16" class="km-attachment-icon km-attachment-upload-icon km-attachment-upload-icon-{{key}} {{uploadIconClass}}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.55556 0 0 3.55556 0 8C0 12.4444 3.55556 16 8 16C12.4444 16 16 12.4444 16 8C16 3.55556 12.4444 0 8 0ZM5.88889 5.44444L7.88889 3.22222C7.88889 3.11111 8 3.11111 8.11111 3.11111C8.22222 3.11111 8.22222 3.11111 8.33333 3.22222L10.3333 5.44444C10.4444 5.55556 10.4444 5.66667 10.3333 5.77778C10.3333 5.88889 10.2222 5.88889 10.1111 5.88889H8.88889V9.44444C8.88889 9.55556 8.77778 9.66667 8.66667 9.66667H7.55556C7.44445 9.66667 7.33333 9.55556 7.33333 9.44444V5.88889H6.22222C6.11111 5.88889 6 5.77778 6 5.77778C5.77778 5.66667 5.77778 5.55556 5.88889 5.44444ZM12.2222 11.4444C12.2222 11.7778 12 12 11.6667 12H4.44444C4.11111 12 3.88889 11.7778 3.88889 11.4444V9.22222H5V10.8889H11.1111V9.22222H12.2222V11.4444Z" fill="white"/></svg><a class="km-attachment-preview-href-{{key}}" href="{{fileMeta.url}}" target="_self" download><svg width="16" height="16" class="km-attachment-download-icon-{{key}} km-attachment-download-icon {{downloadIconClass}}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM11.6 12H5V11.1H11.6V12ZM8.3 10.1L5 6.8H6.9V4H9.7V6.8H11.6L8.3 10.1Z" fill="white"></path></svg>\n        <span class="km-attachment-file-name">{{fileMeta.name}}<span/>{{fileMeta.previewSize}}</a></div><div class="km-attachment-progress-bar-wrapper km-attachment-progress-bar-wrapper-{{key}} {{progressBarClass}}"><div class="km-attachment-progress-bar-success km-attachment-progress-bar-success-{{key}} vis"></div></div></div>'},getProgressMeter:function(f){return'<div class="km-progress-meter-container km-progress-meter-back-drop progress-meter-{{key}}"><svg class="km-progress-svg" xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 107 105"><g class="km-progress-icons"><circle class="km-progress-meter" cx="54" cy="54" r="45" stroke-width="10" /><circle class="km-progress-value" cx="54" cy="54" r="45" stroke-width="5" /><path class="km-progress-stop-upload-icon km-progress-stop-upload-icon-{{key}} vis" d="M51.5,47.9L32.3,28.7c-1.3-1.3-2.3-1.3-3.6,0c-1.3,1.3-0.3,3.3,1,4.6c0,0,0,0,0,0l19.1,19.1   c0.8,0.8,0.8,2.2,0,3.1L29.7,74.7c-1.3,1.3-2.4,3.4-1,4.6c1.8,1.5,2.7,0.6,3.6,0c0,0,1-1,1-1l19.1-19.1c0.8-0.8,2.6-1,3.4-0.1   l19.8,20.3c1.3,1.3,2.3,1.3,3.6,0c1.3-1.3,0.3-3.3-1-4.6L59.1,55.5c-0.8-0.8-0.8-2.2,0-3.1l19.1-19.1c1.3-1.3,2.3-3.3,1-4.6   c-1.3-1.3-3.3-0.3-4.6,1L56.4,48C55.5,48.9,52.3,48.7,51.5,47.9L51.5,47.9z" fill="#FFF" data-name="Path 1"/><path class="km-progress-upload-icon km-progress-upload-icon-{{key}} n-vis" d="M52.246 21.547L30.00689 43.78339a3.2 3.2 0 0 0-.03927 4.4858l.03047.03155a3.2 3.2 0 0 0 4.56449.03994L51.286 31.619v53.712a3.2 3.2 0 0 0 3.2 3.2 3.2 3.2 0 0 0 3.2-3.2V31.619l16.72045 16.72131a3.2 3.2 0 0 0 4.56467-.03976l.03029-.03136a3.2 3.2 0 0 0-.03927-4.4858L56.723 21.547l-.06168-.05724a3.2 3.2 0 0 0-4.3542.00048z" fill="#FFF"/></g></svg></div>'},getAttachmentContanier:function(f,T,L,K){switch(f.fileExpr=T,f.fileUrl=K,f.fileMeta=f.fileMeta||{},f.fileMeta.contentType=f.fileMeta.contentType||"",f.attachmentDownloadClass="n-vis",f.attachmentClass=1!=f.fileMeta.contentType.indexOf("image/")||-1!=f.fileMeta.contentType.indexOf("audio/")||1!=f.fileMeta.contentType.indexOf("video/")?"":"mck-msg-box",!0){case-1!=f.fileMeta.contentType.indexOf("image"):return f.attachmentDownloadClass="vis",Mustache.to_html(Kommunicate.messageTemplate.getAttachmentTemplate(),f);case-1!=f.fileMeta.contentType.indexOf("application"):case-1!=f.fileMeta.contentType.indexOf("text"):case""==f.fileMeta.contentType&&f.contentType!=KommunicateConstants.MESSAGE_CONTENT_TYPE.LOCATION:return f.attachmentClass="km-application-attachment-wrapper",Kommunicate.internetStatus?4==f.type?(f.uploadIconClass="n-vis",f.downloadIconClass="vis",f.cancelIconClass="n-vis",f.progressBarClass="n-vis",f.attachmentClass=""):(f.uploadIconClass="n-vis",f.downloadIconClass=f.sent||f.delivered?"vis":"n-vis",f.cancelIconClass=f.sent||f.delivered?"n-vis":"vis",f.progressBarClass=f.sent||f.delivered?"n-vis":"vis"):(f.uploadIconClass="vis",f.downloadIconClass="n-vis",f.cancelIconClass="n-vis"),f.fileMeta.url=f.fileMeta&&f.fileMeta.url||f.fileUrl||"javascript:void(0)",Mustache.to_html(Kommunicate.messageTemplate.getAttachmentApplicationTemplate(f),f);default:return f.attachmentDownloadClass="vis",f.downloadMediaUrlExpr=L,Mustache.to_html(Kommunicate.messageTemplate.getAttachmentTemplate(),f)}},getProgressMeterContanier:function(f){var T={key:f};return Mustache.to_html(Kommunicate.messageTemplate.getProgressMeter(),T)}},Kommunicate.popupChatTemplate={getPopupChatTemplate:function(f,T,L){var K=kommunicateCommons.isObject(T)&&T.popup,U="",P=f&&f.length&&f[0].message;if(K){var G=L?"km-anonymous-chat-launcher":"applozic-launcher";U='<div id="chat-popup-widget-container" class="chat-popup-widget-container '+((f&&f.length&&f[0].templateKey||KommunicateConstants.CHAT_POPUP_TEMPLATE.HORIZONTAL)===KommunicateConstants.CHAT_POPUP_TEMPLATE.HORIZONTAL?"chat-popup-widget-container--horizontal":"chat-popup-widget-container--vertical")+' n-vis"><div class="chat-popup-widget-text-wrapper '+G+'"><p class="chat-popup-widget-text">'+(P&&kommunicateCommons.formatHtmlTag(P))+'</p></div><div class="chat-popup-widget-close-btn-container"><div class="chat-popup-widget-close-btn"><span class="chat-popup-widget-close-icon-svg"><svg viewBox="0 0 64 64" width="8" xmlns="http://www.w3.org/2000/svg" height="8"><path fill="#fff" d="M28.941 31.786L.613 60.114a2.014 2.014 0 1 0 2.848 2.849l28.541-28.541 28.541 28.541c.394.394.909.59 1.424.59a2.014 2.014 0 0 0 1.424-3.439L35.064 31.786 63.41 3.438A2.014 2.014 0 1 0 60.562.589L32.003 29.15 3.441.59A2.015 2.015 0 0 0 .593 3.439l28.348 28.347z"></path></svg></span></div></div></div>'}if(!L)return U;document.getElementById("km-anonymous-chat-launcher").insertAdjacentHTML("afterEnd",U)}},Kommunicate.initilizeEventListners=function(){w.addEventListener("online",(function(){Kommunicate.internetStatus=!0})),w.addEventListener("offline",(function(){Kommunicate.internetStatus=!1}))};var kmWidgetEvents={sendEventToGoogleAnalytics:function(f,T,L,K){var U=applozic._globals.gaTrackingID||applozic._globals.appSettings.chatWidget.isGAEnabled&&applozic._globals.appSettings.chatWidget.gaTrackingId;U&&void 0!==window.top.ga&&(window.top.ga("create",U.toString(),"auto"),window.top.ga("send",{hitType:"event",eventCategory:f,eventAction:T,eventLabel:L,eventValue:K}))},eventTracking:function(f,T,L){if(kommunicateCommons.isObject(f)&&(T&&(f.data.eventLabel=T),L&&(f.data.eventValue=L),(applozic._globals.gaTrackingID||applozic._globals.appSettings.chatWidget.isGAEnabled&&applozic._globals.appSettings.chatWidget.gaTrackingId)&&kmWidgetEvents.sendEventToGoogleAnalytics(f.data.eventCateogry,f.data.eventAction,f.data.eventLabel,f.data.eventValue),null!==f.eventFunction))try{f.eventFunction(f.data)}catch(f){}}},eventMapping={onChatWidgetOpen:{data:{eventCateogry:"Kommunicate",eventAction:"Open",eventLabel:"Chat Widget Open"},eventFunction:null},onChatWidgetClose:{data:{eventCateogry:"Kommunicate",eventAction:"Close",eventLabel:"Chat Widget Close"},eventFunction:null},onRichMessageButtonClick:{data:{eventCateogry:"Kommunicate",eventAction:"Rich Message Click"},eventFunction:null},onFaqClick:{data:{eventCateogry:"Kommunicate",eventAction:"Click",eventLabel:"FAQ Menu"},eventFunction:null},onRateConversationClick:{data:{eventCateogry:"Kommunicate",eventAction:"Started",eventLabel:"CSAT Start"},eventFunction:null},onSubmitRatingClick:{data:{eventCateogry:"Kommunicate",eventAction:"Submit",eventLabel:"CSAT Submit"},eventFunction:null},onShowResolvedClick:{data:{eventCateogry:"Kommunicate",eventAction:"Click",eventLabel:"Show Resolve"},eventFunction:null},onStartNewConversation:{data:{eventCateogry:"Kommunicate",eventAction:"Start New",eventLabel:"Conversation Start"},eventFunction:null},onGreetingMessageNotificationClick:{data:{eventCateogry:"Kommunicate",eventAction:"Click",eventLabel:"Greeting"},eventFunction:null},onRestartConversationClick:{data:{eventCateogry:"Kommunicate",eventAction:"Restart",eventLabel:"Conversation Restart"},eventFunction:null},onRateConversationEmoticonsClick:{data:{eventCateogry:"Kommunicate",eventAction:"Rate"},eventFunction:null},onLocationIconClick:{data:{eventCateogry:"Kommunicate",eventAction:"Click",eventLabel:"Location"},eventFunction:null},onAttachmentClick:{data:{eventCateogry:"Kommunicate",eventAction:"Click",eventLabel:"Attachment"},eventFunction:null},onCameraButtonClick:{data:{eventCateogry:"Kommunicate",eventAction:"Click",eventLabel:"Camera Button Click"},eventFunction:null},onNotificationClick:{data:{eventCateogry:"Kommunicate",eventAction:"Click",eventLabel:"Notification"},eventFunction:null},onVoiceIconClick:{data:{eventCateogry:"Kommunicate",eventAction:"Click",eventLabel:"VoiceInput"},eventFunction:null},onMessageSent:{data:{eventCateogry:"Kommunicate",eventAction:"Sent",eventLabel:"Message"},eventFunction:null}};Kommunicate.attachmentService={getFileMeta:function(f,T,L){var K={groupId:T,contentType:1,type:5,message:""},U=new FileReader;U.onload=function(f){return function(T){document.createElement("span").innerHTML=['<img class="thumb" src="',T.target.result,'" title="',escape(f.name),'"/>'].join("")}},U.onloadend=function(){FILE_META=[],FILE_META.push({thumbnailUrl:U.result,contentType:f.type,isUploaded:!1,contentType:f.type,stopUpload:!1,name:f.name}),"function"!=typeof L||L(FILE_META,K,f)},U.readAsDataURL(f)},uploadAttachment:function(f,T,L){data={params:f,messagePxy:T},$applozic.fn.applozic("uploadAttachemnt",data)}};var MCK_TRIGGER_MSG_NOTIFICATION_PARAM,MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE,MCK_CHAT_POPUP_TEMPLATE_TIMER,MCK_GROUP_MAP=[],MCK_CLIENT_GROUP_MAP=[],MCK_EVENT_HISTORY=[],KM_PROGRESS_METER_RADIUS=54,KM_PROGRESS_METER_CIRCUMFERENCE=2*Math.PI*KM_PROGRESS_METER_RADIUS,count=0,isFirstLaunch=!0,KM_PENDING_ATTACHMENT_FILE=new Map,CURRENT_GROUP_DATA={},IS_SOCKET_CONNECTED=!1,MCK_BOT_MESSAGE_QUEUE=[],WAITING_QUEUE=[],AVAILABLE_VOICES_FOR_TTS=new Array,KM_ATTACHMENT_V2_SUPPORTED_MIME_TYPES=["application","text","image"],userOverride={voiceOutput:!0};!function(f,T,L){"use strict";T.applozic||(T.applozic=T.applozic?T.applozic:{},f.extend(!0,T.applozic,{applozic:{PRODUCT_ID:"applozic-chat"}}));var K={baseUrl:KM_PLUGIN_SETTINGS.applozicBaseUrl||"https://chat.kommunicate.io",fileBaseUrl:"https://applozic.appspot.com",customFileUrl:"https://googleupload.applozic.com",genereateCloudFileUrl:"https://googleupload.applozic.com/files/url?key={key}",notificationIconLink:"",notificationSoundLink:"",mapStaticAPIkey:"AIzaSyCWRScTDtbt8tlXDr6hiceCsU83aS2UuZw",launcher:"applozic-launcher",emojilibrary:!1,userId:null,appId:null,userName:null,contactNumber:null,email:null,supportId:null,mode:"standard",visitor:!1,olStatus:!1,unreadCountOnchatLauncher:!0,openConversationOnNewMessage:!1,groupUserCount:!1,desktopNotification:!0,locShare:!1,maxAttachmentSize:25,notification:!0,launchOnUnreadMessage:!1,loadOwnContacts:!1,maxGroupSize:100,authenticationTypeId:0,groupName:"Conversations",agentId:"",agentName:"",msgTriggerTimeout:0,labels:Kommunicate.defaultLabels,useBranding:!0,openGroupSettings:{deleteChatAccess:0,allowInfoAccessGroupMembers:!0,disableChatForNonGroupMember:!1,defaultChatDisabledMessage:"Chat Disabled!"},voiceInput:!1,voiceOutput:!1,capturePhoto:!1,captureVideo:!1},U={messageType:5,type:0};function i(P){var G,B=this,z=!1,H={},q=!1,V=!0;MCK_GROUP_MAP=[];var W,J=[],ee=!0,te=[];MCK_CLIENT_GROUP_MAP=[];var ae=!1,ne=[],oe=[],ie=90,se=[],re=[],ce=[],le=[],de=!0,me=0,ue=(P.customerCreatedAt,P.openConversationOnNewMessage),pe=P.KM_VER?P.KM_VER:"";"v2"===pe&&(parent.KommunicateGlobal=window),"v2"===pe&&(parent.Kommunicate=window.Kommunicate);var ge=P.widgetSettings,ve=P.emojilibrary,fe=P.collectFeedback,he=P.hidePostCTA,ke=P.mode;MCK_LABELS=P.labels,MCK_BASE_URL=P.baseUrl;var ye=P.customFileUrl,Ce=P.customUploadUrl,be=P.appId,_e=[],Ee=[0,1,2,3],Ie=[1,2,5,6,10],Te=[],Ae=!1,Se=P.launcher,Me=P.visitor,we=P.userName,Le=P.locShare,xe=P.capturePhoto,Oe=P.captureVideo,Ne=(P.video,P.fileBaseUrl),Ke=P.onInit,Ue=P.onTopicDetails,Re=[0,1,2],De=P.onClose,Pe=P.displayText,Ge=P.password||P.accessToken,Be=P.readConversation,Fe=P.maxGroupSize,ze=P.onTabClicked,He=P.contactNumber,$e=P.maxAttachmentSize,qe=P.appModuleName,je=P.getTopicDetail,Ve=P.contactDisplayName,We=P.validateMessage,Ye=P.finalPriceResponse,Je=P.contactDisplayImage,Qe=P.priceWidget,Xe=P.openGroupSettings,Ze=P.offlineMessageDetail,ot=(P.initAutoSuggestions,P.authenticationTypeId),lt=P.getConversationDetail,ut=P.notificationIconLink,gt=P.mapStaticAPIkey,vt=P.unreadCountOnchatLauncher,ft=P.chatLauncherHtml,ht=P.fileUpload,Ct=ge&&"number"==typeof ge.notificationVolume?ge.notificationVolume:1,_t=ge&&ge.notificationTone?KommunicateConstants.NOTIFICATION_RINGTONES[ge.notificationTone]:KommunicateConstants.NOTIFICATION_RINGTONES.subtle,Et=P.chatPopupSoundNotificationLink?P.chatPopupSoundNotificationLink:KommunicateConstants.KM_CHAT_POPUP_NOTIFICATION_URL,Tt=Me?"guest":f.trim(P.userId),St=Le?P.googleApiKey:"NO_ACCESS",wt=void 0===P.source?1:P.source,xt="boolean"==typeof P.topicBox&&P.topicBox,Ot="boolean"==typeof P.olStatus&&P.olStatus,Nt="boolean"!=typeof P.messageBubbleAvator||P.messageBubbleAvator,Kt="boolean"==typeof P.showOfflineMessage&&P.showOfflineMessage,Dt="boolean"==typeof P.hideGroupSubtitle&&P.hideGroupSubtitle,Gt=void 0===P.defaultMessageMetaData?{}:P.defaultMessageMetaData,Bt="boolean"==typeof P.groupUserCount&&P.groupUserCount,zt="boolean"==typeof P.checkUserBusyWithStatus&&P.checkUserBusyWithStatus,Wt="boolean"==typeof P.resetUserStatus&&P.resetUserStatus,Yt="boolean"==typeof P.topicHeader&&P.topicHeader,Jt=(P.supportId&&P.supportId,"boolean"==typeof P.loadOwnContacts&&P.loadOwnContacts),Qt="boolean"!=typeof P.desktopNotification||P.desktopNotification,Xt="boolean"!=typeof P.notification||P.notification,Zt=("boolean"==typeof P.swNotification&&P.swNotification,"boolean"!=typeof P.autoTypeSearchEnabled||P.autoTypeSearchEnabled),oa="boolean"==typeof P.launchOnNewMessage&&P.launchOnNewMessage,sa="boolean"==typeof P.launchOnUnreadMessage&&P.launchOnUnreadMessage,ra="number"==typeof P.userTypeId&&P.userTypeId,ca=["DEFAULT","NEW","OPEN"],la=["BLOCKED_TO","BLOCKED_BY","UNBLOCKED_TO","UNBLOCKED_BY"],da="number"==typeof P.msgTriggerTimeout?P.msgTriggerTimeout:0;MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE="boolean"==typeof P.automaticChatOpenOnNavigation&&P.automaticChatOpenOnNavigation;var ma,ua,pa="boolean"!=typeof P.attachment||P.attachment,ga=parent.document.title,va=P.chatPopupMessage,fa=new Object,ha=new Array,ka=new Array,ya=new Object,Ca=new Array,ba=new Array,_a=new Array,Ea=new Array,Ia=new function(){var K,U,B=this,z=!1,J=f("#mck-file-menu"),te=f("#mck-message-cell .mck-message-inner"),ae=(f("#mck-tab-individual"),ie);B.getLauncherHtml=function(f){var T=Pa.customSideboxWidget(),L='<div id="km-popup-close-button" aria-label="Close" role="button" class="km-custom-widget-background-color '+("square"==kommunicate._globals.iconShape?"km-square-chat-icon":"")+'"><svg width="64" xmlns="http://www.w3.org/2000/svg" height="64" viewBox="0 0 64 64"><path fill="#fff" d="M28.941 31.786L.613 60.114a2.014 2.014 0 1 0 2.848 2.849l28.541-28.541 28.541 28.541c.394.394.909.59 1.424.59a2.014 2.014 0 0 0 1.424-3.439L35.064 31.786 63.41 3.438A2.014 2.014 0 1 0 60.562.589L32.003 29.15 3.441.59A2.015 2.015 0 0 0 .593 3.439l28.348 28.347z" stroke-width="6" stroke="#fff"/></svg></div>',K='<div id="launcher-svg-container" class="vis" style ="white-space: nowrap;">'+ft+"</div>";return f?'<a href="#" target="_self" aria-label="Open Chat" tabindex="0" role="button">'+L+(ft?K:T)+"</a>":'<div id="mck-sidebox-launcher" class="mck-sidebox-launcher launchershadow n-vis"><a href="#" target="_self" aria-label="Open Chat" role="button" tabindex="0" aria-live="polite" class="applozic-launcher">'+L+(ft?K:T)+'<div id="launcher-agent-img-container" class="n-vis"></div></a><div id="applozic-badge-count" class="applozic-badge-count"></div><div id="mck-msg-preview-visual-indicator" class="mck-msg-preview-visual-indicator-container n-vis"><div class="mck-close-btn-container"><div class="mck-close-btn"><span class="mck-close-icon-svg"><svg viewBox="0 0 64 64" width="8" xmlns="http://www.w3.org/2000/svg" height="8"><path fill="#fff" d="M28.941 31.786L.613 60.114a2.014 2.014 0 1 0 2.848 2.849l28.541-28.541 28.541 28.541c.394.394.909.59 1.424.59a2.014 2.014 0 0 0 1.424-3.439L35.064 31.786 63.41 3.438A2.014 2.014 0 1 0 60.562.589L32.003 29.15 3.441.59A2.015 2.015 0 0 0 .593 3.439l28.348 28.347z"/></svg></span><span class="mck-close-text">Close</span></div></div><div class="mck-msg-preview-visual-indicator-text  applozic-launcher"></div></div></div>'+Kommunicate.popupChatTemplate.getPopupChatTemplate(va,ge)+'<div id="mck-msg-preview" class="mck-msg-preview applozic-launcher"><div class="mck-row"><div class="blk-lg-3 mck-preview-icon"></div><div class="blk-lg-9"><div class="mck-row mck-truncate mck-preview-content"><strong class="mck-preview-cont-name"></strong></div><div class="mck-row mck-preview-content"><div class="mck-preview-msg-content"></div><div class="mck-preview-file-content mck-msg-text notranslate blk-lg-12 mck-attachment n-vis"></div></div></div></div><div id="mck-msg-preview-btns" class="n-vis"><button id="mck-vid-call-accept">Accept</button><button id="mck-vid-call-reject">reject</div></div>'},B.initializeApp=function(T,L){z=L;var K={applicationId:T.appId,userId:Tt};if(null!==we&&(K.displayName=T.userName),null!==T.email&&(K.email=T.email),null!==He&&(K.contactNumber=T.contactNumber),T.imageLink&&(K.imageLink=T.imageLink),T.appModuleName&&(K.appModuleName=T.appModuleName),Ge&&(K.password=Ge),-1===Re.indexOf(ot)&&(ot=0),Wt&&(K.resetUserStatus=!0),"number"==typeof ra&&(K.userTypeId=ra),T.metadata&&(K.metadata=T.metadata),K.enableEncryption=!0,K.appVersionCode=111,K.deviceType=0,K.authenticationTypeId=ot,K.chatNotificationMailSent=!0,G="",window.Applozic.ALApiService.AUTH_TOKEN=null,W="",KommunicateUtils.getCookie(KommunicateConstants.COOKIES.IS_USER_ID_FOR_LEAD_COLLECTION)&&!JSON.parse(KommunicateUtils.getCookie(KommunicateConstants.COOKIES.IS_USER_ID_FOR_LEAD_COLLECTION))&&Va&&0!==Va.length&&(ALStorage.clearMckMessageArray(),ALStorage.clearMckContactNameArray(),ALStorage.clearAppHeaders()),!B.validateAppSession(K))if(Array.isArray(Va)&&0!==Va.length||0!==Ya.length){if(f("#km-userId").val(Tt),KommunicateUtils.getCookie(KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID)&&KommunicateUtils.getCookie(KommunicateConstants.COOKIES.IS_USER_ID_FOR_LEAD_COLLECTION)&&JSON.parse(KommunicateUtils.getCookie(KommunicateConstants.COOKIES.IS_USER_ID_FOR_LEAD_COLLECTION))){var U={userId:KommunicateUtils.getCookie(KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID),applicationId:be,onInit:Na.loadChat,baseUrl:MCK_BASE_URL,locShare:Le,googleApiKey:St,chatNotificationMailSent:!0};return V=!1,Ia.initialize(U),!1}Kommunicate.popupChatTemplate.getPopupChatTemplate(va,ge,!0);var P=document.getElementById("km-anonymous-chat-launcher"),H=document.getElementsByClassName("km-anonymous-chat-launcher"),q=document.getElementById("km-chat-login-modal");"v2"===pe&&(ao===KommunicateConstants.POSITION.LEFT?(P.style.left="10px",parent.document.getElementById("kommunicate-widget-iframe").classList.add("align-left")):P.style.right="10px",P.style.bottom="10px"),f("#km-anonymous-chat-launcher").append(Ia.getLauncherHtml(!0)),B.addLeadCollectionInputDiv(),B.setLeadCollectionLabels(),q.style.visibility="visible",q.style.display="none",P.classList.remove("n-vis"),P.classList.add("vis"),document.getElementById("km-modal-close").addEventListener("click",B.closeLeadCollectionWindow),document.getElementById("km-popup-close-button").addEventListener("click",(function(){event.preventDefault(),event.stopPropagation(),B.closeLeadCollectionWindow()}));for(var J=0;J<H.length;J++)H[J].addEventListener("click",(function(f){if(f.preventDefault(),"v2"===pe){Kommunicate.setDefaultIframeConfigForOpenChat(Za),ao===KommunicateConstants.POSITION.LEFT?P.style.left="10px":P.style.right="10px",P.style.bottom="10px",q.classList.add("km-iframe-sidebox-border-radius");var T=parent.document.getElementById("kommunicate-widget-iframe");!Za&&(T.style.boxShadow="0 1.5rem 2rem rgba(0,0,0,.3)")}q.style.display="block",!Za&&(P.classList.remove("vis"),P.classList.add("n-vis")),Ia.clearMsgTriggerAndChatPopuTimeouts()}));f("#km-form-chat-login .km-form-group input").hasClass("n-vis")&&f("#km-form-chat-login .km-form-group .km-form-control.n-vis").prop("required",null),KommunicateUI.displayPopupChatTemplate(va,ge,qa)}else B.initialize(K)},B.initialize=function(T){window.Applozic.ALApiService.login({data:{alUser:T,baseUrl:MCK_BASE_URL},success:function(L){if("kommunicate"==window.applozic.PRODUCT_ID&&f("#km-chat-login-modal").css("display","none"),ALStorage.clearMckMessageArray(),ALStorage.clearMckContactNameArray(),"INVALID_PASSWORD"===L){var K=document.getElementById("km-chat-login-modal");return K.style.visibility="visible",K.style.display="block",Ia.addPasswordField({id:"km-password",type:"password",name:"km-password",class:"km-form-control km-input-width km-login-error",placeholder:MCK_LABELS["lead.collection"].password.toLowerCase(),required:"true"}),!1}if("INVALID_APPID"===L)throw Kommunicate.displayKommunicateWidget(!1),"function"==typeof Ke&&Ke({status:"error",errorMessage:"INVALID APPLICATION ID"}),new Error("INVALID APPLICATION ID");if("error"===L||"USER_NOT_FOUND"===L)throw Kommunicate.displayKommunicateWidget(!1),"function"==typeof Ke&&Ke({status:"error",errorMessage:"USER NOT FOUND"}),new Error("USER_NOT_FOUND");if("APPMODULE_NOT_FOUND"===L)throw Kommunicate.displayKommunicateWidget(!1),"function"==typeof Ke&&Ke({status:"error",errorMessage:"APPMODULE NOT FOUND"}),new Error("APPMODULE_NOT_FOUND");if("object"!=typeof L||null===L||!L.token)throw Kommunicate.displayKommunicateWidget(!1),"function"==typeof Ke&&Ke({status:"error",errorMessage:"UNABLE TO PROCESS REQUEST"}),new Error("UNABLE TO PROCESS REQUEST");L.appId=T.applicationId,Ge&&(L.accessToken=Ge),B.onInitApp(L)},error:function(){throw ALStorage.clearMckMessageArray(),Kommunicate.displayKommunicateWidget(!1),"function"==typeof Ke&&Ke({status:"error",errorMessage:"UNABLE TO PROCESS REQUEST"}),new Error("UNABLE TO PROCESS REQUEST")}})},B.closeLeadCollectionWindow=function(){var f=document.getElementById("km-chat-login-modal"),T=document.getElementById("km-anonymous-chat-launcher");if("v2"===pe){var L=parent.document.getElementById("kommunicate-widget-iframe"),K=document.getElementById("km-popup-close-button");L.style.boxShadow="none",Za&&(K.style.display="none"),L.classList.add("km-iframe-closed"),L.classList.remove("kommunicate-iframe-enable-media-query"),L.classList.remove("km-iframe-dimension-with-popup"),L.classList.remove("km-iframe-dimension-no-popup")}f.style.display="none",T.classList.remove("n-vis"),T.classList.add("vis")},B.onInitApp=function(L){H=L;var K=f("#mck-sidebox");B.appendLauncher(),B.setLabels(),"v2"===pe&&(B.configureIframe(),B.restrictScrollOnHandHeldDevices()),f(".applozic-launcher").each((function(){f(this).hasClass("mck-msg-preview")||f(this).show()})),L.token,Tt=L.userId,L.countryCode,W=L.deviceKey,L.websocketUrl,L.websocketPort,ie=L.websocketIdleTimeLimit,L.timeZoneOffset,Ne=L.fileBaseUrl,Ae=L.deactivated,null==no&&(no=Ga.isTrialPlan(L.pricingPackage)),G=btoa(L.userId+":"+L.deviceKey),window.Applozic.ALApiService.AUTH_TOKEN=L.authToken,window.Applozic.ALApiService.setAjaxHeaders(G,be,W,Ge,qe),window.Applozic.ALApiService.setEncryptionKeys(L.encryptionKey,L.userEncryptionKey),L.userEncryptionKey,ve&&(document.getElementById("mck-btn-smiley-box").classList.remove("n-vis"),Oa.initEmojis()),me=L.totalUnreadCount,Ta.badgeCountOnLaucher(vt,me),L.connectedClientCount,Me||"guest"===Tt||"0"===Tt||"C0"===Tt||(no?Sa.checkIfUserHasConversations(null,(function(T,L){L&&f.fn.applozic("initializeSocketConnection",z)})):f.fn.applozic("initializeSocketConnection",z)),f.ajaxPrefilter((function(f){f.beforeSend||-1===f.url.indexOf(MCK_BASE_URL)||(f.beforeSend=function(f){window.Applozic.ALApiService.addRequestHeaders(f)})}));var U=ALStorage.getMckContactNameArray();if(null!==U&&U.length>0)for(var P=0;P<U.length;P++){var q=U[P];null!==q&&(Ca[q[0]]=q[1])}Sa.checkUserConnectedStatus(),Ia.tabFocused(),T.addEventListener("online",(function(){Ga.modifyClassList({id:["km-internet-disconnect-msg"]},"n-vis","vis"),window.Applozic.ALSocket.reconnect()})),T.addEventListener("offline",(function(){Ga.modifyClassList({id:["km-internet-disconnect-msg"]},"vis","n-vis")})),Ha.length>0&&me>0&&Ha.html(me),sa&&Na.loadMessageList({tabId:"",isGroup:!1,isLaunch:!0}),Da.init(L),Fa.subscribeToServiceWorker(),ALStorage.setAppHeaders(L),Va&&0!==Va.length||Ya&&0!==Ya.length?(V&&f.fn.applozic("mckLaunchSideboxChat"),!V&&KommunicateUI.displayPopupChatTemplate(va,ge,qa)):(f.fn.applozic("triggerMsgNotification"),!da&&KommunicateUI.displayPopupChatTemplate(va,ge,qa),"block"===K.css("display")&&Ia.clearMsgTriggerAndChatPopuTimeouts()),Kommunicate.initilizeEventListners();var J=KommunicateUtils.getItemFromLocalStorage("mckActiveConversationInfo");MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE&&ge&&ge.isSingleThreaded?Na.loadMessageList({tabId:"",isGroup:!1},(function(f){KommunicateUI.checkSingleThreadedConversationSettings(f&&f.groupFeeds&&f.groupFeeds.length>1)})):KommunicateUI.checkSingleThreadedConversationSettings(),MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE&&KommunicateUtils.isActiveConversationNeedsToBeOpened(J,L)&&Kommunicate.openConversation(J.groupId),MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE&&!KommunicateUtils.isActiveConversationNeedsToBeOpened(J,L)&&KommunicateUtils.removeItemFromLocalStorage("mckActiveConversationInfo"),KommunicateUtils.triggerCustomEvent("kmInitilized",{detail:L,bubbles:!0,cancelable:!0},pe),"function"==typeof Ke&&Ke("success",L),document.getElementById("km-chat-login-modal").style.visibility="hidden"},B.loadDataPostInitialization=function(){q=!0;var L=H;if(Kommunicate.postPluginInitialization(null,L),Oa.createContactWithDetail({userId:Tt,displayName:L.displayName,photoLink:L.imageLink}),Ga.showPoweredBy(L)){var K=parent.document.getElementById("kommunicate-widget-iframe"),U="https://www.kommunicate.io/poweredby?utm_source="+(K?K.getAttribute("data-url")||parent.window.location.href:T.location.href)+"&utm_medium=webplugin&utm_campaign=poweredby";f(".mck-running-on a").attr("href",U),to&&(document.querySelector(".mck-running-on").innerHTML=to),f(".mck-running-on").removeClass("n-vis").addClass("vis")}B.setEmojiHoverText(),B.configureRatingElements()},B.validateAppSession=function(f){La.init(),Oa.init();var T=ALStorage.getAppHeaders();return!(!T||!T.userId||(f.applicationId===T.appId&&f.userId===T.userId&&f.password===Ge?(V=!(0!==Va),B.onInitApp(T),0):(ALStorage.clearAppHeaders(),1)))},B.configurePopupWidget=function(){!Ga.checkIfDeviceIsHandheld()&&Ga.modifyClassList({id:["mck-sidebox"]},"popup-enabled","")},B.configureIframe=function(){var f=document.getElementById("mck-sidebox-launcher"),T=parent.document.getElementById("kommunicate-widget-iframe");ao===KommunicateConstants.POSITION.LEFT?(f.style.left="10px",T.classList.add("align-left"),Ga.modifyClassList({id:["mck-sidebox"]},"align-left")):f.style.right="10px",f.style.bottom="10px",document.getElementById("mck-sidebox").classList.add("km-iframe-sidebox-border-radius"),document.getElementById("applozic-badge-count").classList.add("km-iframe-badge-count"),T.style.display="block";var L=document.getElementById("km-popup-close-button");function n(){kmWidgetEvents.eventTracking(eventMapping.onChatWidgetClose),Ga.setWidgetStateOpen(!1),Na.closeSideBox(),L.style.display="none",T.classList.add("km-iframe-closed"),T.classList.remove("kommunicate-iframe-enable-media-query"),T.classList.remove("km-iframe-dimension-with-popup"),T.classList.remove("km-iframe-dimension-no-popup"),Ga.modifyClassList({id:["applozic-badge-count"]},"","n-vis")}f.addEventListener("click",(function(){Ga.setWidgetStateOpen(!0),T.classList.remove("km-iframe-closed"),T.classList.add("kommunicate-iframe-enable-media-query"),Ga.modifyClassList({id:["applozic-badge-count"]},"n-vis",""),T.style.width="",Za?(T.classList.add("km-iframe-dimension-with-popup"),L.style.display="flex"):T.classList.add("km-iframe-dimension-no-popup"),Za&&B.configurePopupWidget()})),document.getElementById("km-chat-widget-close-button").addEventListener("click",n),L.addEventListener("click",(function(f){f.preventDefault(),f.stopPropagation(),n()}));var K=parent.window.matchMedia("(max-width: 600px)");K.addListener((function(){K.matches?document.getElementById("mck-sidebox").classList.remove("km-iframe-sidebox-border-radius"):document.getElementById("mck-sidebox").classList.add("km-iframe-sidebox-border-radius")}))},B.restrictScrollOnHandHeldDevices=function(){var f=document.getElementById("mck-sidebox-launcher"),T=document.getElementById("km-chat-widget-close-button"),L=parent&&parent.document.body,K=(parent&&parent.document.head,parent&&parent.document.getElementsByTagName("html")[0]);f.addEventListener("click",(function(){Ga.checkIfDeviceIsHandheld()&&(L&&L.classList.add("mck-restrict-scroll"),K&&K.classList.add("mck-restrict-scroll"))})),T.addEventListener("click",(function(){Ga.checkIfDeviceIsHandheld()&&(L&&L.classList.remove("mck-restrict-scroll"),K&&K.classList.remove("mck-restrict-scroll"))}))},B.configureRatingElements=function(){var f=document.getElementsByClassName("mck-rating-box"),T=document.getElementById("mck-submit-comment"),L=document.getElementById("mck-restart-conversation"),K={groupId:0,comments:[],rating:0};L.addEventListener("click",Na.restartConversation),T.addEventListener("click",(function(){kmWidgetEvents.eventTracking(eventMapping.onSubmitRatingClick),K={groupId:0,comments:[],rating:0};var f=document.getElementById("mck-feedback-comment");T.setAttribute("disabled","true"),f&&f.value.trim()&&(K.comments=[f.value]),K.rating=parseInt(document.querySelector(".mck-rating-box.selected").getAttribute("data-rating")),K.groupId=CURRENT_GROUP_DATA&&CURRENT_GROUP_DATA.tabId,K.supportAgentName=CURRENT_GROUP_DATA&&CURRENT_GROUP_DATA.conversationAssignee,K.applicationId=be;var L=za.MCK_USER_DETAIL_MAP[Tt];K.userInfo={name:L.userName,userId:Tt,email:L.email},B.sendFeedback(K)}));for(var U=0;U<f.length;U++)f[U].addEventListener("click",(function(f){if(Ga.modifyClassList({id:["csat-2"]},"","n-vis"),Ga.modifyClassList({id:["mck-rate-conversation"]},"n-vis",""),Ga.modifyClassList({class:["mck-rating-box"]},"","selected"),Ga.modifyClassList({class:["mck-feedback-text-wrapper"]},"","n-vis"),f.currentTarget.classList.add("selected"),"selected"==f.currentTarget.classList[1]){var T=parseInt(f.currentTarget.dataset.rating),L=1==T?"CSAT Rate Poor":5==T?"CSAT Rate Average":10==T?"CSAT Rate Great":"";kmWidgetEvents.eventTracking(eventMapping.onRateConversationEmoticonsClick,L,T)}}))},B.sendFeedback=function(f){Ta.ajax({headers:{"x-authorization":window.Applozic.ALApiService.AUTH_TOKEN},type:"POST",url:Kommunicate.getBaseUrl()+"/rest/ws/feedback/v2/v2?sendAsMessage=true",global:!1,data:JSON.stringify(f),contentType:"application/json",success:function(f){f&&f.data&&(CURRENT_GROUP_DATA.currentGroupFeedback=f.data.data,KommunicateUI.showClosedConversationBanner(!0),document.getElementById("mck-feedback-comment").value="",Ga.modifyClassList({class:["mck-feedback-text-wrapper"]},"n-vis",""))},error:function(){}})},B.getPreLeadDataForAskUserDetail=function(){var f=MCK_LABELS["lead.collection"],T={email:"email",phone:"number"};if(Va&&0===Ya.length)for(var L=0;L<Va.length;L++){var K={};K.field=Va[L],K.type=T[Va[L]]||"text",K.placeholder=f[Va[L]]||"",K.required=!0,Ya.push(K)}},B.addPasswordField=function(f){var T=document.getElementById("km-email"),L=document.getElementById("km-password"),K=document.getElementById("km-submit-chat-login");if(T&&null==L){var U=document.createElement("input"),P=document.createElement("p");for(var G in P.innerText=MCK_LABELS["lead.collection"].errorText,P.classList.add("km-error-msg"),f)U.setAttribute(G,f[G]);T.insertAdjacentElement("afterend",U),U.insertAdjacentElement("afterend",P)}K.removeAttribute("disabled"),K.innerText=MCK_LABELS["lead.collection"].submit},B.addLeadCollectionInputDiv=function(){Va&&B.getPreLeadDataForAskUserDetail();for(var T=0;T<Ya.length;T++){var L=Ya[T],K=document.createElement("div"),U="km-form-control "+("textarea"===L.element?"mck-preleadcollection-textarea":"km-input-width");K.setAttribute("class","km-form-group km-form-group-container");var P=document.createElement(L.element||"input");P.setAttribute("id","km-"+L.field.toLowerCase()),P.setAttribute("name","km-"+L.field.toLowerCase()),L.required&&P.setAttribute("required",L.required),P.setAttribute("class",U),"select"==L.element&&L.options&&Na.checkArray(L.options)?P=B.createSelectFieldDropdown(L.options,P):(P.setAttribute("type",L.type||"text"),P.setAttribute("placeholder",L.placeholder||""),P.setAttribute("aria-label",L.field)),f(K).append(P),f(".km-last-child").append(K)}var G=document.getElementById("km-phone");null!==G&&G.addEventListener("keydown",B.phoneNumberValidation)},B.phoneNumberValidation=function(f){f.target.value=f.target.value.match(/^([0-9]{0,15})/)[0]},B.createSelectFieldDropdown=function(f,T){var L=document.createElement("option");return L.setAttribute("value",""),L.textContent=MCK_LABELS["lead.collection"].option+" "+T.getAttribute("name").toLowerCase().split("-")[1],T.appendChild(L),f.forEach((function(f){Ga.isObject(f)&&((L=document.createElement("option")).setAttribute("value",f.value),L.textContent=f.value.charAt(0).toUpperCase()+f.value.slice(1),T.appendChild(L))})),T},B.setLeadCollectionLabels=function(){var f=MCK_LABELS["lead.collection"],T=document.getElementById("km-submit-chat-login"),L=document.getElementById("km-lead-collection-heading"),K=document.getElementById("km-tab-title");T.innerHTML=f.submit,T.setAttribute("aria-label",f.submit),L.innerHTML=P.preLeadCollection?f.heading:P.appSettings.chatWidget.preChatGreetingMsg||"",L.setAttribute("aria-label",f.heading),K.innerHTML=f.title,K.setAttribute("aria-label",f.title)},B.setEmojiHoverText=function(){var f=document.getElementsByClassName("mck-rating-box"),T=f&&f.length;if(T)for(var L=0;L<T;L++){var K=f[L],U=document.createElement("div");U.innerHTML=nn[K.dataset.rating],K.appendChild(U)}},B.setLabels=function(){f("#mck-conversation-title").html(MCK_LABELS["conversations.title"]).attr("title",MCK_LABELS["conversations.title"]),f("#mck-msg-new, #mck-sidebox-search .mck-box-title").html(MCK_LABELS["start.new"]).attr("title",MCK_LABELS["start.new"]),f("#mck-contact-search-tab strong").html(MCK_LABELS["search.contacts"]).attr("title",MCK_LABELS["search.contacts"]),f("#mck-group-search-tab strong").html(MCK_LABELS["search.groups"]).attr("title",MCK_LABELS["search.groups"]),f("#mck-contact-search-input, #mck-group-search-input, #mck-group-member-search").attr("placeholder",MCK_LABELS["search.placeholder"]),f("#mck-loc-address").attr("placeholder",MCK_LABELS["location.placeholder"]),f("#mck-no-search-contacts").html(MCK_LABELS["empty.contacts"]),f("#mck-no-search-groups").html(MCK_LABELS["empty.groups"]),f("#mck-new-group, #mck-group-create-tab .mck-box-title, #mck-btn-group-create").html(MCK_LABELS["create.group.title"]).attr("title",MCK_LABELS["create.group.title"]),f("#mck-gc-overlay-label").html(MCK_LABELS["add.group.icon"]),f("#mck-msg-error").html(MCK_LABELS["group.deleted"]),f("#mck-gc-title-label").html(MCK_LABELS["group.title"]),f("#mck-gc-type-label").html(MCK_LABELS["group.type"]),f("#mck-group-info-btn, #mck-group-info-tab .mck-box-title").html(MCK_LABELS["group.info.title"]).attr("title",MCK_LABELS["group.info.title"]),f("#mck-gi-overlay-label").html(MCK_LABELS["change.group.icon"]),f("#mck-group-member-title").html(MCK_LABELS["members.title"]).attr("title",MCK_LABELS["members.title"]),f("#mck-group-add-member .blk-lg-9, #mck-gm-search-box .mck-box-title").html(MCK_LABELS["add.members.title"]).attr("title",MCK_LABELS["add.members.title"]),f("#mck-btn-group-update").html(MCK_LABELS["group.info.update"]).attr("title",MCK_LABELS["group.info.update"]),f("#mck-btn-leave-group, #mck-btn-group-exit").html(MCK_LABELS["exit.group"]).attr("title",MCK_LABELS["exit.group"]),f("#mck-typing-label").html(MCK_LABELS.typing),f("#mck-btn-clear-messages").html(MCK_LABELS["clear.messages"]).attr("title",MCK_LABELS["clear.messages"]),f("#mck-block-button").html(MCK_LABELS["block.user"]).attr("title",MCK_LABELS["block.user"]),f("#mck-loc-box .mck-box-title, #mck-share-loc-label").html(MCK_LABELS["location.share.title"]).attr("title",MCK_LABELS["location.share.title"]),f("#mck-btn-loc").attr("title",MCK_LABELS["location.share.title"]),f("#mck-file-up-label").html(MCK_LABELS["file.attachment"]),f("#mck-file-up").attr("title",MCK_LABELS["file.attachment"]),f(".mck-file-attach-label").attr("title",MCK_LABELS["file.attach.title"]),f("#mck-my-loc").html(MCK_LABELS["my.location"]).attr("title",MCK_LABELS["my.location"]),f("#mck-btn-close-loc-box").html(MCK_LABELS.close).attr("title",MCK_LABELS.close),f("#mck-loc-submit").html(MCK_LABELS.send).attr("title",MCK_LABELS.send),f("#mck-msg-sbmt").attr("title",MCK_LABELS["send.message"]),f("#mck-btn-smiley").attr("title",MCK_LABELS.smiley),f("#mck-group-name-save").attr("title",MCK_LABELS.save),f("#mck-btn-group-icon-save").attr("title",MCK_LABELS.save),f("#mck-group-name-edit").attr("title",MCK_LABELS.edit),document.getElementById("mck-text-box").dataset.text=MCK_LABELS["input.message"],document.getElementById("mck-char-warning-text").innerHTML=MCK_LABELS["char.limit.warn"],document.getElementById("km-faq-search-input").setAttribute("placeholder",MCK_LABELS["search.faq"]),document.getElementById("mck-no-faq-found").innerHTML=MCK_LABELS["looking.for.something.else"],document.getElementById("km-internet-disconnect-msg").innerHTML=MCK_LABELS["offline.msg"],document.getElementById("talk-to-human-link").innerHTML=MCK_LABELS["talk.to.agent"],document.getElementById("mck-collect-email").innerHTML=MCK_LABELS["how.to.reachout"],document.getElementById("mck-email-error-alert").innerHTML=MCK_LABELS["email.error.alert"],document.getElementById("mck-rated-text").innerHTML=MCK_LABELS["csat.rating"].CONVERSATION_RATED,document.getElementById("mck-rate-conversation").innerHTML=MCK_LABELS["csat.rating"].RATE_CONVERSATION,document.getElementById("mck-other-queries").innerHTML=MCK_LABELS["csat.rating"].OTHER_QUERIES,document.getElementById("mck-restart-conversation").innerHTML=MCK_LABELS["csat.rating"].RESTART_CONVERSATION,document.getElementById("mck-feedback-comment").setAttribute("placeholder",MCK_LABELS["csat.rating"].CONVERSATION_REVIEW_PLACEHOLDER),document.getElementById("mck-submit-comment").innerHTML=MCK_LABELS["csat.rating"].SUBMIT_RATING,document.getElementById("wq-msg-first-Part").innerHTML=MCK_LABELS["waiting.queue.message"]["first.Part"],document.getElementById("waiting-queue-number").innerHTML=MCK_LABELS["waiting.queue.message"]["waiting.queue.number"],document.getElementById("wq-msg-last-part").innerHTML=MCK_LABELS["waiting.queue.message"]["last.part"],document.getElementById("km-csat-trigger-text").innerText=MCK_LABELS["conversation.header.dropdown"].CSAT_RATING_TEXT,document.getElementById("km-restart-conversation-text").innerText=MCK_LABELS["conversation.header.dropdown"].RESET_CONVERSATION},f(L).on("click",".fancybox-kommunicate",(function(T){T.preventDefault();var L=f(this),K=L.data("url"),U=Ga.formatHtmlTag(L.data("name")),P=L.find("img").attr("data-blobKey"),G=parent.document.getElementById("km-fullscreen-image-modal"),B=parent.document.getElementById("km-fullscreen-image-modal-content"),z=parent.document.getElementById("km-fullscreen-image-modal-caption");if(P&&""==K)B.src=KommunicateConstants.IMAGE_PLACEHOLDER_URL,KommunicateUI.processLazyImage(B,P);else if(""===K){var H;H=L.data("blobkey"),Da.generateCloudUrl(H,(function(f){K=f}))}else B.src=K;G.style.display="block",z.innerHTML=U||""})),parent.document.getElementById("km-fullscreen-image-modal-close").onclick=function(){parent.document.getElementById("km-fullscreen-image-modal").style.display="none"},f(T).on("resize",(function(){if("block"===J.css("display")&&Aa.fileMenuReposition(),0===te.find(".mck-contact-list").length){var f=te.get(0).scrollHeight;te.height()<f&&te.animate({scrollTop:te.prop("scrollHeight")},0)}})),B.appendLauncher=function(){var T=document.querySelector("#km-anonymous-chat-launcher");T&&T.parentNode.removeChild(T),f("#mck-sidebox-launcher").remove(),f("body").append(B.getLauncherHtml()),Ua.init()},B.tabFocused=function(){function e(f){var L={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};(f=f||T.event).type in L?de=L[f.type]:(de=!this.hidden,Ua.clearFlashPageTitleInterval()),de?(ae<1&&ee&&window.Applozic.ALSocket.checkConnected(!0),B.stopIdleTimeCounter(),Ua.clearFlashPageTitleInterval()):(1===window.Applozic.ALSocket.mck_typing_status&&window.Applozic.ALSocket.sendTypingStatus(0),B.manageIdleTime())}"hidden"in L?L.addEventListener("visibilitychange",e):!1 in L?L.addEventListener("mozvisibilitychange",e):!1 in L?L.addEventListener("webkitvisibilitychange",e):!1 in L?L.addEventListener("msvisibilitychange",e):"onfocusin"in L?L.onfocusin=L.onfocusout=e:T.onpageshow=T.onpagehide=T.onfocus=T.onblur=e,void 0!==L.hidden&&e({type:L.hidden?"blur":"focus"})},B.manageIdleTime=function(){ae=ie,K&&clearInterval(K),K=setInterval((function(){--ae<0&&(ae=0,window.Applozic.ALSocket.stopConnectedCheck(),clearInterval(K),K="")}),6e4)},B.stopIdleTimeCounter=function(){ae=ie,K&&clearInterval(K),K=""},B.manageOfflineMessageTime=function(f){if("object"!=typeof Ze||isNaN(Ze.timeout))T.console.log("Offline message timeout required.");else{if(1===Ze.type){if(!Ze.userIds||0===Ze.userIds.length)return void T.console.log("Offline message userIds required.");if(-1===Ze.userIds.indexOf(f))return}U&&clearInterval(U),U=setTimeout((function(){clearInterval(U),U="",Oa.showOfflineMessage()}),5e3*parseInt(Ze.timeout))}},B.stopOfflineMessageCounter=function(){U&&clearInterval(U),U=""},B.clearMsgTriggerAndChatPopuTimeouts=function(){clearTimeout(MCK_TRIGGER_MSG_NOTIFICATION_PARAM),clearTimeout(MCK_CHAT_POPUP_TEMPLATE_TIMER),KommunicateUI.togglePopupChatTemplate()},f(L).on("click",".chat-popup-widget-close-btn-container",(function(){KommunicateUI.togglePopupChatTemplate()}))},Ta=new MckUtils,Aa=new function(){var L=this,K="",U="",P=!1,G=f("#mck-my-loc"),B=f("#mck-loc-box"),z=f("#mck-loc-lat"),H=f("#mck-loc-lon"),q=f("#mck-btn-loc"),V=f("#mck-sidebox-ft"),W=f("#mck-file-menu"),J=f("#mck-btn-attach"),ee=f("#mck-map-content"),te=f("#mck-loc-address");L.init=function(){Le&&T.google&&"object"==typeof T.google.maps&&(K=new T.google.maps.Geocoder,J.on("click",(function(){L.fileMenuToggle()})),q.on("click",(function(f){f.preventDefault(),kmWidgetEvents.eventTracking(eventMapping.onLocationIconClick),P?B.mckModal():(mckMapUtils.getCurrentLocation(L.onGetCurrLocation,L.onErrorCurrLocation),P=!0)}))),G.on("click",(function(){mckMapUtils.getCurrentLocation(L.onGetMyCurrLocation,L.onErrorMyCurrLocation)}))},L.fileMenuReposition=function(){var f=V.offset();f.bottom=T.innerHeight-f.top,W.css({bottom:f.bottom>51?f.bottom:51,right:0})},L.fileMenuToggle=function(){J.hasClass("on")?(J.removeClass("on"),W.hide()):(L.fileMenuReposition(),J.addClass("on"),W.show())},L.onGetCurrLocation=function(f){MCK_CURR_LATITIUDE=f.coords.latitude,MCK_CURR_LONGITUDE=f.coords.longitude,L.openMapBox()},L.onErrorCurrLocation=function(){MCK_CURR_LATITIUDE=46.15242437752303,MCK_CURR_LONGITUDE=2.7470703125,L.openMapBox()},L.onErrorMyCurrLocation=function(f){alert("Unable to retrieve your location. ERROR("+f.code+"): "+f.message)},L.onGetMyCurrLocation=function(f){if(MCK_CURR_LATITIUDE=f.coords.latitude,MCK_CURR_LONGITUDE=f.coords.longitude,z.val(MCK_CURR_LATITIUDE),H.val(MCK_CURR_LONGITUDE),z.trigger("change"),H.trigger("change"),U)te.val(U);else if(K){var T={lat:MCK_CURR_LATITIUDE,lng:MCK_CURR_LONGITUDE};K.geocode({location:T},(function(f,T){"OK"===T&&f[1]&&(U=f[1].formatted_address)}))}},L.openMapBox=function(){ee.locationpicker({location:{latitude:MCK_CURR_LATITIUDE,longitude:MCK_CURR_LONGITUDE},radius:0,scrollwheel:!0,inputBinding:{latitudeInput:z,longitudeInput:H,locationNameInput:te},enableAutocomplete:!0,enableReverseGeocode:!0,onchanged:function(f){MCK_CURR_LATITIUDE=f.latitude,MCK_CURR_LONGITUDE=f.longitude}}),B.on("shown.bs.mck-box",(function(){ee.locationpicker("autosize")})),B.mckModal()}},Sa=new function(){var L=this,K=f("#mck-msg-form"),U=f("#mck-msg-error"),P=f("#mck-tab-title"),G=f("#mck-tab-status"),B=f(".mck-typing-box"),z=f("#mck-block-button"),H=f("#mck-message-cell .mck-message-inner");L.checkUserConnectedStatus=function(){var T=new Array,K=new Array;f(".mck-user-ol-status").each((function(){var L=f(this).data("mck-id");if(void 0!==L&&""!==L){T.push(L);var K=mckContactUtils.formatContactId(""+L);f(this).addClass(K),f(this).next().addClass(K)}})),T.length>0&&(f.each(T,(function(f,T){void 0===za.MCK_USER_DETAIL_MAP[T]&&K.push(T)})),K.length>0?Ka.getUsersDetail(K,{setStatus:!0}):L.updateUserConnectedStatus())},L.updateUserConnectedStatus=function(){f(".mck-user-ol-status").each((function(){var T=f(this),L=T.data("mck-id");if(L){var K=se[L];void 0!==za.MCK_USER_DETAIL_MAP[L]&&K.connected?(T.removeClass("n-vis").addClass("vis"),T.next().html("("+MCK_LABELS.online+")")):(T.removeClass("vis").addClass("n-vis"),T.next().html("(Offline)"))}}))},L.lastSeenOfGroupOfTwo=function(f){if(T.MCK_OL_MAP[f])G.attr("title",MCK_LABELS.online).html(MCK_LABELS.online);else if(ce[f]){var L=mckDateUtils.getLastSeenAtStatus(ce[f]);G.html(L),G.attr("title",L),P.addClass("mck-tab-title-w-status")}},L.toggleBlockUser=function(f,L){if(L)U.html(MCK_LABELS.blocked),U.removeClass("n-vis").addClass("vis").addClass("mck-no-mb"),K.removeClass("vis").addClass("n-vis"),P.removeClass("mck-tab-title-w-status"),G.removeClass("vis").addClass("n-vis"),B.removeClass("vis").addClass("n-vis"),H.data("blocked",!0),z.html(MCK_LABELS["unblock.user"]).attr("title",MCK_LABELS["unblock.user"]);else if(U.html(""),U.removeClass("vis").addClass("n-vis").removeClass("mck-no-mb"),K.removeClass("n-vis").addClass("vis"),H.data("blocked",!1),z.html(MCK_LABELS["block.user"]).attr("title",MCK_LABELS["block.user"]),!oe[f]&&(T.MCK_OL_MAP[f]||ce[f])){if(T.MCK_OL_MAP[f])G.attr("title",MCK_LABELS.online).html(MCK_LABELS.online);else if(ce[f]){var q=mckDateUtils.getLastSeenAtStatus(ce[f]);G.html(q),G.attr("title",q)}P.addClass("mck-tab-title-w-status")}},L.checkIfUserHasConversations=function(f,T){Kommunicate.client.getGroupDetailByType({type:10,startIndex:0,limit:10},(function(f,L){f||"function"==typeof T&&T(f,L.response.length>0)}))}},Ma=(new function(){var L=f("#mck-msg-to"),K=(f("#mck-btn-loc"),f("#mck-loc-box")),U=f("#mck-msg-sbmt"),P=f("#mck-msg-error"),G=f("#mck-loc-submit"),B=f("#mck-msg-response"),z=f("#mck_response_text"),H=f("#mck-message-cell .mck-message-inner");G.on("click",(function(){var f={type:5,contentType:2,message:T.JSON.stringify(mckMapUtils.getSelectedLocation())},G=H.data("mck-conversationid"),q=H.data("mck-topicid");if(G)f.conversationId=G;else if(q){var V={topicId:q},W=re[q];"object"==typeof W&&(V.topicDetail=T.JSON.stringify(W)),f.conversationPxy=V}!0===H.data("isgroup")?f.groupId=L.val():f.to=L.val(),U.attr("disabled",!0),P.removeClass("vis").addClass("n-vis"),P.html(""),z.html(""),B.removeClass("vis").addClass("n-vis"),Na.sendMessage(f),K.mckModal("hide")}))},new MckGroupService),wa=new MckGroupUtils,La=new function(){var K=this,U={0:MCK_LABELS.user,1:MCK_LABELS.admin,2:MCK_LABELS.moderator,3:MCK_LABELS.member},P=document.getElementById("mck-group-create-type");P.options[P.options.length]=new Option(MCK_LABELS.public,"1"),P.options[P.options.length]=new Option(MCK_LABELS.private,"2"),P.options[P.options.length]=new Option(MCK_LABELS.open,"6");var G=f("#mck-msg-form"),B=f("#mck-msg-error"),z=f("#mck-tab-title"),H=f("#mck-tab-status"),q=f("#mck-no-gsm-text"),V=f("#mck-gms-loading"),W=f("#mck-contact-loading"),J=(f("#mck-tab-menu-box"),f("#mck-search-loading"),f("#mck-group-info-tab")),ee=f("#mck-sidebox-search"),te=(f("#mck-group-name-box"),f("#mck-group-back-link")),ae=f("#mck-group-name-edit"),oe=f("#mck-group-name-save"),ie=f("#mck-sidebox-content"),se=f("#mck-tab-option-panel"),de=f("#mck-btn-group-create"),me=f("#mck-group-create-tab"),ue=f("#mck-contacts-content"),pe=f("#mck-btn-group-update"),ge=f("#mck-group-create-type"),ve=f("#mck-group-icon-upload"),fe=f("#mck-group-icon-change"),he=f("#mck-group-member-list"),ke=f("#mck-group-update-panel"),ye=f(".mck-tab-message-option"),Ce=f("#mck-group-create-title"),be=f(".mck-group-menu-options"),Ee=f("#mck-group-member-search"),Ae=f("#mck-btn-group-icon-save"),Se=(f("#mck-group-info-icon-box"),f(".mck-group-admin-options")),Me=f("#mck-group-add-member-box"),we=f("#mck-message-cell .mck-message-inner"),Le=f("#mck-group-name-sec .mck-group-title"),xe=(f("#mck-group-create-icon-box"),f("#mck-group-info-icon-loading")),Oe=f("#mck-gm-search-box"),Ne=(f("#mck-group-member-search-list"),f("#mck-group-create-icon-loading")),Ke=f("#mck-group-info-icon-box .mck-group-icon"),Ue=f("#mck-group-create-icon-box .mck-group-icon"),Re=f("#mck-group-create-icon-box .mck-overlay-box"),De=f("#mck-gc-overlay-label");document.getElementById("mck-char-warning"),f(".mck-group-name-box div[contenteditable]").keypress((function(T){return!!(8===T.which||37===T.keyCode||38===T.keyCode||39===T.keyCode||40===T.keyCode||T.ctrlKey&&97===T.which)||(13!==T.keyCode||T.shiftKey||T.ctrlKey?30>this.innerHTML.length:!!f(T.target).hasClass("mck-group-create-title")&&(K.submitCreateGroup(),!1))})).on("paste",(function(f){var T=this;setTimeout((function(){return T.innerText.length>30&&(T.innerHTML=T.innerText.substring(0,30),Ta.setEndOfContenteditable(T)),!1}),"fast")})).on("drop",(function(f){f.preventDefault(),f.stopPropagation()})),f(L).on("click",".mck-btn-change-role",(function(T){T.preventDefault();var L=f(this).parents(".mck-li-group-member").find(".mck-group-change-role-box"),K=f(this).parents(".mck-li-group-member").data("role");L.find("select").val(K),L.removeClass("n-vis").addClass("vis"),ke.removeClass("n-vis").addClass("vis")})),pe.on("click",(function(){var T=[];if(f(".mck-group-change-role-box.vis").each((function(L,K){var U=f(this),P=parseInt(U.find("select").val());if(P!==U.parents(".mck-li-group-member").data("role")){var G={userId:U.parents(".mck-li-group-member").data("mck-id"),role:P};T.push(G)}})),T.length>0){var L=we.data("mck-id"),K=we.data("isgroup");if(L&&K){pe.attr("disabled",!0).html(MCK_LABELS["group.info.updating"]);var U={groupId:L,users:T,apzCallback:La.onUpdateGroupInfo};Ma.updateGroupInfo(U)}}})),f("#mck-group-info-icon-box .mck-overlay").on("click",(function(f){fe.trigger("click")})),f("#mck-group-create-icon-box .mck-overlay").on("click",(function(f){ve.trigger("click")})),f(L).on("mouseenter",".mck-group-create-icon-box.mck-hover-on",(function(){f(this).find(".mck-overlay-box").removeClass("n-vis")})).on("mouseleave",".mck-group-create-icon-box.mck-hover-on",(function(){var T=f(this);0===T.find(".mck-group-icon-default").length&&T.find(".mck-overlay-box").addClass("n-vis")})),f(L).on("mouseenter",".mck-group-info-icon-box.mck-hover-on",(function(){f(this).find(".mck-overlay-box").removeClass("n-vis")})).on("mouseleave",".mck-group-info-icon-box.mck-hover-on",(function(){f(this).find(".mck-overlay-box").addClass("n-vis")})),ae.on("click",(function(){Le.attr("contenteditable",!0).focus(),Ta.setEndOfContenteditable(Le[0]),oe.removeClass("n-vis").addClass("vis"),ae.removeClass("vis").addClass("n-vis")})),oe.on("click",(function(){var T=f.trim(Le.text());if(T.length>0){var L=we.data("mck-id"),K=we.data("isgroup");if(L&&K){ae.removeClass("n-vis").addClass("vis"),oe.removeClass("vis").addClass("n-vis"),Le.attr("contenteditable",!1);var U={groupId:L,name:T,apzCallback:La.onUpdateGroupInfo};Ma.updateGroupInfo(U)}}else Le.addClass("mck-req-border")})),Ae.on("click",(function(){var f=Ke.data("iconurl");if(f){var T=we.data("mck-id"),L=we.data("isgroup");if(T&&L){setTimeout((function(){Ae.removeClass("vis").addClass("n-vis")}),1e3),Ke.data("iconurl","");var K={groupId:T,imageUrl:f,apzCallback:La.onUpdateGroupInfo};Ma.updateGroupInfo(K)}}else Le.addClass("mck-req-border")})),de.on("click",(function(){K.submitCreateGroup()})),K.init=function(){f.template("groupMemberTemplate",'<li id="li-gm-${contHtmlExpr}" class="${contIdExpr} mck-li-group-member" data-mck-id="${contIdExpr}" data-role="${roleVal}" data-alpha="${contFirstAlphaExpr}"><div class="mck-row mck-group-member-info" title="${contNameExpr}"><div class="blk-lg-3">{{html contImgExpr}}</div><div class="blk-lg-9"><div class="mck-row"><div class="blk-lg-8 mck-cont-name mck-truncate"><strong>${contNameExpr}</strong></div><div class="blk-lg-4 mck-group-admin-text move-right vis"><span>${roleExpr}</span></div></div><div class="mck-row"><div class="blk-lg-8 mck-truncate mck-last-seen-status" title="${contLastSeenExpr}">${contLastSeenExpr}</div><div class="blk-lg-4 mck-group-admin-options move-right ${enableAdminMenuExpr}"><div class="mck-menu-box n-vis"><div class="mck-dropdown-toggle mck-group-admin-menu-toggle mck-text-center" data-toggle="mckdropdown" aria-expanded="true"><span class="mck-caret"></span></div><ul id="mck-group-admin-menu" class="mck-dropdown-menu mck-group-admin-menu mck-tab-menu-box menu-right" role="menu"><li><a href="#" target="_self"  class="mck-btn-remove-member menu-item" title="${removeMemberLabel}">${removeMemberLabel}</a></li><li><a href="#" target="_self"  class="mck-btn-change-role menu-item" title="${changeRoleLabel}">${changeRoleLabel}</a></li></ul></div></div></div><div id="mck-group-change-role-box" class="mck-row mck-group-change-role-box n-vis"><div class="blk-lg-4"><div class="mck-label">Select role </div></div><div class="blk-lg-8 move-right"><select id="mck-change-role-type" class="mck-select"><option value="0">User</option><option value="1">Admin</option><option value="2">Moderator</option><option value="3" selected>Member</option></select></div></div></div></div></li>'),f.template("groupMemberSearchTemplate",'<li id="li-${contHtmlExpr}" class="${contIdExpr} mck-li-group-member" data-mck-id="${contIdExpr}"><a class="mck-add-to-group" href="#" data-mck-id="${contIdExpr}"><div class="mck-row" title="${contNameExpr}"><div class="blk-lg-3">{{html contImgExpr}}</div><div class="blk-lg-9"><div class="mck-row"><div class="blk-lg-12 mck-cont-name mck-truncate"><strong>${contNameExpr}</strong></div></div><div class="mck-row"><div class="blk-lg-12 mck-truncate mck-last-seen-status" title="${contLastSeenExpr}">${contLastSeenExpr}</div></div></div></div></a></li>')},K.createGroupDefaultSettings=function(){var f=KommunicateUtils.getDataFromKmSession("settings");return{groupName:f&&f.groupName||Ja,agentId:f&&f.agentId||Qa,botIds:f&&f.botIds||Xa}},K.checkBotDetail=function(f){Ta.ajax({url:Kommunicate.getBaseUrl()+"/rest/ws/botdetails/"+f,type:"get",headers:{"x-authorization":window.Applozic.ALApiService.AUTH_TOKEN},skipEncryption:!0,global:!1,success:function(f){CURRENT_GROUP_DATA.CHAR_CHECK=f.data[0]&&f.data[0].aiPlatform==KommunicateConstants.BOT_PLATFORM.DIALOGFLOW,!CURRENT_GROUP_DATA.CHAR_CHECK&&K.removeWarningsFromTextBox(),CURRENT_GROUP_DATA.CHAR_CHECK&&K.disableSendButton(!0)},error:function(){CURRENT_GROUP_DATA.CHAR_CHECK=!1,K.removeWarningsFromTextBox()}})},K.removeWarningsFromTextBox=function(){Ga.modifyClassList({id:["mck-char-warning"]},"n-vis","");var f,T=document.getElementById("mck-text-box");document.getElementById("mck-text-warning-span")&&(f=document.getElementById("mck-normal-span").innerHTML,f+=document.getElementById("mck-text-warning-span").innerHTML,T.innerHTML=f,K.disableSendButton(!1))},K.disableSendButton=function(f){var T=document.getElementById("mck-text-box"),L=Ta.textVal(T),K=document.getElementById("mck-msg-sbmt"),U=L.trim().length;f?U>256&&(K.setAttribute("disabled",f),CURRENT_GROUP_DATA.DISABLE_SEND_MESSAGE=f):(K.removeAttribute("disabled"),CURRENT_GROUP_DATA.DISABLE_SEND_MESSAGE=f)},K.submitCreateGroup=function(){var T=f.trim(Ce.text()),L=ge.val(),K=Ue.data("iconurl");if(T.length>0){var U={groupName:T};L&&(L=parseInt(L),-1!==Ie.indexOf(L)&&(U.type=L)),K&&(U.groupIcon=K),Ue.data("iconurl",""),U.isInternal=!0,de.attr("disabled",!0).html(MCK_LABELS["group.create.submit"]),Na.getGroup(U)}else Ce.addClass("mck-req-border")},K.loadGroups=function(T){var L=T.data;ha.length=0,f.each(L,(function(f,T){void 0!==T.id&&(T=wa.addGroup(T),ha.push(T))}))},K.getDeletedAtTime=function(f){if("object"==typeof MCK_GROUP_MAP[f])return MCK_GROUP_MAP[f].deletedAtTime},K.validateOpenGroupUser=function(f){if(6===f.type){if(!Ma.authenticateGroupUser(f)){if(Xe.disableChatForNonGroupMember){var T=Xe.defaultChatDisabledMessage;T||(T="Chat disabled"),B.html(T),B.removeClass("n-vis").addClass("vis").addClass("mck-no-mb"),G.removeClass("vis").addClass("n-vis"),z.removeClass("mck-tab-title-w-status"),H.removeClass("vis").addClass("n-vis")}be.removeClass("vis").addClass("n-vis"),ye.removeClass("vis").addClass("n-vis"),se.removeClass("vis").addClass("n-vis"),void 0===_e[f.contactId]&&window.Applozic.ALSocket.subscribeToOpenGroup(f)}return f.adminName===Tt?0===Xe.deleteChatAccess&&ye.removeClass("vis").addClass("n-vis"):(Xe.allowInfoAccessGroupMembers||be.removeClass("vis").addClass("n-vis"),2!==Xe.deleteChatAccess&&ye.removeClass("vis").addClass("n-vis"),Xe.allowInfoAccessGroupMembers||2===Xe.deleteChatAccess||se.removeClass("vis").addClass("n-vis")),!1}return!0},K.addGroupStatus=function(f){var T=K.isGroupLeft(f);if(6!==f.type&&(T||Dt))T&&La.onGroupLeft("",{groupId:f.contactId}),z.removeClass("mck-tab-title-w-status"),H.removeClass("vis").addClass("n-vis");else if(f.members.length>0){for(var L="",U=!1,P=f.members.length<=30?f.members.length:25,G=0;G<P;G++)if(Tt!==""+f.members[G]&&-1===f.removedMembersId.indexOf(f.members[G])){var B=Oa.fetchContact(""+f.members[G]);L+=" "+Oa.getTabDisplayName(B.contactId,!1)+","}else U=!0;(5!==f.type&&6!==f.type||U&&5!==f.type)&&(L+=" You"),f.members.length>30&&(L+=" and "+(f.members.length-25)+" more"),L=L.replace(/,\s*$/,""),H.html(L),H.attr("title",L),z.addClass("mck-tab-title-w-status"),be.removeClass("n-vis").addClass("vis")}else z.removeClass("mck-tab-title-w-status"),H.removeClass("vis").addClass("n-vis");7===f.type&&(H.html(""),be.removeClass("vis").addClass("n-vis"))},K.disableGroupTab=function(){B.html(MCK_LABELS["group.chat.disabled"]),B.removeClass("n-vis").addClass("vis").addClass("mck-no-mb"),G.removeClass("vis").addClass("n-vis"),z.removeClass("mck-tab-title-w-status"),H.removeClass("vis").addClass("n-vis")},K.isGroupLeft=function(T){var L=!1;return T.removedMembersId&&T.removedMembersId.length>0&&f.each(T.removedMembersId,(function(f,T){T===Tt&&(L=!0)})),L},K.onGroupLeft=function(f,T){if(W.removeClass("vis").addClass("n-vis"),"object"!=typeof f||"error"!==f.status){var L=T.groupId;if(J.hasClass("vis"))L===J.data("mck-id")&&te.trigger("click");else if(ie.hasClass("vis")){var U=we.data("mck-id"),P=we.data("isgroup");U===L.toString()&&P&&(be.removeClass("vis").addClass("n-vis"),K.disableGroupTab())}}else alert("Unable to process your request. "+f.errorMessage)},K.onAddedGroupMember=function(T,L){if(W.removeClass("vis").addClass("n-vis"),"object"!=typeof T||"error"!==T.status){var U=L.groupId,P=L.userId,G="";if(U?G=wa.getGroup(U):L.clientGroupId&&(G=wa.getGroupByClientGroupId(L.clientGroupId)),"object"==typeof G){if(G=Ma.addMemberToGroup(G,P),J.hasClass("vis")){if(U===J.data("mck-id")){var B=Oa.fetchContact(""+P);0===f("#li-gm-"+B.htmlId).length&&K.addGroupMember(G,B),K.sortGroupMemberHtmlList(),K.enableGroupAdminMenuToggle()}}else if(ie.hasClass("vis")){var z=we.data("mck-id"),H=we.data("isgroup");z===U.toString()&&H&&K.addGroupStatus(G)}}else Ma.getGroupFeed({groupId:U,clientGroupId:L.clientGroupId,apzCallback:La.onGroupFeed})}else alert("Unable to process your request. "+T.errorMessage)},K.onRemovedGroupMember=function(T,L){if(W.removeClass("vis").addClass("n-vis"),"object"!=typeof T||"error"!==T.status){var U=L.groupId,P=L.userId,G="";if(U?G=wa.getGroup(U):L.clientGroupId&&(G=wa.getGroupByClientGroupId(L.clientGroupId)),"object"==typeof G){if(G=Ma.removeMemberFromGroup(G,P),J.hasClass("vis")){if(U===J.data("mck-id")){var B=Oa.fetchContact(""+P),z=f("#li-gm-"+B.htmlId);z.length>0&&z.remove()}}else if(ie.hasClass("vis")){var H=we.data("mck-id"),q=we.data("isgroup");H===U.toString()&&q&&K.addGroupStatus(G)}}else Ma.getGroupFeed({groupId:U,clientGroupId:L.clientGroupId,apzCallback:La.onGroupFeed})}else alert("Unable to process your request. "+T.errorMessage)},K.onGroupFeed=function(T,L){if(W.removeClass("vis").addClass("n-vis"),"success"===T.status){var U=T.data,P=U.conversationPxy,z=wa.getGroup(U.id);U.deletedAtTime&&(B.html(MCK_LABELS["group.deleted"]),B.removeClass("n-vis").addClass("vis").addClass("mck-no-mb"),G.removeClass("vis").addClass("n-vis"));var H=new Array;"object"==typeof P&&(le[P.id]=P,Te[P.topicId]=[P.id],P.topicDetail&&(re[P.topicId]=f.parseJSON(P.topicDetail)),H.push(P)),H.length>0&&(Ea[L.groupId]=H),za.loadUserProfiles(U.membersId,(function(T,L){f.each(T,(function(f,T){void 0===Oa.getContact(T)&&L.push(T)})),Ka.getUsersDetail(L,{async:!1})})),L.isMessage&&"object"==typeof L.message&&Oa.populateMessage(L.messageType,L.message,L.notifyUser),L.isReloadTab&&K.reloadGroupTab(z)}},K.onUpdateGroupInfo=function(T,L){if(W.removeClass("vis").addClass("n-vis"),pe.attr("disabled",!1).html("Update"),ke.removeClass("vis").addClass("n-vis"),"object"!=typeof T||"error"!==T.status){var U=L.groupId,P=L.groupInfo,G=wa.getGroup(U);if("object"==typeof G){if(P.imageUrl&&(G.imageUrl=P.imageUrl),P.newName&&(G.displayName=P.newName),P.metadata&&(G.metadata=P.metadata),P.users&&P.users.length>0&&f.each(P.users,(function(f,T){T.userId&&(G.users[T.userId]=T)})),J.hasClass("vis"))P.imageUrl&&Ke.html(Ma.getGroupImage(G.imageUrl)),Le.html(G.displayName),P.users&&P.users.length>0&&(he.html(""),K.addMembersToGroupInfoList(G),G.adminName===Tt?Me.removeClass("n-vis").addClass("vis"):Me.removeClass("vis").addClass("n-vis"));else if(ie.hasClass("vis")){var B=we.data("mck-id"),H=we.data("isgroup");if(B===U.toString()&&H){var q=G.displayName&&Ga.formatHtmlTag(G.displayName);z.html(q)}else f("#li-group-"+G.htmlId).length>0&&(f("#li-group-"+G.htmlId+" .mck-cont-name strong").html(G.displayName),P.imageUrl&&f("#li-group-"+G.htmlId+" .blk-lg-3").html("<img src=' "+G.imageUrl+"'>"))}MCK_GROUP_MAP[G.contactId]=G}}else alert("Unable to process your request. "+T.errorMessage)},K.getGroupFeedFromMessage=function(f){var T=f.message;if(T){if(f.groupId=T.groupId,f.isMessage=!0,T.conversationId){var L=le[T.conversationId];"object"==typeof L&&"object"==typeof re[L.topicId]||(f.conversationId=T.conversationId)}f.apzCallback=La.onGroupFeed,Ma.getGroupFeed(f)}},K.reloadGroupTab=function(f){var T=we.data("mck-id"),L=we.data("isgroup");T===f.contactId.toString()&&L&&K.addGroupStatus(f)},K.loadGroupTab=function(T){if("error"===T.status)alert("Unable to process your request. "+T.errorMessage);else{var L=T.data;Oa.loadTab({tabId:L.contactId,isGroup:!0}),f("#mck-search").val("")}},K.addMembersToGroupInfoList=function(T){var L=T.members;L.sort(),he.html(""),f.each(L,(function(L,U){if(U){var P=Oa.fetchContact(""+U);0===f("#li-gm-"+P.htmlId).length&&K.addGroupMember(T,P)}})),K.sortGroupMemberHtmlList(),K.enableGroupAdminMenuToggle()},K.enableGroupAdminMenuToggle=function(){f(".mck-group-member-info").bind("mouseenter",(function(){f(this).find(".mck-menu-box").removeClass("n-vis")})).bind("mouseleave",(function(){f(this).find(".mck-menu-box").removeClass("open").addClass("n-vis")}))},K.addGroupMember=function(L,K){var P="n-vis",G="n-vis",B=L.users[K.contactId],z=MCK_LABELS.member,H=3;B&&void 0!==B.role&&(H=B.role,z=U[B.role]);var q=Oa.getTabDisplayName(K.contactId,!1);K.contactId===L.adminName&&(P="vis"),L.adminName===Tt&&(G="vis"),K.contactId===Tt&&(q=MCK_LABELS.you,G="n-vis");var V=Oa.getContactImageLink(K,q),W="";ne[K.contactId]||(T.MCK_OL_MAP[K.contactId]?W=MCK_LABELS.online:ce[K.contactId]&&(W=mckDateUtils.getLastSeenAtStatus(ce[K.contactId])));var J=[{roleExpr:z,roleVal:H,removeMemberLabel:MCK_LABELS["remove.member"],changeRoleLabel:MCK_LABELS["change.role"],contHtmlExpr:K.htmlId,contIdExpr:K.contactId,contImgExpr:V,contLastSeenExpr:W,contNameExpr:q,contFirstAlphaExpr:q.charAt(0).toUpperCase(),isAdminExpr:P,enableAdminMenuExpr:G}];f.tmpl("groupMemberTemplate",J).appendTo("#mck-group-member-list")},K.addMembersToGroupSearchList=function(){var T=we.data("mck-id");if(we.data("isgroup")){var L=wa.getGroup(T),U=_a,P=[],G=ALStorage.getFriendListGroupName(),B=ALStorage.getFriendListGroupType();G&&B&&(U=Ka.getFriendList(G,B)),G&&!B&&(U=Ka.getFriendList(G)),(U=U.filter((function(f,T){return U.indexOf(f)===T}))).sort();var z=L.members;f.each(U,(function(f,T){T&&(T="object"==typeof T&&T.contactId?Oa.fetchContact(""+T.contactId):Oa.fetchContact(""+T),(-1===z.indexOf(T.contactId)||-1!==z.indexOf(T.contactId)&&-1!==L.removedMembersId.indexOf(T.contactId))&&(K.addGroupSearchMember(T),P.push(T)))})),K.enableGroupAdminMenuToggle(),P.length>0?q.removeClass("vis").addClass("n-vis"):q.removeClass("n-vis").addClass("vis"),Oa.initAutoSuggest({contactsArray:P,$searchId:Ee,isContactSearch:!1})}V.removeClass("vis").addClass("n-vis")},K.addGroupSearchMember=function(L){var K=Oa.getTabDisplayName(L.contactId,!1),U=Oa.getContactImageLink(L,K),P="user-"+L.htmlId,G="";ne[L.contactId]||(T.MCK_OL_MAP[L.contactId]?G=MCK_LABELS.online:ce[L.contactId]&&(G=mckDateUtils.getLastSeenAtStatus(ce[L.contactId])));var B=[{contHtmlExpr:P,contIdExpr:L.contactId,contImgExpr:U,contLastSeenExpr:G,contNameExpr:K}];f.tmpl("groupMemberSearchTemplate",B).appendTo("#mck-group-member-search-list")},K.loadCreateGroupTab=function(){ue.removeClass("vis").addClass("n-vis"),ie.removeClass("vis").addClass("n-vis"),ee.removeClass("vis").addClass("n-vis"),J.removeClass("vis").addClass("n-vis"),Ne.removeClass("vis").addClass("n-vis"),Ue.data("iconurl",""),Ce.html(""),Re.removeClass("n-vis"),De.html(MCK_LABELS["add.group.icon"]),Ue.html(Ma.getGroupDefaultIcon()),me.removeClass("n-vis").addClass("vis")},K.loadGroupInfo=function(f){if(f.groupId){Le.attr("contenteditable",!1),oe.removeClass("vis").addClass("n-vis"),ae.removeClass("n-vis").addClass("vis"),ue.removeClass("vis").addClass("n-vis"),ee.removeClass("vis").addClass("n-vis"),ke.removeClass("vis").addClass("n-vis"),me.removeClass("vis").addClass("n-vis"),Ae.removeClass("vis").addClass("n-vis"),xe.removeClass("vis").addClass("n-vis"),J.data("mck-id",f.groupId),Ke.data("iconurl",""),f.conversationId&&J.data("mck-conversation-id",f.conversationId),he.html("");var T=wa.getGroup(f.groupId);"object"==typeof T?(Ke.html(Ma.getGroupImage(T.imageUrl)),Le.html(T.displayName),K.addMembersToGroupInfoList(T),T.adminName===Tt?Me.removeClass("n-vis").addClass("vis"):Me.removeClass("vis").addClass("n-vis")):Ma.getGroupFeed({groupId:f.groupId,apzCallback:La.onGroupFeed})}},K.sortGroupMemberHtmlList=function(){f("#mck-group-member-list .mck-li-group-member").sort((function(f,T){return f.dataset.alpha>T.dataset.alpha})).appendTo("#mck-group-member-list")},K.addGroupMemberFromSearch=function(f){var T=J.data("mck-id");if(void 0!==T&&void 0!==f){var L=wa.getGroup(T);"object"==typeof L&&Tt===L.adminName?(za.loadUserProfile(f),Ma.addGroupMember({groupId:T,userId:f,apzCallback:La.onAddedGroupMember})):Se.removeClass("vis").addClass("n-vis")}Oe.mckModal("hide")}},xa=new function(){var T=this,K=["CREATE","UPDATE"],U=f("#mck-file-box"),P=f(".mck-overlay"),G=f("#mck-msg-sbmt"),B=f("#mck-text-box"),z=f("#mck-file-input"),H=f("#mck-image-input"),q=f("#mck-video-input"),V=f("#mck-autosuggest-search-input"),W=f(".mck-overlay-box"),ee=f(".mck-file-upload"),te=f("#mck-img-file-up"),ae=f("#mck-vid-file-up"),ne=f("#mck-group-icon-upload"),oe=f("#mck-group-icon-change"),ie=f("#mck-group-info-icon-box"),se=f("#mck-btn-group-icon-save"),re=f("#mck-message-cell .mck-message-inner"),ce=f("#mck-group-create-icon-box"),le=f("#mck-group-info-icon-loading"),de=f("#mck-group-create-icon-loading"),me=f("#mck-group-info-icon-box .mck-group-icon"),ue=f("#mck-group-create-icon-box .mck-group-icon"),pe=f("#mck-gc-overlay-label");T.init=function(){function s(){var T=f(this)[0].files[0],L=re.data("mck-id");if(T&&KommunicateUI.isAttachmentV2(T.type))Kommunicate.attachmentService.getFileMeta(T,L,(function(f,T,L){J=f,Na.sendMessage(T,L,(function(f){T.key=f.key;var K={};K.file=L,K.name=L.name,Kommunicate.attachmentService.uploadAttachment(K,T,ht)}))}));else{var K={};K.file=T,K.name=T.name,Kommunicate.attachmentService.uploadAttachment(K,null,ht)}}f.template("fileboxTemplate",'<div id="mck-filebox-${fileIdExpr}" class="mck-file-box ${fileIdExpr}"><div class="mck-file-expr"><span class="mck-file-content blk-lg-8"><span class="mck-file-lb">{{html fileNameExpr}}</span>&nbsp;<span class="mck-file-sz">${fileSizeExpr}</span></span><span class="km-progress km-progress-striped active blk-lg-3" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"><span class="km-progress-bar km-progress-bar-success km-bar" stye></span></span><span class="move-right"><button type="button" class="mck-attach-icon mck-box-close mck-remove-file" data-dismiss="div" aria-hidden="true">x</button></span></div></div>'),Kommunicate.attachEvents(f),ee.on("click",(function(f){f.preventDefault(),kmWidgetEvents.eventTracking(eventMapping.onAttachmentClick),z.trigger("click")})),te.on("click",(function(f){f.preventDefault(),kmWidgetEvents.eventTracking(eventMapping.onCameraButtonClick),H.trigger("click")})),ae.on("click",(function(f){f.preventDefault(),kmWidgetEvents.eventTracking(eventMapping.onCameraButtonClick),q.trigger("click")})),ne.on("change",(function(){var L=f(this)[0].files[0];return T.uplaodFileToAWS(L,K[0]),!1})),oe.on("change",(function(){var L=f(this)[0].files[0];return T.uplaodFileToAWS(L,K[1]),!1})),z.on("change",s),H.on("change",s),q.on("change",(function(){var T=f(this)[0].files[0],L={};L.file=T,L.name=T.name,Kommunicate.attachmentService.uploadAttachment(L,null,ht)})),f(L).on("click",".mck-remove-file",(function(){var T=f(this).parents(".mck-file-box"),L=T.data("mckfile");T.remove(),G.attr("disabled",!1),0===U.find(".mck-file-box").length&&(U.removeClass("vis").addClass("n-vis"),B.attr("required","")),"object"==typeof L&&(Da.deleteFileMeta(L.blobKey),f.each(J,(function(f,T){void 0!==T&&T.blobKey===L.blobKey&&J.splice(f,1)})))})),V.on("input",(function(f){T.resizeTextarea(this),"KM_AUTO_SUGGEST"!=V.data("origin")&&""!=V.data("source-url")&&Oa.populateAutoSuggest({sourceUrl:V.data("source-url"),method:V.data("method"),headers:V.data("headers")})}))},T.resizeTextarea=function(T){var L=T.offsetHeight-T.clientHeight;f(T).css("height","auto").css("height",T.scrollHeight+L)},T.audioRecoder=function(f){"awsS3Server"===ht?T.uploadAttachment2AWS(f):"googleCloud"===ht?T.customFileUpload(f):T.uploadFile(f)},T.customFileUpload=function(T,L){var K=T.file,P=!1,z=new FormData,H=[];if(void 0!==K){if(f(".mck-file-box").length>4&&H.push("Can't upload more than 5 files at a time"),K.size>1048576*$e&&H.push("file size can not be more than "+$e+" MB"),!(H.length>0)){var q=Ta.randomId(),V=[{fileIdExpr:q,fileName:T.name,fileNameExpr:'<a href="#" target="_self" >'+T.name+"</a>",fileSizeExpr:Da.getFilePreviewSize(K.size)}];f.tmpl("fileboxTemplate",V).appendTo("#mck-file-box");var W=f(".mck-file-box."+q),te=f(".mck-file-box."+q+" .mck-file-lb"),ae=f(".mck-file-box."+q+" .km-progress .km-bar"),ne=f(".mck-file-box."+q+" .km-progress"),oe=f(".mck-file-box."+q+" .mck-remove-file");ae.css("width","0%"),L&&Kommunicate.attachmentEventHandler.progressMeter(0,L.key),ne.removeClass("n-vis").addClass("vis"),oe.attr("disabled",!0),ee.attr("disabled",!0),KommunicateUI.hideFileBox(K,U,ee);var ie=re.data("mck-id"),se=T.name+K.size;fa[se]=ie,G.attr("disabled",!0),z.append("files[]",K);var ce=new XMLHttpRequest;(ce.upload||ce).addEventListener("progress",(function(f){var T=parseInt(f.loaded/f.total*100,10);ae.css("width",T+"%"),L&&Kommunicate.attachmentEventHandler.progressMeter(T,L.key)})),ce.addEventListener("load",(function(T){var K=f.parseJSON(this.responseText);if("object"==typeof K){var U=K.fileMeta;if(L){L.fileMeta=U;var z={tabId:L.groupId};return P=KommunicateUI.getAttachmentStopUploadStatus(L.key),KommunicateUI.updateAttachmentTemplate(U,L.key),!P&&Na.submitMessage(L,z),void KommunicateUI.updateImageAttachmentPreview(U,L.key)}var H="object"==typeof U?'<a href="'+U.url+'" target="_blank">'+U.name+"</a>":"",q=U.name,V=U.size,ae=re.data("mck-id"),se=q+V,ce=fa[se];return ie!==ae?(Oa.updateDraftMessage(ce,U),void delete fa[se]):(oe.attr("disabled",!1),ee.attr("disabled",!1),G.attr("disabled",!1),delete fa[se],te.html(H),ne.removeClass("vis").addClass("n-vis"),f(".mck-file-box .progress").removeClass("vis").addClass("n-vis"),B.removeAttr("required"),J.push(U),W.data("mckfile",U),ee.children("input").val(""),!1)}oe.attr("disabled",!1),G.attr("disabled",!1),oe.trigger("click")}));var le=ye+"/files/upload/";return ce.open("post",le,!0),window.Applozic.ALApiService.addRequestHeaders(ce),ce.send(z),!1}alert(H.toString())}},T.uploadAttachemnt=function(f,L){"awsS3Server"===ht?T.uploadAttachment2AWS(f,L):"googleCloud"===ht?T.customFileUpload(f,L):T.uploadFile(f,L)},T.uploadFile=function(T,L){var K=T.file,P=new Object,z=!1,H=[],q="";if(void 0!==K)if(f(".mck-file-box").length>4&&H.push("Can't upload more than 5 files at a time"),K.size>1048576*$e&&H.push("file size can not be more than "+$e+" MB"),H.length>0)alert(H.toString());else{var V=Ta.randomId(),W=[{fileIdExpr:V,fileName:T.name,fileNameExpr:'<a href="#" target="_self" >'+T.name+"</a>",fileSizeExpr:Da.getFilePreviewSize(K.size)}];f.tmpl("fileboxTemplate",W).appendTo("#mck-file-box");var te=f(".mck-file-box."+V),ae=f(".mck-file-box."+V+" .mck-file-lb"),ne=f(".mck-file-box."+V+" .km-progress .km-bar");L&&(q=f(".km-msg-box-attachment .km-attachment-progress-bar-wrapper .km-attachment-progress-bar-success-"+L.key));var oe=f(".mck-file-box."+V+" .km-progress"),ie=f(".mck-file-box."+V+" .mck-remove-file");ne.css("width","0%"),L&&Kommunicate.attachmentEventHandler.progressMeter(0,L.key),oe.removeClass("n-vis").addClass("vis"),ie.attr("disabled",!0),ee.attr("disabled",!0),KommunicateUI.hideFileBox(K,U,ee);var se=re.data("mck-id"),ce=T.name+K.size;fa[ce]=se,G.attr("disabled",!0),P.files=[],P.files.push(K);var le=new XMLHttpRequest;(le.upload||le).addEventListener("progress",(function(f){var T=parseInt(f.loaded/f.total*100,10);ne.css("width",T+"%"),q&&q.css("width",T+"%"),L&&Kommunicate.attachmentEventHandler.progressMeter(T,L.key)})),le.addEventListener("load",(function(T){var K=f.parseJSON(this.responseText);if("object"==typeof K.fileMeta){var U=K.fileMeta;if(L){U.url=Ne+"/rest/ws/aws/file/"+U.blobKey,L.fileMeta=U;var P={tabId:L.groupId};return z=KommunicateUI.getAttachmentStopUploadStatus(L.key),KommunicateUI.updateAttachmentTemplate(U,L.key),!z&&Na.submitMessage(L,P),void KommunicateUI.updateImageAttachmentPreview(U,L.key)}var H=Da.getFilePreviewPath(U);U.url=Ne+"/rest/ws/aws/file/"+U.blobKey;var q=U.name,V=U.size,W=re.data("mck-id"),ne=q+V,ce=fa[ne];return se!==W?(Oa.updateDraftMessage(ce,U),void delete fa[ne]):(ie.attr("disabled",!1),ee.attr("disabled",!1),G.attr("disabled",!1),delete fa[ne],ae.html(H),oe.removeClass("vis").addClass("n-vis"),f(".mck-file-box .km-progress").removeClass("vis").addClass("n-vis"),B.removeAttr("required"),J.push(U),te.data("mckfile",U),ee.children("input").val(""),!1)}ie.attr("disabled",!1),G.attr("disabled",!1),ie.trigger("click")})),f.ajax({type:"GET",url:Ne+"/rest/ws/aws/file/url",global:!1,data:"data="+(new Date).getTime(),crosDomain:!0,success:function(f){var T=new FormData;T.append("files[]",K),le.open("POST",f,!0),le.send(T)},error:function(){}})}},T.uploadAttachment2AWS=function(T,L){var K=T.file,P=new FormData,z=[],H=!1,q="";if(void 0!==K)if(f(".mck-file-box").length>4&&z.push("Can't upload more than 5 files at a time"),K.size>1048576*$e&&z.push("file size can not be more than "+$e+" MB"),z.length>0)alert(z.toString());else{var V=Ta.randomId(),W=[{fileIdExpr:V,fileName:T.name,fileNameExpr:'<a href="#" target="_self" >'+T.name+"</a>",fileSizeExpr:Da.getFilePreviewSize(K.size)}];f.tmpl("fileboxTemplate",W).appendTo("#mck-file-box");var te=f(".mck-file-box."+V),ae=f(".mck-file-box."+V+" .mck-file-lb"),ne=f(".mck-file-box."+V+" .km-progress .km-bar");L&&(q=f(".km-msg-box-attachment .km-attachment-progress-bar-wrapper .km-attachment-progress-bar-success-"+L.key));var oe=f(".mck-file-box."+V+" .km-progress"),ie=f(".mck-file-box."+V+" .mck-remove-file");ne.css("width","0%"),L&&Kommunicate.attachmentEventHandler.progressMeter(0,L.key),oe.removeClass("n-vis").addClass("vis"),ie.attr("disabled",!0),ee.attr("disabled",!0),KommunicateUI.hideFileBox(K,U,ee);var se=re.data("mck-id"),ce=T.name+K.size;if(fa[ce]=se,G.attr("disabled",!0),-1!==K.type.indexOf("image")){var le="AWS-ENCRYPTED-"+K.name;P.append("file",K,le)}else P.append("file",K);var de,me=new XMLHttpRequest;(me.upload||me).addEventListener("progress",(function(f){var T=parseInt(f.loaded/f.total*100,10);q&&q.css("width",T+"%"),ne.css("width",T+"%"),L&&Kommunicate.attachmentEventHandler.progressMeter(T,L.key)})),me.addEventListener("load",(function(T){var K=f.parseJSON(this.responseText);if("object"==typeof K){var U=K;if(L){L.fileMeta=U;var P={tabId:L.groupId};return H=KommunicateUI.getAttachmentStopUploadStatus(L.key),KommunicateUI.updateAttachmentTemplate(U,L.key),!H&&Na.submitMessage(L,P),void KommunicateUI.updateImageAttachmentPreview(U,L.key)}var z="object"==typeof U?'<a href="'+U.url+'" target="_blank">'+U.name+"</a>":"",q=U.name,V=U.size,W=re.data("mck-id"),ne=q+V,ce=fa[ne];return se!==W?(Oa.updateDraftMessage(ce,U),void delete fa[ne]):(ie.attr("disabled",!1),ee.attr("disabled",!1),G.attr("disabled",!1),delete fa[ne],ae.html(z),oe.removeClass("vis").addClass("n-vis"),f(".mck-file-box .km-progress").removeClass("vis").addClass("n-vis"),B.removeAttr("required"),J.push(U),te.data("mckfile",U),ee.children("input").val(""),!1)}ie.attr("disabled",!1),G.attr("disabled",!1),ie.trigger("click")})),"awsS3Server"===ht&&-1!==K.type.indexOf("image")&&(de="?aclsPrivate=true");var ue=MCK_BASE_URL+"/rest/ws/upload/image";de&&(ue+=de),me.open("post",ue,!0),window.Applozic.ALApiService.addRequestHeaders(me),me.send(P)}},T.uplaodFileToAWS=function(f,T){var L=new FormData,U=[];if(void 0!==f)if(-1===f.type.indexOf("image")&&U.push("Please upload image file."),U.length>0)alert(U.toString());else{P.attr("disabled",!0),K[0]===T?(ce.find(".mck-overlay-box").removeClass("n-vis"),ce.removeClass("mck-hover-on"),de.removeClass("n-vis").addClass("vis")):(ie.find(".mck-overlay-box").removeClass("n-vis"),ie.removeClass("mck-hover-on"),le.removeClass("n-vis").addClass("vis"));var G=new XMLHttpRequest;G.addEventListener("load",(function(f){var L=this.responseText;return L&&(K[0]===T?(ue.html('<img src="'+L+'"/>'),ue.data("iconurl",L),pe.html(MCK_LABELS["change.group.icon"]),de.removeClass("vis").addClass("n-vis"),ce.addClass("mck-hover-on")):(me.html('<img src="'+L+'"/>'),me.data("iconurl",L),le.removeClass("vis").addClass("n-vis"),ie.addClass("mck-hover-on"),setTimeout((function(){se.removeClass("n-vis").addClass("vis")}),1500)),setTimeout((function(){W.addClass("n-vis")}),1500)),P.attr("disabled",!1),K[0]===T?ne.val(""):oe.val(""),!1})),L.append("file",f),G.open("post",MCK_BASE_URL+"/rest/ws/upload/file",!0),window.Applozic.ALApiService.addRequestHeaders(G),G.send(L)}},T.addFileBox=function(T){var L=Ta.randomId(),K="";"object"==typeof T.fileMeta&&(L=T.fileMeta.createdAtTime,K=T.fileMeta.name);var U=[{fileNameExpr:T.filelb,fileSizeExpr:T.filesize,fileIdExpr:L,fileName:K}];f.tmpl("fileboxTemplate",U).appendTo("#mck-file-box");var P=f(".mck-file-box."+L),z=P.find(".mck-remove-file"),H=P.find(".progress");"object"==typeof T.fileMeta?(P.data("mckblob",T.fileMeta.blobKey),B.removeAttr("required"),G.attr("disabled",!1),z.attr("disabled",!1),H.removeClass("vis").addClass("n-vis"),J.push(T.fileMeta)):(G.attr("disabled",!0),z.attr("disabled",!0),H.removeClass("n-vis").addClass("vis"))}},Oa=new function(){var K=this,U="",G=f("#mck-search"),B=f("#mck-msg-to"),z=f(".mck-file-lb"),H=f(".mck-file-sz"),V=f("#mck-sidebox"),W=f("#mck-file-box"),ee=f("#mck-msg-sbmt"),ie=f("#mck-msg-form"),se=f("#mck-text-box"),de=f(".mck-box-form"),ue=f("#mck-msg-error"),ge=(f("#mck-show-more"),f("#mck-tab-title")),ve=f("#mck-tab-status"),ye=f("#mck-message-cell"),be=f(".mck-typing-box"),_e=(f("#mck-no-messages"),f("#mck-product-box")),Ee=f(".mck-product-icon"),Ie=f(".mck-product-title"),Te=f(".mck-product-subtitle"),Me=f("#mck-product-box .mck-caret"),we=f(".mck-product-rt-up .mck-product-key"),xe=f("#mck-contact-search-input-box"),Oe=f(".mck-product-rt-up .mck-product-value"),Ke=f(".mck-product-rt-down .mck-product-key"),Re=f(".mck-product-rt-down .mck-product-value"),De=(f("#li-mck-group-info"),f("#li-mck-leave-group"),f("#mck-group-info-tab")),Ge=f("#mck-group-search-tab"),Fe=f("#mck-no-search-groups"),He=f("#mck-group-create-tab"),$e=f("#mck-group-search-list"),qe=(f("#mck-group-search-tabview"),f(".mck-group-menu-options")),je=f("#mck-group-search-input"),We=f("#mck-group-search-input-box"),Ye=f("#mck-contact-search-list"),Xe=f("#mck-contacts-content"),ot=f("#mck-contact-search-tab"),lt=(f("#mck-contact-search-tabview"),f("#mck-contact-search-input")),ut=f("#mck-autosuggest-search-input"),ft=f("#mck-autosuggest-metadata"),ht=(f("#mck-search-list"),f("#mck-no-search-contacts")),Ct=f("#mck-search-tab-box li a"),_t=f("#mck-search-tabview-box"),Et=f("#mck-sidebox-search"),St=f("#mck-contact-loading"),wt=f("#mck-typing-label"),Dt=f("#mck-price-widget"),Gt=f("#mck-msg-response"),zt=f("#mck_response_text"),Wt=f("#li-mck-block-user"),Qt=f("#mck-search-loading"),Xt=f("#mck-tab-individual"),ra=f("#mck-attachfile-box"),ca=f("#mck-location-sharing-box"),la=f("#mck-sidebox-content"),da=f("#mck-tab-option-panel"),ma=f("#mck-tab-conversation"),ua=f("#mck-conversation-header"),ga=(f("#mck-no-conversations"),f("#mck-conversation-list")),va=f(".mck-tab-message-option"),fa=f(".mck-box-ft .mck-box-form"),Aa=f("#mck-btn-clear-messages"),Pa=f("#mck-offline-message-box"),Ba=f("#mck-message-cell .mck-message-inner"),Fa=(f("#mck-msg-new"),new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi),'<div class="km-csat-skeleton"> <div class="mck-rated"> <span class="mck-rated-text">'+MCK_LABELS["csat.rating"].CONVERSATION_RATED+'</span><span class="mck-rating-container">{{html ratingSmileSVG}}</span></div><div class="mck-conversation-comment">${ratingComment}</div></div>');K.latestMessageReceivedTime="",K.init=function(){f.template("convTemplate",'<li id="li-${convIdExpr}" class="${convIdExpr}"><a class="${mckLauncherExpr}" href="#" data-mck-conversationid="${convIdExpr}" data-mck-id="${tabIdExpr}" data-isgroup="${isGroupExpr}" data-mck-topicid="${topicIdExpr}" data-isconvtab="true"><div class="mck-row mck-truncate" title="${convTitleExpr}">${convTitleExpr}</div></a></li>'),f.template("messageTemplate",'<div tabindex="-1" name="message" data-msgdelivered="${msgDeliveredExpr}" data-msgsent="${msgSentExpr}" data-msgtype="${msgTypeExpr}" data-msgtime="${msgCreatedAtTime}"data-msgcontent="${replyIdExpr}" data-msgkey="${msgKeyExpr}" data-contact="${toExpr}" class="mck-m-b ${msgKeyExpr} ${msgFloatExpr} ${msgAvatorClassExpr} ${botMsgDelayExpr}"><div class="mck-clear"><div class="${nameTextExpr} ${showNameExpr} mck-conversation-name"><span class="mck-ol-status ${contOlExpr}"><span class="mck-ol-icon" title="${onlineLabel}"></span>&nbsp;</span>${msgNameExpr}</div><div class="blk-lg-12"><div class="mck-msg-avator blk-lg-3">{{html msgImgExpr}}</div><div class ="km-conversation-container-right ${kmAttchMsg}"><div class="km-msg-box-attachment ${attachmentBoxExpr} ">{{html attachmentTemplate}}<div class="km-msg-box-progressMeter ${progressMeterClassExpr} ">{{html progressMeter}}</div></div><div class="mck-msg-box ${msgClassExpr} ${msgBoxColor}"><div class="move-right mck-msg-text"></div><div class="mck-msg-reply mck-verticalLine ${msgReplyToVisibleExpr}"><div class="mck-msgto">${msgReplyTo} </div></div><div class="mck-msg-reply mck-verticalLine ${msgReplyDivExpr}"><div class="mck-msgreply-border ${textreplyVisExpr}">${msgReply}</div><div class="mck-msgreply-border ${msgpreviewvisExpr}">{{html msgPreview}}</div></div><div class="mck-msg-text mck-msg-content notranslate" tabindex="-1"></div></div><div class="mck-msg-box-rich-text-container notranslate ${kmRichTextMarkupVisibility} ${containerType}"><div class="email-message-indicator ${emailMsgIndicatorExpr}"><span><svg xmlns="http://www.w3.org/2000/svg" width="12" height="11" viewBox="0 0 12 11"><path fill="#BCBABA" fill-rule="nonzero" d="M12 3.64244378L7.82144281 0v2.08065889h-.0112584c-1.2252898.0458706-2.30872368.23590597-3.23022417.58877205-1.03614858.39436807-1.89047392.92952513-2.56710409 1.60169828-.53552482.53356847-.95771502 1.14100649-1.27501442 1.8173497-.08349984.17792235-.16437271.35624185-.23304899.54349718-.32987128.89954044-.56029331 1.87632619-.49311816 2.87991943C.02781163 9.76011309.1572833 10.5.30795828 10.5c0 0 .18801538-1.03695368.94795775-2.22482365.23267371-.36259621.50437656-.70533502.81698495-1.02186205l.0350887.03038182v-.06533086c.19420749-.19301397.40079923-.37828356.63497407-.54588006.63272238-.45433742 1.40748832-.8141536 2.32279668-1.0796471.74962217-.21763716 1.60432278-.34412883 2.54909064-.39019801h.20809286l-.00150112 2.08085746L12 3.64244378z"/></svg></span><span>via email</span></div>{{html kmRichTextMarkup}}</div><div class="${msgFloatExpr}-muted mck-text-light mck-text-xs mck-t-xs ${timeStampExpr} vis"><span class="mck-created-at-time notranslate">${createdAtTimeExpr}</span> <span class="mck-message-status notranslate" aria-hidden="${msgStatusAriaTag}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17.06103 10.90199" width="24" height="24" class="${statusIconExpr} mck-message-status notranslate" focusable="false" aria-hidden="true" ><path fill="#859479" d="M16.89436.53548l-.57-.444a.434.434 0 0 0-.609.076l-6.39 8.2a.38.38 0 0 1-.577.039l-.427-.388a.381.381 0 0 0-.578.038l-.451.576a.5.5 0 0 0 .043.645l1.575 1.51a.38.38 0 0 0 .577-.039l7.483-9.6a.436.436 0 0 0-.076-.609z" class="mck-delivery-report--delivered-read"></path><path fill="#859479" d="M12.00236.53548l-.57-.444a.434.434 0 0 0-.609.076l-6.39 8.2a.38.38 0 0 1-.577.039l-2.614-2.558a.435.435 0 0 0-.614.007l-.505.516a.435.435 0 0 0 .007.614l3.887 3.8a.38.38 0 0 0 .577-.039l7.483-9.6A.435.435 0 0 0 12.00109.536l-.00073-.00052z"  class="mck-delivery-report--sent"></path><path fill="#859479" d="M9.75 7.713H8.244V5.359a.5.5 0 0 0-.5-.5H7.65a.5.5 0 0 0-.5.5v2.947a.5.5 0 0 0 .5.5h.094l.003-.001.003.002h2a.5.5 0 0 0 .5-.5v-.094a.5.5 0 0 0-.5-.5zm0-5.263h-3.5c-1.82 0-3.3 1.48-3.3 3.3v3.5c0 1.82 1.48 3.3 3.3 3.3h3.5c1.82 0 3.3-1.48 3.3-3.3v-3.5c0-1.82-1.48-3.3-3.3-3.3zm2 6.8a2 2 0 0 1-2 2h-3.5a2 2 0 0 1-2-2v-3.5a2 2 0 0 1 2-2h3.5a2 2 0 0 1 2 2v3.5z" class="mck-delivery-report--pending"></path></svg><p class="mck-sending-failed">Sending failed</p></span></div></div></div></div><div class="n-vis mck-context-menu"><ul><li><a class="mck-message-forward ${msgForwardVisibleExpr}">${msgForwardExpr}</a></li><li><a class="mck-message-delete">${msgDeleteExpr}</a></li><li><a class="mck-message-reply">${msgReplyExpr}</a></li></ul></div></div>'),f.template("contactTemplate",'<li id="li-${contHtmlExpr}" class="${contIdExpr} ${conversationStatusClass}" data-msg-time="${msgCreatedAtTimeExpr}" data-is-queued="${isConversationInWaitingQueue}" role="button" tabindex="0"><a class="${mckLauncherExpr}" href="#" data-mck-conversationid="${conversationExpr}" data-mck-id="${contIdExpr}" data-isgroup="${contTabExpr}"><div class="mck-row" title="${contNameExpr}"><div class="mck-conversation-topic mck-truncate ${contHeaderExpr}">${titleExpr}</div><div class="blk-lg-3">{{html contImgExpr}}<div class="mck-unread-count-box move-right mck-truncate ${contUnreadExpr}"><span class="mck-unread-count-text">{{html contUnreadCount}}</span></div></div><div class="blk-lg-9"><div class="mck-row"><div class="blk-lg-8 mck-cont-name mck-truncate"><div class="mck-ol-status ${contOlExpr}"><span class="mck-ol-icon" title="${onlineLabel}"></span>&nbsp;</div><strong class="mck-truncate">${contNameExpr}</strong></div><div class="mck-text-muted move-right mck-cont-msg-date mck-truncate blk-lg-4">${msgCreatedDateExpr}</div></div><div class="mck-row"><div class="mck-cont-msg-wrapper blk-lg-6 mck-truncate msgTextExpr"></div></div></div></div></a></li>'),f.template("searchContactbox",'<li id="li-${contHtmlExpr}" class="${contIdExpr}"><a class="applozic-launcher" href="#" data-mck-id="${contIdExpr}" data-isgroup="${contTabExpr}"><div class="mck-row" title="${contNameExpr}"><div class="blk-lg-3">{{html contImgExpr}}</div><div class="blk-lg-9"><div class="mck-row"><div class="blk-lg-12 mck-cont-name mck-truncate"><strong>${contNameExpr}</strong><div class="move-right mck-group-count-box mck-group-count-text ${displayGroupUserCountExpr}">${groupUserCountExpr}</div></div><div class="blk-lg-12 mck-text-muted">${contLastSeenExpr}</div></div></div></div></a></li>'),f.template("csatModule",Fa)},K.loadDropdownOptions=function(){var f=!1,T=P.oneTimeRating&&!KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]==KommunicateConstants.FEEDBACK_API_STATUS.RATED;if(fe&&!T&&(f=!0,Ga.modifyClassList({id:["km-csat-trigger"]},"","n-vis")),P.restartConversationByUser){var L=document.getElementById("km-restart-conversation"),K=!0;CURRENT_GROUP_DATA.groupMembers&&CURRENT_GROUP_DATA.groupMembers.map((function(f){!K||2!=f.role&&1!=f.roleType||f.userId!=CURRENT_GROUP_DATA.conversationAssignee||(K=!1,CURRENT_GROUP_DATA.initialBot=f)})),CURRENT_GROUP_DATA&&CURRENT_GROUP_DATA.initialBot&&CURRENT_GROUP_DATA.conversationAssignee&&CURRENT_GROUP_DATA.conversationAssignee==CURRENT_GROUP_DATA.initialBot.userId?(Ga.modifyClassList({id:["km-restart-conversation"]},"","n-vis"),L&&L.addEventListener("click",Na.restartConversation)):Ga.modifyClassList({id:["km-restart-conversation"]},"n-vis","")}tn&&(f=!0,KommunicateUI.toggleVoiceOutputOverride(userOverride.voiceOutput),Ga.modifyClassList({id:["user-overide-voice-output"]},"","n-vis")),f&&Ga.modifyClassList({id:["km-widget-options"]},"","n-vis")},K.initEmojis=function(){try{f("#mck-text-box").emojiarea({button:"#mck-btn-smiley",wysiwyg:!0,menuPosition:"top"})}catch(f){U||(U=setTimeout((function(){K.initEmojis()}),3e4))}},K.handleLoadTab=function(){if("v2"===pe){!q&&Ia.loadDataPostInitialization(),Kommunicate.setDefaultIframeConfigForOpenChat(Za);var T=parent.document.getElementById("kommunicate-widget-iframe").contentDocument.getElementById("mck-sidebox-launcher");!Ga.isWidgetOpen()&&T.click()}"none"===V.css("display")&&(f(".mckModal").mckModal("hide"),V.mckModal()),B.focus()},K.loadTab=function(L,U){var G=KommunicateUtils.getCookie(KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID);(KommunicateUtils.getItemFromLocalStorage("mckActiveConversationInfo",{groupId:L.tabId})||Ga.isWidgetOpen())&&K.handleLoadTab(),Ia.clearMsgTriggerAndChatPopuTimeouts(),MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE&&L.isGroup&&L.tabId&&KommunicateUtils.setItemToLocalStorage("mckActiveConversationInfo",{groupId:L.tabId,appId:P.appId,userId:G});var z=Ba.data("mck-id");if(z)if(se.html().length>1||W.hasClass("vis")){var H={text:se.html(),files:[]};W.hasClass("vis")&&f(".mck-file-box").each((function(){var T=f(this),L={filelb:T.find(".mck-file-lb").html(),filesize:T.find(".mck-file-sz").html()},K=T.data("mckfile");"object"==typeof K&&(L.fileMeta=K),H.files.push(L)})),ya[z]=H}else delete ya[z];if(ae=!0,K.clearMessageField(!1),K.addDraftMessage(L.tabId),ue.html(""),ue.removeClass("vis").addClass("n-vis"),zt.html(""),Gt.removeClass("vis").addClass("n-vis"),ie[0].reset(),ie.removeClass("n-vis").addClass("vis"),Ba.html(""),ue.removeClass("mck-no-mb"),Xe.removeClass("n-vis").addClass("vis"),fa.removeClass("vis").addClass("n-vis"),f("#mck-sidebox-ft").removeClass("vis").addClass("n-vis"),Wa&&KommunicateUI.loadQuickReplies(Wa),Et.removeClass("vis").addClass("n-vis"),De.removeClass("vis").addClass("n-vis"),He.removeClass("vis").addClass("n-vis"),la.removeClass("n-vis").addClass("vis"),_e.removeClass("vis").addClass("n-vis"),ua.addClass("n-vis"),St.removeClass("vis").addClass("n-vis"),Ba.removeClass("mck-group-inner"),ve.removeClass("vis").addClass("n-vis"),ge.removeClass("mck-tab-title-w-status"),ge.removeClass("mck-tab-title-w-typing"),be.removeClass("vis").addClass("n-vis"),wt.html(MCK_LABELS.typing),Ba.data("isgroup",L.isGroup),Ba.data("datetime",""),document.getElementById("mck-char-warning")&&document.getElementById("mck-char-warning").classList.add("n-vis"),Ga.modifyClassList({class:["mck-rating-box"]},"","selected"),L.tabId){if(B.val(L.tabId),Ba.data("mck-id",L.tabId),Ba.data("mck-conversationid",L.conversationId),Ba.data("mck-topicid",L.topicId),da.data("tabId",L.tabId),da.removeClass("n-vis").addClass("vis"),Xe.removeClass("vis").addClass("n-vis"),fa.removeClass("n-vis").addClass("vis"),f("#mck-sidebox-ft").removeClass("n-vis").addClass("vis"),Aa.removeClass("n-vis").addClass("vis"),qe.removeClass("vis").addClass("n-vis"),Ga.modifyClassList({id:["mck-waiting-queue"]},"n-vis","vis"),L.isGroup?(Ba.addClass("mck-group-inner"),Wt.removeClass("vis").addClass("n-vis"),KommunicateUI.activateTypingField()):Wt.removeClass("n-vis").addClass("vis"),!L.topicId&&L.conversationId){var q=le[L.conversationId];"object"==typeof q&&(L.topicId=q.topicId)}if(L.topicId){var V=re[L.topicId];"object"==typeof V&&(Yt?(Ba.data("mck-title",V.title),ua.html(V.title),ua.removeClass("n-vis")):xt&&(K.setProductProperties(V,L.topicId),Me.addClass("n-vis"),_e.addClass("mck-product-box-wc"),ga.addClass("n-vis"),_e.removeClass("n-vis").addClass("vis")))}Le&&T.google&&"object"==typeof T.google.maps?(ra.removeClass("vis").addClass("n-vis"),ca.removeClass("n-vis").addClass("vis")):(ca.removeClass("vis").addClass("n-vis"),pa&&ra.removeClass("n-vis").addClass("vis")),K.isGroupDeleted(L.tabId,L.isGroup)&&(ue.html(MCK_LABELS["group.deleted"]),ue.removeClass("n-vis").addClass("vis").addClass("mck-no-mb"),ie.removeClass("vis").addClass("n-vis")),ma.removeClass("vis").addClass("n-vis"),_t.removeClass("vis").addClass("n-vis"),Xt.removeClass("n-vis").addClass("vis"),"support"===ke&&f(".mck-tab-link").removeClass("vis").addClass("n-vis"),Qe&&(Dt.removeClass("n-vis").addClass("vis"),Ba.addClass("mck-msg-w-panel")),Ae&&(ue.html("Deactivated"),ue.removeClass("n-vis").addClass("vis").addClass("mck-no-mb"),ie.removeClass("vis").addClass("n-vis"));var J=L.isGroup?L.tabId:Tt;window.Applozic.ALSocket.subscibeToTypingChannel(J),"function"==typeof ze&&ze({tabId:L.tabId,isGroup:L.isGroup})}else{L.tabId="",Kt&&Oa.hideOfflineMessage(),Xt.removeClass("vis").addClass("n-vis"),ma.removeClass("n-vis").addClass("vis"),_t.removeClass("n-vis").addClass("vis"),_e.removeClass("vis").addClass("n-vis"),Ba.data("mck-id",""),Ba.data("mck-conversationid",""),Ba.data("mck-topicid",""),Dt.removeClass("vis").addClass("n-vis"),Ba.removeClass("mck-msg-w-panel"),da.removeClass("vis").addClass("n-vis"),Aa.removeClass("vis").addClass("n-vis"),B.val("");var ee=ALStorage.getLatestMessageArray();if(window.Applozic.ALSocket.unsubscibeToTypingChannel(),null!==ee&&ee.length>0)return L.isReload=!0,Oa.addContactsFromMessageList({message:ee},L),void(ae=!1)}if(L.viaCreateGroup){var te=L.groupDetails,ne=te&&te.metadata.CONVERSATION_ASSIGNEE,oe=te.users.filter((function(f){return f.userId==ne}))[0];CURRENT_GROUP_DATA.conversationAssignee=ne;var ce={name:L.groupDetails.name,imageUrl:L.groupDetails.imageUrl};Na.processOnlineStatusChange(L.tabId,oe,ce),oe.roleType==KommunicateConstants.APPLOZIC_USER_ROLE_TYPE.BOT?La.checkBotDetail(ne):CURRENT_GROUP_DATA.CHAR_CHECK=!1}else L.isWaitingQueue=!0,Na.loadMessageList(L,U);document.getElementById("mck-submit-comment").removeAttribute("disabled")},K.setProductProperties=function(f,T){Ie.html(f.title),Ee.html(K.getTopicLink(f.link));var L=f.subtitle?f.subtitle:"";Te.html(L);var U=f.key1?f.key1:"",P=f.value1?":"+f.value1:"";we.html(U),Oe.html(P);var G=f.key2?f.key2:"",B=f.value2?":"+f.value2:"";Ke.html(G),Re.html(B),"function"==typeof Ue&&(f.topicId=T,Ue(f))},K.getTopicLink=function(f){return f?'<img src="'+f+'">':'<span class="mck-icon-no-image"></span>'},K.isFileEncryptedImage=function(f){return f&&f.contentType&&-1!==f.contentType.indexOf("image")&&f.name&&-1!==f.name.indexOf("AWS-ENCRYPTED")},K.processMessageList=function(T,L,U,P,G){var B,z=Ba.children("div[name='message']:first"),H=Ba.data("mck-id"),q=Ba.data("isgroup"),V="";P=void 0!==P&&P;var W=q?wa.getGroup(H):Oa.fetchContact(H);if(L&&Ba.data("last-message-received-time",T.message[0].createdAtTime),G&&(L=!1,T&&T.message&&(T.message=T.message.reverse())),void 0===T.message.length){var J=[];J.push(T.message),ALStorage.updateMckMessageArray(J),K.addMessage(T.message,W,P,!1,U),B=T.createdAtTime}else ALStorage.updateMckMessageArray(T.message),f.each(T.message,(function(f,T){void 0!==T.to&&(!V&&(V="object"==typeof T.metadata&&T.metadata.KM_ENABLE_ATTACHMENT?T.metadata.KM_ENABLE_ATTACHMENT:""),T&&T.fileMeta&&Oa.isFileEncryptedImage(T.fileMeta)&&(T.fileMeta.url="",T.fileMeta.thumbnailUrl=KommunicateConstants.IMAGE_PLACEHOLDER_URL),K.addMessage(T,W,P,!1,U,V,null,G),Kommunicate.appendEmailToIframe(T),B=T.createdAtTime,G&&!L&&10!=T.contentType&&(L=!0))}));da.data("datetime",B),!L&&z.length>0?Ba.scrollTop(z.offset().top-Ba.offset().top+Ba.scrollTop()):L&&Ba.animate({scrollTop:Ba.prop("scrollHeight")},"slow",(function(){var f=document.querySelectorAll("img.lazy-image");f&&f.length>0&&Array.prototype.slice.call(f).map((function(f){KommunicateUI.isInView(f,document.querySelector("#mck-message-cell .mck-message-inner"))&&KommunicateUI.processLazyImage(f,f.getAttribute("data-thumbnailBlobKey"))}))}))},K.closeConversation=function(f){if("function"==typeof Pe){var T=Pe();if("object"==typeof T)var L="BUSY_WITH_OTHER"===f?T.onBusyWithOtherUser:T.onConversationClose}L||(L="Chat disabled with user"),ue.html(L),ue.removeClass("n-vis").addClass("vis").addClass("mck-no-mb"),ie.removeClass("vis").addClass("n-vis")},K.addTooltip=function(T){f("."+T+" .mck-pending-icon").attr("title","pending"),f("."+T+" .mck-btn-trash").attr("title","delete"),f("."+T+" .mck-sent-icon").attr("title","sent"),f("."+T+" .mck-btn-forward").attr("title","forward message"),f("."+T+" .mck-delivered-icon").attr("title","delivered"),f("."+T+" .mck-read-icon").attr("title","delivered and read"),f("."+T+" .msgtype-outbox-cr").attr("title","sent via Carrier"),f("."+T+" .msgtype-outbox-mck").attr("title","sent"),f("."+T+" .msgtype-inbox-cr").attr("title","received via Carrier"),f("."+T+" .msgtype-inbox-mck").attr("title","recieved")},K.fetchContact=function(f){var T=K.getContact(f);return void 0===T&&(T=K.createContact(f)),T},K.getContact=function(f){return"object"==typeof te[f]?te[f]:void 0},K.getContactDisplayName=function(f){if("string"==typeof Ca[f])return Ca[f];if(void 0===Ca[f]){var T=za.MCK_USER_DETAIL_MAP[f];return void 0!==T?T.displayName:void 0}},K.sendUserEmail=function(){if(document.getElementById("input-for-email").value.length>1){var T=document.getElementById("input-for-email").value;Ka.updateUser({data:{email:T},success:function(T){f("#input-for-email").after("<div style='width: 100px; margin: auto;'><span>Email Sent</span></div>"),f("#input-for-email").remove(),f("#send-email-button").remove()},error:function(f){}})}else alert("No email")},K.updateMetadata=function(f,L){var K=T.JSON.stringify({key:f,metadata:L});window.Applozic.ALApiService.ajax({type:"POST",url:MCK_BASE_URL+"/rest/ws/message/update/metadata",global:!1,data:K,contentType:"application/json",success:function(f){}})},K.addMessage=function(U,P,G,B,z,H,q,V){var W="",J="",ee="",te="vis",ae="n-vis",ne="",oe="n-vis",ie="n-vis",ce="vis",de="n-vis",me="n-vis",ue="";if(Kommunicate.visibleMessage(U)&&("object"==typeof U.metadata&&void 0!==U.metadata.AL_REPLY&&(W=U.metadata.AL_REPLY,void 0!==(J=Ra.getReplyMessageByKey(W))&&((P.isGroup&&J||!P.isGroup&&void 0===J.fileMeta)&&(oe="vis"),ne=5===J.type?"You":Oa.getTabDisplayName(J.to,!1),"object"!=typeof J.fileMeta&&2!==J.contentType||(ee=K.getImageForReplyMessage(J),te="n-vis",ae="vis",oe="n-vis"))),!(f("#mck-message-cell ."+U.key).length>0)&&(U.source!=KommunicateConstants.MESSAGE_SOURCE.MAIL_INTERCEPTOR||(ie="vis",f(".email-conversation-indicator").addClass("vis").removeClass("n-vis"),U.message)))){U.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.ATTACHMENT||U.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.LOCATION?(ce=U.message?"vis km-attach-msg-right":"n-vis",de="n-vis",ue="km-attach-msg",me="km-attach-msg-right"):ce=U.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.TEXT_HTML&&U.source==KommunicateConstants.MESSAGE_SOURCE.MAIL_INTERCEPTOR||U.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.DEFAULT&&"string"!=typeof U.message?"n-vis":"vis";var pe,ge,ve="mck-msg-right",fe="mck-timestamp-"+U.key;0!==U.type&&4!==U.type&&6!==U.type||(ve="mck-msg-left"),4!==U.contentType&&10!==U.contentType&&103!==U.contentType||(ve="mck-msg-center"),pe="mck-msg-right"===ve?"km-custom-widget-background-color":"km-custom-widget-background-color-secondary","mck-msg-right"!==ve&&"km-attach-msg"===ue&&(ce="vis km-attach-msg-left",me="km-attach-msg-left"),ge=K.getStatusIconName(U);var ke=U.key,ye="'"+U.deviceKey+"','"+U.to+"','"+U.to+"','"+ke+"'",Ce="",be="",_e="",Ee="n-vis",Ie="",Te="";if(za.loadUserProfile(U.to),!U.groupId||4===U.contentType||7===P.type||0!==U.type&&4!==U.type&&6!==U.type||(Ce=K.getTabDisplayName(U.to,!1),Ee="vis",_e=K.getNameTextClassByAlphabet(Ce)),Nt){Ie="mck-msg-avator-bubble";var Ae="",Se=Ce;"mck-msg-right"===ve?(Ae=Oa.fetchContact(Tt),Se=K.getTabDisplayName(Ae.displayName,!1),Te="false"):"mck-msg-left"===ve&&(Ae=U.groupId?Oa.fetchContact(U.to):P,Te="true"),Ae&&(be=K.getContactImageLink(Ae,Se))}U.groupId&&10===U.contentType&&(Ce="",be="",_e="");var Me="n-vis",we="",Le="",xe=U.message;"object"==typeof U.fileMeta&&(we=U.fileMeta.name,Le=U.fileMeta.size),"object"==typeof U.fileMeta&&(U.fileMeta.contentType.indexOf("audio")||U.fileMeta.contentType.indexOf("image")||U.fileMeta.contentType.indexOf("video"))&&(Me="vis");var Oe="n-vis";Ot&&T.MCK_OL_MAP[U.to]&&10!==U.contentType&&(Oe="vis"),KommunicateUI.handleAttachmentIconVisibility(H,U,!G);var Ne=Kommunicate.isRichTextMessage(U.metadata)||3==U.contentType,Ke=Ne?"vis":"n-vis",Ue=Ne?Kommunicate.getRichTextMessageTemplate(U):"",Re=Kommunicate.getContainerTypeForRichMessage(U),De=Kommunicate.isAttachment(U);U.fileMeta&&U.fileMeta.size&&(U.fileMeta.previewSize=Da.getFilePreviewSize(U.fileMeta.size));var Pe=De?Kommunicate.messageTemplate.getAttachmentContanier(U,Oa.getFilePath(U),Da.getFileAttachment(U),Da.getFileurl(U)):"";if(U.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.ATTACHMENT){de=De?"n-vis":"vis",me=De?me:"n-vis";var Ge=!De||U.fileMeta.url||U.fileMeta.blobKey?"":Kommunicate.messageTemplate.getProgressMeterContanier(U.key)}U.message&&U.contentType!=KommunicateConstants.MESSAGE_CONTENT_TYPE.LOCATION||(ce="n-vis");var Be="vis";G&&0!==eo&&!V&&Oa.isMessageSentByBot(U,P)&&(Be="n-vis"),he&&Ne&&(-1!=Ue.indexOf("km-cta-multi-button-container")||-1!=Ue.indexOf("km-faq-list--footer_button-container")||Re&&-1!=Re.indexOf("km-cta-multi-button-container"))&&(-1!=Ue.indexOf("<button")||-1!=Ue.indexOf("km-list-item-handler"))&&-1==Ue.indexOf("km-link-button")&&(Be+=" contains-quick-replies-only");var Fe=[{kmAttchMsg:ue,msgReply:J?J.message+"\n":"",msgReplyTo:J?ne+"\n":"",msgReplyDivExpr:J?"vis":"n-vis",msgReplyToVisibleExpr:oe,msgPreview:ee?K.getImageForReplyMessage(J):"",msgpreviewvisExpr:ae,textreplyVisExpr:te,msgKeyExpr:U.key,msgDeliveredExpr:U.delivered,msgSentExpr:U.sent,msgCreatedAtTime:U.createdAtTime,msgTypeExpr:U.type,msgDeleteExpr:MCK_LABELS.delete,msgReplyExpr:MCK_LABELS.reply,msgForwardExpr:MCK_LABELS.forward,msgForwardVisibleExpr:"kommunicate"==window.applozic.PRODUCT_ID?"n-vis":"vis",msgSourceExpr:U.source,statusIconExpr:ge,contactExpr:"vis",toExpr:U.to||Tt,msgAvatorClassExpr:Ie,showNameExpr:Ee,msgNameExpr:Ce,msgImgExpr:be,nameTextExpr:_e,msgFloatExpr:ve,msgStatusAriaTag:Te,timeStampExpr:fe,replyIdExpr:ke,createdAtTimeExpr:mckDateUtils.getDate(U.createdAtTime),msgFeatExpr:"n-vis",replyMessageParametersExpr:ye,downloadMediaUrlExpr:Da.getFileAttachment(U),msgClassExpr:ce,msgBoxColor:pe,progressMeterClassExpr:de,attachmentBoxExpr:me,msgExpr:xe,selfDestructTimeExpr:U.timeToLive,fileMetaKeyExpr:U.fileMetaKey,downloadIconVisibleExpr:Me,fileExpr:Oa.getFilePath(U),fileUrlExpr:Da.getFileurl(U),fileNameExpr:we,fileSizeExpr:Le,contOlExpr:Oe,kmRichTextMarkupVisibility:Ke,kmRichTextMarkup:Ue,containerType:Re,emailMsgIndicatorExpr:ie,attachmentTemplate:Pe,progressMeter:Ge,botMsgDelayExpr:Be}];if(G?f.tmpl("messageTemplate",Fe).appendTo("#mck-message-cell .mck-message-inner"):f.tmpl("messageTemplate",Fe).prependTo("#mck-message-cell .mck-message-inner"),U.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.NOTIFY_MESSAGE&&U.metadata&&U.metadata.feedback){var ze=JSON.parse(U.metadata.feedback),He=Ga.getRatingSmilies(ze.rating),$e="";ze.comments&&($e='"'+ze.comments.trim()+'"');var qe=[{ratingSmileSVG:He,ratingComment:$e}];f("."+ke+" .km-conversation-container-right").remove(),f.tmpl("csatModule",qe).appendTo("."+ke+" .blk-lg-12")}if(U.metadata.obsolete&&"true"==U.metadata.obsolete||!U.metadata.KM_AUTO_SUGGESTION)Na.hideAutoSuggestionBoxEnableTxtBox();else{var je={};try{je=JSON.parse(U.metadata.KM_AUTO_SUGGESTION)}catch(U){}ut.addClass("mck-text-box").removeClass("n-vis"),se.removeClass("mck-text-box").addClass("n-vis"),ut.attr("placeholder",je.placeholder?je.placeholder:""),ut.data("prev-msgkey",U.key),xa.resizeTextarea(ut[0]),je.source.constructor==Array?(ut.data("origin","KM_AUTO_SUGGEST"),je.source.length&&Oa.populateAutoSuggest({source:je.source})):"object"==typeof je.source&&(ut.data("source-url",je.source.url),ut.data("method",je.source.method?je.source.method:"get"),ut.data("headers",je.source.headers?je.source.headers:{}))}if(23===U.contentType){if("BUTTON"===U.metadata.msg_type){var Ve=[];if(U.metadata.payload){if(!(Ve=f.parseJSON(U.metadata.payload))[0].hidden)var We="<div style='width: 100px; margin: auto;'><button style='height: 27px;color: #FFF;background-color: #000;border-radius: 10px; width: 100px; margin: 10px;'>"+Ve[0].title+"</button></div>";if(Ve.length>1)for(var Ye=1;Ye<Ve.length;Ye++)Ve[Ye].hidden||(We+="<div style='width: 100px; margin: auto;'><button style='height: 27px;color: #FFF;background-color: #000;border-radius: 10px; width: 100px; margin: 10px;'>"+Ve[Ye].title+"</button></div>");f("div[data-msgkey='"+U.key+"'] .blk-lg-12").after(We)}else We="<div style='width: 100px; margin: auto;'><button style='height: 27px;color: #FFF;background-color: #000;border-radius: 10px; width: 100px; margin: 10px;'>Button</button></div>",f("div[data-msgkey='"+U.key+"'] .blk-lg-12").after(We)}if("INPUT"===U.metadata.msg_type&&"false"===U.metadata.hidden&&(We="<div style='float: left; margin: 13px; width: 100%'><input id='input-for-email' type='text' style='background-color: #FFF;width: 60%;height:35px;' placeholder='Enter your email...'/>",We+="<button id='send-email-button' style='height: 27px; width: 11%;color: #FFF;background-color: #000;border-radius: 0 10px 10px 0;'>Submit</button></div>",f("div[data-msgkey='"+U.key+"'] .blk-lg-12").after(We),f("#send-email-button").click((function(){document.getElementById("input-for-email").value.length>1&&(K.sendUserEmail(),K.updateMetadata(U.key,{hidden:"true"}))}))),"LIST"===U.metadata.msg_type&&(Ve=[],U.metadata.payload)){if(We="",(Ve=f.parseJSON(U.metadata.payload))[0].hidden||("button"===Ve[0].type.toLowerCase()?We="<div style='width: 100px; margin: auto;'><button style='height: 27px;color: #FFF;background-color: #000;border-radius: 10px; width: 100px; margin: 10px;'>"+Ve[0].title+"</button></div>":"input"===Ve[0].type.toLowerCase()&&(We="<div style='float: left; margin: 13px; width: 100%'><input type='text' style='background-color: #FFF;width: 60%;height:35px;' placeholder='Enter your email...'/>",We+="<button style='height: 27px; width: 11%;color: #FFF;background-color: #000;border-radius: 0 10px 10px 0;'>"+Ve[0].title+"</button></div>")),Ve.length>1)for(Ye=1;Ye<Ve.length;Ye++)Ve[Ye].hidden||("button"===Ve[Ye].type.toLowerCase()?We+="<div style='width: 100px; margin: auto;'><button style='height: 27px;color: #FFF;background-color: #000;border-radius: 10px; width: 100px; margin: 10px;'>"+Ve[Ye].title+"</button></div>":"input"===Ve[Ye].type.toLowerCase()&&(We+="<div style='float: left; margin: 13px; width: 100%'><input type='text' style='background-color: #FFF;width: 60%;height:35px;' placeholder='Enter your email...'/>",We+="<button style='height: 27px; width: 11%;color: #FFF;background-color: #000;border-radius: 0 10px 10px 0;'>"+Ve[Ye].title+"</button></div>"));f("div[data-msgkey='"+U.key+"'] .blk-lg-12").after(We)}}var Je="";if(U.message){U.message=Oa.getScriptMessagePreview(U,U.message);var Xe=U.message.replace(/\n/g,"<br/>");null!==T.emoji&&void 0!==T.emoji?(Je=T.emoji.replace_unified(Xe),Je=T.emoji.replace_colons(Je)):Je=Xe}if(U.conversationId){var Ze=le[U.conversationId];if("object"!=typeof Ze&&Ra.getTopicId({conversationId:U.conversationId},(function(f){Oa.populateMessage(f.messageType,f.message,f.notifyUser)})),G&&(Ba.data("mck-conversationid",U.conversationId),Ze)){var ot=re[Ze.topicId];"object"==typeof ot&&(xt?K.setProductProperties(ot,Ze.topicId):Yt&&ua.html(ot.title))}}if(4===U.contentType){var lt=Je;Je="Final agreed price: "+Je,Qe||(Je+='<br/><button class="mck-accept" data-mck-topic-price="'+lt+'" data-mck-conversationid="'+U.conversationId+'">Accept</button>')}var gt=f("."+ke+" .mck-msg-content"),vt=Ga.isMessageContainsUrl(U.message);if(!(window.navigator.userAgent.indexOf("MSIE")>-1||window.navigator.userAgent.match(/Trident.*rv\:11\./))&&0===U.contentType&&vt&&KommunicateUI.getLinkDataToPreview(vt,(function(f){gt.prepend(f)})),-1===Je.indexOf("emoji-inner")&&0===U.contentType){var ft=Je.split("<br/>");for(Ye=0;Ye<ft.length;Ye++){if(""===ft[Ye])var ht=L.createElement("BR");else(ht=L.createElement("div")).appendChild(L.createTextNode(ft[Ye])),ht=f(ht).linkify({target:"_blank"});gt.append(ht)}}else gt.html(Je),gt.linkify({target:"_blank"});Ne&&Kommunicate.richMsgEventHandler.initializeSlick(f("div[data-msgkey='"+U.key+"'] .km-div-slider")),U.fileMeta&&(f("."+ke+" .mck-file-text").removeClass("n-vis").addClass("vis"),""===gt.html()&&gt.removeClass("vis").addClass("n-vis")),2===U.contentType&&(gt.removeClass("vis").addClass("n-vis"),f("."+ke+" .mck-file-text").removeClass("n-vis").addClass("vis")),B&&Ba.animate({scrollTop:Ba.prop("scrollHeight")},"slow"),va.hasClass("n-vis")&&(U.groupId?6!==wa.getGroup(U.groupId).type&&va.removeClass("n-vis").addClass("vis"):va.removeClass("n-vis").addClass("vis")),K.addTooltip(U.key),4!==U.contentType&&10!==U.contentType&&z&&K.messageContextMenu(U.key),U.groupId&&10===U.contentType&&G&&Ma.getGroupFeed({groupId:U.groupId,isReloadTab:!0,apzCallback:La.onGroupFeed}),4===U.source&&f(".mck-msg-box-rich-text-container .km-faq-answer--body_ans").linkify({target:"_blank"}),"function"==typeof q&&q()}},K.addContactForSearchList=function(L,U){var P=L.userCount,G=L.isGroup,B=K.getTabDisplayName(L.contactId,G),z=K.getContactImageLink(L,B),H=(L.contactId,G?"gs-group-"+L.htmlId:"cs-user-"+L.htmlId),q="",V=G&&Bt;f("#li-"+H+" .mck-group-count-text").html(P),G||ne[L.contactId]||(T.MCK_OL_MAP[L.contactId]?q=MCK_LABELS.online:ce[L.contactId]&&(q=mckDateUtils.getLastSeenAtStatus(ce[L.contactId])));var W=[{contHtmlExpr:H,contIdExpr:L.contactId,contTabExpr:L.isGroup,contImgExpr:z,contLastSeenExpr:q,contNameExpr:B,groupUserCountExpr:L.userCount,displayGroupUserCountExpr:V?"vis":"n-vis"}];f.tmpl("searchContactbox",W).prependTo("#"+U)},K.getFilePath=function(T){if(2===T.contentType)try{var L=f.parseJSON(T.message);if(L.lat&&L.lon)return'<a href="https://maps.google.com/maps?z=17&t=m&q=loc:'+L.lat+","+L.lon+'" target="_blank"><img src="https://maps.googleapis.com/maps/api/staticmap?zoom=17&size=200x150&center='+L.lat+","+L.lon+"&maptype=roadmap&markers=color:red|"+L.lat+","+L.lon+"&key="+gt+'"/></a>'}catch(f){if(-1!==T.message.indexOf(","))return'<a href="https://maps.google.com/maps?z=17&t=m&q=loc:'+T.message+'" target="_blank"><img src="https://maps.googleapis.com/maps/api/staticmap?zoom=17&size=200x150&center='+T.message+"&maptype=roadmap&markers=color:red|"+T.message+"&key="+gt+'" /></a>'}if("object"==typeof T.fileMeta){if(-1!==T.fileMeta.contentType.indexOf("image")){if(-1!==T.fileMeta.contentType.indexOf("svg"))return'<a href="#" target="_self"  role="link" class="file-preview-link fancybox-media fancybox-kommunicate" data-type="'+T.fileMeta.contentType+'" data-url="'+Da.getFileurl(T)+'" data-name="'+Ga.formatHtmlTag(T.fileMeta.name)+'"><img src="'+Ne+"/rest/ws/aws/file/"+T.fileMeta.blobKey+'" area-hidden="true"></img></a>';if(5===T.contentType)return'<a href="#" target="_self"  role="link" class="file-preview-link fancybox-media fancybox-kommunicate" data-type="'+T.fileMeta.contentType+'" data-url="'+T.fileMeta.blobKey+'" data-name="'+Ga.formatHtmlTag(T.fileMeta.name)+'"><img src="'+T.fileMeta.blobKey+'" area-hidden="true"></img></a>';if(T.fileMeta.hasOwnProperty("url")){var K;if(-1!==T.fileMeta.url.indexOf("www.googleapis.com"))return Da.generateCloudUrl(T.fileMeta.thumbnailBlobKey,(function(f){K=f})),'<a href="#" target="_self"  role="link" class="file-preview-link fancybox-media fancybox-kommunicate" data-type="'+T.fileMeta.contentType+'" data-url="" data-blobKey="'+T.fileMeta.blobKey+'" data-name="'+Ga.formatHtmlTag(T.fileMeta.name)+'"><img src="'+K+'" area-hidden="true" ></img></a>';var U=T.fileMeta.name,P=!1;return Oa.isFileEncryptedImage(T.fileMeta)&&(U=U.replace("AWS-ENCRYPTED-",""),P=!0),'<a href="#" target="_self"  role="link" class="file-preview-link fancybox-media fancybox-kommunicate" data-type="'+T.fileMeta.contentType+'" data-url="'+Da.getFileurl(T)+'" data-name="'+Ga.formatHtmlTag(U)+'"><img'+(P?' class="lazy-image"':"")+' src="'+T.fileMeta.thumbnailUrl+'" area-hidden="true" data-blobKey="'+T.fileMeta.blobKey+'" data-thumbnailBlobKey="'+T.fileMeta.thumbnailBlobKey+'" ></img></a>'}return T.fileMeta.thumbnailUrl==="thumbnail_"+T.fileMeta.name?'<a href="#" target="_self"  role="link" class="file-preview-link fancybox-media fancybox-kommunicate" data-type="'+T.fileMeta.contentType+'" data-url="'+Da.getFileurl(T)+'" data-name="'+Ga.formatHtmlTag(T.fileMeta.name)+'"><img src="'+Ce+"/files/thumbnail_"+T.fileMeta.name+'" area-hidden="true" ></img></a>':'<a href="#" target="_self"  role="link" class="file-preview-link fancybox-media fancybox-kommunicate" data-type="'+T.fileMeta.contentType+'" data-url="'+Da.getFileurl(T)+'" data-name="'+Ga.formatHtmlTag(T.fileMeta.name)+'"><img src="'+T.fileMeta.thumbnailUrl+'" area-hidden="true" ></img></a>'}return-1!==T.fileMeta.contentType.indexOf("video")?'<video controls class="mck-video-player"><source src="'+Da.getFileurl(T)+'" type="video/mp4"><source src="'+Da.getFileurl(T)+'" type="video/ogg"></video>':-1!==T.fileMeta.contentType.indexOf("audio")?'<a href="#" target="_self" ><audio controls class="mck-audio-player"><source src="'+Da.getFileurl(T)+'" type="audio/ogg"><source src="'+Da.getFileurl(T)+'" type="audio/mpeg"></audio><p class="mck-file-tag"></p></a>':'<a href="#" role="link" class="file-preview-link" target="_blank"></a>'}return""},K.getImageForMessagePreview=function(T){if("object"==typeof T.fileMeta)return-1!==T.fileMeta.contentType.indexOf("image")?'<span>photo</span> <img src="'+Ne+"/rest/ws/aws/file/"+T.fileMeta.blobKey+'" class="mck-image-reply move-right"/>':-1!==T.fileMeta.contentType.indexOf("audio")?'<span>audio</span><span class="mck-file-detail move-right"><span class="mck-file-name"><span class="mck-icon-attachment"></span>&nbsp;'+T.fileMeta.name+'</span>&nbsp;<span class="file-size">'+Da.getFilePreviewSize(T.fileMeta.size)+"</span></span>":'<span class="mck-file-detail move-right"><span class="mck-file-name"><span class="mck-icon-attachment"></span>&nbsp;'+T.fileMeta.name+'</span>&nbsp;<span class="file-size">'+Da.getFilePreviewSize(T.fileMeta.size)+"</span></span>";if(2===T.contentType){var L=f.parseJSON(T.message);return'<span>location</span><img src="https://maps.googleapis.com/maps/api/staticmap?zoom=17&size=200x150&center='+L.lat+","+L.lon+"&maptype=roadmap&markers=color:red|"+L.lat+","+L.lon+'" class="mck-image-reply move-right"/>'}},K.getImageForReplyMessage=function(T){var L=Oa.getTabDisplayName(T.to,!1);if("object"==typeof T.fileMeta)return-1!==T.fileMeta.contentType.indexOf("image")?'<div><div class="mck-imagereply mck-margin"><div class="mck-msgto">'+L+'</div><div><span class="mck-icon-camera mck-camera"></span><span>Photo</span></div></div><div class="mck-imagereply"><img src="'+Da.getFileurl(T)+'" class="mck-image-reply mck-msg-text mck-msg-content"/></div></div>':-1!==T.fileMeta.contentType.indexOf("audio")?'<div class="mck-attachmentmsgto">'+L+'</div><span class="mck-file-detail mck-msg-text mck-msg-content"><span class="mck-file-name"><span class="mck-icon-attachment"></span>&nbsp;'+T.fileMeta.name+'</span>&nbsp;<span class="file-size">'+Da.getFilePreviewSize(T.fileMeta.size)+"</span></span>":'<div class="mck-attachmentmsgto">'+L+'</div><span class="mck-file-detail"><span class="mck-file-name"><span class="mck-icon-attachment"></span>&nbsp;'+T.fileMeta.name+'</span>&nbsp;<span class="file-size">'+Da.getFilePreviewSize(T.fileMeta.size)+"</span></span>";if(2===T.contentType){var K=f.parseJSON(T.message);return'<div><div class="mck-imagereply mck-margin"><div class="mck-msgto">'+L+'</div><span class="mck-icon-marker mck-location-icon"></span><span>Location</span></div><div class="mck-imagereply"><img src="https://maps.googleapis.com/maps/api/staticmap?zoom=17&size=200x150&center='+K.lat+","+K.lon+"&maptype=roadmap&markers=color:red|"+K.lat+","+K.lon+'" class="mck-image-reply mck-msg-text "/></div></div>'}},K.getImageUrlForGroupType=function(f,T){var L=T?Ga.formatHtmlTag(T)+" profile image":"Profile image";return f.imageUrl?'<img src="'+f.imageUrl+'" alt="'+L+'"/>':K.getContactImageByAlphabet(T)},K.getContactImageLink=function(f,T,L){var U="",P=T?Ga.formatHtmlTag(T)+" profile image":"Profile image";if(f.isGroup||f.photoSrc||f.photoData||f.photoLink||!za.MCK_USER_DETAIL_MAP[f.contactId]||!za.MCK_USER_DETAIL_MAP[f.contactId].imageLink||(f.photoSrc=za.MCK_USER_DETAIL_MAP[f.contactId].imageLink),f.members&&10==f.type)U=L&&L.senderName&&za.MCK_USER_DETAIL_MAP[L.senderName]&&za.MCK_USER_DETAIL_MAP[L.senderName].imageLink?'<img src="'+za.MCK_USER_DETAIL_MAP[L.senderName].imageLink+'" alt="'+P+'"/>':K.getImageUrlForGroupType(f,T);else if(f.isGroup&&7!==f.type)U=Ma.getGroupImage(f.imageUrl);else{if(f.isGroup&&7===f.type&&f.members.length>1&&Ma.getContactFromGroupOfTwo(f,(function(T){f=Oa.fetchContact(T)})),"function"==typeof Je){var G=Je(f.contactId);G&&void 0!==G&&(U='<img src="'+G+'"/>')}U||(f.photoSrc?U='<img src="'+f.photoSrc+'" alt="'+P+'"/>':f.photoData?U='<img src="data:image/jpeg;base64,'+f.photoData+'" alt="'+P+'"/>':f.photoLink?U='<img src="'+MCK_BASE_URL+"/contact.image?photoLink="+f.photoLink+'" alt="'+P+'"/>':"bot"==f.contactId?U='<img src="https://cdn.kommunicate.io/kommunicate/bot_default_image.png" alt="'+P+'"/>':(T||(T=f.displayName),U=K.getContactImageByAlphabet(T)))}return U},K.getContactImageByAlphabet=function(f){if(void 0===f||""===f)return'<div class="mck-alpha-contact-image mck-alpha-user"><span class="mck-icon-user"></span></div>';var T=f.charAt(0);return T.match(/^[a-zA-Z0-9]+$/)?'<div class="mck-videocall-image alpha_'+(T=T.toUpperCase())+'"><span class="mck-contact-icon">'+T+"</span></div>":'<div class="mck-videocall-image alpha_user"><span class="mck-icon-user"></span></div>'},K.getNameTextClassByAlphabet=function(f){if(void 0===f||""===f)return"mck-text-user";var T=(f=f.toString()).charAt(0);return T.match(/^[a-zA-Z0-9]+$/)?"mck-text-"+(T=T.toLowerCase()):"mck-text-user"},K.addContactsFromMessageList=function(T,L){var U;if(T+""!="null"){if(0==Ba.has(f("#mck-contact-list")).length&&Ba.html('<ul id="mck-contact-list" class="mck-contact-list mck-nav mck-nav-tabs mck-nav-stacked"></ul>'),void 0===T.message.length?(T.message.groupId?Ma.addGroupFromMessage(T.message,!1,(function(f,T,L){K.updateRecentConversationList(f,T,L)})):K.addContactsFromMessage(T.message),U=T.message.createdAtTime):f.each(T.message,(function(f,T){void 0!==T.to&&(T.groupId?Ma.addGroupFromMessage(T,!0,(function(f,T,L){K.updateRecentConversationList(f,T,L)})):K.addContactsFromMessage(T,!0),U=T.createdAtTime)})),Ba.data("datetime",U),L.isReload){var P="";if(L.lastActiveTabId){var G=L.isLastActiveTabGroup?"group-"+L.lastActiveTabId:"user-"+mckContactUtils.formatContactId(L.lastActiveTabId);P=f("#li-"+G)}P.length>0?Ba.animate({scrollTop:P.offset().top-Ba.offset().top+Ba.scrollTop()},"fast"):Ba.animate({scrollTop:0},0)}}else U=""},K.addGroupFromMessageList=function(T,L){T+""!="null"&&(L&&Ba.html('<ul id="mck-group-list" class="mck-contact-list mck-nav mck-nav-tabs mck-nav-stacked"></ul>'),void 0===T.message.length?Ma.addGroupFromMessage(T.message,!1,(function(f,T,L){K.updateRecentConversationList(f,T,L)})):f.each(T.message,(function(f,T){void 0!==T.to&&Ma.addGroupFromMessage(T,!0,(function(f,T,L){K.updateRecentConversationList(f,T,L)}))})))},K.createContact=function(f){var T=K.getContactDisplayName(f);void 0===T&&(T=f);var L={contactId:f,htmlId:mckContactUtils.formatContactId(f),displayName:T,name:T+" <"+f+"> [Main]",value:f,photoLink:"",photoSrc:"",photoData:"",email:"",unsaved:!0,isGroup:!1};return te[f]=L,L},K.createContactWithDetail=function(f){var T=f.displayName,L=f.userId;T||(T=K.getContactDisplayName(L)),void 0===T?T=L:Ca[L]=T;var U=f.photoLink?f.photoLink:"";U||(U=f.imageLink?f.imageLink:"");var P=f.imageData?f.imageData:"",G={contactId:L,htmlId:mckContactUtils.formatContactId(L),displayName:T,name:T+" <"+L+"> [Main]",value:L,photoLink:"",photoSrc:U,photoData:P,email:"",unsaved:!0,isGroup:!1,roleType:f.roleType};return te[L]=G,G},K.updateContactDetail=function(f,T){var L=T.displayName,U=T.userId;f.displayName&&f.displayName!==f.contactId||(L||(L=K.getContactDisplayName(U)),void 0===L?L=U:Ca[U]=L,f.displayName=L);var P=T.photoLink;P||(P=T.imageLink?T.imageLink:""),P&&!f.photoSrc&&(f.photoSrc=P);var G=T.imageData?T.imageData:"";return G&&!f.photoData&&(f.photoData=G),T.roleType&&(f.roleType=T.roleType),te[U]=f,f},K.addContactsFromMessage=function(f,T){var L=K.getUserIdFromMessage(f);if(L.length>0&&L[0])for(var U=0;U<L.length;U++){var P=K.fetchContact(""+L[U]);K.updateRecentConversationList(P,f,T)}},K.updateRecentConversationList=function(T,L,U){if(!L||!L.metadata||!L.metadata.KM_ASSIGN&&!L.metadata.KM_STATUS){var P="mck-contact-list",G=T.isGroup?"group-"+T.htmlId:"user-"+T.htmlId;f("#"+P+" #li-"+G).length>0?(f("#"+P+" #li-"+T.htmlId+" .mck-cont-msg-wrapper").is(":empty")||U)&&void 0!==L&&K.updateContact(T,L,P):K.addContact(T,P,L),KommunicateUI.handleConversationBanner()}},K.addContactsToSearchList=function(){var T=[],L=[];if(f.each(ka,(function(f,T){L.push(T.contactId)})),"undefined"!=typeof contactList){var U={async:!1};U.userIds=contactList,Ka.getUsersDetail(U.userIds,U),L=contactList}var P=L.filter((function(f,T){return L.indexOf(f)===T}));P.sort(),Qt.removeClass("vis").addClass("n-vis"),P.length>0?f.each(P,(function(L,U){if(U){var P=K.fetchContact(""+U);T.push(P),0===f("#li-cs-user-"+P.htmlId).length&&K.addContactForSearchList(P,"mck-contact-search-list")}})):ht.removeClass("n-vis").addClass("vis"),K.initAutoSuggest({contactsArray:T,$searchId:lt,isContactSearch:!0})},ut.on("keyup",(function(f){Na.toggleMediaOptions(this),se.text(ut.val()),"block"!==document.querySelector("ul.mcktypeahead.mck-auto-suggest-menu").style.display&&13===f.keyCode&&(f.preventDefault(),se.submit(),Oa.clearMessageField(!0))})),K.populateAutoSuggest=function(f){ut.mcktypeahead({order:"desc",hint:!1,minLength:2,wrapper:".mck-box-form",backdropOnFocus:!0,menu:'<ul class="mcktypeahead mck-auto-suggest-menu mck-dropup-menu"></ul>',show:function(){var f=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({left:f.left}),this.$menu.show(),this.shown=!0,this},source:f&&f.source?K.processAutosuggestData(f.source):function(T,L){Ta.ajax({url:f.sourceUrl+T,type:f.method,header:f.headers,success:function(f){var T=K.processAutosuggestData(f.data);L(T)}})},items:8,highlight:!0,updater:function(f){var T=JSON.parse(f);return 0!=Object.keys(T.metadata).length&&ft.val(JSON.stringify(T.metadata)),se.text(T.displayMessage),ut.on("keydown",(function(f){se.text(ut.val()),13===f.which&&T.displayMessage&&(f.preventDefault(),se.submit(),Oa.clearMessageField(!0)),9===f.which&&(ut.focus(),f.preventDefault())})),T.displayMessage},matcher:function(f){return new RegExp(this.query,"i").test(f.searchKey)},highlighter:function(f){return JSON.parse(f.toString()).displayMessage}}),f&&f.source&&(ut.mcktypeahead().data("mcktypeahead").source=K.processAutosuggestData(f.source)),ut.focus()},K.processAutosuggestData=function(f){var T=new Array;return f.map((function(f){var L="string"==typeof f?{searchKey:f,message:f,metadata:{}}:f,K={searchKey:L.searchKey,toString:function(){var f={displayMessage:L.message,metadata:L.metadata?L.metadata:{}};return JSON.stringify(f)},toLowerCase:function(){return L.searchKey.toLowerCase()},indexOf:function(f){return String.prototype.indexOf.apply(L.searchKey,arguments)},replace:function(f){var T=L.searchKey;return String.prototype.replace.apply('<div style="padding: 10px; font-size: 1.5em;">'+T+"</div>",arguments)}};T.push(K)})),T},K.initAutoSuggest=function(T){for(var L,U=T.contactsArray,P=T.$searchId,G=[],B={},z=[],H=0;H<U.length;H++){var q=U[H];q.displayName=K.getTabDisplayName(q.contactId,q.isGroup),L=q.displayName?f.trim(q.displayName):f.trim(q.contactId),(!0===MCK_SELF_CHAT_DISABLE&&q.contactId!==Tt||!0!==MCK_SELF_CHAT_DISABLE)&&(B[L]=q,G.push(L),z.push(L))}var d=function(f){var T=B[f],L=T.displayName.split(" "),K=L.length,U=L[0],P="",G="";2===K?G=L[1]:K>=3&&(G=L[K-1],P=L[K-2]);var z=new RegExp(this.query,"i");return z.test(T.displayName)||z.test(T.contactId)||z.test(P)||z.test(G)||z.test(T.email)||z.test(U+" "+G)},u=function(f){return B[f].displayName},p=function(L){var K=B[L];T.isContactSearch?(Oa.loadTab({tabId:K.contactId,isGroup:K.isGroup}),fa.removeClass("n-vis").addClass("vis"),f("#mck-sidebox-ft").removeClass("n-vis").addClass("n-vis")):La.addGroupMemberFromSearch(K.contactId)};if(P.hasClass("mck-typeahead"))return P.mcktypeahead().data("mcktypeahead").source=G,P.mcktypeahead().data("mcktypeahead").matcher=d,P.mcktypeahead().data("mcktypeahead").highlighter=u,void(P.mcktypeahead().data("mcktypeahead").updater=p);P.addClass("mck-typeahead"),P.mcktypeahead({source:G,matcher:d,highlighter:u,updater:p})},K.initSearchAutoType=function(){Zt&&(lt.keypress((function(f){if(13===f.which){var T=lt.val();T&&(!0===MCK_SELF_CHAT_DISABLE&&T!==Tt||!0!==MCK_SELF_CHAT_DISABLE)&&(T=void 0!==T&&""!==T?T.toString():"")&&(Oa.loadTab({tabId:T,isGroup:!1,isSearch:!0}),fa.removeClass("n-vis").addClass("vis")),lt.val("")}})),je.keypress((function(f){if(13===f.which)return!0})),f(L).on("click",".mck-group-search-link",(function(f){return f.preventDefault(),!0})),f(L).on("click",".mck-contact-search-link",(function(T){T.preventDefault();var L=lt.val();""!==L&&(!0===MCK_SELF_CHAT_DISABLE&&L!==Tt||!0!==MCK_SELF_CHAT_DISABLE)&&(Oa.loadTab({tabId:L,isGroup:!1,isSearch:!0}),fa.removeClass("n-vis").addClass("vis"),f("#mck-sidebox-ft").removeClass("n-vis").addClass("vis")),lt.val("")})))},K.removeContact=function(T){var L=T.isGroup?"group-"+T.htmlId:"user-"+T.htmlId;f("#li-"+L).remove()},K.updateContact=function(T,L,U){var P=T.isGroup?"group-"+T.htmlId:"user-"+T.htmlId,G=f("#li-"+P),B=G.data("msg-time");if((!L.metadata||!L.metadata.action)&&L&&L.createdAtTime>B){var z=L.groupId?"group_"+T.contactId:"user_"+T.contactId,H=K.getUnreadCount(z),q=K.getMessageTextForContactPreview(L,T);if(L&&L.metadata&&L.metadata.feedback&&(q=MCK_LABELS.you+" "+q),void 0===q)return;f("#li-"+P+" .mck-cont-msg-date").html(void 0===L.createdAtTime?"":Ga.getTimeOrDate(L?L.createdAtTime:"",!0));var V=f("#li-"+P+" .mck-cont-msg-wrapper");if(V.html(""),"object"==typeof q?V.append(q):V.html(q),L.conversationId){var W=L.conversationId,J=le[W];if("object"==typeof J){var ee=J.topicId;if(ee&&Yt){var te=re[ee];"object"==typeof te&&f("#li-"+P+" .mck-conversation-topic").html(te.title)}}f("#li-"+P+" a").data("mck-conversationid",W)}H>0&&(f("#li-"+P+" .mck-unread-count-text").html(H),f("#li-"+P+" .mck-unread-count-box").removeClass("n-vis").addClass("vis"));var ae=f("#"+U+" li:nth-child(1)").data("msg-time");G.data("msg-time",L.createdAtTime),(void 0===ae||(L?L.createdAtTime:"")>=ae)&&0!==f("#mck-contact-list li").index(G)&&f("#"+U+" li:nth-child(1)").before(G)}},K.clearContactMessageData=function(T,L){var K=mckContactUtils.formatContactId(T),U=L?"group-"+K:"user-"+K;f("#li-"+U+" .mck-cont-msg-date").html(""),f("#li-"+U+" .mck-cont-msg-wrapper").html("")},K.addContact=function(L,U,P){var G=K.getMessageTextForContactPreview(P,L),B=L.userCount,z="",H=!1;if(void 0!==P){if(P.conversationId){z=P.conversationId;var q=le[z]}P.groupId&&(H=!0)}var V=K.getTabDisplayName(L.contactId,H),W="",J=!1;L&&L.metadata&&L.metadata.CONVERSATION_STATUS==Kommunicate.conversationHelper.status.WAITING?(V=MCK_LABELS["waiting.queue.message"]["contact.name"],W='<div class="mck-videocall-image alpha_W"><span class="mck-contact-icon">...</span></div>',J=!0):W=K.getContactImageLink(L,V);var ee=!1,te=H?"group_"+L.contactId:"user_"+L.contactId,ae=K.getUnreadCount(te),ie=ae>0&&"mck-search-list"!==U?"vis":"n-vis",se="n-vis",ce=H?"group-"+L.htmlId:"user-"+L.htmlId,de=H&&Bt,me=L&&L.metadata&&L.metadata.CONVERSATION_STATUS==Kommunicate.conversationHelper.status.CLOSED?"mck-conversation-resolved":"mck-conversation-open";if(f("#li-"+ce+" .mck-group-count-text").html(B),f("#li-"+ce+" .mck-group-count-box").removeClass("n-vis").addClass("vis"),H||ne[L.contactId]||oe[L.contactId]||!Ot||!T.MCK_OL_MAP[L.contactId]||(se="vis",ee=!0),7===L.type&&L.members.length>1){var ue,pe=wa.getGroup(P.groupId);Ma.getContactFromGroupOfTwo(pe,(function(f){ue=Oa.fetchContact(f)})),H&&Ot&&T.MCK_OL_MAP[ue.contactId]&&(se="vis",ee=!0)}var ge="n-vis";if("object"==typeof q&&Yt){var ve=re[q.topicId];if("object"==typeof ve){ge="vis";var fe=ve.title}}var he=[{contHtmlExpr:ce=H?"group-"+L.htmlId:"user-"+L.htmlId,contIdExpr:L.contactId,contTabExpr:H,msgCreatedAtTimeExpr:P?P.createdAtTime:"",mckLauncherExpr:Se,contImgExpr:W,contOlExpr:se,onlineLabel:MCK_LABELS.online,contUnreadExpr:ie,contUnreadCount:ae,contNameExpr:V,conversationExpr:z,contHeaderExpr:ge,titleExpr:fe,groupUserCountExpr:H?L.userCount:"",displayGroupUserCountExpr:de?"vis":"n-vis",msgCreatedDateExpr:P?Ga.getTimeOrDate(P.createdAtTime,!0):"",conversationStatusClass:me,isConversationInWaitingQueue:J}],ke=f("#"+U+" li:nth-child(1)").data("msg-time");void 0===ke||(P?P.createdAtTime:"")>=ke||-1!==U.indexOf("search")&&ee?f.tmpl("contactTemplate",he).prependTo("#"+U):(f.tmpl("contactTemplate",he).appendTo("#"+U),KommunicateUI.checkSingleThreadedConversationSettings(!0));var ye=f("#li-"+ce+" .msgTextExpr");G=K.getScriptMessagePreview(P,G),P&&P.metadata&&P.metadata.feedback&&(G=MCK_LABELS.you+" "+G),Ga.isObject(G)?ye.append(G):ye.html(G),void 0===G&&ye.html("")},K.addContactsToContactSearchList=function(){ht.removeClass("vis").addClass("n-vis"),Fe.removeClass("vis").addClass("n-vis"),ot.hasClass("active")||(Ct.removeClass("active"),ot.addClass("active")),$e.removeClass("vis").addClass("n-vis"),Ye.removeClass("n-vis").addClass("vis"),We.removeClass("vis").addClass("n-vis"),xe.removeClass("n-vis").addClass("vis"),Ye.html(""),Xe.removeClass("vis").addClass("n-vis"),la.removeClass("vis").addClass("n-vis"),De.removeClass("vis").addClass("n-vis"),He.removeClass("vis").addClass("n-vis"),Et.removeClass("n-vis").addClass("vis"),Qt.removeClass("n-vis").addClass("vis"),0!==ka.length?Oa.addContactsToSearchList():Jt?(Qt.removeClass("vis").addClass("n-vis"),ht.removeClass("n-vis").addClass("vis")):Ka.loadContacts(),lt.focus()},K.addGroupsToGroupSearchList=function(){var T=[],L=[];if(ht.removeClass("vis").addClass("n-vis"),Fe.removeClass("vis").addClass("n-vis"),Ge.hasClass("active")||(Ct.removeClass("active"),Ge.addClass("active")),Ye.removeClass("vis").addClass("n-vis"),$e.removeClass("n-vis").addClass("vis"),xe.removeClass("vis").addClass("n-vis"),We.removeClass("n-vis").addClass("vis"),$e.html(""),Xe.removeClass("vis").addClass("n-vis"),la.removeClass("vis").addClass("n-vis"),De.removeClass("vis").addClass("n-vis"),He.removeClass("vis").addClass("n-vis"),Et.removeClass("n-vis").addClass("vis"),Qt.removeClass("n-vis").addClass("vis"),ha.length>0){f.each(ha,(function(f,T){L.push(T.contactId)}));var U=L.filter((function(f,T){return L.indexOf(f)===T}));U.sort(),f.each(U,(function(L,U){if(U){var P=wa.getGroup(""+U);T.push(P),0===f("#li-gs-group-"+P.htmlId).length&&K.addContactForSearchList(P,"mck-group-search-list")}}))}else Fe.removeClass("n-vis").addClass("vis");K.initAutoSuggest({contactsArray:T,$searchId:je,isContactSearch:!0}),Qt.removeClass("vis").addClass("n-vis")},K.addConversationMenu=function(T,L){var K=Ba.data("mck-id");if(ga.html(""),T===K){var U=Ea[T];if(void 0===U||0===U.length||1===U.length)return Me.addClass("n-vis"),_e.addClass("mck-product-box-wc"),void ga.addClass("n-vis");ga.removeClass("n-vis"),Me.removeClass("n-vis"),_e.removeClass("mck-product-box-wc"),f.each(U,(function(K,U){if(0===f("#mck-conversation-list #li-"+U.id).length){var P="";if(U.topicDetail){var G=f.parseJSON(U.topicDetail);P="object"==typeof G?G.title:U.topicDetail}P||(P=U.topicId);var B=[{convIdExpr:U.id,tabIdExpr:T,isGroupExpr:L,topicIdExpr:U.topicId,convTitleExpr:P,mckLauncherExpr:Se}];f.tmpl("convTemplate",B).appendTo(ga)}})),f("#mck-conversation-list li").length<2&&(Me.addClass("n-vis"),_e.addClass("mck-product-box-wc"),ga.addClass("n-vis"))}},K.loadContacts=function(T){T+""!="null"&&void 0!==T&&void 0!==T.contacts&&0!==T.contacts.length&&(ka.length=0,_a.length=0,f.each(T.contacts,(function(f,T){if(void 0!==T.userId){var L=K.getContact(""+T.userId);L=void 0===L?K.createContactWithDetail(T):K.updateContactDetail(L,T),ka.push(L),_a.push(L.contactId)}})))},K.loadContactsForContactList=function(f){var L=f.startIndex?f.startIndex:"0",K=f.pageSize?f.pageSize:"50",U=MCK_BASE_URL+"/rest/ws/user/filter?startIndex="+L+"&pageSize="+K+"&orderBy=1";window.Applozic.ALApiService.ajax({url:U,type:"get",global:!1,encryptionKey:window.Applozic.ALApiService.getEncryptionKey(),success:function(f){},error:function(){T.console.log("Unable to load contacts. Please reload page.")}})},K.getStatusIcon=function(f){return'<span class="'+K.getStatusIconName(f)+" move-right "+f.key+'_status status-icon"></span>'},K.getStatusIconName=function(f){return Kommunicate.internetStatus||1!==f.contentType?7===f.type||6===f.type||4===f.type||0===f.type?"":5===f.status?"mck-read-icon":4===f.status?"mck-delivered-icon":3===f.type||5===f.type||1===f.type&&(0===f.source||1===f.source)?"mck-sent-icon":"":"mck-failed-text"},K.clearMessageField=function(f){se.html(""),de.removeClass("mck-text-req"),ee.attr("disabled",!1),W.removeClass("vis").removeClass("mck-text-req").addClass("n-vis").attr("required","").html("");var T="true"===document.getElementById("mck-text-box").getAttribute("data-quick-reply");f&&!T?se.focus().select():(G.blur(),se.blur()),document.getElementById("mck-text-box").setAttribute("data-quick-reply",!1),document.getElementById("mck-char-warning")&&document.getElementById("mck-char-warning").classList.add("n-vis")},K.addDraftMessage=function(T){if(J=[],T&&"object"==typeof ya[T]){var L=ya[T];se.html(L.text),L.files.length>0&&(f.each(L.files,(function(f,T){xa.addFileBox(T)})),z.html(L.filelb),H.html(L.filesize),W.removeClass("n-vis").removeClass("mck-text-req").addClass("vis").removeAttr("required"))}else J=[]},K.showOfflineMessage=function(){"object"==typeof Ze&&Ze.innerHTML?(Pa.html(Ze.innerHTML),Pa.removeClass("n-vis").addClass("vis")):T.console.log("Offline message innerHTML required.")},K.hideOfflineMessage=function(){Ia.stopOfflineMessageCounter(),Pa.removeClass("vis").addClass("n-vis")},K.removeConversationThread=function(T,L){ALStorage.clearMckMessageArray();var K=L?wa.getGroup(T):Oa.getContact(T),U=Ba.data("mck-id"),P=Ba.data("isgroup");if(void 0===U||""===U){var G=void 0!==K?K.htmlId:mckContactUtils.formatContactId(T);f("#li-"+(L?"group-"+G:"user-"+G)).remove()}else U===T&&P===L&&(da.data("datetime",""),ye.removeClass("n-vis").addClass("vis"),va.removeClass("vis").addClass("n-vis"))},K.removedDeletedMessage=function(T,L,K){ALStorage.clearMckMessageArray();var U=f("."+T);U.length>0?(U.remove(),Ba.is(":empty")&&(ye.removeClass("n-vis").addClass("vis"),va.removeClass("vis").addClass("n-vis"))):void 0!==L&&f("#mck-contact-list").length>0&&Ra.updateContactList(L,K)},K.getScriptMessagePreview=function(f,T){return f&&f.message&&f.contentType!==KommunicateConstants.MESSAGE_CONTENT_TYPE.LOCATION&&f.contentType!==KommunicateConstants.MESSAGE_CONTENT_TYPE.TEXT_HTML&&!Kommunicate.isRichTextMessage(f.metadata)&&"string"==typeof T&&-1===T.indexOf("emoji-inner")&&(T=Ga.formatHtmlTag(T)),T},K.getMessageTextForContactPreview=function(f,K){var U="";if(void 0!==f){if(f.message){if("true"===f.metadata.hide)return;if(f.metadata&&(f.metadata.KM_ASSIGN||f.metadata.KM_STATUS))return;if(f.contentType===KommunicateConstants.MESSAGE_CONTENT_TYPE.LOCATION)U='<span class="mck-icon--location"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="rgba(38,50,56,.52)"/><path d="M0 0h24v24H0z" fill="none"/></svg></span><span>Location</span>';else if(f.contentType===KommunicateConstants.MESSAGE_CONTENT_TYPE.TEXT_HTML&&f.source===KommunicateConstants.MESSAGE_SOURCE.MAIL_INTERCEPTOR){var P=f.message.match(/<b>(.*?)<\/b>/g).map((function(f){return f.replace(/<\/?b>/g,"")})),G='<span class="mck-icon--email"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-.4 4.25l-6.54 4.09c-.65.41-1.47.41-2.12 0L4.4 8.25c-.25-.16-.4-.43-.4-.72 0-.67.73-1.07 1.3-.72L12 11l6.7-4.19c.57-.35 1.3.05 1.3.72 0 .29-.15.56-.4.72z" fill="rgba(38,50,56,.52)"/></svg>';U=P?G+P[0]:G+"</span><span>Email</span>"}else{var B=f.message;if(Ta.startsWith(B,"<img"))return'<span class="mck-icon--camera"><svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3.2" fill="rgba(38,50,56,.52)"/><path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z" fill="rgba(38,50,56,.52)"/><path d="M0 0h24v24H0z" fill="none"/></svg></span><span>image</span>';null!==T.emoji&&void 0!==T.emoji?(U=T.emoji.replace_unified(B),U=-1!==(U=T.emoji.replace_colons(U)).indexOf("</span>")?U.substring(0,U.lastIndexOf("</span>")):U):U=B,K.isGroup||-1===U.indexOf("emoji-inner")&&f.contentType===KommunicateConstants.MESSAGE_CONTENT_TYPE.DEFAULT&&((H=L.createElement("p")).appendChild(L.createTextNode(U)),U=H)}}else f.fileMetaKey&&"object"==typeof f.fileMeta?U=Da.getFileIcon(f):f.metadata&&f.metadata.messagePreview&&(U=f.metadata.messagePreview);if(Kommunicate.isRichTextMessage(f.metadata)||f.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.TEXT_HTML){var z=f.message;f.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.TEXT_HTML&&(z=""),U='<span class="mck-icon--rich-message">'+KommunicateConstants.RICH_MESSAGE_ICON+"</span><span>"+(z||MCK_LABELS["rich.message"]["notification.preview"])+"</span>"}if(K.isGroup&&K.type!==KommunicateConstants.GROUP_TYPE.SELLER&&K.type!==KommunicateConstants.GROUP_TYPE.GROUP_OF_TWO){var H,q=f.to.split(",")[0]===Tt?"Me":Oa.getTabDisplayName(f.to.split(",")[0],!1);f.contentType!==KommunicateConstants.MESSAGE_CONTENT_TYPE.NOTIFY_MESSAGE&&K.type!==KommunicateConstants.GROUP_TYPE.SUPPORT&&(U=q+": "+U),-1===U.indexOf("emoji-inner")&&f&&f.message&&f.contentType===KommunicateConstants.MESSAGE_CONTENT_TYPE.DEFAULT&&!Kommunicate.isRichTextMessage(f.metadata)&&((H=L.createElement("p")).appendChild(L.createTextNode(U)),U=H)}}return U},K.getTextForMessagePreview=function(T,K){var U="";if(void 0!==T){if(2===T.contentType)U="Shared location";else if(T.message){var P=T.message;if(Ta.startsWith(P,"<img"))U="Image attachment";else{var G=L.createElement("div");G.innerHTML=P,U=(P=f.trim(Ta.textVal(G))).substring(0,50)}}else T.fileMetaKey&&"object"==typeof T.fileMeta&&(U=-1!==T.fileMeta.contentType.indexOf("image")?"Image attachment":"File attachment");K.isGroup&&3!==K.type&&7!==K.type&&(U=(T.to.split(",")[0]===Tt?"Me":Oa.getTabDisplayName(T.to.split(",")[0],!1))+": "+U)}return U},K.getUserIdFromMessage=function(f){var T=f.to;return T.lastIndexOf(",")===T.length-1&&(T=T.substring(0,T.length-1)),T.split(",")},K.getUserIdArrayFromMessageList=function(T){var L=new Array;return void 0===T.length?L.concat(K.getUserIdFromMessage(T)):f.each(T,(function(f,T){void 0!==T.to&&(L=L.concat(K.getUserIdFromMessage(T)))})),L},K.messageContextMenu=function(T){var L=f("."+T+" .mck-msg-box");L.addEventListener&&L.addEventListener("contextmenu",(function(f){f.preventDefault()}),!1)},K.isValidMetaData=function(f){return!f.metadata||"HIDDEN"!==f.metadata.category&&"true"!=f.metadata.hide&&"false"!=f.metadata.show&&!f.metadata.KM_ASSIGN&&!f.metadata.KM_STATUS},K.updateDraftMessage=function(T,L){if("object"==typeof L){var K={text:"",files:[]},U={fileMeta:L,filelb:Da.getFilePreviewPath(L),filesize:Da.getFilePreviewSize(L.size)};void 0!==T&&"object"==typeof ya[T]&&(K=ya[T],f.each(K.files,(function(f,T){T.filelb===U.filelb&&K.files.splice(f,1)}))),K.files.push(U)}ya[T]=K},K.updateUnreadCount=function(f,T,L){var U=K.getUnreadCount(f);ba[f]=T,(L||Ha.length>0)&&((me+=T-U)<0&&(me=0),me>0?Ha.html(me):Ha.html("")),L&&Ta.badgeCountOnLaucher(vt,me),Ga.isWidgetOpen()&&Ga.modifyClassList({id:["applozic-badge-count"]},"n-vis","")},K.incrementUnreadCount=function(f){me+=1,ba[f]=void 0===ba[f]?1:ba[f]+1,Ha.length>0&&Ha.html(me),Ta.badgeCountOnLaucher(vt,me)},K.getUnreadCount=function(f){return void 0===ba[f]?(ba[f]=0,0):ba[f]},K.isGroupDeleted=function(f,T){if(T){var L=La.getDeletedAtTime(f);return void 0!==L&&L>0}return!1},K.getTabDisplayName=function(f,T,L){var U="";if(T)U=Ma.getGroupDisplayName(f);else{"function"==typeof Ve&&(U=Ve(f)),void 0!==L&&L&&(U=L,Ca[f]=L),U||(U=K.getContactDisplayName(f));var P=K.fetchContact(""+f);U?(P.displayName=U,te[P.contactId]=P):void 0!==P.displayName&&(U=P.displayName),U||(U=f)}return U&&Ga.formatHtmlTag(U)},K.populateMessage=function(T,L,U){mckDateUtils.convertMilisIntoTime(L.metadata.CALL_DURATION);var P=L.groupId?wa.getGroup(L.groupId):Oa.getContact(L.to);za.loadUserProfile(L.to),!K.isMessageSentByBot(L,P)&&f(".km-typing-wrapper").remove();var G=Ba.data("mck-id"),B=Oa.isValidMetaData(L);if(void 0===G||""===G){var z=f("#mck-contact-list").length;if(z>0&&B){var H="object"==typeof L.metadata&&(void 0===L.metadata.KM_ASSIGN||void 0===L.metadata.KM_STATUS);L.groupId?Ma.addGroupFromMessage(L,H,(function(f,T,L){K.updateRecentConversationList(f,T,L)})):Oa.addContactsFromMessage(L,!0)}else Oa.addContactsFromMessageList({message:[L]},"");if("APPLOZIC_01"===T||"MESSAGE_RECEIVED"===T){if(void 0===P&&(P=L.groupId?wa.createGroup(L.groupId):Oa.createContact(L.to)),oa)return void Oa.loadTab({tabId:P.contactId,isGroup:P.isGroup,conversationId:L.conversationId});var q=L.groupId?"group_"+P.contactId:"user_"+P.contactId;B&&(10!==L.contentType&&102!==L.contentType&&Oa.incrementUnreadCount(q),"block"!==document.getElementById("mck-sidebox").style.display&&Ua.notifyUser(L));var V=L.groupId?"group-"+P.htmlId:"user-"+P.htmlId;f("#li-"+V+" .mck-unread-count-text").html(Oa.getUnreadCount(q)),Oa.getUnreadCount(q)>0&&f("#li-"+V+" .mck-unread-count-box").removeClass("n-vis").addClass("vis"),Na.sendDeliveryUpdate(L.pairedMessageKey)}}else if(void 0===P&&(P=L.groupId?wa.createGroup(L.groupId):Oa.createContact(L.to)),"APPLOZIC_01"===T||"MESSAGE_RECEIVED"===T){if(void 0!==P){var W=Ba.data("isgroup");if((void 0===L.oldKey||0===f("."+L.oldKey).length)&&0===f("."+L.key).length||10===L.contentType){if(void 0===G||G!=P.contactId||W!==P.isGroup||De.hasClass("vis")){if(oa)return void Oa.loadTab({tabId:P.contactId,isGroup:P.isGroup,conversationId:L.conversationId});B&&10!==L.contentType&&102!==L.contentType&&(q=L.groupId?"group_"+P.contactId:"user_"+P.contactId,Oa.incrementUnreadCount(q)),Na.sendDeliveryUpdate(L.pairedMessageKey)}else{var J=!0;if(W&&6===P.type&&(J=Ma.isAppendOpenGroupContextMenu(P)),L.conversationId&&(Yt||xt)){var ee=Ba.data("mck-conversationid");if(ee&&ee.toString()===L.conversationId.toString())L.metadata&&"HIDDEN"===L.metadata.category||Oa.addMessage(L,P,!0,!0,J),Na.sendReadUpdate(L.pairedMessageKey);else if(oa)return void Oa.loadTab({tabId:P.contactId,isGroup:P.isGroup,conversationId:L.conversationId})}else{if(7===P.type){var te,ae=wa.getGroup(L.groupId);Ma.getContactFromGroupOfTwo(ae,(function(f){te=Oa.fetchContact(f)})),Sa.lastSeenOfGroupOfTwo(te.contactId),Oa.addMessage(L,P,!0,!0,J)}(!L.metadata||"HIDDEN"!==L.metadata.category&&"true"!==L.metadata.hide&&7!==P.type||!L.message&&(L.metadata.hasOwnProperty("KM_ASSIGN_TO")||L.metadata.hasOwnProperty("KM_ASSIGN_TEAM")))&&(0!==eo&&K.isMessageSentByBot(L,P)?Oa.addMessage(L,P,!0,!0,J,null,(function(){K.processMessageInQueue(L)})):(Oa.addMessage(L,P,!0,!0,J),f(".km-typing-wrapper").remove()),Oa.messageClubbing(!1)),Na.sendReadUpdate(L.pairedMessageKey)}L.groupId||(f("#mck-tab-status").html(MCK_LABELS.online),za.updateUserStatus({userId:L.to,status:1},(function(f){Ka.getUsersDetail(f,{})})))}U&&6!==P.type&&"block"!==document.getElementById("mck-sidebox").style.display&&Ua.notifyUser(L)}}}else"APPLOZIC_02"!==T||102==L.contentType||(void 0!==L.oldKey&&0!==f("."+L.oldKey).length||0!==f("."+L.key).length)&&10!==L.contentType||(z>0?Oa.addContactsFromMessage(L,!0):void 0!==P&&(W=Ba.data("isgroup"),void 0!==G&&G===P.contactId&&W===P.isGroup&&(J=!0,W&&6===P.type&&(J=Ma.isAppendOpenGroupContextMenu(P)),L.metadata&&"HIDDEN"===L.metadata.category||Oa.addMessage(L,P,!0,!0,J),3===L.type&&(f("."+L.key+" .mck-message-status").removeClass("mck-pending-icon").addClass("mck-sent-icon"),Oa.addTooltip(L.key)))));St.removeClass("vis").addClass("n-vis")},K.isMessageSentByBot=function(f,T){return T.users&&T.users[f.to]&&"bot"!==T.users[f.to].userId&&T.users[f.to].role===KommunicateConstants.GROUP_ROLE.MODERATOR_OR_BOT},K.processMessageInQueue=function(f){f&&f.key&&MCK_BOT_MESSAGE_QUEUE.push(f.key),1==MCK_BOT_MESSAGE_QUEUE.length&&K.procesMessageTimerDelay()},K.procesMessageTimerDelay=function(){var T,L=document.getElementById("mck-message-cell");document.querySelector(".km-typing-wrapper")||(Ba.append('<div class="km-typing-wrapper"><div class="km-typing-indicator"></div><div class="km-typing-indicator"></div><div class="km-typing-indicator"></div></div>'),Ba.animate({scrollTop:Ba.prop("scrollHeight")},0)),setTimeout((function(){T=L.querySelector('div[data-msgkey="'+MCK_BOT_MESSAGE_QUEUE[0]+'"]'),f(".km-typing-wrapper").remove(),T&&(T.classList.remove("n-vis"),Ba.animate({scrollTop:Ba.prop("scrollHeight")},0)),MCK_BOT_MESSAGE_QUEUE.shift(),0!=MCK_BOT_MESSAGE_QUEUE.length&&K.procesMessageTimerDelay()}),eo)},K.getMessageFeed=function(T){var L={};if(L.key=T.key,L.timeStamp=T.createdAtTime,L.message=T.message,L.from=4===T.type?T.to:Tt,T.groupId?L.to=T.groupId:L.to=5===T.type?T.to:Tt,L.status="read",L.type=4===T.type?"inbox":"outbox",5===T.type&&(3===T.status?L.status="sent":4===T.status&&(L.status="delivered")),"object"==typeof T.fileMeta){var K=f.extend({},T.fileMeta);void 0!==K.url&&""!==K.url||(K.url=Ne+"/rest/ws/aws/file/"+T.fileMeta.blobKey),delete K.blobKey,L.file=K}return L.source=T.source,L.metadata=T.metadata,L},K.updateUnreadCountonChatIcon=function(T){if(sa&&T.length>0){var L=null,K=0;T.length>0&&(f.each(T,(function(f,T){T.unreadCount>0&&null!==L||T.unreadCount>0&&(L=T.userId,K=T.unreadCount)})),me>0&&"none"===V.css("display")&&(null!==L&&K===me?Oa.loadTab({tabId:L,isGroup:!1}):Oa.loadTab({tabId:"",isGroup:!1})))}},K.loadMessageListOnUserDetailFetch=function(T){St.removeClass("vis").addClass("n-vis");var L=Ba.data("mck-id"),K=Ba.data("isgroup");if(void 0===L||T.tabId===L&&""+K==""+T.isGroup){var U=wa.getGroup(T.tabId);La.addGroupStatus(U);var P=6!==U.type;P=!0,6===U.type&&(La.validateOpenGroupUser(U),P=Ma.isAppendOpenGroupContextMenu(U)),T.isMessages?(Oa.processMessageList(T.messageData,!0,P),6!==U.type&&va.removeClass("n-vis").addClass("vis"),"function"==typeof Be&&Be(T.tabId)):0===f("#mck-message-cell .mck-message-inner div[name='message']").length&&va.removeClass("vis").addClass("n-vis")}},K.messageClubbing=function(T){var L=f('#mck-message-cell .mck-message-inner div[name="message"]'),K=L.length;if(K>1&&!T){var U=L[K-1].getAttribute("data-msgtime")-L[K-2].getAttribute("data-msgtime");L[K-2].getAttribute("data-contact")==L[K-1].getAttribute("data-contact")&&U<KommunicateConstants.MESSAGE_CLUBBING.TIME_FRAME&&(L[K-2].classList.add("km-clubbing-first"),L[K-1].classList.add("km-clubbing-last"))}else f.each(L,(function(f,T){var K=L[f].nextSibling&&L[f].nextSibling.getAttribute("data-msgtime")-L[f].getAttribute("data-msgtime");L[f].nextSibling&&L[f].nextSibling.getAttribute("data-contact")==L[f].getAttribute("data-contact")&&K<KommunicateConstants.MESSAGE_CLUBBING.TIME_FRAME&&(L[f].classList.add("km-clubbing-first"),L[f].nextSibling.classList.add("km-clubbing-last"))}))}},Na=new function(){var K,U=this,G=f("#mck-search"),B=f("#mck-msg-to"),z=f("#mck-msg-new"),H=(f("#mck-audio"),f("#mck-mike-btn"),f("#mck-sidebox")),q=f("#mck-file-box"),V=f("#mck-text-box"),W=f(".mck-box-form"),ee=f("#mck-msg-form"),te=f("#mck-msg-sbmt"),ie=f("#mck-new-group"),se=f("#mck-tab-title"),de=f("#mck-msg-error"),me=f("#mck-btn-attach"),ue=f("#mck-tab-status"),pe=f("#mck-message-cell"),ge=f(".mck-typing-box"),fe=f("#mck-gms-loading"),he=f("#mck-group-title"),ke=f("#mck-contact-loading"),ye=(f("#mck-no-messages"),f(".mck-group-search")),Ce=(f(".mck-city-search"),f("#mck-msg-response")),_e=f("#mck-msg-form #mck-file-input"),Ie=f("#mck-block-button"),Me=f("#li-mck-block-user"),we=f("#li-mck-group-info"),Ne=f("#mck_response_text"),Ke=f(".mck-contact-search"),Ue=f("#mck-group-info-tab"),Re=f("#mck-price-text-box"),Pe=(f("#mck-sidebox-search"),f("#mck-group-info-btn")),Fe=(Ue=f("#mck-group-info-tab"),f("#mck-btn-group-exit")),ze=f("#mck-group-back-link"),He=f("#mck-btn-leave-group"),$e=f(".mck-sidebox-content"),qe=(f("#mck-no-more-messages"),f("#mck-btn-group-create")),Ve=(f("#mck-group-create-tab"),f("#mck-group-add-member")),Je=(f("#mck-contacts-content"),f("#mck-tab-option-panel")),Qe=(f("#mck-no-conversations"),f("#mck-group-create-title")),Xe=f(".mck-group-menu-options"),Ze=f(".mck-tab-message-option"),ut=f(".mck-group-admin-options"),gt=f("#mck-group-member-search"),vt=f("#mck-autosuggest-search-input"),ht=f("#mck-autosuggest-metadata"),Ct=f("#mck-message-cell .mck-message-inner"),_t=(f("#mck-search-cell .mck-message-inner"),f("#mck-no-more-conversations"),f("#mck-gm-search-box")),Et=f("#mck-group-member-search-list"),Ot=f("#mck-no-gsm-text"),Nt=f("#mck-minutes"),Dt=f("#mck-seconds"),Bt=document.getElementById("mck-char-warning"),Wt=document.getElementById("mck-char-warning-text");U.hideAutoSuggestionBoxEnableTxtBox=function(){vt.hasClass("mck-text-box")&&(vt.addClass("n-vis").removeClass("mck-text-box").val(""),V.removeClass("n-vis").addClass("mck-text-box"),vt.data("source-url",""),f(".mck-dropup-menu")&&f(".mck-dropup-menu").hide())},U.triggerWelcomeEvent=function(){var f=KommunicateUtils.getDataFromKmSession("settings"),T=f?f.customWelcomeEvent:"WELCOME";window.Applozic.ALApiService.sendMessage({data:{message:{type:5,contentType:10,message:"Event:"+T,groupId:CURRENT_GROUP_DATA.tabId,metadata:{category:"HIDDEN",KM_TRIGGER_EVENT:T},source:1}},success:function(f){},error:function(f){}})},U.changeConversationAssignee=function(){window.Applozic.ALApiService.ajax({type:"PATCH",url:MCK_BASE_URL+"/rest/ws/group/assignee/change?groupId="+encodeURIComponent(CURRENT_GROUP_DATA.tabId)+"&assignee="+encodeURIComponent(CURRENT_GROUP_DATA.initialBot.userId),global:!1,contentType:"text/plain",success:function(f){"success"==f.status&&P.restartConversationByUser&&CURRENT_GROUP_DATA.conversationAssignee!=CURRENT_GROUP_DATA.initialBot.userId?Ma.removeGroupMemberFromChat({groupId:CURRENT_GROUP_DATA.tabId,userId:CURRENT_GROUP_DATA.conversationAssignee,callback:function(f){"success"==f.status&&U.triggerWelcomeEvent()}}):P.restartConversationByUser&&U.triggerWelcomeEvent()},error:function(f){}})},U.restartConversation=function(f){kmWidgetEvents.eventTracking(eventMapping.onRestartConversationClick),"km-restart-conversation"==f.target.id||"km-restart-conversation-text"==f.target.id&&P.restartConversationByUser?U.changeConversationAssignee():(P.restartConversationByUser&&Ga.modifyClassList({id:["km-widget-options"]},"","n-vis"),KommunicateUI.showClosedConversationBanner(!1),KommunicateUI.isConvJustResolved=!1,Oa.loadDropdownOptions())},U.showSendButton=function(){Ga.modifyClassList({id:["send-button-wrapper"]},"vis","n-vis"),Ga.modifyClassList({id:["mck-file-up","mck-btn-loc","mck-btn-smiley-box","mck-img-file-up","mck-vid-file-up"]},"n-vis","vis"),!Le&&Ga.modifyClassList({id:["mck-file-up2"]},"n-vis","vis"),!xe&&Ga.modifyClassList({id:["mck-img-file-up"]},"n-vis",""),!Oe&&Ga.modifyClassList({id:["mck-vid-file-up"]},"n-vis","")},U.hideSendButton=function(){Ga.modifyClassList({id:["send-button-wrapper"]},"n-vis","vis"),pa&&Ga.modifyClassList({id:["mck-file-up"]},"vis","n-vis"),Le?Ga.modifyClassList({id:["mck-btn-loc"]},"vis","n-vis"):Ga.modifyClassList({id:["mck-file-up2"]},"vis","n-vis"),xe&&Ga.modifyClassList({id:["mck-img-file-up"]},"","n-vis"),Oe&&Ga.modifyClassList({id:["mck-vid-file-up"]},"","n-vis"),ve&&Ga.modifyClassList({id:["mck-btn-smiley-box"]},"vis","n-vis")},U.toggleMediaOptions=function(f){var T="";""!=(T="TEXTAREA"===f.tagName||"INPUT"===f.tagName?f.value:f.textContent)&&T.replace(/\s/g,"").length?(U.showSendButton(),Kommunicate.typingAreaService.hideMicButton()):(U.hideSendButton(),Kommunicate.typingAreaService.showMicIfSpeechRecognitionSupported())},U.checkArray=function(f){if(f&&!1===Array.isArray(f))throw new Error("askUserDetails should be an array");return f},U.getUserMetadata=function(){var T=["name","email","phone","password"],L={},K="";return Ya.map((function(U){K=U.field&&U.field.toLowerCase(),-1===T.indexOf(K)&&(L[U.field]=f("#km-"+K).val())})),L},U.createNewConversation=function(f,T){Kommunicate.startConversation(f,T)},U.openChatbox=function(T,L){kmWidgetEvents.eventTracking(eventMapping.onChatWidgetOpen),Ga.setWidgetStateOpen(!0),"none"===H.css("display")&&(f(".mckModal").mckModal("hide"),H.mckModal(),Ct.html("")),B.focus()},U.loadConversationWithAgents=function(T,L){U.openChatbox(),"kommunicate"==window.applozic.PRODUCT_ID&&He.removeClass("vis").addClass("n-vis"),Kommunicate.client.getGroupDetailByType({type:10,startIndex:0,limit:10},(function(T,K){if(!T)if(0==K.response.length){var U=La.createGroupDefaultSettings();Na.createNewConversation(U,(function(f){L()}))}else if(1==K.response.length){var P=K.response[0].id;f.fn.applozic("loadGroupTab",P,L)}else da>0&&ALStorage.clearMckMessageArray(),f.fn.applozic("loadTab",null,L)}))},U.timer=function(){var f=0,T=this;K=setInterval((function(){++f,Dt.html(T.pad(f%60)),Nt.html(T.pad(parseInt(f/60)))}),1e3),T.pad=function(f){var T=f+"";return T.length<2?"0"+T:T}},U.stoptimer=function(){Dt.html("0"),Nt.html("0"),clearInterval(K)},f(L).on("click",".mck-message-delete",(function(){U.deleteMessage(f(this).parents(".mck-m-b").data("msgkey"))})),f(L).on("click",".mck-message-reply",(function(){U.replyMessage(f(this).parents(".mck-m-b").data("msgkey"))})),f(L).on("click",".mck-message-forward",(function(){z.data("forwardMessageKey",f(this).parents(".mck-m-b").data("msgkey")),z.trigger("click")})),f(".mck-minimize-icon").click((function(){f(".mck-box-md,.mck-box-ft").animate({height:"toggle"}),$e.hasClass("minimized")?($e.css("height","100%"),$e.removeClass("minimized")):($e.css("height","0%"),$e.addClass("minimized"))})),U.init=function(){var K=document.getElementById("mck-text-box");f.template("oflTemplate",'<div id="mck-ofl-blk" class="mck-m-b"><div class="mck-clear"><div class="blk-lg-12 mck-text-light mck-text-muted mck-test-center">${userIdExpr} is offline now</div></div></div>'),ALStorage.clearMckMessageArray(),f(L).on("click","."+Se,(function(){f(this).hasClass("mck-msg-preview")&&f(this).hide(),Ia.clearMsgTriggerAndChatPopuTimeouts()})),Oa.initSearchAutoType(),Ke.click((function(){var T=La.createGroupDefaultSettings();Na.createNewConversation(T,(function(f){})),f("#mck-msg-new").attr("disabled",!0),Ia.clearMsgTriggerAndChatPopuTimeouts()})),f(L).on("click","#mck-sidebox-launcher",(function(){document.getElementById("launcher-agent-img-container").classList.add("n-vis"),document.getElementById("launcher-agent-img-container").classList.remove("vis"),void 0!==ft?document.getElementById("mck-sidebox-launcher").childNodes[0].childNodes[0].classList.remove("n-vis"):document.getElementById("launcher-svg-container").classList.remove("n-vis")})),f(L).on("click","#talk-to-human-link",(function(){var T=La.createGroupDefaultSettings();KommunicateUI.hideFaq(),KommunicateUI.showChat(),""===f("#km-faq-search-input").val()?Na.createNewConversation(T,(function(f){})):Na.createNewConversation(T,(function(f){KommunicateUI.sendFaqQueryAsMsg(f)})),f("#mck-contact-list").removeClass("vis").addClass("n-vis")})),ye.click((function(){Oa.addGroupsToGroupSearchList()})),K.addEventListener("keyup",(function(){U.toggleMediaOptions(this)})),U.cursorPosition=function(f){var T=window.getSelection(),L=0,K=0,U=T.getRangeAt(f).startOffset,P=f.firstChild,G=document.getElementById("mck-normal-span"),B=T.focusNode;G&&(P=G.firstChild);var z=document.createRange();z.setStart(P,0),z.setEnd(B,U);var H=z.commonAncestorContainer.childNodes;for(L=0;L<H.length&&(H[L].nodeType&&"3"==H[L].nodeType&&""==H[L].nodeValue&&K++,H[L]!=z.endContainer||"3"!=H[L].nodeType);L++);L-=K,T.removeAllRanges(),T.addRange(z);var q=T.toString().length;return T.collapseToEnd(),{position:U,node:L,totalLength:q}},U.disableSendButton=function(f){var T=document.getElementById("mck-msg-sbmt");f?T.setAttribute("disabled",f):T.removeAttribute("disabled"),CURRENT_GROUP_DATA.DISABLE_SEND_MESSAGE=f},V.on("input paste",(function(f){if(CURRENT_GROUP_DATA.CHAR_CHECK){var T,L=V[0];document.getElementById("mck-char-count")||(Wt.innerHTML+='<span> | </span><span id="mck-char-count"></span>');var K=Ta.textVal(L),P=K.trim().length;if(P>199){var G=U.cursorPosition(L),B=G.position,z=G.totalLength,H=G.node;if(P>256){var q;U.disableSendButton(!0),T="("+MCK_LABELS["limit.remove"]+" "+(P-256)+" "+MCK_LABELS["limit.characters"]+")";var W=K.slice(0,256);W=W.replace(/(?:\r\n|\r|\n)/g,"<br>");var J=K.slice(256);J=J.replace(/(?:\r\n|\r|\n)/g,"<br>");var ee=document.getElementById("mck-text-warning-span"),te=document.getElementById("mck-normal-span");if(ee&&"paste"!=f.type)q=document.getSelection(),z<=257&&q.focusNode!=ee.firstChild&&(ee.innerHTML=J,te.innerHTML=W,q=document.getSelection(),z>=257?(ae=ee.childNodes[H-(te.childNodes.length-1)],z>256&&(B=z-256)):ae=te.childNodes[H],q.collapse(ae,B));else{L.innerHTML='<span id = "mck-normal-span"></span><span contenteditable="true" id="mck-text-warning-span"></span>',(te=document.getElementById("mck-normal-span")).innerHTML=W,(ee=document.getElementById("mck-text-warning-span")).innerHTML=J,q=document.getSelection();try{var ae;0==H&&z>256?(ae=ee.firstChild,B=z-256):z>256?H-(te.childNodes.length-1)>=ee.childNodes.length?(ae=ee.lastChild,B=ee.lastChild.length):B>(ae=ee.childNodes[H-(te.childNodes.length-1)]).nodeValue.length&&(B=z-256):ae=te.childNodes[H],q.collapse(ae,B)}catch(f){ae=ee.lastChild,B=ee.lastChild.length,q.collapse(ae,B)}}}else{te=document.getElementById("mck-normal-span"),ee=document.getElementById("mck-text-warning-span");var ne="";te&&(ne=te.innerHTML),ee&&(ne+=ee.innerHTML),ne.length>1&&(L.innerHTML=ne,q=document.getSelection(),z>256?q.collapse(L.lastChild,L.lastChild.length-1):q.collapse(L.childNodes[H],B)),U.disableSendButton(!1),T="("+(256-P)+" "+MCK_LABELS["limit.characters"]+" "+MCK_LABELS["limit.remaining"]+")"}document.getElementById("mck-char-count").innerHTML=T,Bt.classList.remove("n-vis"),Bt.classList.contains("mck-warning-slide-up")||(Bt.classList.add("mck-warning-slide-up"),Bt.classList.remove("mck-warning-slide-down"))}else U.disableSendButton(!1),Bt.classList.contains("n-vis")||Bt.classList.contains("mck-warning-slide-down")||(Bt.classList.add("mck-warning-slide-down"),Bt.classList.remove("mck-warning-slide-up"),setTimeout((function(){Bt.classList.add("n-vis")}),700))}})),V.keydown((function(f){if(W.hasClass("mck-text-req")&&W.removeClass("mck-text-req"),13===f.keyCode&&(f.shiftKey||f.ctrlKey)){if(f.preventDefault(),T.getSelection){var K=T.getSelection(),U=K.getRangeAt(0),P=L.createElement("br"),G=L.createTextNode(" ");return U.deleteContents(),U.insertNode(P),U.collapse(!1),U.insertNode(G),U.selectNodeContents(G),K.removeAllRanges(),K.addRange(U),V.animate({scrollTop:V.prop("scrollHeight")},0),!1}}else 13!==f.keyCode||CURRENT_GROUP_DATA.DISABLE_SEND_MESSAGE?13===f.keyCode&&CURRENT_GROUP_DATA.DISABLE_SEND_MESSAGE?f.preventDefault():0===window.Applozic.ALSocket.mck_typing_status&&window.Applozic.ALSocket.sendTypingStatus(1,window.Applozic.ALSocket.mck_typing_status,Tt,Ct.data("mck-id")):(f.preventDefault(),1===window.Applozic.ALSocket.mck_typing_status&&window.Applozic.ALSocket.sendTypingStatus(0,window.Applozic.ALSocket.mck_typing_status,Tt,Ct.data("mck-id")),te.is(":disabled")&&q.hasClass("vis")?alert(MCK_LABELS["file.uploading.wait"]):ee.submit(),Oa.messageClubbing(!1))})),f(L).on("click",".mck-btn-clear-messages",(function(){confirm(MCK_LABELS["clear.messages.alert"])&&Na.deleteConversation()})),f(L).on("click",".applozic-tm-launcher",(function(T){T.preventDefault();var L=f(this).data("mck-id");L=void 0!==L&&""!==L?L.toString():"";var K=f(this).data("mck-name");K=void 0!==K&&""!==K?K.toString():"";var U=f(this).data("mck-supportid");U=void 0!==U&&""!==U?U.toString():"";var P=f(this).data("mck-topicid");P=void 0!==P&&""!==P?P.toString():"";var G=f(this).data("mck-msg");if(G=void 0!==G&&""!==G?G.toString():"","function"==typeof je&&P){var B=je(P);"object"==typeof B&&"undefined"!==B.title&&(re[P]=B)}var z={topicId:P,tabId:L,userName:K,isMessage:!0},H={type:5,contentType:0,message:G};z.messagePxy=H,U?(z.isGroup=!0,z.supportId=U,Na.getConversationId(z)):(z.isGroup=!1,Oa.loadTab(z,Ra.dispatchMessage))})),f(L).on("click",".applozic-wt-launcher",(function(T){T.preventDefault();var L=f(this).data("mck-id");L=void 0!==L&&""!==L?L.toString():"";var K=f(this).data("mck-name");K=void 0!==K&&""!==K?K.toString():"";var U=f(this).data("mck-topicid");U=void 0!==U&&""!==U?U.toString():"";var P=f(this).data("mck-topic-status");if(P=P?-1===ca.indexOf(P)?ca[0]:P.toString():ca[0],"function"==typeof je){var G=je(U);"object"==typeof G&&"undefined"!==G.title&&(re[U]=G)}Na.getConversationId({tabId:L,isGroup:!1,userName:K,topicId:U,topicStatus:P,isMessage:!1})})),f(L).on("click",".applozic-ct-launcher",(function(T){T.preventDefault();var L=f(this).data("mck-id");L=void 0!==L&&""!==L?L.toString():"";var K=f(this).data("mck-name");K=void 0!==K&&""!==K?K.toString():"";var U=f(this).data("mck-topicid");U=void 0!==U&&""!==U?U.toString():"";var P=f(this).data("mck-topic-status"),G={tabId:L,isGroup:!1,userName:K,topicId:U,topicStatus:P=P?-1===ca.indexOf(P)?ca[0]:P.toString():ca[0],isMessage:!1};if("function"==typeof lt){var B=lt(U);"object"==typeof B&&(B.topicDetail&&"object"==typeof B.topicDetail&&"undefined"!==B.topicDetail.title&&(re[U]=B.topicDetail),B.fallBackTemplatesList&&B.fallBackTemplatesList.length>0&&(G.fallBackTemplatesList=B.fallBackTemplatesList))}Na.getConversationId(G)})),f(L).on("click","."+Se+", .mck-contact-list ."+Se,(function(T){T.preventDefault(),f("#mck-tab-individual .mck-tab-link.mck-back-btn-container").addClass("vis-table").removeClass("n-vis"),f("#mck-tab-individual .mck-name-status-container.mck-box-title").removeClass("padding"),count++;var L=f(this),K=this,U=L.data("mck-id");count>1&&"object"!=typeof MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-1]&&MCK_EVENT_HISTORY.push(K),U?L.parents(".mck-search-list").length?(G.bind("blur"),setTimeout((function(){Na.openChat(K)}),600)):Na.openChat(K):(f.fn.applozic("mckLaunchSideboxChat"),Ia.clearMsgTriggerAndChatPopuTimeouts())})),document.getElementById("km-csat-trigger").onclick=function(f){f.preventDefault(),KommunicateUI.triggerCSAT(),Ga.modifyClassList({id:["mck-csat-close"]},"vis","n-vis")},document.getElementById("km-csat-close-button").onclick=function(f){f.preventDefault(),KommunicateUI.showClosedConversationBanner(!1)},document.getElementById("user-overide-voice-output").onclick=function(f){f.preventDefault(),userOverride.voiceOutput=!userOverride.voiceOutput,KommunicateUI.toggleVoiceOutputOverride(userOverride.voiceOutput)},f("#km-form-chat-login").submit((function(T){var L=f("#km-submit-chat-login"),K=f("#km-error-chat-login"),P=f("#km-userId").val(),G=f("#km-email").val(),B=f("#km-name").val(),z=f("#km-phone").val(),H=f("#km-password").val();H&&(Ge=H),z&&(P=z,document.getElementById("km-phone").removeEventListener("keydown",U.phoneNumberValidation)),G&&(P=G,KommunicateUtils.setCookie({name:KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID,value:G,expiresInDays:30,domain:MCK_COOKIE_DOMAIN}),KommunicateUtils.setCookie({name:KommunicateConstants.COOKIES.IS_USER_ID_FOR_LEAD_COLLECTION,value:!0,expiresInDays:30,domain:MCK_COOKIE_DOMAIN}));var q=Na.getUserMetadata();K.removeClass("show").addClass("hide"),K.html("");var V={userId:P,applicationId:be,onInit:i,baseUrl:MCK_BASE_URL,locShare:Le,metadata:q,password:H,googleApiKey:St,chatNotificationMailSent:!0,authenticationTypeId:ot};return G&&(V.email=G.toLowerCase()),B&&(V.displayName=B),z&&(V.contactNumber=z),L.attr("disabled",!0),L.html("Initiating chat..."),ke.addClass("vis"),Ia.initialize(V),!1}));var i=function(){"kommunicate"===window.applozic.PRODUCT_ID&&He.removeClass("vis").addClass("n-vis"),Na.loadConversationWithAgents({groupName:Ja,agentId:Qa,botIds:Xa})};f(".km-login-model-close").on("click",(function(T){f("#km-chat-login-modal").css("display","none")})),f(L).on("click","#mck-conversation-back-btn",(function(T){T.preventDefault();var L=MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-1],K=kommunicate&&kommunicate._globals&&kommunicate._globals.faqCategory;if("string"!=typeof L||-1==L.indexOf("faq")||(K?"km-faq-list"==L:"km-faq-category-list"==L)){f(this);var U=Ct.data("mck-id"),P=Ct.data("isgroup");KommunicateUI.hideAwayMessage(),KommunicateUI.hideLeadCollectionTemplate(),KommunicateUI.showClosedConversationBanner(!1),!pa&&Ga.modifyClassList({id:["mck-attachfile-box","mck-file-up"]},"n-vis","vis"),Oa.loadTab({tabId:"",isGroup:!1,lastActiveTabId:U,isLastActiveTabGroup:P})}})),f(L).on("click",".mck-close-sidebox",(function(f){f.preventDefault(),U.closeSideBox()})),f(L).on("click",".mck-price-submit",(function(f){f.preventDefault(),U.sendPriceMessage()})),Re.keydown((function(f){13===f.keyCode&&U.sendPriceMessage()})),Ct.bind("scroll",(function(){if(Ct.find(".mck-contact-list").length>0)Ct.scrollTop()+Ct.innerHeight()>=Ct[0].scrollHeight&&(T=Ct.data("datetime"))>0&&!ae&&Na.loadMessageList({tabId:"",isGroup:!1,startTime:T});else if(0===Ct.scrollTop()){var f=Ct.data("mck-id");if(void 0===f||""===f)return;var T,L=Ct.data("isgroup"),K=Ct.data("mck-conversationid");K=K?K.toString():"",(T=Je.data("datetime"))>0&&!ae&&Na.loadMessageList({tabId:f,isGroup:L,conversationId:K,startTime:T})}else{var U=document.querySelectorAll("img.lazy-image");U&&U.length>0&&Array.prototype.slice.call(U).map((function(f){KommunicateUI.isInView(f,document.querySelector("#mck-message-cell .mck-message-inner"))&&KommunicateUI.processLazyImage(f,f.getAttribute("data-thumbnailBlobKey"))}))}})),Re.on("click",(function(f){f.preventDefault(),Re.removeClass("mck-text-req")})),Ie.on("click",(function(f){f.preventDefault();var T=Ct.data("mck-id"),L=Ct.data("isgroup"),K=!Ct.data("blocked");if(L)Me.removeClass("vis").addClass("n-vis");else{var U=K?MCK_LABELS["block.user.alert"]:MCK_LABELS["unblock.user.alert"];confirm(U)&&za.blockUser(T,K,(function(f){Sa.toggleBlockUser(f,K)}))}})),He.on("click",(function(f){f.preventDefault();var T=Ct.data("mck-id");Ct.data("isgroup")?confirm(MCK_LABELS["exit.group.alert"])&&Ma.leaveGroup({apzCallback:La.onGroupLeft,groupId:T}):Xe.removeClass("vis").addClass("n-vis")})),f(L).on("click",".mck-add-to-group",(function(T){T.preventDefault();var L=f(this).data("mck-id");void 0!==L&&La.addGroupMemberFromSearch(L),_t.mckModal("hide")})),f(L).on("click",".mck-btn-remove-member",(function(T){T.stopPropagation();var L=f(this).parents(".mck-li-group-member").data("mck-id"),K=Ue.data("mck-id");if(void 0!==K&&void 0!==L){var U=wa.getGroup(K);"object"==typeof U&&Tt===U.adminName?confirm(MCK_LABELS["remove.member.alert"])&&Ma.removeGroupMember({groupId:K,userId:L,apzCallback:La.onRemovedGroupMember}):ut.removeClass("vis").addClass("n-vis")}})),Fe.on("click",(function(f){f.preventDefault();var T=Ue.data("mck-id");T?confirm(MCK_LABELS["exit.group.alert"])&&Ma.leaveGroup({groupId:T,apzCallback:La.onGroupLeft}):Oa.loadTab({tabId:"",isGroup:!1})})),Pe.on("click",(function(f){f.preventDefault();var T=Ct.data("mck-id");if(Ct.data("isgroup")){var L={groupId:T},K=Ct.data("mck-conversationid");K&&(L.conversationId=K),La.loadGroupInfo(L)}else Xe.removeClass("vis").addClass("n-vis")})),ie.on("click",(function(f){f.preventDefault(),La.loadCreateGroupTab()})),ze.on("click",(function(f){f.preventDefault();var T=Ue.data("mck-id"),L=Ue.data("mck-conversation-id");if(T){var K={tabId:T,isGroup:!0};L&&(K.conversationId=L),Oa.loadTab(K)}else Oa.loadTab({tabId:"",isGroup:!1})})),Ve.on("click",(function(T){T.preventDefault();var L=Ue.data("mck-id");if(L){var K=wa.getGroup(L);if(!K||K.adminName!==Tt)return void ut.removeClass("vis").addClass("n-vis");Et.html(""),_t.mckModal(),fe.removeClass("n-vis").addClass("vis"),_a.length>0?La.addMembersToGroupSearchList():Jt?ka.length>0?(f.each(ka,(function(f,T){_a.push(T.contactId)})),La.addMembersToGroupSearchList()):(fe.removeClass("vis").addClass("n-vis"),Ot.removeClass("n-vis").addClass("vis")):Ka.loadContacts()}})),gt.keypress((function(f){if(13===f.which){var T=gt.val();return""!==T&&La.addGroupMemberFromSearch(T),gt.val(""),!0}})),f(L).on("click",".mck-group-member-search-link",(function(f){f.preventDefault();var T=gt.val();""!==T&&La.addGroupMemberFromSearch(T),gt.val("")})),f(L).on("click",".mck-show-more",(function(T){T.preventDefault();var L=f(this),K=L.data("tabId"),U=Ct.data("isgroup"),P=Ct.data("mck-conversationid");P=P?P.toString():"";var G=L.data("datetime");Na.loadMessageList({tabId:K,isGroup:U,conversationId:P,startTime:G})})),f(L).on("click",".mck-accept",(function(T){var L=f(this).data("mck-conversationid"),K=f(this).data("mck-topic-price");if("function"==typeof Ye&&K&&L){var U=le[L],P=B.val(),G=Ma.getGroupDisplayName(P);"object"==typeof U?(Ye({custId:Tt,suppId:G,productId:U.topicId,price:K}),Ra.sendConversationCloseUpdate(L)):Ra.getTopicId({conversationId:L,suppId:G,priceText:K},(function(f){Oa.populateMessage(f.messageType,f.message,f.notifyUser)}))}})),ee.submit((function(){1===window.Applozic.ALSocket.mck_typing_status&&window.Applozic.ALSocket.sendTypingStatus(0,window.Applozic.ALSocket.mck_typing_status,Tt,Ct.data("mck-id"));var L=f.trim(Ta.textVal(V[0]));if(q.hasClass("n-vis")&&J.length>0&&(J=[]),0===L.length&&0===J.length)return W.addClass("mck-text-req"),!1;if("function"==typeof We&&!We(L))return!1;var K={type:5,contentType:0,message:L},P=Ct.data("mck-conversationid"),G=Ct.data("mck-topicid");if(P)K.conversationId=P;else if(G){var z={topicId:G},H=re[G];"object"==typeof H&&(z.topicDetail=T.JSON.stringify(H)),K.conversationPxy=z}var ee=ht.val();return ee&&""!=ee&&(K.metadata={suggestMessageMetadata:ee},ht.val("")),""!=vt.data("prev-msgkey")&&void 0!==vt.data("prev-msgkey")&&(Na.updateMessageMetadata({key:vt.data("prev-msgkey"),metadata:{obsolete:!0}}),vt.data("prev-msgkey","")),U.hideAutoSuggestionBoxEnableTxtBox(),!0===Ct.data("isgroup")?K.groupId=B.val():K.to=B.val(),te.attr("disabled",!0),de.removeClass("vis").addClass("n-vis"),de.html(""),Ne.html(""),Ce.removeClass("vis").addClass("n-vis"),1==f("[data-msgtype=5]").length&&(KommunicateUI.leadCollectionEnabledOnAwayMessage&&KommunicateUI.awayMessageInfo.isEnabled&&1==KommunicateUI.awayMessageInfo.eventId||KommunicateUI.welcomeMessageEnabled&&KommunicateUI.leadCollectionEnabledOnWelcomeMessage&&KommunicateUI.anonymousUser)&&!KommunicateUI.validateEmail(K.message)||(U.hideSendButton(),Kommunicate.typingAreaService.showMicIfSpeechRecognitionSupported(),U.sendMessage(K)),!1})),_e.on("click",(function(){f(this).val(""),de.removeClass("vis").addClass("n-vis"),Ce.removeClass("vis").addClass("n-vis")})),f(L).bind("click",(function(T){f(".mck-context-menu").removeClass("vis").addClass("n-vis"),!me.hasClass("on")||f(T.target).hasClass("mck-icon-upload")||f(T.target).hasClass("mck-btn-attach")||Aa.fileMenuToggle(),W.removeClass("mck-text-req"),L.activeElement&&L.activeElement!==V&&1===window.Applozic.ALSocket.mck_typing_status&&window.Applozic.ALSocket.sendTypingStatus(0,window.Applozic.ALSocket.mck_typing_status,Tt,Ct.data("mck-id")),L.activeElement&&"mck-group-name-save"!==L.activeElement.id&&he.removeClass("mck-req-border"),L.activeElement&&"mck-btn-group-create"!==L.activeElement.id&&Qe.removeClass("mck-req-border"),f(".mcktypeahead.mck-dropdown-menu").hide()})),f(".mck-tabview-item").click((function(){f(".mck-tabview-item").removeClass("active"),f(this).addClass("active")}))},f(".mck-sidebox").on("click","#mck-mike-btn",(function(){f(this).removeClass("vis").addClass("n-vis"),f(".mck-stop-btn").addClass("vis").removeClass("n-vis"),Fr.voice.record(!1,(function(){f("#mck-audio").removeClass("n-vis").addClass("vis"),Na.timer()}))})),f(".mck-sidebox").on("click","#mck-stop-recording",(function(){f("#mck-mike-btn").addClass("vis").removeClass("n-vis"),f(".mck-stop-btn").addClass("n-vis").removeClass("vis"),f("#mck-audio").removeClass("vis").addClass("n-vis"),Na.stoptimer(),Fr.voice.export((function(T){var L={};L.file=T,L.name="blob",f.fn.applozic("audioAttach",L)}),"blob"),Fr.voice.stop()})),U.closeSideBox=function(){Ga.setWidgetStateOpen(!1),MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE&&KommunicateUtils.removeItemFromLocalStorage("mckActiveConversationInfo"),KommunicateUI.hideAwayMessage(),KommunicateUI.hideLeadCollectionTemplate(),KommunicateUI.showClosedConversationBanner(!1),H.mckModal("hide"),f("#mck-sidebox-launcher").removeClass("n-vis").addClass("vis"),document.getElementById("launcher-agent-img-container").classList.contains("vis")?(document.querySelector("#mck-sidebox-launcher #launcher-svg-container").classList.add("n-vis"),document.querySelector("#mck-sidebox-launcher #launcher-svg-container").classList.remove("vis")):(document.querySelector("#mck-sidebox-launcher #launcher-svg-container").classList.add("vis"),document.querySelector("#mck-sidebox-launcher #launcher-svg-container").classList.remove("n-vis"));var T=Ct.data("mck-conversationid");if(Ct.data("mck-id",""),Ct.data("mck-topicid",""),Ct.data("mck-name",""),Ct.data("mck-conversationid",""),T){var L=le[T];if("object"==typeof L){var K=L.topicId;"function"==typeof De&&De(Tt,K)}}window.Applozic.ALSocket.unsubscibeToTypingChannel()},U.openChat=function(T,L){var K=f(T),U=K.data("mck-id"),P=K.parent().data("is-queued");U=void 0!==U&&""!==U?U.toString():"";var B=K.data("mck-name");B=void 0!==B&&""!==B?B.toString():"";var z=K.data("mck-topicid");z=void 0!==z&&""!==z?z.toString():"";var H=!0===K.data("isgroup"),q=K.data("mck-conversationid");if(q=void 0!==q&&""!==q?q.toString():"",KommunicateUI.checkSingleThreadedConversationSettings(Object.keys(MCK_GROUP_MAP).length>1),z&&!q){var V=f(elem).data("mck-topic-status");V=V?-1===ca.indexOf(V)?ca[0]:V.toString():ca[0],Na.getConversationId({tabId:U,isGroup:H,userName:B,topicId:z,topicStatus:V,isMessage:!1})}else Oa.loadTab({tabId:U,isGroup:H,userName:B,conversationId:q,topicId:z,isConversationInWaitingQueue:P},L);G.val("")},U.sendMessage=function(T,L,K){var P,G;if(kmWidgetEvents.eventTracking(eventMapping.onMessageSent),Kommunicate.internetStatus&&void 0!==f("#mck-message-cell .mck-message-inner div[name='message']:last-child").data("msgkey")&&(P=f("#mck-message-cell .mck-message-inner div[name='message']:last-child").data("msgkey"),G=Ra.getReplyMessageByKey(P)),"object"==typeof T){if(T.to&&za.MCK_USER_DETAIL_MAP[T.to]&&za.MCK_USER_DETAIL_MAP[T.to].deletedAtTime)return de.html(MCK_LABELS["user.delete"]).removeClass("n-vis").addClass("vis"),f("#mck-tab-status").removeClass("vis").addClass("n-vis"),ee.removeClass("vis").addClass("n-vis"),void Me.removeClass("vis").addClass("n-vis");var B=T.metadata?T.metadata:{},z=f("#mck-text-box").data("AL_REPLY");if(void 0===z||""===z||T.forward||(B.AL_REPLY=z),T.metadata=B,void 0!==T.message&&0!==T.message.length||0!==J.length){if(G&&(!G.metadata.altype||0!==G.type&&4!==G.type&&6!==G.type||(B.altype=G.metadata.altype)),T.conversationId){var H=le[T.conversationId];if("undefined"!==H&&H.closed)return Oa.closeConversation(),void te.attr("disabled",!1)}if(Ct.data("blocked")&&!T.groupId)return Sa.toggleBlockUser(ae,!0),void te.attr("disabled",!1);var q="";if(T.groupId?void 0===(q=wa.getGroup(T.groupId))&&(q=wa.createGroup(T.groupId)):q=T.clientGroupId?wa.getGroupByClientGroupId(T.clientGroupId):Oa.fetchContact(T.to),f("#mck-message-cell .mck-no-data-text").length>0&&f(".mck-no-data-text").remove(),T.message&&0===J.length){var V=Ze.hasClass("n-vis"),ae=Ct.data("mck-id"),ne=Ta.randomId();T.key=ne,12!==T.contentType&&ae&&ae.toString()===q.contactId&&102!==T.contentType&&Ra.addMessageToTab(T,q,(function(f,T){Oa.addMessage(f,T,!0,!0,!1)}));var oe={tabId:q.contactId,isTopPanelAdded:V};U.submitMessage(T,oe)}else if(!T.message||0===J.length||1!==T.contentType&&2!==T.contentType){if(J.length>0){var ie=T.message;f.each(J,(function(P,G){var B=Ze.hasClass("n-vis"),z=Ct.data("mck-id"),H=Ta.randomId();T.key=H,T.fileMeta=G,P!=J.length-1?T.message="":T.message=ie,L&&L.size&&(T.fileMeta.size=L.size),T.contentType=1,12!==T.contentType&&z&&z.toString()===q.contactId&&Ra.addMessageToTab(T,q,(function(f,T){Oa.addMessage(f,T,!0,!0,!1)}));var V={tabId:q.contactId,isTopPanelAdded:B},W=KommunicateUI.getAttachmentStopUploadStatus(T.key);if(!Kommunicate.internetStatus||W)return KM_PENDING_ATTACHMENT_FILE[T.key]=L,-1!=L.type.indexOf("image/")&&KommunicateUI.displayUploadIconForAttachment(T.key,!1),void KommunicateUI.updateAttachmentStopUploadStatus(T.key,!0);J&&KommunicateUI.isAttachmentV2(J[0].contentType)?(f(".mck-timestamp-"+T.key).removeClass("vis").addClass("n-vis"),-1!=J[0].contentType.indexOf("image/")&&KommunicateUI.displayProgressMeter(T.key),KommunicateUI.updateAttachmentTemplate(T,T.key),"function"==typeof K&&K(T)):U.submitMessage(T,V)}))}}else{V=Ze.hasClass("n-vis"),ae=Ct.data("mck-id"),ne=Ta.randomId(),T.key=ne;var se={};T.groupId?se.groupId=T.groupId:se.to=T.to,se.type=T.type,se.key=Ta.randomId(),se.message=T.message,se.contentType=T.contentType,T.contentType=1,T.fileMeta=J[0],T.message="",12!==T.contentType&&ae&&ae.toString()===q.contactId&&(Ra.addMessageToTab(T,q,(function(f,T){Oa.addMessage(f,T,!0,!0,!1)})),Ra.addMessageToTab(se,q,(function(f,T){Oa.addMessage(f,T,!0,!0,!1)}))),oe={tabId:q.contactId,isTopPanelAdded:V},U.submitMessage(T,oe),U.submitMessage(se,oe)}W.removeClass("mck-text-req"),te.attr("disabled",!1),f("."+ne+" .mck-message-status").removeClass("mck-sent-icon").addClass("mck-pending-icon"),Oa.addTooltip(ne),Oa.clearMessageField(!0),J=[],delete ya[q.contactId]}else W.addClass("mck-text-req")}},U.sendForwardMessage=function(f){var L=ALStorage.getMessageByKey(f);if(void 0!==L){L.fileMeta&&J.push(L.fileMeta);var K={type:5,contentType:L.contentType,message:L.message,forward:"forward"};L.metadata&&(L.metadata.AL_REPLY&&(L.metadata.AL_REPLY=""),K.metadata=L.metadata);var P=Ct.data("mck-conversationid"),G=Ct.data("mck-topicid");if(P)K.conversationId=P;else if(G){var z={topicId:G},H=re[G];"object"==typeof H&&(z.topicDetail=T.JSON.stringify(H)),K.conversationPxy=z}!0===Ct.data("isgroup")?K.groupId=B.val():K.to=B.val(),U.sendMessage(K)}},U.sendWelcomeMessage=function(f){var T=Ta.randomId(),L=Ct.data("mck-id"),K=Ct.data("isgroup"),U={key:T,type:4,contentType:0,to:f.sender,message:f.messageContent};if(L&&L.toString()===f.sender&&!K){var P=Oa.fetchContact(L);Ra.addMessageToTab(U,P,(function(f,T){Oa.addMessage(f,T,!0,!0,!1)}))}window.Applozic.ALApiService.ajax({type:"GET",url:MCK_BASE_URL+"/rest/ws/message/add/inbox",global:!1,data:"sender="+encodeURIComponent(f.sender)+"&messageContent="+encodeURIComponent(f.messageContent),contentType:"text/plain",success:function(T){f.callback&&f.callback(T)}})},U.getChatContext=function(T){var L=T&&T.metadata&&"object"==typeof T.metadata.KM_CHAT_CONTEXT?T.metadata.KM_CHAT_CONTEXT:{},K=KommunicateUtils.getSettings("KM_CHAT_CONTEXT");return K="object"==typeof K?K:{},Gt="object"==typeof Gt?Gt:{},f.extend({},K,Gt,L)},U.submitMessage=function(L,K){var P=L.key,G=L.metadata?L.metadata:{};zt&&(G=f.extend(L.metadata,{userStatus:4}));var B=f("#mck-text-box").data("AL_REPLY");void 0===B||""===B||L.forward||(G.AL_REPLY=B,f("#mck-text-box").data("AL_REPLY","")),L.source=wt;var z=f("#mck-message-cell .mck-message-inner div[name='message']."+P);f.extend(G,{KM_CHAT_CONTEXT:JSON.stringify(U.getChatContext(L))}),L.metadata=G,window.Applozic.ALApiService.ajax({type:"POST",url:MCK_BASE_URL+"/rest/ws/message/send",global:!1,data:T.JSON.stringify(L),contentType:"application/json",success:function(T){L&&"object"==typeof L.fileMeta&&KommunicateUI.isAttachmentV2(L.fileMeta.contentType)&&(f(".mck-timestamp-"+L.key).removeClass("n-vis").addClass("vis"),KommunicateUI.updateAttachmentStopUploadStatus(L.key,!1));var U=Ct.data("mck-id");if("object"==typeof T){KommunicateUI.deleteProgressMeter(L.key,!0),f(".km-attachment-download-icon-"+L.key).removeClass("n-vis").addClass("vis"),f(".km-attachment-cancel-icon-"+L.key).removeClass("vis").addClass("n-vis"),Ga.modifyClassList({class:["km-attachment-progress-bar-wrapper-"+L.key]},"n-vis","vis");var G=T.messageKey;if(U&&U.toString()===K.tabId){var B=T.conversationId;Ct.data("mck-conversationid",B),z.removeClass(P).addClass(G),z.data("msgkey",G),f("."+G+" .mck-message-status").removeClass("mck-pending-icon").addClass("mck-sent-icon").attr("title","sent"),Oa.addTooltip(G),K.isTopPanelAdded&&Je.data("datetime",T.createdAt);var H=!0;L.groupId&&6===wa.getGroup(L.groupId).type&&(H=!1),H&&Oa.messageContextMenu(G)}if(L.conversationPxy){var q=L.conversationPxy;L.topicId&&(Te[L.topicId]=[B]),le[B]=q}}else"CONVERSATION_CLOSED"===T||"BUSY_WITH_OTHER"===T?(te.attr("disabled",!1),Oa.closeConversation(T),z.remove(),K.isTopPanelAdded&&Ze.removeClass("vis").addClass("n-vis")):"error"===T&&(te.attr("disabled",!1),de.html("Unable to process your request. Please try again"),de.removeClass("n-vis").addClass("vis"),z.remove(),K.isTopPanelAdded&&Ze.removeClass("vis").addClass("n-vis"));var V=f("[data-msgtype=5]").length,W=null;if(CURRENT_GROUP_DATA.groupMembers&&CURRENT_GROUP_DATA.groupMembers.length)for(var J=0;J<=CURRENT_GROUP_DATA.groupMembers.length;J++)if(CURRENT_GROUP_DATA.groupMembers[J]&&CURRENT_GROUP_DATA.groupMembers[J].userId==CURRENT_GROUP_DATA.conversationAssignee){W=CURRENT_GROUP_DATA.groupMembers[J].roleType;break}1==V&&(KommunicateUI.leadCollectionEnabledOnAwayMessage&&1!==W&&KommunicateUI.awayMessageInfo.isEnabled&&1==KommunicateUI.awayMessageInfo.eventId||KommunicateUI.welcomeMessageEnabled&&1!==W&&KommunicateUI.leadCollectionEnabledOnWelcomeMessage&&KommunicateUI.anonymousUser)&&KommunicateUI.displayLeadCollectionTemplate(null),V>1&&f("#mck-email-collection-box").removeClass("vis").addClass("n-vis");var ee=Oa.getTabDisplayName(U,!1);if(!za.MCK_USER_DETAIL_MAP[U]&&U!==ee){Ka.updateDisplayName(U,ee);var ae={userId:U,userName:ee};za.MCK_USER_DETAIL_MAP[ae.userId]=ae}},error:function(){de.html("Unable to process your request. Please try again."),de.removeClass("n-vis").addClass("vis"),z&&z.remove(),K.isTopPanelAdded&&Ze.removeClass("vis").addClass("n-vis")}}),f("#mck-reply-to-div").removeClass("vis").addClass("n-vis")},U.updateMessageMetadata=function(f){(f.metadata||f.messageKey)&&window.Applozic.ALApiService.ajax({type:"POST",url:MCK_BASE_URL+"/rest/ws/message/update/metadata",global:!1,data:T.JSON.stringify(f),contentType:"application/json",success:function(f){},error:function(){}})},U.downloadImage=function(f){window.open(f,"_blank")},U.replyMessage=function(T){var L,K=(Ct.data("mck-id"),Ra.getReplyMessageByKey(T));V.focus().select(),f("#mck-reply-to-div").removeClass("n-vis").addClass("vis"),L=5===K.type?"You":Oa.getTabDisplayName(K.to,!1),f("#mck-reply-to").html(L),"object"==typeof K.fileMeta||2===K.contentType?f("#mck-reply-msg").html(Oa.getImageForMessagePreview(K)):f("#mck-reply-msg").html(K.message),f("#mck-text-box").data("AL_REPLY",T)},f("#close").click((function(){f("#mck-reply-to-div").removeClass("vis").addClass("n-vis"),f("#mck-text-box").data("AL_REPLY","")})),U.deleteMessage=function(L){var K=Ct.data("mck-id");void 0!==K&&window.Applozic.ALApiService.ajax({url:MCK_BASE_URL+"/rest/ws/message/delete?key="+L,type:"get",success:function(U){"success"===U?(Ct.data("mck-id")===K&&(f("."+L).remove(),Ct.is(":empty")&&Ze.removeClass("vis").addClass("n-vis")),ALStorage.clearMckMessageArray()):T.console.log("Unable to delete message. Please reload page.")}})},U.deleteConversation=function(){var f=Ct.data("mck-id"),T=Ct.data("isgroup"),L=Ct.data("mck-conversationid");if(void 0!==f){var K={};T?K.groupId=f:K.userId=f,L&&(K.conversationId=L),ae=!0,window.Applozic.ALApiService.deleteConversation({data:K,success:function(){Ct.data("mck-id")===f&&(Ct.html(""),Je.data("datetime",""),pe.removeClass("n-vis").addClass("vis"),Ze.removeClass("vis").addClass("n-vis"),ae=!1)},error:function(){}})}},U.populateAwayStatusAndMessage=function(f,T,L,K){U.isFaqTabOpen()||U.isConversationInWaitingQueue()||(K&&"AGENTS_ONLINE"===K.code&&!T?KommunicateUI.setAvailabilityStatus("online"):K&&"SUCCESS"===K.code&&!T&&KommunicateUI.setAvailabilityStatus("away"),KommunicateUI.populateAwayMessage(L,K),KommunicateUI.updateLeadCollectionStatus(L,K,f.message||[]))},U.loadMessageList=function(L,K){var U=!1,P=!1,G="",B=!1;void 0!==L.tabId&&""!==L.tabId?(CURRENT_GROUP_DATA.tabId=parseInt(L.tabId),G=L.isGroup?"&groupId="+L.tabId:"&userId="+encodeURIComponent(L.tabId),U=!0,L.startTime&&(G+="&endTime="+L.startTime),G+="&pageSize=30",(Yt||xt)&&L.conversationId&&(G+="&conversationId="+L.conversationId,void 0===Ea[L.tabId]?(P=!0,G+="&conversationReq=true"):Oa.addConversationMenu(L.tabId,L.isGroup))):(ae=!0,L.startTime&&(G+="&endTime="+L.startTime),G+="&mainPageSize=30"),L.startTime||L.allowReload||Ct.html(""),L.latestMessageReceivedTime&&(G+="&startTime="+L.latestMessageReceivedTime),L.allowReload?B=!0:ke.removeClass("n-vis").addClass("vis"),window.Applozic.ALApiService.ajax({url:MCK_BASE_URL+"/rest/ws/message/list?startIndex=0"+G,type:"get",global:!1,success:function(G){var H=!0;CURRENT_GROUP_DATA.isgroup=L.isGroup,CURRENT_GROUP_DATA.conversationStatus=G&&G.groupFeeds[0]&&G.groupFeeds[0].metadata.CONVERSATION_STATUS,CURRENT_GROUP_DATA.conversationAssignee=G&&G.groupFeeds[0]&&G.groupFeeds[0].metadata.CONVERSATION_ASSIGNEE,CURRENT_GROUP_DATA.groupMembers=G.userDetails&&G.userDetails,CURRENT_GROUP_DATA.lastMessagingMember=G.message[0]&&G.message[0].contactIds,L.isWaitingQueue&&KommunicateUI.handleWaitingQueueMessage();var q=Ct.data("mck-id"),V=Ct.data("isgroup");if(L.isGroup&&!L.startTime||ke.removeClass("vis").addClass("n-vis"),ae=!1,(void 0===q||L.tabId===q&&""+V==""+L.isGroup)&&(G+""!="null"&&void 0!==G.message&&0!==G.message.length||(H=!1,U?L.startTime?Je.data("datetime",""):L.isGroup||0!==f("#mck-message-cell .mck-message-inner div[name='message']").length||Ze.removeClass("vis").addClass("n-vis"):(L.startTime,Ct.data("datetime",""))),G+""!="null"&&"error"!==G.status)){if(U){if(H&&(L.startTime>0?Oa.processMessageList(G,!1,!0,B):L.isGroup||(Oa.processMessageList(G,!0,!0,B),Ze.removeClass("n-vis").addClass("vis"))),!L.startTime>0&&!L.isGroup&&"function"==typeof Be&&Be(L.tabId),G.userDetails.length>0&&f.each(G.userDetails,(function(f,K){if(za.MCK_USER_DETAIL_MAP[K.userId]=K,!L.isGroup&&(K.connected?T.MCK_OL_MAP[K.userId]=!0:(T.MCK_OL_MAP[K.userId]=!1,void 0!==K.lastSeenAtTime&&(ce[K.userId]=K.lastSeenAtTime)),Ae||L.isGroup||(K.blockedByThis?(ne[K.userId]=!0,Sa.toggleBlockUser(L.tabId,!0)):K.blockedByOther?(oe[K.userId]=!0,se.removeClass("mck-tab-title-w-status"),ue.removeClass("vis").addClass("n-vis"),ge.removeClass("vis").addClass("n-vis"),Ct.data("blocked",!1)):Sa.toggleBlockUser(L.tabId,!1)),K.userName&&!L.startTime)){var U=Oa.getTabDisplayName(L.tabId,L.isGroup,K.userName);se.html(U),se.attr("title",U),KommunicateUI.adjustConversationTitleHeadingWidth(Za)}})),!Kt||L.isGroup||L.startTime||T.MCK_OL_MAP[L.tabId]||Ia.manageOfflineMessageTime(L.tabId),G.conversationPxys.length>0){var W=new Array;f.each(G.conversationPxys,(function(L,K){if("object"==typeof K&&(W.push(K),le[K.id]=K,Te[K.topicId]=[K.id],K.topicDetail))try{re[K.topicId]=f.parseJSON(K.topicDetail)}catch(L){T.console.log("Incorect Topic Detail!")}})),P&&(Ea[L.tabId]=W,Oa.addConversationMenu(L.tabId,L.isGroup))}if(L.conversationId){var J=le[L.conversationId];"object"==typeof J&&J.closed&&Oa.closeConversation()}L.startTime||(L.isGroup?(La.addGroupStatus(wa.getGroup(L.tabId)),Oa.updateUnreadCount("group_"+L.tabId,0,!0)):Oa.updateUnreadCount("user_"+L.tabId,0,!0)),G.groupFeeds.length>0&&f.each(G.groupFeeds,(function(T,K){var U=wa.addGroup(K);if(!L.startTime){var P=K.membersId,z=[];if(f.each(P,(function(f,T){void 0===Oa.getContact(T)&&z.push(T)})),z.length>0)L.isMessages=H,L.messageData=G,L.isLoadMessageList=!0,Ka.getUsersDetail(z,L);else{La.addGroupStatus(U);var q,V=!0;7===U.type&&(we.removeClass("vis").addClass("n-vis"),Ma.getContactFromGroupOfTwo(U,(function(f){q=Oa.fetchContact(f)})),Sa.lastSeenOfGroupOfTwo(q.contactId)),"kommunicate"==window.applozic.PRODUCT_ID&&U.users[Tt]&&(3!==U.users[Tt].role&&2!==U.users[Tt].role&&0!==U.users[Tt].role||we.removeClass("vis").addClass("n-vis")),6===U.type&&(La.validateOpenGroupUser(U),V=Ma.isAppendOpenGroupContextMenu(U)),ke.removeClass("vis").addClass("n-vis"),H?(Oa.loadDropdownOptions(),Oa.processMessageList(G,!0,V,B,L.allowReload),6!==U.type&&Ze.removeClass("n-vis").addClass("vis")):0===f("#mck-message-cell .mck-message-inner div[name='message']").length&&Ze.removeClass("vis").addClass("n-vis"),"function"==typeof Be&&Be(L.tabId)}}}))}else L.startTime||(T.MCK_OL_MAP=[]),G.userDetails.length>0&&f.each(G.userDetails,(function(f,L){za.MCK_USER_DETAIL_MAP[L.userId]=L,L.connected?T.MCK_OL_MAP[L.userId]=!0:(T.MCK_OL_MAP[L.userId]=!1,void 0!==L.lastSeenAtTime&&(ce[L.userId]=L.lastSeenAtTime)),Oa.updateUnreadCount("user_"+L.userId,L.unreadCount,!1);var K=Oa.getContact(""+L.userId);void 0===K?Oa.createContactWithDetail(L):Oa.updateContactDetail(K,L)})),G.groupFeeds.length>0&&f.each(G.groupFeeds,(function(f,T){Oa.updateUnreadCount("group_"+T.id,T.unreadCount,!1),wa.addGroup(T)})),G.blockedUserPxyList.blockedToUserList.length>0&&f.each(G.blockedUserPxyList.blockedToUserList,(function(f,T){T.userBlocked&&(ne[T.blockedTo]=!0)})),G.blockedUserPxyList.blockedByUserList.length>0&&f.each(G.blockedUserPxyList.blockedByUserList,(function(f,T){T.userBlocked&&(oe[T.blockedBy]=!0)})),G.conversationPxys.length>0&&f.each(G.conversationPxys,(function(L,K){if(le[K.id]=K,Te[K.topicId]=[K.id],K.topicDetail)try{re[K.topicId]=f.parseJSON(K.topicDetail)}catch(L){T.console.log("Incorect Topic Detail!")}})),H?(L.startTime?L.startTime&&(L.isReload=!1,U||ALStorage.updateLatestMessageArray(G.message)):(L.isReload=!0,U||ALStorage.setLatestMessageArray(G.message)),U&&ALStorage.updateMckMessageArray(G.message),Oa.addContactsFromMessageList(G,L)):Ct.data("datetime",""),L.isLaunch&&Oa.updateUnreadCountonChatIcon(G.userDetails);if(L.isGroup){Kommunicate.conversation.processConversationOpenedFromList(G);var ee=G.groupFeeds[0]&&G.groupFeeds[0].metadata.CONVERSATION_ASSIGNEE,te=G.userDetails.filter((function(f){return f.userId==ee}))[0]}if(G.userDetails.length>0&&G.groupFeeds.length>0){var ie,de=new Object;ie=G.groupFeeds[0].name?G.groupFeeds[0].name:void 0!==L.groupName?L.groupName:Oa.getTabDisplayName(L.tabId,L.isGroup,L.userName),de.name=ie,G&&G.groupFeeds[0]&&(de.imageUrl=G.groupFeeds[0].imageUrl),!L.isConversationInWaitingQueue&&Na.processOnlineStatusChange(L.tabId,te,de)}}var me=z.data("forwardMessageKey");for(var pe in void 0!==me&&(Na.sendForwardMessage(me),z.data("forwardMessageKey","")),"function"==typeof K&&K(G),Oa.messageClubbing(!0),G.userDetails){if(G.userDetails[pe].userId&&G.userDetails[pe].userId==CURRENT_GROUP_DATA.conversationAssignee&&G.userDetails[pe].roleType==KommunicateConstants.APPLOZIC_USER_ROLE_TYPE.BOT){La.checkBotDetail(CURRENT_GROUP_DATA.conversationAssignee);break}CURRENT_GROUP_DATA.CHAR_CHECK=!1}},error:function(f,L,U){401===f.status&&ALStorage.clearSessionStorageElements(),ae=!1,ke.removeClass("vis").addClass("n-vis"),T.console.log("Unable to load messages. Please reload page."),"function"==typeof K&&K(null,U)}})},U.getAndSetAwayMessage=function(f,T,L,K){var P=KommunicateUtils.isSessionStorageAvailable()?JSON.parse(sessionStorage.kommunicate):{},G=P&&P.settings&&P.settings.KM_CHAT_CONTEXT&&P.settings.KM_CHAT_CONTEXT.kmUserLanguageCode;T&&void 0!==L&&L!==KommunicateConstants.APPLOZIC_USER_ROLE_TYPE.BOT&&Kommunicate.getAwayMessage({applicationId:be,conversationId:T,languageCode:G||"default"},(function(T,L){U.populateAwayStatusAndMessage(f,K,T,L)}))},U.getUserAvailabilityStatus=function(f,T){var L=new Object;void 0!==f&&f.roleType===KommunicateConstants.APPLOZIC_USER_ROLE_TYPE.BOT?L.availabilityStatus=KommunicateConstants.AVAILABILITY_STATUS.ONLINE:void 0!==f&&f.roleType===KommunicateConstants.APPLOZIC_USER_ROLE_TYPE.APPLICATION_WEB_ADMIN&&(void 0!==f&&1==f.connected?L.availabilityStatus=KommunicateConstants.AVAILABILITY_STATUS.ONLINE:(L.availabilityStatus=KommunicateConstants.AVAILABILITY_STATUS.OFFLINE,L.isAgentOffline=!0)),"function"==typeof T&&T(L)},U.isFaqTabOpen=function(){return document.querySelector("#km-faqdiv").classList.contains("vis")||document.querySelector("#km-faq-category-list-container").classList.contains("vis")||document.querySelector("#km-contact-search-input-box").classList.contains("vis")},U.isConversationInWaitingQueue=function(){return document.querySelector("#mck-waiting-queue").classList.contains("vis")},U.updateConversationHeader=function(T){if(!U.isFaqTabOpen()&&!U.isConversationInWaitingQueue()){var L;T.name=T.name&&Ga.formatHtmlTag(T.name);var K=T.name?T.name+" profile image":"Profile image";se.html(T.name),se.attr("title",T.name),KommunicateUI.adjustConversationTitleHeadingWidth(Za),T.imageUrl?(L=T.imageUrl,f(".mck-agent-image-container img").removeClass("n-vis"),f(".mck-agent-image-container .mck-agent-image-svg-container").addClass("n-vis")):(L="",f(".mck-agent-image-container .mck-agent-image-svg-container").html(Oa.getContactImageByAlphabet(T.name)),f(".mck-agent-image-container .mck-agent-image-svg-container").removeClass("n-vis"),f(".mck-agent-image-container img").addClass("n-vis")),f(".mck-agent-image-container img").attr({src:L,alt:K}),MCK_GROUP_MAP[CURRENT_GROUP_DATA.tabId]&&T.name&&(MCK_GROUP_MAP[CURRENT_GROUP_DATA.tabId].displayName=T.name,MCK_GROUP_MAP[CURRENT_GROUP_DATA.tabId].imageUrl=L),KommunicateUI.setAvailabilityStatus(T.availabilityStatus)}},U.updateAssigneeDetails=function(f,T){var L=new Object;f.displayName&&(L.name=f.displayName),f.imageLink&&(L.imageUrl=f.imageLink),CURRENT_GROUP_DATA.conversationAssignee=f&&f.userId,f.roleType===KommunicateConstants.APPLOZIC_USER_ROLE_TYPE.BOT?L.availabilityStatus=KommunicateConstants.AVAILABILITY_STATUS.ONLINE:L.availabilityStatus=f.connected?KommunicateConstants.AVAILABILITY_STATUS.ONLINE:KommunicateConstants.AVAILABILITY_STATUS.OFFLINE,U.processOnlineStatusChange(T,f,L)},U.processOnlineStatusChange=function(f,T,L){Na.getUserAvailabilityStatus(T,(function(K){L.availabilityStatus=K.availabilityStatus,Na.getAndSetAwayMessage({},f,T&&T.roleType,K.isAgentOffline),Na.updateConversationHeader(L)}))},U.updateContactList=function(f,T){var L={};T?L.groupId=f:L.userId=f,L.pageSize=1,window.Applozic.ALApiService.getMessages({data:L,success:function(L){var K=L.data;if(K+""=="null"||void 0===K.message||0===K.message.length)Oa.clearContactMessageData(f,T);else{var P=K.message[0];void 0!==P&&(P.groupId?Ma.addGroupFromMessage(P,!0,(function(f,T,L){U.updateRecentConversationList(f,T,L)})):Oa.addContactsFromMessage(P,!0))}},error:function(L){Oa.clearContactMessageData(f,T)}})},U.conversationReadUpdate=function(f){var T=f.tabId,L=f.isGroup?"group_"+T:"user_"+T;if(T&&Oa.getUnreadCount(L)>0){var K=""+f.isGroup=="true"?"groupId="+T:"userId="+T;window.Applozic.ALApiService.conversationReadUpdate({data:K,success:function(f){Oa.updateUnreadCount(L,0,!0)},error:function(){}})}},U.getConversationId=function(L){if(!L.isGroup&&!L.isMessage&&L.topicStatus!==ca[1]){var K=Te[L.topicId];if(K&&"object"==typeof(P=le[K])){if(Ct.data("mck-conversationid",P.id),L.conversationId=P.id,void 0!==Ea[L.tabId]){var U=Ea[L.tabId];U.push(P),Ea[L.tabId]=U}return void Oa.loadTab(L)}}if(L.topicId){var P={topicId:L.topicId,userId:L.tabId,status:L.topicStatus};L.isGroup?P.groupId=L.groupId:P.userId=L.tabId;var G=re[L.topicId];"object"==typeof G&&(P.topicDetail=T.JSON.stringify(G)),L.fallBackTemplatesList&&L.fallBackTemplatesList.length>0&&(P.fallBackTemplatesList=L.fallBackTemplatesList),window.Applozic.ALApiService.getConversationId({data:P,success:function(K){if("object"==typeof K&&"success"===K.status){var U=K.response;if("object"==typeof U&&"undefined"!==U.conversationPxy){var P=U.conversationPxy;if(le[P.id]=P,Te[P.topicId]=[P.id],P.topicDetail)try{re[P.topicId]=f.parseJSON(P.topicDetail)}catch(f){T.console.log("Incorect Topic Detail!")}if(Ct.data("mck-conversationid",P.id),L.conversationId=P.id,void 0!==Ea[L.tabId]){var G=Ea[L.tabId];G.push(P),Ea[L.tabId]=G}if(L.isGroup){var B=wa.addGroup(U);L.tabId=B.contactId}L.isMessage&&P.created?Oa.loadTab(L,Ra.dispatchMessage):Oa.loadTab(L)}}},error:function(){}})}},U.sendPriceMessage=function(){var T=Re.val();if(""!==T){T=f.trim(T);var L=B.val(),K=Ct.data("mck-conversationid",K),P={type:5,contentType:4,message:T};if(!0===Ct.data("isgroup")?P.groupId=L:P.to=L,Ct.data("mck-conversationid")){K=Ct.data("mck-conversationid"),P.conversationId=K;var G=le[K];"object"!==G?Ra.getTopicId({conversationId:K,suppId:L,priceText:T},(function(f){Oa.populateMessage(f.messageType,f.message,f.notifyUser)})):"function"==typeof Ye&&Ye({custId:Tt,suppId:L,productId:G.topicId,price:T}),Re.val("")}U.sendMessage(P)}else Re.addClass("mck-text-req")},U.getGroup=function(L){var K=[];Oa.loadDropdownOptions(),f.each(L.users,(function(f,T){void 0!==T.userId&&(void 0!==T.groupRole&&-1===Ee.indexOf(T.groupRole)||K.push(T))}));var U={groupName:f.trim(L.groupName),users:K,type:L.type};L.admin&&(U.admin=L.admin),L.clientGroupId&&(U.clientGroupId=L.clientGroupId),L.groupIcon&&(U.imageUrl=L.groupIcon),U.metadata=L.metadata?L.metadata:MCK_LABELS["group.metadata"];var P=new Object;window.Applozic.ALApiService.ajax({url:MCK_BASE_URL+"/rest/ws/group/v2.1/create",global:!1,data:T.JSON.stringify(U),type:"post",contentType:"application/json",success:function(K){if(L.isInternal&&qe.attr("disabled",!1).html(MCK_LABELS["create.group.title"]),"object"==typeof K&&"success"===K.status){var U=K.response;if("object"==typeof U){var G=wa.addGroup(U);U.users.length>0&&f.each(U.users,(function(f,L){za.MCK_USER_DETAIL_MAP[L.userId]=L,L.connected?T.MCK_OL_MAP[L.userId]=!0:(T.MCK_OL_MAP[L.userId]=!1,void 0!==L.lastSeenAtTime&&(ce[L.userId]=L.lastSeenAtTime)),Oa.updateUnreadCount("user_"+L.userId,L.unreadCount,!1);var K=Oa.getContact(""+L.userId);void 0===K?Oa.createContactWithDetail(L):Oa.updateContactDetail(K,L)})),CURRENT_GROUP_DATA.tabId=U.clientGroupId,CURRENT_GROUP_DATA.conversationStatus=U.metadata.CONVERSATION_STATUS,CURRENT_GROUP_DATA.groupMembers=U.groupUsers,L.tabId=G.contactId,L.isGroup=!0,!L.allowMessagesViaSocket&&(L.viaCreateGroup=!0),L.groupDetails=U,L.isMessage?Oa.loadTab(L,Ra.dispatchMessage):L.isInternal?(Ct.data("mck-id",G.contactId),Ct.data("isgroup",!0),La.loadGroupInfo({groupId:G.contactId})):Oa.loadTab(L),"function"==typeof L.callback&&(P.updated=!!K.updated&&K.updated,P.status="success",P.data=G,L.callback(P),Oa.loadDropdownOptions())}}else"error"===K.status&&"function"==typeof L.callback&&(P.status="error",P.errorMessage=K.errorResponse[0].description,L.callback(P))},error:function(){L.isInternal&&qe.attr("disabled",!1).html(MCK_LABELS["create.group.title"]),"function"==typeof L.callback&&(P.status="error",P.errorMessage="Unable to process request.",L.callback(P))}})},U.sendDeliveryUpdate=function(f){void 0!==f&&""!==f&&window.Applozic.ALSocket.sendMessageStatus(f,4,Tt)},U.sendReadUpdate=function(f){void 0!==f&&""!==f&&window.Applozic.ALSocket.sendMessageStatus(f,1,Tt)}},Ka=new function(){f("#mck-search-list");var L=f("#mck-sidebox-search"),K=f("#mck-search-loading");f("#mck-search-cell .mck-message-inner"),f("#mck-message-cell .mck-message-inner"),f(".mck-tab-message-option"),f("#mck-contact-loading"),this.getContactDisplayName=function(f){var T=[];window.Applozic.ALApiService.getContactDisplayName({data:{userIdArray:f},success:function(f){for(var L in f)f.hasOwnProperty(L)&&(T.push([L,f[L]]),Ca[L]=f[L],Oa.fetchContact(L).displayName=f[L]);ALStorage.updateMckContactNameArray(T)},error:function(){}})},this.loadContacts=function(){var U=[];window.Applozic.ALApiService.getContactList({url:"/rest/ws/user/v3/filter?startIndex=0&pageSize=50&orderBy=1",baseUrl:MCK_BASE_URL,success:function(K){if(L.hasClass("vis"))return"object"==typeof K&&K.users.length>0&&(f.each(K.users,(function(f,L){if(void 0!==L.userId){var K=Oa.getContact(""+L.userId);K=void 0===K?Oa.createContactWithDetail(L):Oa.updateContactDetail(K,L),ka.push(K),U.push([L.userId,K.displayName]),L.connected?T.MCK_OL_MAP[L.userId]=!0:(T.MCK_OL_MAP[L.userId]=!1,void 0!==L.lastSeenAtTime&&(ce[L.userId]=L.lastSeenAtTime))}})),Ka.getUsersDetail(contactNameArray,{async:!1}),U.length>0&&ALStorage.updateMckContactNameArray(U)),Oa.addContactsToSearchList(),void La.addMembersToGroupSearchList()},error:function(){K.removeClass("vis").addClass("n-vis"),T.console.log("Unable to load contacts. Please reload page.")}})},this.getUsersDetail=function(L,K){if(!(void 0===L||L.length<1)){for(var U=void 0===K.cached||K.cached,P=[],G=L.filter((function(f,T){return L.indexOf(f)===T})),B=0;B<G.length;B++){var z=G[B];U&&void 0!==za.MCK_USER_DETAIL_MAP[z]||P.push(z)}if(0!==P.length){var H=new Object;window.Applozic.ALApiService.getUserDetail({data:P,success:function(L){"success"===L.status&&L.response.length>0&&f.each(L.response,(function(f,L){za.MCK_USER_DETAIL_MAP[L.userId]=L,T.MCK_OL_MAP[L.userId]=L.connected;var K=Oa.getContact(""+L.userId);K=void 0===K?Oa.createContactWithDetail(L):Oa.updateContactDetail(K,L)})),K.setStatus?Sa.updateUserConnectedStatus():K.message?Oa.populateMessage(K.messageType,K.message,K.notifyUser):K.isLoadMessageList&&Oa.loadMessageListOnUserDetailFetch(K),H.status="success",H.data=L,K.callback&&K.callback(H)},error:function(){K.setStatus?Sa.updateUserConnectedStatus():K.message?Oa.populateMessage(K.messageType,K.message,K.notifyUser):K.isLoadMessageList&&Oa.loadMessageListOnUserDetailFetch(K),H.status="error",K.callback&&K.callback(H)}})}else K.setStatus?Sa.updateUserConnectedStatus():K.message?Oa.populateMessage(K.messageType,K.message,K.notifyUser):K.isLoadMessageList&&Oa.loadMessageListOnUserDetailFetch(K)}},this.updateUserIdentity=function(f){if(null!==f.newUserId&&""!==f.newUserId){var T="newUserId="+encodeURIComponent(f.newUserId);window.Applozic.ALApiService.ajax({url:MCK_BASE_URL+"/rest/ws/user/change/identifier",type:"get",data:T,contentType:"application/json",success:function(T){"object"==typeof T&&"success"===T.status&&f.callback&&f.callback(T)},error:function(T){f.callback&&f.callback({response:"error"})}})}},this.updateUser=function(L){var K={elasticUpdate:!0};L.data.email&&(K.allowEmail=!0);var U=MCK_BASE_URL+"/rest/ws/user/update?"+f.param(K);window.Applozic.ALApiService.ajax({type:"POST",url:U,data:T.JSON.stringify(L.data),contentType:"application/json",success:function(f){L.success&&L.success(f)},error:function(f){L.error&&L.error(f)}})},this.updateDisplayName=function(T,L){if(""!==T&&""!==L){var K="userId="+T+"&displayName="+L;f.ajax({url:MCK_BASE_URL+"/rest/ws/user/name",type:"get",data:K,success:function(f){if("object"==typeof f&&"success"===f.status)return"success"},error:function(){}})}}},Ua=new function(){var T,K,U,P,G=this;G.init=function(){f("#mck-sidebox"),K=f("#mck-group-info-tab"),f("#mck-sidebox-launcher"),T=f("#mck-message-cell .mck-message-inner"),U=f("#mck-msg-preview-visual-indicator"),P=f("#mck-msg-preview-visual-indicator .mck-msg-preview-visual-indicator-text")},G.notifyUser=function(f){if(!1!==f.alert&&7!==f.type&&!1!==f.metadata.alert){var T=f.groupId?wa.getGroup(""+f.groupId):Oa.fetchContact(""+f.to.split(",")[0]),L=!1;f.groupId&&(L=!0),za.loadUserProfile(f.to);var K=Oa.getTabDisplayName(T.contactId,L),U=$a;if(Ia.clearMsgTriggerAndChatPopuTimeouts(),G.showNewMessageNotification(f,T,K),"v2"===pe&&!ue&&G.handleIframeNotification(),Qt&&!de){var P=ut,B=Oa.getTextForMessagePreview(f,T);if("function"==typeof Je&&!T.isGroup){var z=Je(T.contactId);z&&void 0!==z&&(P=z)}ma=setInterval((function(){parent.document.title===ga?parent.document.title=MCK_LABELS["page.title.on.new.message"]+K:parent.document.title=ga}),1e3),U?Ba.sendDesktopNotification(K,P,B,U):Ba.sendDesktopNotification(K,P,B)}}},G.clearFlashPageTitleInterval=function(){clearInterval(ma),parent.document.title=ga},G.handleIframeNotification=function(){ao===KommunicateConstants.POSITION.LEFT&&Ga.modifyClassList({class:["mck-msg-preview-visual-indicator-container","mck-close-btn-container"]},"align-left");var f=parent.document.getElementById("kommunicate-widget-iframe"),T=document.getElementById("mck-msg-preview-visual-indicator").offsetWidth,L=document.getElementById("mck-sidebox-launcher").offsetWidth;f.classList.add("km-iframe-notification"),f.style.width=T+L+50+"px"},G.hideMessagePreview=function(){var f=parent.document.getElementById("kommunicate-widget-iframe");U.removeClass("vis").addClass("n-vis"),P.html(""),f.style.width=""},G.formatMessageForNotification=function(f){var T=f.textContent.length||f.innerText.length||f.length;return document.getElementsByClassName("mck-msg-preview-visual-indicator-text")[0].style.width=T>28?"200px":7*T+"px",T>86&&(f.innerHTML=f.innerHTML.replace(/&nbsp;/g," ").substring(0,80)+" ..."),f},G.showNewMessageNotification=function(B,z,H){if(Xt&&102!==B.contentType&&!B.metadata.KM_ASSIGN&&!B.metadata.KM_STATUS){var q=T.data("mck-id"),V=T.data("isgroup");if(q===z.contactId&&V===z.isGroup&&!K.hasClass("vis")&&!da){if(!B.conversationId||!Yt&&!xt)return;var W=T.data("mck-conversationid");if((W=void 0!==W&&""!==W?W.toString():"")===B.conversationId.toString())return}P.data("isgroup",z.isGroup);var J=B.conversationId?B.conversationId:"";P.data("mck-conversationid",J);var ee=Oa.getContactImageLink(z,H,B);if(B.message){var te=Oa.getMessageTextForContactPreview(B,z);if(P.html(""),P.removeClass("mck-flexi"),"object"==typeof te){var ae=G.formatMessageForNotification(te);P.append(ae)}else if(3===B.contentType){var ne=Ga.removeHtmlTag(B.message),oe=document.createElement("p");oe.appendChild(document.createTextNode(ne)),ae=G.formatMessageForNotification(oe),P.append(ae)}else P.html(te);U.removeClass("n-vis").addClass("vis")}else P.html("");if(B.fileMetaKey)P.html(Da.getFileIcon(B)),U.removeClass("n-vis").addClass("vis"),P.addClass("mck-flexi");else if(2===B.contentType){for(;"."===te[te.length-1];)te=te.slice(0,-1);P.html(te),U.removeClass("n-vis").addClass("vis"),P.addClass("mck-flexi")}-1!=!ee.indexOf("/avatars/default.png")?(f("#launcher-agent-img-container").html(ee),f("#launcher-agent-img-container").addClass("vis").removeClass("n-vis"),f("#launcher-svg-container").addClass("n-vis").removeClass("vis")):(f("#launcher-agent-img-container").html("").addClass("n-vis").removeClass("vis"),f("#launcher-svg-container").addClass("vis").removeClass("n-vis")),void 0!==ft&&document.getElementById("mck-sidebox-launcher").childNodes[0].childNodes[0].classList.add("n-vis"),P.data("mck-id",z.contactId),Kommunicate.KmEventHandler.notificationEvent(B),f(L).on("click","#mck-msg-preview-visual-indicator .mck-close-btn",(function(f){var T=parent.document.getElementById("kommunicate-widget-iframe");T.classList.remove("km-iframe-dimension-no-popup"),T.classList.remove("km-iframe-notification"),T.classList.remove("km-iframe-dimension-with-popup"),document.getElementById("km-popup-close-button").style.display="none",G.hideMessagePreview(),Ga.modifyClassList({id:["applozic-badge-count"]},"","n-vis")})),f(L).on("click"," #mck-msg-preview-visual-indicator .mck-msg-preview-visual-indicator-text",(function(){kmWidgetEvents.eventTracking(eventMapping.onNotificationClick),G.hideMessagePreview(),KommunicateUI.hideFaq()})),!de&&Ua.clearFlashPageTitleInterval()}}},Ra=new AlMessageService,Da=new AlFileService,Pa=new KmCustomTheme,Ga=new KommunicateCommons,Ba=new MckNotificationUtils,Fa=new AlNotificationService,za=new AlUserService,Ha=f(".chat-launcher-icon"),$a=null,qa=null,ja={},Va=Na.checkArray(P.askUserDetails),Wa=P.quickReplies?Na.checkArray(P.quickReplies):[],Ya=P.preLeadCollection?Na.checkArray(P.preLeadCollection):P.appSettings.collectLead&&P.appSettings.leadCollection?Na.checkArray(P.appSettings.leadCollection):[],Ja=P.conversationTitle,Qa=P.agentId,Xa=P.botIds,Za=(P.agentName,"boolean"!=typeof P.useBranding||P.useBranding,P.popupWidget);T.MCK_OL_MAP=new Array;var en=P.voiceInput,tn=P.voiceOutput,nn={1:MCK_LABELS["emoji.hover.text"].poor,5:MCK_LABELS["emoji.hover.text"].average,10:MCK_LABELS["emoji.hover.text"].great},eo=ge&&ge.botMessageDelayInterval?ge.botMessageDelayInterval:0,to=ge&&ge.customBranding,ao=ge&&Ga.isObject(ge)&&ge.hasOwnProperty("position")?ge.position:KommunicateConstants.POSITION.RIGHT;window.Applozic.SOCKET_DISCONNECT_PROCEDURE={SOCKET_DISCONNECT_TIMER_VALUE:12e4,DISCONNECTED:!1,start:function(){this.SOCKET_DISCONNECT_TIMEOUT=setTimeout((function(){Sa.checkIfUserHasConversations(null,(function(f,T){T||(window.Applozic.ALSocket.disconnect(),window.Applozic.SOCKET_DISCONNECT_PROCEDURE.DISCONNECTED=!0,IS_SOCKET_CONNECTED=!1)}))}),this.SOCKET_DISCONNECT_TIMER_VALUE)},stop:function(){clearTimeout(this.SOCKET_DISCONNECT_TIMEOUT)}};var no=P.connectSocketOnWidgetClick,oo={};Ga.checkIfDeviceIsHandheld()&&(MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE=!1),B.toggleMediaOptions=function(){var f=document.getElementById("mck-text-box");Na.toggleMediaOptions(f)},B.submitMessage=function(f){Na.submitMessage(f.messagePxy,f.optns)},B.mckLaunchSideboxChat=function(){Ga.setWidgetStateOpen(!0),!Za&&f("#mck-sidebox-launcher").removeClass("vis").addClass("n-vis"),"v2"===pe&&Kommunicate.setDefaultIframeConfigForOpenChat(Za),KommunicateUI.showChat(),f("#mck-away-msg-box").removeClass("vis").addClass("n-vis"),Na.loadConversationWithAgents({groupName:Ja,agentId:Qa,botIds:Xa},(function(f){kmWidgetEvents.eventTracking(eventMapping.onStartNewConversation),KommunicateUI.activateTypingField(),Oa.loadDropdownOptions()})),f("#mck-msg-preview-visual-indicator").hasClass("vis")&&f("#mck-msg-preview-visual-indicator").removeClass("vis").addClass("n-vis");var T=document.getElementById("chat-popup-widget-container");T&&T.firstChild&&T.firstChild.removeEventListener("click",KommunicateUI.captureGreetingMessageClick)},B.openChat=function(f){Na.openChat(f)};var io={onConnectFailed:function(f){IS_SOCKET_CONNECTED=!1,navigator.onLine&&window.Applozic.ALSocket.reconnect()},onConnect:function(f){IS_SOCKET_CONNECTED=!0,Ga.modifyClassList({id:["km-local-file-system-warning"]},"n-vis","vis"),"object"==typeof oo&&0!=Object.keys(oo).length&&B.subscribeToEvents(oo,(function(){oo={}}))},onMessageDelivered:function(f){},onMessageRead:function(f){},onMessageDeleted:function(f){},onConversationDeleted:function(f){},onUserConnect:function(f){},onUserDisconnect:function(f){},onConversationReadFromOtherSource:function(f){},onConversationRead:function(f){},onMessageReceived:function(f){},onMessageSentUpdate:function(f){},onMessageSent:function(f){},onUserBlocked:function(f){},onUserUnblocked:function(f){},onUserActivated:function(f){},onUserDeactivated:function(f){},onMessageNotification:function(f){},connectToSocket:function(f){so.connectToSocket(f)},onMessage:function(f){so.onMessage(f)},onOpenGroupMessage:function(f){so.onOpenGroupMessage(f)},onTypingStatus:function(f){so.onTypingStatus(f)}};B.loadConversationWithAgent=function(f){if(!f||!f.agentId)throw new Error("params are empty");Na.loadConversationWithAgents(f)};var so=new function(){var L=f("#mck-sidebox"),K=f("#mck-tab-title"),U=f(".mck-typing-box"),P=f("#mck-tab-status"),G=(f("#mck-offline-message-box"),f("#mck-typing-label")),B=f("#mck-message-cell .mck-message-inner"),H=f(".mck-message-inner"),q=f("#mck-message-cell .mck-message-inner");this.connectToSocket=function(f){if(f&&"block"===L.css("display")){var T=B.data("mck-id");if(T){var K=B.data("isgroup"),U=B.data("mck-conversationid"),P=B.data("mck-topicid"),G=q.data("last-message-received-time")+1;ALStorage.clearMckMessageArray(),Na.loadMessageList({tabId:T,isGroup:K,conversationId:U,topicId:P,latestMessageReceivedTime:G,allowReload:!0})}else ALStorage.clearMckMessageArray(),z&&Oa.loadTab({tabId:"",isGroup:!1}),z=!0}window.Applozic.ALSocket.stompClient.connected||window.Applozic.ALSocket.reconnect()},this.onTypingStatus=function(T){var L=window.Applozic.ALSocket.typingSubscriber;if(null!=L&&L.id===T.headers.subscription){var z=T.body,q=z.split(",")[1],V=Number(z.split(",")[2]),W=T.headers.destination.substring(T.headers.destination.lastIndexOf("-")+1,T.headers.destination.length),J=B.data("mck-id"),ee=B.data("isgroup"),te=wa.getGroup(J);if(!ne[q]&&!oe[q])if(1===V){if(!(Tt===q&&ee||J!==q&&J!=W)){if(ee=B.data("isgroup")){if(q!==Tt){if(Ma.authenticateGroupUser(te)||6===te.type&&!Xe.disableChatForNonGroupMember){K.addClass("mck-tab-title-w-typing"),P.removeClass("vis").addClass("n-vis");var ae=Oa.getTabDisplayName(q,!1);ae=ae.split(" ")[0],G.html(ae+" "+MCK_LABELS["is.typing"])}7===te.type&&(K.addClass("mck-tab-title-w-typing"),G.html(MCK_LABELS["is.typing"]),P.html(""))}}else K.addClass("mck-tab-title-w-typing"),P.removeClass("vis").addClass("n-vis");f(".km-typing-wrapper").remove(),H.append('<div class="km-typing-wrapper"><div class="km-typing-indicator"></div><div class="km-typing-indicator"></div><div class="km-typing-indicator"></div></div>'),H.animate({scrollTop:H.prop("scrollHeight")},0),setTimeout((function(){K.removeClass("mck-tab-title-w-typing"),f(".km-typing-wrapper").remove(),K.hasClass(void 0===te||7!=te.type),G.html(MCK_LABELS.typing)}),1e4)}}else K.removeClass("mck-tab-title-w-typing"),U.removeClass("vis").addClass("n-vis"),f(".km-typing-wrapper").remove(),K.hasClass("mck-tab-title-w-status")&&(void 0===te||te.type),G.html(MCK_LABELS.typing)}},this.onOpenGroupMessage=function(T){if(-1!==window.Applozic.ALSocket.openGroupSubscriber.indexOf(T.headers.subscription)){var L=JSON.parse(T.body),K=L.type,U=L.message;if("APPLOZIC_03"===K)ALStorage.updateLatestMessage(U),0!==U.type&&4!==U.type&&(f("."+U.key+" .mck-message-status").removeClass("mck-pending-icon").addClass("mck-sent-icon").attr("title","sent"),Oa.addTooltip(U.key)),events.onMessageSentUpdate({messageKey:U.key});else if("APPLOZIC_01"===K||"APPLOZIC_02"===K||"MESSAGE_RECEIVED"===K){ALStorage.updateLatestMessage(U);var P=U.groupId?wa.getGroup(U.groupId):Oa.getContact(U.to);if(f("#mck-sidebox-content"),B.data("mck-id"),"APPLOZIC_01"===K||"MESSAGE_RECEIVED"===K){var G=Oa.getMessageFeed(U);events.onMessageReceived({message:G})}else"APPLOZIC_02"===K&&(G=Oa.getMessageFeed(U),events.onMessageSent({message:G}));if(U.conversationId){var z=le[U.conversationId];!Yt&&!xt||"object"==typeof z&&"object"==typeof re[z.topicId]||Ra.getTopicId({conversationId:U.conversationId,messageType:K,message:U,notifyUser:L.notifyUser,async:!1,populate:!1},(function(f){Oa.populateMessage(f.messageType,f.message,f.notifyUser)}))}if(void 0===P){var H={message:U,messageType:K,notifyUser:L.notifyUser};if(U.groupId)La.getGroupFeedFromMessage(H);else{var q=[];q.push(U.to),Ka.getUsersDetail(q,H)}return}Oa.populateMessage(K,U,L.notifyUser)}}},this.onMessage=function(L){"object"==typeof L.message&&q.data("last-message-received-time",L.message.createdAtTime);var G=L.type;if("APPLOZIC_04"===G||"MESSAGE_DELIVERED"===G)f("."+L.message.split(",")[0]+" .mck-message-status").removeClass("mck-pending-icon").removeClass("mck-sent-icon").addClass("mck-delivered-icon").attr("title","delivered"),Oa.addTooltip(L.message.split(",")[0]);else if("APPLOZIC_08"===G||"MT_MESSAGE_DELIVERED_READ"===G)f("."+L.message.split(",")[0]+" .mck-message-status").removeClass("mck-pending-icon").removeClass("mck-sent-icon").removeClass("mck-delivered-icon").addClass("mck-read-icon"),Oa.addTooltip(L.message.split(",")[0]);else if("APPLOZIC_05"===G){var z=L.message.split(",")[0],H=L.message.split(",")[1],V="1"===L.message.split(",")[2];Oa.removedDeletedMessage(z,H,V);var W={messageKey:L.message.split(",")[0]};V?W.groupId=H:W.userKey=H}else if("APPLOZIC_27"===G){var J=L.message.split(",")[0],ee=L.message.split(",")[1];if(void 0!==J){Oa.removeConversationThread(J,!1),Oa.updateUnreadCount("user_"+J,0,!0);var te={userId:J};ee&&(te.topicId=ee)}}else if("APPLOZIC_11"===G){J=L.message;var ae=Oa.fetchContact(J);if(H=B.data("mck-id"),!ne[J]&&!oe[J]){if(H!==ae.contactId||B.data("isgroup")){var ie=mckContactUtils.formatContactId(J);f("#li-user-"+ie+" .mck-ol-status").removeClass("n-vis").addClass("vis")}else f("#mck-tab-status").html(MCK_LABELS.online),Kt&&Oa.hideOfflineMessage();f(".mck-user-ol-status."+ie).removeClass("n-vis").addClass("vis"),f(".mck-user-ol-status."+ie).next().html("("+MCK_LABELS.online+")"),T.MCK_OL_MAP[J]=!0,za.updateUserStatus({userId:L.message,status:1},(function(f){Ka.getUsersDetail(f,{})}))}}else if("APPLOZIC_12"===G){J=L.message.split(",")[0];var se=L.message.split(",")[1];ae=Oa.fetchContact(J),T.MCK_OL_MAP[J]=!1,se&&(ce[J]=se),ne[J]||oe[J]||((H=B.data("mck-id"))!==ae.contactId||B.data("isgroup")||(f("#mck-tab-status").html(mckDateUtils.getLastSeenAtStatus(se)),Kt&&Ia.manageOfflineMessageTime(H)),f(".mck-user-ol-status."+ae.htmlId).removeClass("vis").addClass("n-vis"),f(".mck-user-ol-status."+ae.htmlId).next().html("(Offline)"),f("#li-user-"+ie+" .mck-ol-status").removeClass("vis").addClass("n-vis"),za.updateUserStatus({userId:J,status:0,lastSeenAtTime:se},(function(f){Ka.getUsersDetail(f,{})})))}else if("APPLOZIC_29"===G)J=L.message.split(",")[0],ee=L.message.split(",")[1],ae=Oa.fetchContact(J),Oa.updateUnreadCount("user_"+ae.contactId,0,!0),void 0!==(H=B.data("mck-id"))&&""!==H||(f("#li-user-"+ae.htmlId+" .mck-unread-count-text").html(Oa.getUnreadCount("user_"+ae.contactId)),f("#li-user-"+ae.htmlId+" .mck-unread-count-box").removeClass("vis").addClass("n-vis")),te={userId:J},ee&&(te.topicId=ee);else if("APPLOZIC_28"===G)J=L.message.split(",")[0],ee=L.message.split(",")[1],(H=B.data("mck-id"))===J&&(f(".mck-msg-right .mck-message-status").removeClass("mck-pending-icon").removeClass("mck-sent-icon").removeClass("mck-delivered-icon").addClass("mck-read-icon"),f(".mck-msg-right .mck-delivered-icon").attr("title","delivered and read"),void 0===(ae=Oa.getContact(J))&&((he=[]).push(J),Ka.getUsersDetail(he,{}))),te={userId:J},ee&&(te.topicId=ee);else if("APPLOZIC_16"===G){var de=L.message.split(":")[0];J=L.message.split(":")[1],ae=Oa.fetchContact(J),(H=B.data("mck-id"))===ae.contactId?de===la[0]?(ne[ae.contactId]=!0,Sa.toggleBlockUser(H,!0)):(oe[ae.contactId]=!0,K.removeClass("mck-tab-title-w-status"),P.removeClass("vis").addClass("n-vis"),U.removeClass("vis").addClass("n-vis")):f("#li-user-"+ae.htmlId+" .mck-ol-status").removeClass("vis").addClass("n-vis")}else if("APPLOZIC_17"===G)de=L.message.split(":")[0],J=L.message.split(":")[1],ae=Oa.fetchContact(J),(H=B.data("mck-id"))===ae.contactId?de===la[2]?(ne[ae.contactId]=!1,Sa.toggleBlockUser(H,!1)):(T.MCK_OL_MAP[H]||ce[H])&&(oe[ae.contactId]=!1,ne[H]||(T.MCK_OL_MAP[H]?P.html(MCK_LABELS.online):ce[H]&&P.html(mckDateUtils.getLastSeenAtStatus(ce[H])),K.addClass("mck-tab-title-w-status"))):T.MCK_OL_MAP[H]&&f("#li-user-"+ae.htmlId+" .mck-ol-status").removeClass("n-vis").addClass("vis");else if("APPLOZIC_18"===G)Ae=!1;else if("APPLOZIC_19"===G)Ae=!0;else{var me=L.message;if("APPLOZIC_03"===G)ALStorage.updateLatestMessage(me),0!==me.type&&4!==me.type&&(f("."+me.key+" .mck-message-status").removeClass("mck-pending-icon").addClass("mck-sent-icon"),Oa.addTooltip(me.key));else if("APPLOZIC_01"===G||"APPLOZIC_02"===G||"MESSAGE_RECEIVED"===G){if(ALStorage.updateLatestMessage(me),ae=me.groupId?wa.getGroup(me.groupId):Oa.getContact(me.to),f("#mck-sidebox-content"),H=B.data("mck-id"),L.message.metadata&&L.message.metadata.actionRequest&&"askCSAT"==L.message.metadata.actionRequest&&KommunicateUI.askCSAT(),L.message.metadata.KM_STATUS){var ue="li-group-"+L.message.groupId,pe=L.message.metadata.KM_STATUS;MCK_GROUP_MAP&&MCK_GROUP_MAP[L.message.groupId]&&(MCK_GROUP_MAP[L.message.groupId].metadata.CONVERSATION_STATUS=Kommunicate.conversationHelper.status[pe.toUpperCase()]),CURRENT_GROUP_DATA.tabId=L.message.groupId,CURRENT_GROUP_DATA.conversationStatus=Kommunicate.conversationHelper.status[pe.toUpperCase()],L.message.metadata.KM_STATUS===KommunicateConstants.CONVERSATION_CLOSED_STATUS?Ga.modifyClassList({id:[ue]},"mck-conversation-resolved","mck-conversation-open"):L.message.metadata.KM_STATUS===KommunicateConstants.CONVERSATION_OPEN_STATUS&&Ga.modifyClassList({id:[ue]},"mck-conversation-open","mck-conversation-resolved"),KommunicateUI.handleConversationBanner(),L&&L.message&&KommunicateUI.handleWaitingQueueMessage()}if(Ga.isObject(L.message)&&L.message.groupId&&L.message.groupId==H&&L.message.metadata&&(CURRENT_GROUP_DATA.tabId=L.message.groupId,L.message.metadata.KM_STATUS===KommunicateConstants.CONVERSATION_CLOSED_STATUS||L.message.metadata.KM_STATUS===KommunicateConstants.CONVERSATION_RESOLVED_STATUS?0!==eo&&Oa.isMessageSentByBot(L.message,ae)?setTimeout((function(){KommunicateUI.showClosedConversationBanner(!0)}),eo):(KommunicateUI.isConvJustResolved=!KommunicateUI.isConvJustResolved,KommunicateUI.showClosedConversationBanner(!0)):L.message.metadata.KM_STATUS===KommunicateConstants.CONVERSATION_OPEN_STATUS&&KommunicateUI.showClosedConversationBanner(!1),me&&me.metadata&&me.metadata.KM_ASSIGN&&!(ae&&ae.metadata&&ae.metadata.KM_ORIGINAL_TITLE))){var ge={cached:!1,callback:function(f){if(f&&f.data&&f.data.response&&0!==f.data.response.length){var T=f.data.response[0];Na.updateAssigneeDetails(T,H),T.roleType!=KommunicateConstants.APPLOZIC_USER_ROLE_TYPE.BOT?(CURRENT_GROUP_DATA.CHAR_CHECK=!1,La.removeWarningsFromTextBox()):La.checkBotDetail(T.userId)}}};Ka.getUsersDetail([me.metadata.KM_ASSIGN],ge)}if("APPLOZIC_01"===G||"MESSAGE_RECEIVED"===G){var ve=JSON.parse(JSON.stringify(me));ve.userOverride=userOverride,Kommunicate.KmEventHandler.onMessageReceived(ve)}else"APPLOZIC_02"===G&&Kommunicate.KmEventHandler.onMessageSent(me);if(me.conversationId){var fe=le[me.conversationId];!Yt&&!xt||"object"==typeof fe&&"object"==typeof re[fe.topicId]||Ra.getTopicId({conversationId:me.conversationId,messageType:G,message:me,notifyUser:L.notifyUser,async:!1,populate:!1},(function(f){Oa.populateMessage(f.messageType,f.message,f.notifyUser)}))}if(void 0===ae){var he,ke={message:me,messageType:G,notifyUser:L.notifyUser};return void(me.groupId?La.getGroupFeedFromMessage(ke):((he=[]).push(me.to),Ka.getUsersDetail(he,ke)))}103==me.contentType||((ke={}).messageType=G,ke.message=me,ke.notifyUser=L.notifyUser,me.to&&Ka.getUsersDetail([me.to],ke))}}}};B.getOptions=function(){return P},B.init=function(){if(window.Applozic.ALApiService.initServerUrl(MCK_BASE_URL),Da.get(P),Ra.init(P),Pa.init(P),Ga.init(P),Fa.init(P),Oa.init(),ja.loop=!1,ja.volume=Ct,_t){ua=new RingToneService;try{$a=ua.loadRingTone(_t,ja)}catch(f){}}if(Ga.isObject(ge)&&ge.popup){ua=new RingToneService;var f={};f.volume=ge.greetingMessageVolume;try{qa=ua.loadChatPopupTone(Et,f)}catch(f){}}Na.init(),xa.init(),La.init(),Ia.initializeApp(P,!1),Ua.init(),Aa.init(),!pa&&Ga.modifyClassList({id:["mck-attachfile-box","mck-file-up"]},"n-vis","vis"),!xe&&Ga.modifyClassList({id:["mck-attach-img-box","mck-img-file-up"]},"n-vis",""),!Oe&&Ga.modifyClassList({id:["mck-attach-vid-box","mck-vid-file-up"]},"n-vis",""),en&&Kommunicate.typingAreaService.showMicIfSpeechRecognitionSupported(),"v2"!==pe||"file:"!=window.frameElement.getAttribute("data-protocol")||window.top.hasOwnProperty("cordova")||Ga.modifyClassList({id:["km-local-file-system-warning"]},"vis","n-vis"),document.addEventListener("keydown",(function(f){document.body.classList.add("accesibility")})),document.addEventListener("mousedown",(function(f){document.body.classList.remove("accesibility")})),tn&&"speechSynthesis"in window&&(AVAILABLE_VOICES_FOR_TTS=speechSynthesis.getVoices(),void 0!==speechSynthesis.onvoiceschanged&&(speechSynthesis.onvoiceschanged=function(){AVAILABLE_VOICES_FOR_TTS=speechSynthesis.getVoices()}))},B.reInit=function(L){KommunicateUtils.storeDataIntoKmSession("appOptions",L),"object"===f.type(L)&&(L=f.extend(!0,{},K,L),P.conversationTitle=P.conversationTitle||P.groupName,P.accessToken=P.password||P.accessToken,f.fn.applozic("reset",L),L.userId&&L.appId&&""!==f.trim(L.userId)&&""!==f.trim(L.appId)?(Ia.initializeApp(L,!0),P=L):T.console("Oops! looks like incorrect application id or user Id."))},B.loadTabView=function(T){void 0===T.isGroup&&(T.isGroup=!1),Oa.loadTab(T),f("#mck-search").val("")},B.loadTab=function(T,L){Oa.loadTab({tabId:T,isGroup:!1},L),f("#mck-search").val("")},B.loadChat=function(T){if(!(void 0!==T.userId&&""!==T.userId||void 0!==T.groupId&&""!==T.groupId||void 0!==T.clientGroupId&&""!==T.clientGroupId))return"UserId or groupId or clientGroupId required";var L={tabId:T.userId,isGroup:!1};if(L={},T.userId&&(L.tabId=userId,L.isGroup=!1),T.displayName&&(L.userName=T.displayName),T.convId&&(L.conversationId=T.convId),T.groupId||T.clientGroupId)if(L.isGroup=!0,T.clientGroupId){if(L.clientGroupId=T.clientGroupId,"object"!=typeof(K=wa.getGroupByClientGroupId(T.clientGroupId)))return Ma.getGroupFeed({clientGroupId:L.clientGroupId,apzCallback:La.onGroupFeed,callback:La.loadGroupTab}),void f("#mck-search").val("");L.tabId=K.contactId}else{var K;if("object"!=typeof(K=wa.getGroup(T.groupId)))return Ma.getGroupFeed({groupId:T.groupId,apzCallback:La.onGroupFeed,callback:La.loadGroupTab}),void f("#mck-search").val("");L.tabId=T.groupId}Oa.loadTab(L),f("#mck-search").val("")},B.uploadFile=function(f){xa.uploadFile(f)},B.uploadAttachemnt=function(f){xa.uploadAttachemnt(f.params,f.messagePxy)},B.audioAttach=function(f){xa.audioRecoder(f)},B.loadGroupTab=function(T,L){if(void 0===T||""===T)return"GroupId required";"object"==typeof wa.getGroup(T)?(Oa.loadTab({tabId:T,isGroup:!0},L),f("#mck-search").val("")):Ma.getGroupFeed({groupId:T,apzCallback:La.onGroupFeed,callback:La.loadGroupTab})},B.loadGroupTabByClientGroupId=function(T){if(void 0===T.clientGroupId||""===T.clientGroupId)return"Client Group Id Required";var L=wa.getGroupByClientGroupId(T.clientGroupId);"object"==typeof L?(Oa.loadTab({tabId:L.contactId,isGroup:!0}),f("#mck-search").val("")):Ma.getGroupFeed({clientGroupId:T.clientGroupId,apzCallback:La.onGroupFeed,callback:La.loadGroupTab})},B.loadConvTab=function(f){"object"==typeof f&&f.userId&&f.convId&&Oa.loadTab({tabId:f.userId,conversationId:f.convId,isGroup:!1})},B.loadTabWithTopic=function(f){if("object"==typeof f&&(f.userId||f.groupId)&&f.topicId){var T={tabId:f.userId,topicId:f.topicId};if(f.userName&&(T.userName=f.userName),f.topicStatus?T.topicStatus=-1===ca.indexOf(f.topicStatus)?ca[0]:f.topicStatus.toString():T.topicStatus=ca[0],"function"==typeof je||f.topicDetail){var L=f.topicDetail?f.topicDetail:je(f.topicId);"object"==typeof L&&"undefined"!==L.title&&(re[f.topicId]=L)}if(f.message){var K={type:5,contentType:0,message:message};T.messagePxy=K,T.isMessage=!0}else T.isMessage=!1;f.supportId?(T.isGroup=!0,T.supportId=supportId):(T.isGroup=!1,T.userId=f.userId),Na.getConversationId(T)}else{if(!f.userId||!f.groupId)return"UserId required";if(!f.topicId)return"TopicId required"}},B.loadContacts=function(f){Oa.loadContacts(f)},B.loadContactsForContactList=function(f){Oa.loadContactsForContactList(f)},B.setOffline=function(){void 0!==window.Applozic.ALSocket&&window.Applozic.ALSocket.sendStatus(0)},B.setOnline=function(){void 0!==window.Applozic.ALSocket&&window.Applozic.ALSocket.sendStatus(1)},B.reset=function(T){ALStorage.clearSessionStorageElements(),G="",window.Applozic.ALApiService.AUTH_TOKEN=null,J=[],MCK_GROUP_MAP=[],ee=!0,te=[],W="",ke=T.mode,ne=[],oe=[],ae=!1,ie=90,be=T.appId,ce=[],le=[],re=[],MCK_CLIENT_GROUP_MAP=[],de=!0,MCK_LABELS=T.labels,me=0,MCK_BASE_URL=T.baseUrl,ht=T.fileupload,ye=T.customFileUrl,fa=new Object,ha=new Array,Se=T.launcher,_e=[],we=T.userName,Me=T.visitor,Te=[],ka=new Array,ya=new Object,Ne=T.fileBaseUrl,Le=T.locShare,xe=T.capturePhoto,Oe=T.captureVideo,P.video,Ke=T.onInit,Ue=T.onTopicDetails,Ca=new Array,ba=new Array,De=T.onClose,Ge=T.password||T.accessToken,Pe=T.displayText,Be=T.readConversation,Fe=T.maxGroupSize,Ea=new Array,ze=T.onTabClicked,He=T.contactNumber,qe=T.appModuleName,je=T.getTopicDetail,$e=T.maxAttachmentSize,We=T.validateMessage,Ve=T.contactDisplayName,_a=new Array,Ye=T.finalPriceResponse,Je=T.contactDisplayImage,Qe=T.priceWidget,Xe=P.openGroupSettings,Ze=T.offlineMessageDetail,T.initAutoSuggestions,lt=T.getConversationDetail,ot=T.authenticationTypeId,Tt=Me?"guest":f.trim(T.userId),St=Le?T.googleApiKey:"NO_ACCESS",Ot="boolean"==typeof T.olStatus&&T.olStatus,xt="boolean"==typeof T.topicBox&&T.topicBox,Kt="boolean"==typeof T.showOfflineMessage&&T.showOfflineMessage,Yt="boolean"==typeof T.topicHeader&&T.topicHeader,Xt="boolean"!=typeof T.notification||T.notification,"boolean"==typeof T.swNotification&&T.swNotification,T.supportId&&T.supportId,Dt="boolean"==typeof T.hideGroupSubtitle&&T.hideGroupSubtitle,Gt=void 0===T.defaultMessageMetaData?{}:T.defaultMessageMetaData,Bt="boolean"==typeof T.groupUserCount&&T.groupUserCount,Qt="boolean"==typeof T.desktopNotification&&T.desktopNotification,Jt="boolean"==typeof T.loadOwnContacts&&T.loadOwnContacts,Nt="boolean"==typeof T.messageBubbleAvator&&T.messageBubbleAvator,Wt="boolean"==typeof P.resetUserStatus&&P.resetUserStatus,oa="boolean"==typeof T.launchOnNewMessage&&T.launchOnNewMessage,Zt="boolean"!=typeof T.autoTypeSearchEnabled||T.autoTypeSearchEnabled,zt="boolean"==typeof T.checkUserBusyWithStatus&&T.checkUserBusyWithStatus,sa="boolean"==typeof T.launchOnUnreadMessage&&T.launchOnUnreadMessage,Va=P.askUserDetails},B.logout=function(){void 0!==window.Applozic.ALSocket&&(window.Applozic.ALSocket.disconnect(),sessionStorage.removeItem("kommunicate"),window.Applozic.ALApiService.setAjaxHeaders("","","","",""),ALStorage.clearSessionStorageElements(),f.fn.applozic("reset",P),KommunicateUtils.deleteCookie({name:KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_USERNAME,domain:MCK_COOKIE_DOMAIN}),KommunicateUtils.deleteCookie({name:KommunicateConstants.COOKIES.KOMMUNICATE_LOGGED_IN_ID,domain:MCK_COOKIE_DOMAIN}),f("#mck-sidebox").hide(),f("#mck-sidebox-launcher").hide(),parent.document.getElementById("kommunicate-widget-iframe")&&(parent.document.getElementById("kommunicate-widget-iframe").style.display="none")),ee=!1},B.getUserStatus=function(T){"function"==typeof T.callback&&(void 0!==T.userIds?Ka.getUsersDetail(T.userIds,T):za.getUserStatus(T,(function(T){f.each(T.users,(function(f,T){var L=Oa.getContact(""+T.userId);L=void 0===L?Oa.createContactWithDetail(T):Oa.updateContactDetail(L,T),_a.push(L.contactId)}))})))},B.getGroupList=function(f){return"function"==typeof f.callback?(f.apzCallback=La.loadGroups,Ma.loadGroups(f),"success"):"Callback Function Required"},B.leaveGroup=function(f){return"object"!=typeof f?"Unsupported Format. Please check format":"function"==typeof f.callback?void 0!==f.groupId&&""!==f.groupId||void 0!==f.clientGroupId&&""!==f.clientGroupId?(f.apzCallback=La.onGroupLeft,Ma.leaveGroup(f),"success"):void f.callback({status:"error",errorMessage:"GroupId or Client GroupId Required"}):"Callback Function Required"},B.addGroupMember=function(f){return"object"!=typeof f?"Unsupported Format. Please check format":"function"==typeof f.callback?void 0!==f.groupId&&""!==f.groupId||void 0!==f.clientGroupId&&""!==f.clientGroupId?void 0===f.userId||""===f.userId?void f.callback({status:"error",errorMessage:"UserId required"}):void 0!==f.role&&-1===Ee.indexOf(f.role)?void f.callback({status:"error",errorMessage:"Incorrect member role"}):(za.loadUserProfile(f.userId),f.apzCallback=La.onAddedGroupMember,Ma.addGroupMember(f),"success"):void f.callback({status:"error",errorMessage:"GroupId or clientGroupId required"}):"Callback function required"},B.removeGroupMember=function(f){return"object"!=typeof f?"Unsupported Format. Please check format":"function"==typeof f.callback?void 0!==f.groupId&&""!==f.groupId||void 0!==f.clientGroupId&&""!==f.clientGroupId?void 0===f.userId||""===f.userId?void f.callback({status:"error",errorMessage:"UserId required"}):(f.apzCallback=La.onRemovedGroupMember,Ma.removeGroupMemberFromChat(f),"success"):void f.callback({status:"error",errorMessage:"GroupId or clientGroupId required"}):"Callback function required"},B.updateGroupInfo=function(T){if("object"!=typeof T)return"Unsupported format. Please check format";if("function"==typeof T.callback){if(!(void 0!==T.groupId&&""!==T.groupId||void 0!==T.clientGroupId&&""!==T.clientGroupId))return void T.callback({status:"error",errorMessage:"GroupId or clientGroupId required"});if(!(void 0!==T.name&&""!==T.name||void 0!==T.imageUrl&&""!==T.imageUrl||T.users&&0!==T.users.length))return void T.callback({status:"error",errorMessage:"Group properties required"});if(T.users&&T.users.length>0){var L=[];if(f.each(T.users,(function(f,T){T.userId&&void 0!==T.role&&-1!==Ee.indexOf(T.role)&&L.push(T)})),0===L.length)return void T.callback({status:"error",errorMessage:"Incorrect users detail"})}return L=[],f(".mck-group-change-role-box.vis").each((function(T,K){var U=f(this),P=parseInt(U.find("select").val());if(P!==U.parents(".mck-li-group-member").data("role")){var G={userId:U.parents(".mck-li-group-member").data("mck-id"),role:P};L.push(G)}})),T.apzCallback=La.onUpdateGroupInfo,Ma.updateGroupInfo(T),"success"}return"Callback function required"},B.getMessages=function(f){"function"==typeof f.callback&&Ra.getMessages(f)},B.getMessageList=function(f){return void 0!==f&&"function"==typeof f.callback?(Ra.getMessageList(f,(function(f){if(void 0!==f.to||void 0!==f.groupId){var T=Oa.getMessageFeed(f);messageFeeds.push(T)}})),"success"):"Callback function required"},B.getMessageListByTopicId=function(f){if("object"!=typeof f)return"Unsupported format. Please check format";if("function"==typeof f.callback){if(!(void 0!==f.id&&""!==f.id||void 0!==f.clientGroupId&&""!==f.clientGroupId))return void f.callback({status:"error",errorMessage:"Id or clientGroupId required"});if(f.id&&"boolean"!=typeof f.isGroup)return void f.callback({status:"error",errorMessage:"IsGroup parameter required"});if(!f.topicId)return void f.callback("TopicId required");f.id&&(f.tabId=f.id),f.topicStatus=ca[0];var T=Te[f.topicId];return T&&"object"==typeof le[T]?(f.conversationId=T,Ra.getMessageList(f,(function(f){if(void 0!==f.to||void 0!==f.groupId){var T=Oa.getMessageFeed(f);messageFeeds.push(T)}}))):(f.isExtMessageList=!0,f.pageSize=1,Ra.fetchConversationByTopicId(f,(function(f){Na.getMessageList(f)}))),"success"}return"Callback function required."},B.sendMessage=function(T){if("object"==typeof T){var L=(T=f.extend(!0,{},U,T)).message;if(!T.to)return"To field required";if(void 0===L||""===L)return"Message field required";if(T.type>12)return"Invalid message type";L=f.trim(L);var K={to:f.trim(T.to),type:T.messageType,contentType:T.type,message:L,metadata:T.metadata};return Na.sendMessage(K),"success"}return"Unsupported format. Please check format"},B.updateUserIdentity=function(f){Ka.updateUserIdentity(f)},B.updateUser=function(f){Ka.updateUser(f)},B.getGroupListByFilter=function(f){Ma.getGroupByFilter(f)},B.updateMessageMetadata=function(f){Na.updateMessageMetadata(f)},B.sendGroupMessage=function(T){if("object"==typeof T){var L=(T=f.extend(!0,{},U,T)).message;if(!T.groupId&&!T.clientGroupId)return"groupId or clientGroupId required";if(void 0===L||""===L)return"message field required";if(T.type>12)return"invalid message type";L=f.trim(L);var K={type:T.messageType,contentType:T.type,message:L,metadata:T.metadata||{}};if(T.groupId)K.groupId=f.trim(T.groupId);else if(T.clientGroupId){if(void 0===wa.getGroupByClientGroupId(T.clientGroupId))return"group not found";K.clientGroupId=f.trim(T.clientGroupId)}return Na.sendMessage(K),"success"}return"Unsupported format. Please check format"},B.addWelcomeMessage=function(f){return"object"!=typeof f?"Unsupported format. Please check format":void 0===f.sender||""===f.sender?"Sender Field Required":void 0===f.messageContent||""===f.messageContent?"Message Content Required":void Na.sendWelcomeMessage(f)},B.createGroup=function(f){if("object"==typeof f){if("function"==typeof f.callback){var T=f.users;return void 0===T?void f.callback({status:"error",errorMessage:"Users list required"}):T.length>Fe?void f.callback({status:"error",errorMessage:"Users limit exceeds "+Fe+". Max number of users allowed is "+Fe+"."}):f.groupName?void 0===f.type||""===f.type?void f.callback({status:"error",errorMessage:"Group type required"}):-1===Ie.indexOf(f.type)?void f.callback({status:"error",errorMessage:"Invalid group type"}):(Na.getGroup(f),"success"):void f.callback({status:"error",errorMessage:"Group name required"})}return"Callback function required"}return"Unsupported Format. Please check format"},B.triggerMsgNotification=function(){0!=da&&(MCK_TRIGGER_MSG_NOTIFICATION_PARAM=setTimeout((function(){B.getLatestConversationForMsgTriggerTimeout()}),da))},B.getLatestConversationForMsgTriggerTimeout=function(){Ga.setWidgetStateOpen(!0),Na.loadMessageList({tabId:"",isGroup:!1},(function(f){if(f&&f.groupFeeds&&0!==f.groupFeeds.length&&f.message&&0!==f.message.length){var T=f.groupFeeds[0].id,L=f.message.filter((function(f){return f.groupId==T}))[0];L.type!==KommunicateConstants.MESSAGE_TYPE.SENT&&Ua.notifyUser(L)}else{var K=La.createGroupDefaultSettings();K.isMessage=!1,K.isInternal=!0,Kommunicate.startConversation(K)}}))},B.initGroupTab=function(f){if("object"==typeof f){var T=f.users;return void 0===T||T.length<1?"Users List Required":T.length>Fe?"Users limit exceeds "+Fe+". Max number of users allowed is "+Fe+".":f.groupName?void 0===f.type?"Group type required":-1===Ie.indexOf(f.type)?"Invalid group type":(Na.getGroup(f),"success"):"Group name required"}return"Unsupported format. Please check format"},B.getTotalUnreadCount=function(){return me},B.subscribeToEvents=function(f,T){if(IS_SOCKET_CONNECTED){if("object"==typeof f){for(var L in"function"==typeof f.onConnectFailed&&(window.Applozic.ALSocket.events.onConnectFailed=f.onConnectFailed),"function"==typeof f.onConnect&&(window.Applozic.ALSocket.events.onConnect=f.onConnect),"function"==typeof f.onMessageDelivered&&(window.Applozic.ALSocket.events.onMessageDelivered=f.onMessageDelivered),"function"==typeof f.onMessageRead&&(window.Applozic.ALSocket.events.onMessageRead=f.onMessageRead),"function"==typeof f.onMessageDeleted&&(window.Applozic.ALSocket.events.onMessageDeleted=f.onMessageDeleted),"function"==typeof f.onConversationDeleted&&(window.Applozic.ALSocket.events.onConversationDeleted=f.onConversationDeleted),"function"==typeof f.onUserConnect&&(window.Applozic.ALSocket.events.onUserConnect=f.onUserConnect),"function"==typeof f.onUserDisconnect&&(window.Applozic.ALSocket.events.onUserDisconnect=f.onUserDisconnect),"function"==typeof f.onConversationReadFromOtherSource&&(window.Applozic.ALSocket.events.onConversationReadFromOtherSource=f.onConversationReadFromOtherSource),"function"==typeof f.onConversationRead&&(window.Applozic.ALSocket.events.onConversationRead=f.onConversationRead),"function"==typeof f.onMessageReceived&&(window.Applozic.ALSocket.events.onMessageReceived=f.onMessageReceived),"function"==typeof f.onMessageSentUpdate&&(window.Applozic.ALSocket.events.onMessageSentUpdate=f.onMessageSentUpdate),"function"==typeof f.onMessageSent&&(window.Applozic.ALSocket.events.onMessageSent=f.onMessageSent),"function"==typeof f.onUserBlocked&&(window.Applozic.ALSocket.events.onUserBlocked=f.onUserBlocked),"function"==typeof f.onUserUnblocked&&(window.Applozic.ALSocket.events.onUserUnblocked=f.onUserUnblocked),"function"==typeof f.onUserActivated&&(window.Applozic.ALSocket.events.onUserActivated=f.onUserActivated),"function"==typeof f.onMessageNotification&&(window.Applozic.ALSocket.events.onMessageNotification=f.onMessageNotification),"function"==typeof f.onUserDeactivated&&(window.Applozic.ALSocket.events.onUserDeactivated=f.onUserDeactivated),f)if("Function"==f[L].__proto__.constructor.name){var K=f[L].name;eventMapping.hasOwnProperty(K)&&(eventMapping[K].eventFunction=f[K])}"function"==typeof T&&T()}}else oo=f},B.getConversation=function(f){Ra.getTopicId({conversationId:f.conversationId},(function(f){Oa.populateMessage(f.messageType,f.message,f.notifyUser)}))},B.initializeSocketConnection=function(f){f?window.Applozic.ALSocket.reconnect():window.Applozic.ALSocket.init(be,H,io),!no&&!da&&window.Applozic.SOCKET_DISCONNECT_PROCEDURE.start()}}f.fn.applozic=function(T,L,U){var P=f("#mck-sidebox");f.extend(kommunicate,Kommunicate),"object"===f.type(T)&&(KommunicateUtils.storeDataIntoKmSession("appOptions",T),(T=f.extend(!0,{},K,T)).conversationTitle=T.conversationTitle||T.groupName,T.accessToken=T.password||T.accessToken);var G=void 0;if(void 0!==P.data("applozic_instance"))if(G=P.data("applozic_instance"),"string"===f.type(T))switch(T){case"reInitialize":return G.reInit(L);case"loadConvTab":G.loadConvTab(L);break;case"loadTab":G.loadTab(L,U);break;case"uploadFile":G.uploadFile(L);break;case"uploadAttachemnt":G.uploadAttachemnt(L);break;case"loadTabView":G.loadTabView(L);break;case"loadChat":G.loadChat(L);break;case"loadContextualTab":return G.loadTabWithTopic(L);case"audioAttach":G.audioAttach(L);break;case"addWelcomeMessage":G.addWelcomeMessage(L);break;case"loadContacts":G.loadContacts(L);break;case"sendMessage":return G.sendMessage(L);case"sendGroupMessage":return G.sendGroupMessage(L);case"createGroup":return G.createGroup(L);case"loadBroadcastTab":case"initBroadcastTab":return L.groupName=L.groupName?L.groupName:"Broadcast",L.type=5,G.initGroupTab(L);case"initGroupTab":return G.initGroupTab(L);case"loadGroupTab":return G.loadGroupTab(L,U);case"loadGroupTabByClientGroupId":return G.loadGroupTabByClientGroupId(L);case"setOffline":return G.setOffline(),"success";case"setOnline":return G.setOnline(),"success";case"logout":return G.logout(),"success";case"reset":G.reset(L);break;case"getUserDetail":return G.getUserStatus(L),"success";case"getGroupList":return G.getGroupList(L),"success";case"leaveGroup":return G.leaveGroup(L);case"addGroupMember":return G.addGroupMember(L);case"removeGroupMember":return G.removeGroupMember(L);case"updateGroupInfo":return G.updateGroupInfo(L);case"getMessages":G.getMessages(L);break;case"messageList":return G.getMessageList(L);case"getMessageListByTopicId":return G.getMessageListByTopicId(L);case"getTotalUnreadCount":return G.getTotalUnreadCount();case"subscribeToEvents":return G.subscribeToEvents(L);case"getConversation":return G.getConversation(L);case"loadConversationWithAgent":return G.loadConversationWithAgent(L);case"updateUserIdentity":return G.updateUserIdentity(L);case"updateUser":return G.updateUser(L);case"getGroupListByFilter":return G.getGroupListByFilter(L);case"updateMessageMetadata":return G.updateMessageMetadata(L);case"mckLaunchSideboxChat":return G.mckLaunchSideboxChat();case"triggerMsgNotification":return G.triggerMsgNotification();case"openChat":return G.openChat(L);case"submitMessage":return G.submitMessage(L);case"toggleMediaOptions":return G.toggleMediaOptions();case"initializeSocketConnection":return G.initializeSocketConnection(L)}else"object"===f.type(T)&&G.reInit(T);else if("object"===f.type(T))if(T.userId&&T.appId&&""!==f.trim(T.userId)&&""!==f.trim(T.appId))if(void 0!==P.data("applozic_instance"))(G=P.data("applozic_instance")).reInit(T);else{if(void 0!==T.ojq?($=T.ojq,jQuery=T.ojq):($=f,jQuery=f),"function"==typeof T.obsm)$.fn.modal=T.obsm,jQuery.fn.modal=T.obsm;else if("function"==typeof f.fn.modal){var B=f.fn.modal.noConflict();$.fn.modal=B,jQuery.fn.modal=B}else"function"==typeof $.fn.modal&&(B=$.fn.modal.noConflict(),$.fn.modal=B,jQuery.fn.modal=B);"function"==typeof T.omckm?f.fn.mckModal=T.omckm:"function"==typeof f.fn.mckModal?f.fn.mckModal=f.fn.mckModal.noConflict():"function"==typeof $.fn.mckModal&&(f.fn.mckModal=$.fn.mckModal.noConflict()),"function"==typeof $.fn.linkify?(f.fn.linkify=$.fn.linkify,jQuery.fn.linkify=$.fn.linkify):"function"==typeof f.fn.linkify&&($.fn.linkify=f.fn.linkify,jQuery.fn.linkify=f.fn.linkify),"function"==typeof $.fn.emojiarea?f.fn.emojiarea=$.fn.emojiarea:"function"==typeof f.fn.emojiarea&&($.fn.emojiarea=f.fn.emojiarea,jQuery.fn.emojiarea=f.fn.emojiarea),"function"==typeof $.fn.locationpicker?f.fn.locationpicker=$.fn.locationpicker:"function"==typeof f.fn.locationpicker&&($.fn.locationpicker=f.fn.locationpicker,jQuery.fn.locationpicker=f.fn.locationpicker);var z=new i(T);P.data("applozic_instance",z),z.init()}else alert("Oops! looks like incorrect application id or user Id.")},f.fn.applozic.defaults=K}($applozic,window,document);var kommunicateCommons=new KommunicateCommons;function KmCustomTheme(){var f,T=this;T.init=function(L){(f=L.widgetSettings)&&T.changeColorTheme()},T.KmCustomImageIcon=function(f){return"<img src="+f+' alt="Live chat"></img>'},T.createCustomClasses=function(f){var T=document.createElement("style");T.type="text/css",T.innerHTML=f,document.getElementsByTagName("head")[0].appendChild(T)},T.customSideboxWidget=function(){var L="#5553B7";if(kommunicateCommons.isObject(f)){L=f&&f.primaryColor?f.primaryColor:"#5553B7",secondaryColor=f&&f.secondaryColor?f.secondaryColor:"#e6e5ec";var K="square"==kommunicate._globals.iconShape?"km-square-chat-icon":null,U=".km-custom-widget-background-color { background: "+L+" !important;} .km-custom-widget-background-color-secondary { background: "+secondaryColor+" !important;} .km-custom-widget-border-color { border-color: "+L+" !important;} .km-custom-widget-text-color { color: "+L+" !important;} .km-custom-widget-fill { fill: "+L+" !important;} .km-custom-widget-stroke { stroke: "+L+" !important;}";T.createCustomClasses(U)}else{var P=".km-chat-widget-background-color { background: "+L+" !important}";T.createCustomClasses(P)}return'<div id="launcher-svg-container" class="km-chat-icon-sidebox km-custom-widget-background-color km-chat-widget-background-color '+K+'" >'+T.returnCustomWidget()+"</div>"},T.returnCustomWidget=function(){return kommunicateCommons.isObject(f)&&f.iconIndex?"image"===f.iconIndex?T.KmCustomImageIcon(f.widgetImageLink):KommunicateConstants.CUSTOM_WIDGETS_SVG[f.iconIndex]:KommunicateConstants.CUSTOM_WIDGETS_SVG[1]},T.changeColorTheme=function(){for(var T=document.getElementsByClassName("mck-box-top"),L=0;L<T.length;L++)T[L].style.backgroundColor=f.primaryColor}}function KommunicateCommons(){var f,T,L,K=this;KommunicateCommons.CONNECT_SOCKET_ON_WIDGET_CLICK,KommunicateCommons.IS_WIDGET_OPEN=!1,K.init=function(K){f=K.customerCreatedAt,T="boolean"!=typeof K.useBranding||K.useBranding,L=K.widgetSettings,KommunicateCommons.CONNECT_SOCKET_ON_WIDGET_CLICK=K.connectSocketOnWidgetClick||!1},K.isTrialPlan=function(f){var T=!1;return f===KommunicateConstants.PRICING_PACKAGE.TRIAL&&(KommunicateCommons.CONNECT_SOCKET_ON_WIDGET_CLICK=!0,T=!0),T},K.isStartupPlan=function(f){return f&&f.pricingPackage&&f.pricingPackage===KommunicateConstants.PRICING_PACKAGE.STARTUP},K.isKommunicatePlanExpired=function(f){return K.getDaysCount()>31&&K.isStartupPlan(f)},K.getDaysCount=function(){var T=new Date,L=new Date(f),K=T.getTime()-L.getTime();return Math.ceil(K/864e5)},K.showPoweredBy=function(f){var U=K.isKommunicatePlanExpired(f);return!!T&&(!!U||(kommunicateCommons.isObject(L)&&void 0!==L.showPoweredBy?L.showPoweredBy:!f||!f.pricingPackage||f.pricingPackage!=KommunicateConstants.PRICING_PACKAGE.ENTERPRISE_MONTHLY&&f.pricingPackage!=KommunicateConstants.PRICING_PACKAGE.ENTERPRISE_YEARLY))},K.classListChanger=function(f,T,L){T&&f.classList.add(T),L&&f.classList.remove(L)},K.modifyClassList=function(f,T,L){var U=f.id,P=f.class,G=[];U&&U.forEach((function(f){document.getElementById(f)&&G.push(document.getElementById(f))})),P&&P.forEach((function(f){for(var T=document.getElementsByClassName(f),L=0;L<=T.length-1;L++)T&&G.push(T[L])})),G.forEach((function(f){K.classListChanger(f,T,L)}))},K.isObject=function(f){return!!f&&"object"==typeof f&&f.constructor==Object},K.isUrlValid=function(f){return!!f&&/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(f)},K.isMessageContainsUrl=function(f){var T=new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?([^ ])+"),L=f?f.match(T):"";return!(!f||!L)&&!!this.isUrlValid(L[0])&&L[0]},K.getTimeOrDate=function(f){var T=MCK_LABELS["time.stamp"],L=new Date(f),K=new Date,U=Math.max(0,(K.getTime()-L.getTime())/1e3);return U<60?parseInt(U)+" "+(parseInt(U)<=1?T["sec.ago"]:T["secs.ago"]):U<3600?parseInt(U/60)+" "+(parseInt(U/60)<=1?T["min.ago"]:T["mins.ago"]):U<=172800?parseInt(U/3600)+" "+(parseInt(U/3600)<=1?T["hr.ago"]:T["hrs.ago"]):U>172800?(day=L.getDate(),month=L.toDateString().match(/ [a-zA-Z]*/)[0].replace(" ",""),year=L.getFullYear()==K.getFullYear()?"":" "+L.getFullYear(),day+" "+month+year):void 0},K.setWidgetStateOpen=function(f){KommunicateCommons.IS_WIDGET_OPEN!==f&&(KommunicateCommons.IS_WIDGET_OPEN=f,IS_SOCKET_CONNECTED?window.Applozic.SOCKET_DISCONNECT_PROCEDURE.stop():KommunicateCommons.CONNECT_SOCKET_ON_WIDGET_CLICK?$applozic.fn.applozic("initializeSocketConnection",!1):window.Applozic.SOCKET_DISCONNECT_PROCEDURE.DISCONNECTED&&window.Applozic.ALSocket.checkConnected(!0))},K.isWidgetOpen=function(){return KommunicateCommons.IS_WIDGET_OPEN},K.checkIfDeviceIsHandheld=function(){var f,T=!1;return f=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(f)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(f.substr(0,4)))&&(T=!0),T},K.removeHtmlTag=function(f){var T=document.createElement("div");return T.innerHTML=f,T.textContent||T.innerText||""},K.formatHtmlTag=function(f){return f.replace(/</g,"&lt;").replace(/>/g,"&gt;")},K.isConversationClosedByBot=function(){if(CURRENT_GROUP_DATA.groupMembers&&Array.isArray(CURRENT_GROUP_DATA.groupMembers)){var f=CURRENT_GROUP_DATA.groupMembers.filter((function(f){return f.userId==CURRENT_GROUP_DATA.lastMessagingMember}));return f[0]&&f[0].role==KommunicateConstants.APPLOZIC_USER_ROLE_TYPE.BOT}return!1},K.getRatingSmilies=function(f){return KommunicateConstants.RATINGS_SVG[f]},K.getDefaultAvatarImageSvg=function(){return KommunicateConstants.DEFAULT_AVATAR_IMAGE},K.getFeedback=function(f,T){mckUtils.ajax({headers:{"x-authorization":window.Applozic.ALApiService.AUTH_TOKEN},type:"GET",url:Kommunicate.getBaseUrl()+"/rest/ws/feedback/v2/"+f,global:!1,contentType:"application/json",success:T,error:function(f){}})},K.debounce=function(f,T,L){var K;return function(){var U=this,P=arguments,i=function(){K=null,L||f.apply(U,P)},G=L&&!K;clearTimeout(K),K=setTimeout(i,T),G&&f.apply(U,P)}}}function RingToneService(){this.loadRingTone=function(f,T){var L={src:[f],loop:T.loop,html5:!0};return L.volume=T&&null!=T.volume?T.volume:1,new Howl(L)},this.loadChatPopupTone=function(f,T){var L={src:[f],html5:!0};return L.volume=T&&null!=T.volume?T.volume:1,new Howl(L)}}Kommunicate.attachEvents=function(f){f("#mck-message-cell").on("click",".km-increment-guest-count",Kommunicate.richMsgEventHandler.incrementGuestCount),f("#mck-message-cell").on("click",".km-decrement-guest-count",Kommunicate.richMsgEventHandler.decrementGuestCount),f("#mck-message-cell").on("click",".km-btn-add-more-rooms",Kommunicate.richMsgEventHandler.addMoreRoom),f("#mck-message-cell").on("click",".km-done-button",Kommunicate.richMsgEventHandler.processSelectedRoom),f("#mck-message-cell").on("click",".km-card-message-footer-button",Kommunicate.richMsgEventHandler.processHotelBookClick),f("#mck-message-cell").on("click",".mck-form-submit-button",Kommunicate.richMsgEventHandler.handleFormSubmit),f("#mck-message-cell").on("click",".km-cta-button",Kommunicate.richMsgEventHandler.handleRichButtonClick),f("#mck-message-cell").on("click",".km-submit-person-detail",Kommunicate.richMsgEventHandler.handlleSubmitPersonDetail),f("#mck-message-cell").on("click",".km-block-room-button",Kommunicate.richMsgEventHandler.processBookRoomClick),f("#mck-message-cell").on("click",".km-quick-replies",Kommunicate.richMsgEventHandler.processQuickReplies),f("#mck-message-cell").on("click",".km-list-item-handler",Kommunicate.richMsgEventHandler.processClickOnListItem),f("#mck-message-cell").on("click",".km-list-button-item-handler",Kommunicate.richMsgEventHandler.processClickOnButtonItem),f("#mck-message-cell").on("click",".km-faq-dialog-button",Kommunicate.richMsgEventHandler.processClickOnDialogButton),f("#mck-message-cell").on("click",".km-progress-meter-container",Kommunicate.attachmentEventHandler.manageUploadAttachment),f("#mck-message-cell").on("click",".km-link-button",Kommunicate.richMsgEventHandler.handleLinkButtonClick),f("#mck-message-cell").on("click",".km-attachment-icon",Kommunicate.attachmentEventHandler.handleSendingAttachment)},Kommunicate.attachmentEventHandler={manageUploadAttachment:function(f){var T=$applozic(f.target).closest(".km-msg-box-attachment").find(".km-progress-stop-upload-icon").hasClass("n-vis"),L=$applozic(f.target).closest(".km-msg-box-attachment").find(".km-progress-upload-icon").hasClass("n-vis"),K=$applozic(f.target).closest(".km-msg-box-attachment").children(),U=K[0].dataset.msgkey,P=$applozic(f.target).closest(".mck-clear").find(".mck-msg-right-muted"),G=K[0].dataset.filemetakey,B=KM_PENDING_ATTACHMENT_FILE[U];if(KommunicateUI.updateAttachmentStopUploadStatus(U,!0),Kommunicate.internetStatus)if(!T&&L)Kommunicate.attachmentEventHandler.progressMeter(100,U),$applozic(".km-progress-stop-upload-icon-"+U).removeClass("vis").addClass("n-vis"),$applozic(".km-progress-upload-icon-"+U).removeClass("n-vis").addClass("vis"),Kommunicate.attachmentEventHandler.progressMeter(100,U),$applozic(".mck-timestamp-"+U).removeClass("n-vis").addClass("vis"),P[0].querySelector(".mck-sending-failed").style.display="block";else{var z=K[0].dataset.filename,H=K[0].dataset.filesize,q=K[0].dataset.fileurl,V=K[0].dataset.filetype,W=K[0].dataset.groupid,J=K[0].dataset.thumbnailurl;if(H&&q&&G&&z&&V){KommunicateUI.updateAttachmentStopUploadStatus(U,!1),messagePxy={contentType:1,groupId:W,fileMeta:{blobKey:G,url:q,contentType:V,size:H,key:G,thumbnailUrl:q,name:z},message:"",type:5,metadata:{},key:U};var ee={messagePxy:messagePxy,optns:{tabId:W}};$applozic.fn.applozic("submitMessage",ee),$applozic(f.target).closest(".km-msg-box-progressMeter").children().removeClass("km-progress-meter-back-drop"),$applozic(f.target).closest(".km-msg-box-progressMeter").addClass("n-vis"),$applozic(".mck-timestamp-"+U).removeClass("n-vis").addClass("vis"),P[0].querySelector(".mck-sending-failed").style.display="none"}else J&&W&&U&&B&&(messagePxy={contentType:1,groupId:W,key:U,fileMeta:{thumbnailUrl:J,contentType:1,isUploaded:!1},message:"",type:5,metadata:{}},ee={params:{file:B,name:B.name},messagePxy:messagePxy},KommunicateUI.updateAttachmentStopUploadStatus(U,!1),$applozic.fn.applozic("uploadAttachemnt",ee),$applozic(".mck-timestamp-"+U).removeClass("n-vis").addClass("vis"),P[0].querySelector(".mck-sending-failed").style.display="none",delete KM_PENDING_ATTACHMENT_FILE[U],$applozic(f.target).closest(".km-msg-box-progressMeter").children().removeClass("km-progress-meter-back-drop"))}else KommunicateUI.displayUploadIconForAttachment(U,!1),KommunicateUI.updateAttachmentStopUploadStatus(U,!0)},progressMeter:function(f,T){document.getElementById("km-progress-meter-input");var L=".progress-meter-"+T+" .km-progress-value";KommunicateUI.getAttachmentStopUploadStatus(T)&&(f=100);var K=document.querySelector(L);if(K){K.style.strokeDasharray=KM_PROGRESS_METER_CIRCUMFERENCE;var U=KM_PROGRESS_METER_CIRCUMFERENCE*(1-f/100);K.style.strokeDashoffset=U}},handleSendingAttachment:function(f){var T=!Kommunicate.internetStatus||$applozic(f.target).closest(".km-msg-box-attachment").find(".km-attachment-cancel-icon").hasClass("vis"),L=($applozic(f.target).closest(".km-msg-box-attachment").find(".km-attachment-upload-icon").hasClass("vis"),$applozic(f.target).closest(".km-msg-box-attachment").children()),K=L[0].dataset.msgkey,U=$applozic(f.target).closest(".mck-clear").find(".mck-msg-right-muted"),P=KM_PENDING_ATTACHMENT_FILE[K],G=L[0].dataset.filemetakey;if(T)KommunicateUI.updateAttachmentStopUploadStatus(K,!0),kommunicateCommons.modifyClassList({class:["km-attachment-progress-bar-success-"+K,"km-attachment-progress-bar-wrapper-"+K]},"n-vis","vis"),kommunicateCommons.modifyClassList({class:["mck-timestamp-"+K]},"vis","n-vis"),$applozic(".km-attachment-cancel-icon-"+K).removeClass("vis").addClass("n-vis"),$applozic(".km-attachment-upload-icon-"+K).removeClass("n-vis").addClass("vis"),U[0].querySelector(".mck-sending-failed").style.display="block";else{var B=L[0].dataset.filename,z=L[0].dataset.filesize,H=L[0].dataset.filetype,q=L[0].dataset.groupid,V=L[0].dataset.thumbnailurl,W=L[0].dataset.fileurl;if(z&&G&&B&&H&&W){KommunicateUI.updateAttachmentStopUploadStatus(K,!1),messagePxy={contentType:1,groupId:q,fileMeta:{blobKey:G,contentType:H,size:z,key:G,name:B,url:W,thumbnailUrl:W},message:"",type:5,metadata:{},key:K};var J={messagePxy:messagePxy,optns:{tabId:q}};$applozic.fn.applozic("submitMessage",J),$applozic(".km-attachment-cancel-icon-"+K).removeClass("vis").addClass("n-vis"),$applozic(".km-attachment-upload-icon-"+K).removeClass("vis").addClass("n-vis"),U[0].querySelector(".mck-sending-failed").style.display="none",kommunicateCommons.modifyClassList({class:["mck-timestamp-"+K]},"n-vis","vis")}else V&&q&&K&&P&&(messagePxy={contentType:1,groupId:q,key:K,fileMeta:{thumbnailUrl:V,contentType:1,isUploaded:!1},message:"",type:5,metadata:{}},J={params:{file:P,name:P.name},messagePxy:messagePxy},KommunicateUI.updateAttachmentStopUploadStatus(K,!1),$applozic.fn.applozic("uploadAttachemnt",J),kommunicateCommons.modifyClassList({class:["mck-timestamp-"+K]},"vis","n-vis"),U[0].querySelector(".mck-sending-failed").style.display="none",delete KM_PENDING_ATTACHMENT_FILE[K])}}},Kommunicate.richMsgEventHandler={svg:{arrow:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="11" viewBox="0 0 10 19"><path fill="#5B5959" fill-rule="evenodd" d="M9.076 18.266c.21.2.544.2.753 0a.53.53 0 0 0 0-.753L1.524 9.208 9.829.903a.53.53 0 0 0 0-.752.546.546 0 0 0-.753 0L.026 9.208l9.05 9.058z"/></svg>'},initializeSlick:function(f){f.length>0&&tns({container:f[0],edgePadding:60,items:1,slideBy:"page",loop:!1,controlsText:[Kommunicate.richMsgEventHandler.svg.arrow,Kommunicate.richMsgEventHandler.svg.arrow],mouseDrag:!0,arrowKeys:!0,onInit:function(){}})},decrementGuestCount:function(f){var T=f.target||f.srcElement,L=T.dataset.type;"guest"==L?T.parentElement.getElementsByClassName("km-room-number-field")[0].stepDown():"children"==L&&T.parentElement.getElementsByClassName("km-person-number-field")[0].stepDown()},incrementGuestCount:function(f){var T=f.target||f.srcElement,L=T.dataset.type;"guest"==L?T.parentElement.getElementsByClassName("km-room-number-field")[0].stepUp():"children"==L&&T.parentElement.getElementsByClassName("km-person-number-field")[0].stepUp()},decrementPersonCount:function(){document.getElementById("km-person-number-field").stepDown()},incrementPersonCount:function(){document.getElementById("km-person-number-field").stepUp()},addMoreRoom:function(f){var T=f.target.parentElement.parentElement.parentElement,L=Number(f.target.dataset.roomcount)+1;f.target.setAttribute("data-roomcount",L);var K=document.createElement("div");K.innerHTML=Kommunicate.markup.getSingleRoomPaxInfo(L),T.getElementsByClassName("km-room-person-selector-container")[0].appendChild(K)},processSelectedRoom:function(f){for(var T=[],L=$(f.target).closest(".mck-msg-box-rich-text-container").find(".km-room-person-selector-container input.km-room-number-field"),K=$(f.target).closest(".mck-msg-box-rich-text-container").find(".km-room-person-selector-container input.km-person-number-field"),U="",P=0;P<L.length;P++){var G=K[P].value,B=Array(1*G).fill(10);T.push({NoOfAdults:L[P].value,NoOfChild:G,ChildAge:B}),U+="Room "+(P+1)+" Guest "+L[P].value+"\n"}var z={message:U,metadata:{isRoomGuestJSON:!0,roomGuestJson:JSON.stringify(T),guestTypeId:"ADULTS"}};Kommunicate.sendMessage(z)},processHotelBookClick:function(f){var T=f.target||f.srcElement,L=T.dataset.sessionid,K=T.dataset.resultindex,U={message:"Get room detail of "+T.dataset.name.replace("_"," "),metadata:{hotelSelected:!0,sessionId:L,resultIndex:K,skipDialogflow:!0}};Kommunicate.sendMessage(U)},processBookRoomClick:function(f){var T=f.target||f.srcElement,L=T.dataset.sessionid,K=T.dataset.roomindex,U=T.dataset.noofrooms,P="undefined"==T.dataset.hotelname?"":T.dataset.hotelname,G=T.dataset.hotelresultindex,B={message:"Book "+P.replace("_"," "),metadata:{sessionId:L,RoomIndex:K,NoOfRooms:U,blockHotelRoom:!0,skipDialogflow:!0,HotelResultIndex:G}},z=$applozic("#mck-message-cell .mck-message-inner"),H=$applozic("#mck-msg-to");!0===z.data("isgroup")?B.groupId=H.val():B.to=H.val(),$applozic.fn.applozic("sendGroupMessage",B)},handleRichButtonClick:function(f){var T=[],L="",K=f.target||f.srcElement,U=K.dataset.requesttype,P=K.dataset.buttontype||K.type,G=K.parentElement.getElementsByClassName("km-btn-hidden-form")[0]||K.parentElement;if("submit"==P){var B={},z={},H=-1!=G.className.indexOf("mck-actionable-form"),q=!!H&&JSON.parse(K.dataset.postBackToKommunicate.toLowerCase()),V=!!H&&JSON.parse(K.dataset.postBackAsMessage.toLowerCase()),W=K.title||K.innerHTML,J=[];J=Array.prototype.concat.apply(J,G.getElementsByTagName("input")),J=Array.prototype.concat.apply(J,G.getElementsByTagName("select")),J=Array.prototype.concat.apply(J,G.getElementsByTagName("textarea"));for(var ee="",te="",ae="",ne=0;ne<J.length;ne++){switch(ee=J[ne].name,te=J[ne].type,ae=J[ne].value,te){case"radio":J[ne].checked&&(B[ee]=ae);break;case"checkbox":J[ne].checked&&(!B[ee]&&(B[ee]=[]),B[ee].push(ae));break;case"select-one":B[ee]=ae,J[ne].dataset.errorText&&(Kommunicate.richMsgEventHandler.handleFormErrorMessage(G,ee,J[ne].dataset.errorText,!ae),T.push(ae?"success":"failed"));break;default:B[ee]=ae;try{J[ne].dataset.regex&&(L=Kommunicate.richMsgEventHandler.isValidString(J[ne].dataset.regex,ae),T.push(L?"success":"failed"),Kommunicate.richMsgEventHandler.handleFormErrorMessage(G,ee,J[ne].dataset.errorText||MCK_LABELS["rich.form"].errorText,!L))}catch(f){}}-1==KommunicateConstants.FORM_POST_BACK_MESSAGE_UNSUPPORTED_FIELDS.indexOf(te)&&(z[ee]=B[ee])}if(!H||-1==T.indexOf("failed")){if("json"==U){var oe=new XMLHttpRequest;oe.onreadystatechange=function(){4==this.readyState&&this.status},oe.open("POST",G.action),oe.send(JSON.stringify(B))}else!H&&G.submit(),H&&KommunicateUtils.isURL(G.action)&&$applozic.post(G.action,B).done((function(f){}));var ie={},se={},re="";if(V&&Object.keys(B).length)for(ne=0;ne<Object.keys(B).length;ne++){var ce=Object.keys(B)[ne];re=re.concat(ce+":"+B[ce]+"\n")}ie.message=W&&re?W.concat("\n"+re):W,H&&U==KommunicateConstants.POST_BACK_TO_BOT_PLATFORM&&(se.KM_CHAT_CONTEXT={formData:B});var le=q&&Kommunicate.markup.getFormDataMessageTemplate(z);le&&Kommunicate.sendMessage({message:le,type:KommunicateConstants.MESSAGE_CONTENT_TYPE.TEXT_HTML}),Object.keys(se).length>0&&(ie.metadata=se),(Object.keys(se).length>0||Object.keys(ie).length>0)&&Kommunicate.sendMessage(ie)}}},handleFormErrorMessage:function(f,T,L,K){f.getElementsByClassName(("mck-form-error-"+T).toLowerCase().replace(/ +/g,""))[0].innerHTML=K?L:""},handlleSubmitPersonDetail:function(f){var T=$applozic(f.target).closest(".km-guest-details-container").find(".km-title-select option:selected").text(),L=$applozic(f.target).closest(".km-guest-details-container").find(".km-guest-detail-form input.km-age-input"),K=$applozic(f.target).closest(".km-guest-details-container").find(".km-guest-detail-form input.first-name-input"),U=$applozic(f.target).closest(".km-guest-details-container").find(".km-guest-detail-form input.middle-name-input"),P=$applozic(f.target).closest(".km-guest-details-container").find(".km-guest-detail-form input.last-name-input"),G=$applozic(f.target).closest(".km-guest-details-container").find(".km-guest-detail-form input.e-mail-input"),B=$applozic(f.target).closest(".km-guest-details-container").find(".km-guest-detail-form input.number-input");if(""!=K[0].value&&""!=P[0].value&&""!=G[0].value&&""!=B[0].value){var z={Title:"title"===T?"":T,Age:L[0].value,FirstName:K[0].value,MiddleName:U[0].value,LastName:P[0].value,EmailId:G[0].value,PhoneNo:B[0].value},H=(f.target||f.srcElement).dataset.sessionid,q={message:z.Title+" "+z.FirstName+" "+z.LastName+"\n"+z.EmailId+"\n"+z.PhoneNo,metadata:{sessionId:H,guestDetail:!0,skipDialogflow:!0,personInfo:JSON.stringify(z)}};Kommunicate.sendMessage(q)}else $applozic(f.target).closest(".km-guest-details-container").find(".km-mandatory-field-error").removeClass("n-vis").addClass("vis")},processQuickReplies:function(f){kmWidgetEvents.eventTracking(eventMapping.onRichMessageButtonClick,f.target.innerText);var T=f.target.title,L={};try{L=JSON.parse(f.target.dataset.metadata)}catch(f){}var K=f.target.dataset.languagecode;K&&Kommunicate.updateUserLanguage(K);var U={message:T,metadata:L};document.getElementById("mck-text-box").setAttribute("data-quick-reply",!0),Kommunicate.sendMessage(U),kommunicate._globals.hidePostCTA&&!Kommunicate.getAllSiblings(f.target).some((function(f){return f.classList.contains("km-link-button")}))&&Kommunicate.hideMessage(f.target)},processClickOnListItem:function(f){kmWidgetEvents.eventTracking(eventMapping.onRichMessageButtonClick,f.target.innerText);var T=f.currentTarget,L=T.dataset.reply,K=T.dataset.type,U=T.dataset.articleid,P=T.dataset.source,G=T.dataset.languagecode,B={};try{B=JSON.parse(T.dataset.metadata)}catch(f){}if(B.KM_FAQ_ID=U,B.source=P,K&&"quick_reply"==K){G&&Kommunicate.updateUserLanguage(G);var z={message:L,metadata:B};Kommunicate.sendMessage(z)}},processClickOnButtonItem:function(f){f.preventDefault(),kmWidgetEvents.eventTracking(eventMapping.onRichMessageButtonClick,f.target.innerText);var T=f.currentTarget,L=T.dataset.reply,K=T.dataset.type,U=T.dataset.languagecode,P=T.dataset&&T.dataset.metadata||{};if(P.KM_BUTTON_CLICKED=!0,K&&"quick_reply"==K){U&&Kommunicate.updateUserLanguage(U);var G={message:L,metadata:P};Kommunicate.sendMessage(G)}},processClickOnDialogButton:function(f){kmWidgetEvents.eventTracking(eventMapping.onRichMessageButtonClick,f.target.innerText);var T=f.currentTarget,L=T.dataset.reply,K={};try{K=JSON.parse(T.dataset.metadata)}catch(f){}K.skipBot=void 0===K.skipBot||K.skipBot;var U={message:L,metadata:K};Kommunicate.sendMessage(U)},handleLinkButtonClick:function(f){kmWidgetEvents.eventTracking(eventMapping.onRichMessageButtonClick,f.target.innerText);var T=decodeURI(f.currentTarget.dataset.url);window.open(T,f.currentTarget.dataset.target)},handleFormSubmit:function(f){f.preventDefault(),kmWidgetEvents.eventTracking(eventMapping.onRichMessageButtonClick,f.target.innerText)},isValidString:function(f,T){return new RegExp(f).test(T)}},kommunicateCommons=new KommunicateCommons,KommunicateUI={awayMessageInfo:{},awayMessageScroll:!0,leadCollectionEnabledOnAwayMessage:!1,welcomeMessageEnabled:!1,leadCollectionEnabledOnWelcomeMessage:!1,anonymousUser:!1,showResolvedConversations:!1,isCSATtriggeredByUser:!1,isConvJustResolved:!1,convRatedTabIds:{},faqSVGImage:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><circle class="km-custom-widget-fill" cx="12" cy="12" r="12" fill="#5553B7" fill-rule="nonzero" opacity=".654"/><g transform="translate(6.545 5.818)"><polygon fill="#FFF" points=".033 2.236 .033 12.057 10.732 12.057 10.732 .02 3.324 .02"/><rect class="km-custom-widget-fill" width="6.433" height="1" x="2.144" y="5.468" fill="#5553B7" fill-rule="nonzero" opacity=".65" rx=".5"/><rect class="km-custom-widget-fill" width="4.289" height="1" x="2.144" y="8.095" fill="#5553B7" fill-rule="nonzero" opacity=".65" rx=".5"/><polygon class="km-custom-widget-fill" fill="#5553B7" points="2.656 .563 3.384 2.487 1.162 3.439" opacity=".65" transform="rotate(26 2.273 2.001)"/></g></g></svg>',CONSTS:{},updateScroll:function(f){f.scrollTop=f.scrollHeight},updateLeadCollectionStatus:function(f,T,L){KommunicateUI.awayMessageInfo={},f||"SUCCESS"!=T.code&&"AGENTS_ONLINE"!=T.code||(KommunicateUI.leadCollectionEnabledOnAwayMessage=T.data.collectEmailOnAwayMessage,"AGENTS_ONLINE"!=T.code&&T.data.messageList.length>0&&(KommunicateUI.awayMessageInfo.eventId=T.data.messageList[0].eventId,KommunicateUI.awayMessageInfo.isEnabled=!0),KommunicateUI.leadCollectionEnabledOnWelcomeMessage=T.data.collectEmailOnWelcomeMessage,KommunicateUI.welcomeMessageEnabled=T.data.welcomeMessageEnabled,KommunicateUI.anonymousUser=T.data.anonymousUser,KommunicateUI.displayLeadCollectionTemplate(L))},loadIntentDropdown:function(){var f=document.getElementById("mck-intent-options"),T=kommunicate._globals.replyMenu;if(T&&f)for(var L=0;L<=T.length;L++){var K=document.createElement("li");K.innerText=T[L],K.addEventListener("click",(function(f){f.preventDefault()})),f.appendChild(K)}},populateAwayMessage:function(f,T){var L=$applozic("#mck-tab-individual").hasClass("n-vis"),K=$applozic("#mck-conversation-status-box").hasClass("vis");!f&&"SUCCESS"==T.code&&T.data.messageList.length>0&&!L&&!K?(awayMessage=T.data.messageList[0].message,awayMessage=kommunicateCommons.formatHtmlTag(awayMessage),$applozic("#mck-away-msg").html(awayMessage),$applozic("#mck-away-msg").linkify({target:"_blank"}),$applozic("#mck-away-msg-box").removeClass("n-vis").addClass("vis")):$applozic("#mck-away-msg-box").removeClass("vis").addClass("n-vis");var U=document.querySelectorAll(".mck-message-inner.mck-group-inner")[0];KommunicateUI.awayMessageScroll&&U&&(KommunicateUI.updateScroll(U),KommunicateUI.awayMessageScroll=!1)},getLinkDataToPreview:function(f,T){mckUtils.ajax({headers:{"x-authorization":window.Applozic.ALApiService.AUTH_TOKEN},url:kommunicate.getBaseUrl()+"/rest/ws/extractlink?linkToExtract="+f,type:"GET",global:!1,success:function(f){if(f){var L=kommunicate.markup.getLinkPreviewTemplate(f);T(L)}},error:function(f){}})},showAwayMessage:function(){var f=$applozic("#mck-tab-individual").hasClass("n-vis");KommunicateUI.awayMessageInfo&&KommunicateUI.awayMessageInfo.isEnabled&&!f&&($applozic("#mck-email-collection-box").removeClass("vis").addClass("n-vis"),$applozic("#mck-away-msg-box").removeClass("n-vis").addClass("vis"))},hideAwayMessage:function(){$applozic("#mck-away-msg-box").removeClass("vis").addClass("n-vis")},displayLeadCollectionTemplate:function(f){var T=0;if(f&&f.length){T=0;for(var L=0;L<f.length&&(5!=f[L].type||2!=++T);L++);1==T?(KommunicateUI.leadCollectionEnabledOnAwayMessage&&KommunicateUI.awayMessageInfo.isEnabled&&1==KommunicateUI.awayMessageInfo.eventId||KommunicateUI.welcomeMessageEnabled&&KommunicateUI.leadCollectionEnabledOnWelcomeMessage&&KommunicateUI.anonymousUser)&&(this.populateLeadCollectionTemplate(),this.hideAwayMessage()):this.hideLeadCollectionTemplate()}else null==f&&(this.populateLeadCollectionTemplate(),this.hideAwayMessage())},displayProgressMeter:function(f,T){$applozic(".progress-meter-"+f).removeClass("n-vis").addClass("vis"),$applozic(".mck-attachment-"+f).next().removeClass("n-vis").addClass("vis"),$applozic(".mck-attachment-"+f+" .mck-image-download").addClass("n-vis")},deleteProgressMeter:function(f,T){$applozic(".progress-meter-"+f).remove(),T&&$applozic(".mck-attachment-"+f).next().removeClass("vis").addClass("n-vis")},displayUploadIconForAttachment:function(f,T){$applozic(".progress-meter-"+f+" .km-progress-upload-icon").removeClass("n-vis").addClass("vis"),$applozic(".progress-meter-"+f+" .km-progress-stop-upload-icon").removeClass("vis").addClass("n-vis"),Kommunicate.attachmentEventHandler.progressMeter(100,f),!T&&$applozic(".mck-attachment-"+f).next().removeClass("n-vis").addClass("vis")},updateImageAttachmentPreview:function(f,T){var L=$applozic(".mck-attachment-"+T)[0],K=L&&L.dataset&&L.dataset.thumbnailurl;K&&$applozic(".mck-attachment-"+T+" .file-preview-link").attr("data-url",K)},hideFileBox:function(f,T,L){KommunicateUI.isAttachmentV2(f.type)?(T.removeClass("vis").addClass("n-vis"),L.attr("disabled",!1)):T.removeClass("n-vis").addClass("vis")},isAttachmentV2:function(f){if(!f)return!0;var T=f.substring(0,f.indexOf("/"));return-1!=KM_ATTACHMENT_V2_SUPPORTED_MIME_TYPES.indexOf(T)},updateAttachmentTemplate:function(f,T){var L,K=document.querySelector(".mck-message-inner.mck-group-inner");K&&T&&(L=K.querySelector(".mck-attachment-"+T)),L&&(f.blobKey&&L.setAttribute("data-filemetakey",f.blobKey),f.name&&L.setAttribute("data-filename",f.name),L.setAttribute("data-fileurl",f.thumbnailUrl||f.url),f.size&&L.setAttribute("data-filesize",f.size),L.setAttribute("data-filetype",f.contentType||f.fileMeta.contentType),f.url&&$applozic(".km-attachment-preview-href-"+T).attr("href",f.url))},updateAttachmentStopUploadStatus:function(f,T){var L=document.querySelector(".mck-message-inner.mck-group-inner"),K=L&&L.querySelector(".mck-attachment-"+f);K&&K.setAttribute("data-stopupload",T)},getAttachmentStopUploadStatus:function(f){var T=$applozic(".mck-attachment-"+f).attr("data-stopupload");return"true"==T},populateLeadCollectionTemplate:function(){KommunicateUI.hideAwayMessage(),$applozic("#mck-email-collection-box").removeClass("n-vis").addClass("vis"),$applozic("#mck-btn-attach-box").removeClass("vis").addClass("n-vis"),$applozic("#mck-text-box").blur(),$applozic("#mck-text-box").attr("data-text","Your email ID")},hideLeadCollectionTemplate:function(){$applozic("#mck-email-collection-box").removeClass("vis").addClass("n-vis"),$applozic("#mck-email-error-alert-box").removeClass("vis").addClass("n-vis"),$applozic("#mck-btn-attach-box").removeClass("n-vis").addClass("vis"),$applozic("#mck-text-box").attr("data-text",MCK_LABELS["input.message"])},validateEmail:function(f){return f.match(/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/)?($applozic("#mck-email-error-alert-box").removeClass("vis").addClass("n-vis"),this.hideLeadCollectionTemplate(),window.$applozic.fn.applozic("updateUser",{data:{email:f}}),!0):($applozic("#mck-email-error-alert-box").removeClass("n-vis").addClass("vis"),$applozic("#mck-email-collection-box").removeClass("vis").addClass("n-vis"),!1)},initFaq:function(){var f={};f.appId=kommunicate._globals.appId,$applozic(d).on("click","#km-faq",(function(){var f=kommunicate&&kommunicate._globals&&kommunicate._globals.faqCategory;kmWidgetEvents.eventTracking(eventMapping.onFaqClick),MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE&&KommunicateUtils.removeItemFromLocalStorage("mckActiveConversationInfo"),KommunicateUI.showHeader(),KommunicateUI.awayMessageScroll=!0,f?"km-faq-list"!==MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-1]&&MCK_EVENT_HISTORY.push("km-faq-list"):"km-faq-category-list"!==MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-1]&&MCK_EVENT_HISTORY.push("km-faq-category-list"),MCK_BOT_MESSAGE_QUEUE=[],kommunicateCommons.modifyClassList({id:["km-contact-search-input-box","faq-common","km-faqdiv","mck-tab-title","km-faq-category-list-container"],class:["mck-conversation-back-btn","km-contact-input-container"]},"vis","n-vis"),kommunicateCommons.modifyClassList({id:["km-faq","mck-no-conversations","mck-away-msg-box","mck-sidebox-ft","mck-contacts-content","km-widget-options"],class:["mck-conversation","mck-agent-image-container","mck-agent-status-text"]},"n-vis","vis"),f?$applozic("#km-faq-category-list-container").addClass("n-vis"):$applozic("#km-faq-list-container").addClass("n-vis")&&$applozic("#km-faq-category-list-container").removeClass("n-vis"),$applozic("#mck-tab-title").html("FAQ"),$applozic("#mck-msg-new").attr("disabled",!1),$applozic("#mck-tab-individual .mck-tab-link.mck-back-btn-container").removeClass("n-vis").addClass("vis-table"),$applozic("#mck-tab-individual .mck-name-status-container.mck-box-title").removeClass("padding"),KommunicateUI.checkSingleThreadedConversationSettings(!0)})),$applozic(d).on("click",".km-faq-category-card",(function(){kommunicateCommons.modifyClassList({id:["km-faq-category-list-container"]},"n-vis","vis"),kommunicateCommons.modifyClassList({id:["km-faq-list-container"]},"vis","n-vis"),"km-faq-list"!==MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-1]&&MCK_EVENT_HISTORY.push("km-faq-list");var T=this.getAttribute("data-category-name");document.querySelector("#km-faq-list-container").innerHTML="",Kommunicate.getFaqList(f,T)})),$applozic(d).on("click","#mck-conversation-back-btn",(function(f){if($applozic(".km-contact-input-container").removeClass("vis").addClass("n-vis"),MCK_MAINTAIN_ACTIVE_CONVERSATION_STATE&&KommunicateUtils.removeItemFromLocalStorage("mckActiveConversationInfo"),KommunicateUI.awayMessageScroll=!0,KommunicateUI.hideAwayMessage(),KommunicateUI.hideLeadCollectionTemplate(),kommunicateCommons.modifyClassList({id:["km-widget-options"]},"n-vis"),MCK_BOT_MESSAGE_QUEUE=[],MCK_EVENT_HISTORY.length>=2){if("km-faq-category-list"==MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-2])return KommunicateUI.showHeader(),kommunicateCommons.modifyClassList({id:["km-faqdiv","km-faq-category-list-container","km-contact-search-input-box"],class:["km-contact-input-container"]},"vis","n-vis"),kommunicateCommons.modifyClassList({id:["km-faq-list-container"],class:["km-no-results-found-container"]},"n-vis","vis"),$applozic("#mck-msg-new").attr("disabled",!1),void MCK_EVENT_HISTORY.splice(MCK_EVENT_HISTORY.length-1,1);if("km-faq-list"==MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-2])return KommunicateUI.showHeader(),kommunicateCommons.modifyClassList({id:["km-faqdiv","km-contact-search-input-box"],class:["km-contact-input-container"]},"vis","n-vis"),kommunicateCommons.modifyClassList({id:["km-faqanswer"],class:["km-no-results-found-container"]},"n-vis","vis"),$applozic("#mck-msg-new").attr("disabled",!1),void MCK_EVENT_HISTORY.splice(MCK_EVENT_HISTORY.length-1,1);if("object"==typeof MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-2]){kommunicateCommons.modifyClassList({id:["mck-tab-conversation","km-faq"],class:["mck-conversation","mck-agent-image-container","mck-agent-status-text"]},"vis","n-vis"),kommunicateCommons.modifyClassList({id:["faq-common"],class:["km-no-results-found-container","km-talk-to-human-div"]},"n-vis","vis");var T=MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-2];return $applozic.fn.applozic("openChat",T),MCK_EVENT_HISTORY.splice(MCK_EVENT_HISTORY.length-1,1),void KommunicateUI.activateTypingField()}return $applozic("#km-faq").removeClass("n-vis").addClass("vis"),$applozic("#mck-msg-new").attr("disabled",!1),MCK_EVENT_HISTORY.splice(MCK_EVENT_HISTORY.length-1,1),void(MCK_EVENT_HISTORY.length=0)}return kommunicateCommons.modifyClassList({id:["km-faq","mck-rate-conversation"],class:["mck-conversation"]},"vis","n-vis"),kommunicateCommons.modifyClassList({id:["faq-common"],class:["km-no-results-found-container","km-talk-to-human-div","mck-agent-status-text","mck-agent-image-container","mck-agent-status-indicator"]},"n-vis","vis"),kommunicateCommons.modifyClassList({class:["mck-rating-box"]},"","selected"),document.getElementById("mck-tab-title").textContent="",MCK_EVENT_HISTORY.length=0,KommunicateUI.handleConversationBanner(),void(document.querySelector("#km-faq-search-input").value&&document.querySelector(".km-clear-faq-search-icon").click())})),$applozic(d).on("click","#mck-msg-preview, #mck-msg-preview-visual-indicator .mck-msg-preview-visual-indicator-text",(function(){KommunicateUI.showChat()})),$applozic(d).on("click",".km-faq-list",(function(){$applozic("#km-faqanswer").empty(),"km-faq-answer-list"!==MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-1]&&MCK_EVENT_HISTORY.push("km-faq-answer-list");var T=$(this).attr("data-articleid"),L=$(this).attr("data-source");KommunicateKB.getArticle({data:{appId:f.appId,articleId:T,source:L},success:function(f){var T=f&&f.data;if(T&&0==$applozic("#km-faqanswer .km-faqanswer-list").length){var L=T.title&&kommunicateCommons.formatHtmlTag(T.title);$applozic("#km-faqanswer").append('<div class="km-faqanswer-list ql-snow"><div class="km-faqquestion">'+L+'</div> <div class="km-faqanchor km-faqanswer ql-editor">'+T.body+"</div></div>"),$applozic("#km-contact-search-input-box").removeClass("vis").addClass("n-vis"),$applozic("#km-faqdiv").removeClass("vis").addClass("n-vis"),$applozic("#km-faqanswer").removeClass("n-vis").addClass("vis"),$applozic("#mck-tab-individual").removeClass("n-vis").addClass("vis"),$applozic("#mck-tab-conversation").removeClass("vis").addClass("n-vis"),$applozic("#mck-no-conversations").removeClass("vis").addClass("n-vis"),$applozic("#km-faqanswer .km-faqanswer").linkify({target:"_blank"})}},error:function(f){throw new Error("Error while fetching faq details",f)}}),$applozic(".km-contact-input-container").removeClass("vis").addClass("n-vis")})),$applozic(d).on("click","#km-faqanswer a",(function(f){f.preventDefault(),window.open(f.target.href)})),$applozic("#km-faq-search-input").keyup(kommunicateCommons.debounce((function(T){T.target.value.length>0?$applozic(".km-clear-faq-search-icon").addClass("vis").removeClass("n-vis"):$applozic(".km-clear-faq-search-icon").addClass("n-vis").removeClass("vis"),document.querySelector("#km-faq-category-list-container.n-vis")||("km-faq-list"!==MCK_EVENT_HISTORY[MCK_EVENT_HISTORY.length-1]&&MCK_EVENT_HISTORY.push("km-faq-list"),kommunicateCommons.modifyClassList({id:["km-faq-category-list-container"]},"n-vis","vis"),kommunicateCommons.modifyClassList({id:["km-faq-list-container"]},"vis","n-vis")),32!=T.which&&T.which,KommunicateUI.searchFaqs(f)}),500)),$applozic(d).on("click",".km-clear-faq-search-icon",(function(){$applozic("#km-faq-search-input").val(""),$applozic(".km-clear-faq-search-icon").addClass("n-vis").removeClass("vis");var f=jQuery.Event("keyup");f.which=13,$applozic("#km-faq-search-input").trigger(f)}))},faqEmptyState:function(){kommunicateCommons.modifyClassList({class:["km-no-results-found-container","km-talk-to-human-div"]},"vis","n-vis"),document.querySelector(".km-talk-to-human-div p").innerHTML=MCK_LABELS["no-faq-found"],document.querySelector(".km-no-results-found p").innerHTML=MCK_LABELS["faq-empty-state"]},searchFaqUI:function(f){f.data&&0===f.data.length?(kommunicateCommons.modifyClassList({class:["km-no-results-found-container","km-talk-to-human-div"]},"vis","n-vis"),document.querySelector(".km-talk-to-human-div p").innerHTML=MCK_LABELS["no-faq-found"],document.querySelector(".km-no-results-found p").innerHTML="NO RESULTS FOUND"):(kommunicateCommons.modifyClassList({class:["km-no-results-found-container"]},"n-vis","vis"),document.querySelector(".km-talk-to-human-div p").innerHTML=MCK_LABELS["looking.for.something.else"],kommunicateCommons.modifyClassList({class:["km-talk-to-human-div"]},"vis","n-vis")),document.getElementById("km-faq-list-container").innerHTML="",$applozic.each(f.data,(function(f,T){var L=T.id||T.articleId,K=T.name||T.title;K=K&&kommunicateCommons.formatHtmlTag(K),document.getElementById("km-faq-list-container").innerHTML+='<li class="km-faq-list"  data-articleId="'+L+'"><a class="km-faqdisplay"> <div class="km-faqimage">'+KommunicateUI.faqSVGImage+'</div><div class="km-faqanchor">'+K+"</div></a></li>"}))},searchFaqs:function(f){var T={appId:f&&f.appId,query:document.getElementById("km-faq-search-input").value};kommunicate&&kommunicate._globals&&kommunicate._globals.faqCategory&&(T.categoryName=kommunicate._globals.faqCategory),document.getElementById("km-faq-search-input").value?KommunicateKB.searchFaqs({data:T,success:function(f){KommunicateUI.searchFaqUI(f)},error:function(f){}}):KommunicateKB.getArticles({data:T,success:function(f){KommunicateUI.searchFaqUI(f)},error:function(){}})},hideFaq:function(){$applozic("#km-contact-search-input-box").removeClass("vis").addClass("n-vis"),$applozic("#km-faqdiv").removeClass("vis").addClass("n-vis"),$applozic("#mck-msg-new").attr("disabled",!1)},hideMessagePreview:function(){$applozic("#mck-msg-preview-visual-indicator").removeClass("vis").addClass("n-vis"),$applozic("#mck-msg-preview-visual-indicator .mck-msg-preview-visual-indicator-text").html("")},showChat:function(){kommunicateCommons.setWidgetStateOpen(!0),$applozic("#faq-common").removeClass("vis").addClass("n-vis"),$applozic(".mck-conversation").removeClass("n-vis").addClass("vis"),$applozic("#km-faq").removeClass("n-vis").addClass("vis"),$applozic("#mck-msg-new").attr("disabled",!1),0===$applozic("#mck-message-cell .mck-message-inner div[name='message']").length&&1==isFirstLaunch?isFirstLaunch=!1:($applozic("#mck-tab-individual .mck-tab-link.mck-back-btn-container").removeClass("n-vis"),$applozic("#mck-tab-individual .mck-name-status-container.mck-box-title").removeClass("padding"))},showHeader:function(){$applozic("#mck-tab-individual").removeClass("n-vis").addClass("vis"),$applozic("#mck-tab-conversation").removeClass("vis").addClass("n-vis"),$applozic("#mck-msg-new").attr("disabled",!1)},sendFaqQueryAsMsg:function(f){var T=$applozic("#km-faq-search-input").val(),L=MCK_LABELS["faq.query.message"].QUERY_REGARDING+' \n"'+T+'"\n\n'+MCK_LABELS["faq.query.message"].HELP_YOU;if(""!==T){var K={groupId:f,type:5,contentType:0,message:L};$applozic.fn.applozic("sendGroupMessage",K)}},activateTypingField:function(){!kommunicateCommons.checkIfDeviceIsHandheld()&&$applozic("#mck-text-box").focus()},setAvailabilityStatus:function(f){$applozic(".mck-agent-image-container").removeClass("n-vis").addClass("vis"),$applozic(".mck-agent-image-container .mck-agent-status-indicator").removeClass("mck-status--online").removeClass("mck-status--offline").removeClass("mck-status--away").removeClass("n-vis").addClass("vis mck-status--"+f),$applozic("#mck-agent-status-text").text(MCK_LABELS[f]).addClass("vis").removeClass("n-vis")},toggleVoiceOutputOverride:function(f){f?(kommunicateCommons.modifyClassList({id:["user-overide-voice-output-svg-off"]},"n-vis"),kommunicateCommons.modifyClassList({id:["user-overide-voice-output-svg-on"]},"","n-vis"),document.getElementById("user-overide-voice-output-text").innerText=MCK_LABELS["conversation.header.dropdown"].USER_OVERIDE_VOICE_OUTPUT_OFF):(kommunicateCommons.modifyClassList({id:["user-overide-voice-output-svg-on"]},"n-vis"),kommunicateCommons.modifyClassList({id:["user-overide-voice-output-svg-off"]},"","n-vis"),document.getElementById("user-overide-voice-output-text").innerText=MCK_LABELS["conversation.header.dropdown"].USER_OVERIDE_VOICE_OUTPUT_ON)},loadQuickReplies:function(f){var T=document.getElementById("mck-intent-options");if(f.length>0&&T&&T.childElementCount<1){kommunicateCommons.modifyClassList({id:["mck-quick-replies-box"]},"vis","n-vis");for(var L=0;L<=f.length-1;L++){var K=document.createElement("li");K.innerText=f[L],T.appendChild(K),K.onclick=function(f){f.preventDefault(),document.getElementById("mck-text-box").innerText=this.innerText,document.getElementById("mck-msg-sbmt").click()}}}},triggerCSAT:function(){var f=document.getElementsByClassName("mck-rated").length>0;kommunicate._globals.oneTimeRating&&(f&&CURRENT_GROUP_DATA.tabId?KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]=KommunicateConstants.FEEDBACK_API_STATUS.RATED:(KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]>KommunicateConstants.FEEDBACK_API_STATUS.RATED||!KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId])&&kommunicateCommons.getFeedback(CURRENT_GROUP_DATA.tabId,(function(f){KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]=f.data?KommunicateConstants.FEEDBACK_API_STATUS.RATED:KommunicateConstants.FEEDBACK_API_STATUS.INIT})));var T=kommunicate._globals.oneTimeRating?kommunicate._globals.collectFeedback&&KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]!=KommunicateConstants.FEEDBACK_API_STATUS.RATED:kommunicate._globals.collectFeedback;kmWidgetEvents.eventTracking(eventMapping.onRateConversationClick),KommunicateUI.isConvJustResolved||(KommunicateUI.isCSATtriggeredByUser=!0);var L=document.querySelector(".mck-message-inner.mck-group-inner");if(T)document.getElementById("mck-submit-comment").disabled=!1,kommunicateCommons.modifyClassList({class:["mck-rating-box"]},"","selected"),kommunicateCommons.modifyClassList({class:["mck-box-form"]},"n-vis","vis"),kommunicateCommons.modifyClassList({id:["mck-sidebox-ft"]},"km-mid-conv-csat"),kommunicateCommons.modifyClassList({id:["csat-1"]},"vis","n-vis"),KommunicateUI.isConvJustResolved=!1;else if(KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]==KommunicateConstants.FEEDBACK_API_STATUS.RATED&&kommunicate._globals.oneTimeRating){var K=MCK_LABELS["closed.conversation.message"],U=document.getElementById("mck-conversation-status-box");U&&(U.innerHTML=K),kommunicateCommons.modifyClassList({id:["mck-sidebox-ft"]},"mck-closed-conv-banner"),kommunicateCommons.modifyClassList({id:["mck-conversation-status-box"]},"vis","n-vis"),kommunicateCommons.modifyClassList({class:["mck-box-form"]},"","n-vis"),kommunicateCommons.modifyClassList({id:["km-widget-options"]},"n-vis"),KommunicateUI.updateScroll(L)}else kommunicateCommons.modifyClassList({class:["mck-csat-text-1"]},"vis","n-vis")},askCSAT:function(){KommunicateUI.triggerCSAT(),kommunicateCommons.modifyClassList({id:["mck-csat-close"]},"vis","n-vis")},showClosedConversationBanner:function(f){var T=document.getElementsByClassName("mck-rated").length>0;kommunicate._globals.oneTimeRating&&(T&&CURRENT_GROUP_DATA.tabId?KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]=KommunicateConstants.FEEDBACK_API_STATUS.RATED:(KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]>KommunicateConstants.FEEDBACK_API_STATUS.RATED||!KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId])&&kommunicateCommons.getFeedback(CURRENT_GROUP_DATA.tabId,(function(f){KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]=f.data?KommunicateConstants.FEEDBACK_API_STATUS.RATED:KommunicateConstants.FEEDBACK_API_STATUS.INIT})));var L=MCK_LABELS["closed.conversation.message"],K=document.getElementById("mck-conversation-status-box"),U=KommunicateUI.isCSATtriggeredByUser,P=KommunicateUI.isConvJustResolved,G=kommunicate._globals.oneTimeRating?kommunicate._globals.collectFeedback&&KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]!=KommunicateConstants.FEEDBACK_API_STATUS.RATED:kommunicate._globals.collectFeedback,B=document.querySelector(".mck-message-inner.mck-group-inner");f&&kommunicateCommons.modifyClassList({class:["mck-box-form"]},"n-vis"),!G||!f||kommunicateCommons.isConversationClosedByBot()||U||P?f&&KommunicateUI.isCSATtriggeredByUser?(KommunicateUI.isCSATtriggeredByUser=!1,kommunicateCommons.modifyClassList({id:["csat-1","csat-2","csat-3","mck-rated"]},"n-vis",""),kommunicateCommons.modifyClassList({id:["mck-sidebox-ft"]},"","km-mid-conv-csat"),kommunicateCommons.modifyClassList({id:["mck-conversation-status-box"]},"n-vis","vis"),kommunicateCommons.modifyClassList({class:["mck-box-form"]},"","n-vis"),kommunicateCommons.modifyClassList({class:["mck-csat-text-1"]},"n-vis")):f&&KommunicateUI.isConvJustResolved?KommunicateUI.askCSAT():f?(K&&(K.innerHTML=L),kommunicateCommons.modifyClassList({id:["mck-sidebox-ft"]},"mck-closed-conv-banner"),kommunicateCommons.modifyClassList({id:["mck-conversation-status-box"]},"vis","n-vis"),kommunicateCommons.modifyClassList({class:["mck-box-form"]},"","n-vis"),kommunicateCommons.modifyClassList({id:["km-widget-options"]},"n-vis"),KommunicateUI.updateScroll(B)):(kommunicateCommons.modifyClassList({id:["csat-1","csat-2","csat-3","mck-rated"]},"n-vis",""),kommunicateCommons.modifyClassList({id:["mck-sidebox-ft"]},"","mck-closed-conv-banner"),kommunicateCommons.modifyClassList({id:["mck-sidebox-ft"]},"","km-mid-conv-csat"),kommunicateCommons.modifyClassList({id:["mck-conversation-status-box"]},"n-vis","vis"),kommunicateCommons.modifyClassList({class:["mck-box-form"]},"","n-vis"),kommunicateCommons.modifyClassList({class:["mck-csat-text-1"]},"n-vis")):kommunicateCommons.getFeedback(CURRENT_GROUP_DATA.tabId,(function(f){var T=f.data;KommunicateUI.convRatedTabIds[CURRENT_GROUP_DATA.tabId]=T?KommunicateConstants.FEEDBACK_API_STATUS.RATED:KommunicateConstants.FEEDBACK_API_STATUS.INIT,CURRENT_GROUP_DATA.currentGroupFeedback=T,kommunicateCommons.modifyClassList({class:["mck-box-form"]},"n-vis"),kommunicateCommons.modifyClassList({class:["mck-csat-text-1"]},"","n-vis"),kommunicateCommons.modifyClassList({id:["mck-sidebox-ft"]},"mck-closed-conv-banner"),kommunicateCommons.modifyClassList({id:["csat-1","csat-2","csat-3"]},"n-vis"),kommunicateCommons.modifyClassList({id:["km-widget-options"]},"n-vis"),T||(kommunicateCommons.modifyClassList({id:["csat-1"]},"","n-vis"),document.getElementById("mck-submit-comment").disabled=!1),KommunicateUI.updateScroll(B)}))},handleAttachmentIconVisibility:function(f,T,L){!L&&"object"==typeof T.metadata&&T.metadata.KM_ENABLE_ATTACHMENT?("true"==T.metadata.KM_ENABLE_ATTACHMENT&&kommunicateCommons.modifyClassList({id:["mck-attachfile-box","mck-file-up"]},"vis","n-vis"),"false"==T.metadata.KM_ENABLE_ATTACHMENT&&kommunicateCommons.modifyClassList({id:["mck-attachfile-box","mck-file-up"]},"n-vis","vis")):L&&f&&("true"==f&&kommunicateCommons.modifyClassList({id:["mck-attachfile-box","mck-file-up"]},"vis","n-vis"),"false"==f&&kommunicateCommons.modifyClassList({id:["mck-attachfile-box","mck-file-up"]},"n-vis","vis"))},displayPopupChatTemplate:function(f,T,L){var K=!kommunicateCommons.isObject(T)||!T.hasOwnProperty("enableGreetingMessageInMobile")||T.enableGreetingMessageInMobile,U=kommunicateCommons.isObject(T)&&T.popup&&(!kommunicateCommons.checkIfDeviceIsHandheld()||K),P=f&&f.length?f[0].delay:-1,G=f&&f.length&&f[0].templateKey||KommunicateConstants.CHAT_POPUP_TEMPLATE.HORIZONTAL;U&&P>-1&&(MCK_CHAT_POPUP_TEMPLATE_TIMER=setTimeout((function(){KommunicateUI.togglePopupChatTemplate(G,!0,L)}),P))},captureGreetingMessageClick:function(f){f.preventDefault(),kmWidgetEvents.eventTracking(eventMapping.onGreetingMessageNotificationClick)},togglePopupChatTemplate:function(f,T,L){var K=parent.document.getElementById("kommunicate-widget-iframe"),U=KommunicateUtils.getDataFromKmSession("playPopupNotificationTone");if(T&&!kommunicateCommons.isWidgetOpen()){(null==U||U)&&(L&&L.play(),KommunicateUtils.storeDataIntoKmSession("playPopupNotificationTone",!1)),f===KommunicateConstants.CHAT_POPUP_TEMPLATE.HORIZONTAL&&kommunicateCommons.modifyClassList({id:["mck-sidebox-launcher","launcher-svg-container"]},"km-no-box-shadow",""),f===KommunicateConstants.CHAT_POPUP_TEMPLATE.HORIZONTAL?K.classList.add("chat-popup-widget-horizontal"):K.classList.add("chat-popup-widget-vertical"),kommunicateCommons.modifyClassList({id:["launcher-svg-container"]},"km-animate",""),kommunicateCommons.modifyClassList({id:["chat-popup-widget-container"]},"km-animate","n-vis");var P=document.getElementById("chat-popup-widget-container");if(P&&P.firstChild&&P.firstChild.addEventListener("click",this.captureGreetingMessageClick),K.classList.contains("chat-popup-widget-vertical")){var G="iframe#kommunicate-widget-iframe.chat-popup-widget-vertical { height:"+(document.getElementById("chat-popup-widget-container").offsetHeight+15)+"px!important;}";parent.document.querySelector("style#kommunicate-style-sheet").innerText+=G}(kommunicate&&kommunicate._globals&&kommunicate._globals.widgetSettings&&kommunicate._globals.widgetSettings.hasOwnProperty("position")?kommunicate._globals.widgetSettings.position:KommunicateConstants.POSITION.RIGHT)===KommunicateConstants.POSITION.LEFT&&kommunicateCommons.modifyClassList({class:["chat-popup-widget-close-btn-container","chat-popup-widget-container--vertical","chat-popup-widget-text-wrapper","chat-popup-widget-container--horizontal"]},"align-left")}else kommunicateCommons.modifyClassList({id:["mck-sidebox-launcher","launcher-svg-container"]},"","km-no-box-shadow"),kommunicateCommons.modifyClassList({id:["launcher-svg-container"]},"","km-animate"),K&&K.classList.remove("chat-popup-widget-horizontal"),K&&K.classList.remove("chat-popup-widget-vertical"),kommunicateCommons.modifyClassList({id:["chat-popup-widget-container"]},"n-vis","km-animate")},handleConversationBanner:function(f){var T=document.querySelectorAll("ul#mck-contact-list li")&&document.querySelectorAll("ul#mck-contact-list li").length,L='<div id="mck-conversation-filter"><span id="mck-conversation-banner-heading">'.concat(MCK_LABELS["filter.conversation.list"].ACTIVE_CONVERSATIONS,'</span><span id="mck-conversation-banner-action" onclick="KommunicateUI.toggleShowResolvedConversationsStatus(),KommunicateUI.handleResolvedConversationsList()">').concat(MCK_LABELS["filter.conversation.list"].HIDE_RESOLVED,"</span></div>"),K=document.getElementsByClassName("mck-conversation-resolved")&&document.getElementsByClassName("mck-conversation-resolved").length,U=document.getElementsByClassName("mck-conversation-open")&&document.getElementsByClassName("mck-conversation-open").length,P=document.querySelector(".mck-conversation.vis .mck-message-inner"),G=document.getElementById("mck-conversation-filter");T!==U&&T!==K&&!G&&P?P.insertAdjacentHTML("afterbegin",L):T===K?(G&&G.parentNode.removeChild(G),KommunicateUI.showResolvedConversations=!0):G&&T==U&&(G&&G.parentNode.removeChild(G),KommunicateUI.showResolvedConversations=!1),KommunicateUI.handleResolvedConversationsList()},toggleShowResolvedConversationsStatus:function(){KommunicateUI.showResolvedConversations=!KommunicateUI.showResolvedConversations},handleResolvedConversationsList:function(){var f=document.getElementById("mck-conversation-banner-heading"),T=document.getElementById("mck-conversation-banner-action");KommunicateUI.showResolvedConversations?(kommunicateCommons.modifyClassList({class:["mck-conversation-resolved"]},"mck-show-resolved-conversation"),f&&(f.innerHTML=MCK_LABELS["filter.conversation.list"].ALL_CONVERSATIONS),T&&T.innerText==MCK_LABELS["filter.conversation.list"].SHOW_RESOLVED&&kmWidgetEvents.eventTracking(eventMapping.onShowResolvedClick),T&&(T.innerHTML=MCK_LABELS["filter.conversation.list"].HIDE_RESOLVED)):(kommunicateCommons.modifyClassList({class:["mck-conversation-resolved"]},"","mck-show-resolved-conversation"),f&&(f.innerHTML=MCK_LABELS["filter.conversation.list"].ACTIVE_CONVERSATIONS),T&&(T.innerHTML=MCK_LABELS["filter.conversation.list"].SHOW_RESOLVED))},adjustConversationTitleHeadingWidth:function(f){var T="mck-title-width-wo-faq-with-close-btn",L=document.getElementById("mck-tab-title");L.classList.remove(T),document.querySelector(".km-kb-container").classList.contains("vis")&&(T=f?"mck-title-width-with-faq":"mck-title-width-with-faq-close-btn"),L.classList.add(T)},checkSingleThreadedConversationSettings:function(f){if(kommunicateCommons.isObject(kommunicate._globals.widgetSettings)&&kommunicate._globals.widgetSettings.isSingleThreaded){var T=document.getElementById("mck-contacts-content"),L=document.querySelector(".mck-back-btn-container");T.classList.add("force-n-vis"),f?L.classList.remove("force-n-vis"):L.classList.add("force-n-vis")}},handleWaitingQueueMessage:function(){var f=CURRENT_GROUP_DATA,T=f&&f.tabId,L=f&&f.conversationStatus==Kommunicate.conversationHelper.status.WAITING;window.Applozic.ALApiService.ajax({type:"GET",url:MCK_BASE_URL+"/rest/ws/group/waiting/list",global:!1,contentType:"application/json",success:function(f){if("success"===f.status){var K=(WAITING_QUEUE=f.response).indexOf(parseInt(T))>-1,U=document.getElementById("waiting-queue-number"),P=document.getElementById("mck-tab-title");if(U&&L&&K&&WAITING_QUEUE.length){U.innerHTML="#"+parseInt(WAITING_QUEUE.indexOf(parseInt(T))+1),kommunicateCommons.modifyClassList({id:["mck-waiting-queue"]},"vis","n-vis"),kommunicateCommons.modifyClassList({class:["mck-agent-image-container","mck-agent-status-text"]},"n-vis","vis"),P.innerHTML=MCK_LABELS["waiting.queue.message"]["header.text"];var G=document.querySelector(".mck-message-inner.mck-group-inner");G&&KommunicateUI.updateScroll(G)}else kommunicateCommons.modifyClassList({id:["mck-waiting-queue"]},"n-vis","vis"),kommunicateCommons.modifyClassList({class:["mck-agent-image-container","mck-agent-status-text"]},"vis","n-vis"),(P=document.getElementById("mck-tab-title")).innerHTML=P.getAttribute("title")}},error:function(f){throw new Error("Error while fetching waiting list",f)}})},getUrlFromBlobKey:function(f,T){var L="?key="+f;window.Applozic.ALApiService.ajax({type:"GET",global:!1,url:MCK_BASE_URL+"/rest/ws/file/url"+L,success:function(f){T(null,f)},error:function(f){T(f)}})},isInView:function(f,T){const L=f.getBoundingClientRect(),K=T.getBoundingClientRect();return L.top>=K.top&&L.left>=K.left&&L.bottom<=K.bottom&&L.right<=K.right},processLazyImage:function(f,T){f.classList.remove("lazy-image"),KommunicateUI.getUrlFromBlobKey(T,(function(T,L){if(T)throw T;L&&(f.src=L),setTimeout((function(){f.classList.add("lazy-image")}),KommunicateConstants.AWS_IMAGE_URL_EXPIRY_TIME)}))}},Kommunicate.KmEventHandler={openChatOnNotification:function(f){"block"!==document.getElementById("mck-sidebox").style.display&&(f&&f.groupId?(document.getElementById("launcher-agent-img-container").classList.remove("vis"),document.getElementById("launcher-agent-img-container").classList.add("n-vis"),document.getElementById("launcher-svg-container").classList.remove("n-vis"),document.getElementById("launcher-svg-container").classList.add("vis"),window.Kommunicate.openConversation(f.groupId)):window.Kommunicate.openDirectConversation(f.to),KommunicateUI.hideMessagePreview())},notificationEvent:function(f){KommunicateUtils.getDataFromKmSession("appOptions")&&KommunicateUtils.getDataFromKmSession("appOptions").openConversationOnNewMessage?Kommunicate.KmEventHandler.openChatOnNotification(f):document.getElementById("launcher-agent-img-container").classList.contains("vis")&&(document.querySelector("#mck-sidebox-launcher #launcher-svg-container").classList.add("n-vis"),document.querySelector("#mck-sidebox-launcher #launcher-svg-container").classList.remove("vis"))},onMessageReceived:function(f){var T=f.metadata&&"HIDDEN"!=f.metadata.category&&"true"!=f.metadata.hide;f.metadata&&!T||(KommunicateUI.hideAwayMessage(),f.userOverride.voiceOutput&&Kommunicate.mediaService.voiceOutputIncomingMessage(f))},onMessageSent:function(f){f&&f.metadata&&f.metadata.feedback||KommunicateUI.showClosedConversationBanner(!1)}},Kommunicate.postPluginInitialization=function(f,T){var L;KommunicateKB.init(Kommunicate.getBaseUrl()),kommunicate&&kommunicate._globals&&kommunicate._globals.faqCategory?(L=kommunicate._globals.faqCategory,Kommunicate.getFaqList(T,L)):Kommunicate.getFaqCategories(T)},Kommunicate.getFaqList=function(f,T){KommunicateKB.getArticles({data:{appId:f.appId,query:"",categoryName:T},success:function(f){f.data&&f.data.length>0&&$applozic(".km-kb-container").hasClass("n-vis")&&($applozic(".km-kb-container").removeClass("n-vis").addClass("vis"),KommunicateUI.adjustConversationTitleHeadingWidth(kommunicate._globals.popupWidget)),f.data.length?$applozic.each(f.data,(function(f,T){var L=T&&T.title&&kommunicateCommons.formatHtmlTag(T.title);$applozic("#km-faq-list-container").append('<li class="km-faq-list" aria-disabled="false" role="button" tabindex="0" data-source="'+T.source+'" data-articleId="'+T.articleId+'"><a class="km-faqdisplay"><div class="km-faqimage">'+KommunicateUI.faqSVGImage+'</div> <div class="km-faqanchor">'+L+"</div></a></li>")})):KommunicateUI.faqEmptyState(),kommunicate&&kommunicate._globals&&kommunicate._globals.faqCategory&&KommunicateUI.initFaq()},error:function(){}})},Kommunicate.getFaqCategories=function(f){KommunicateKB.getCategories({data:{appId:f.appId,baseUrl:Kommunicate.getBaseUrl()},success:function(f){f.data&&f.data.length>0&&$applozic(".km-kb-container").hasClass("n-vis")&&($applozic(".km-kb-container").removeClass("n-vis").addClass("vis"),KommunicateUI.adjustConversationTitleHeadingWidth(kommunicate._globals.popupWidget)),$applozic.each(f.data,(function(f,T){if(T&&T.articleCount&&T.name&&T.description){var L=T.name,K=T.description;$applozic("#km-faq-category-list-container").append('<div class="km-faq-category-card km-custom-widget-border-color" data-category-name="'+L.replace(/ /g,"-")+'"><div class="km-faq-category-card-title km-custom-widget-text-color">'+L+'</div><div class="km-faq-category-card-body">'+K+"</div> </div>")}})),KommunicateUI.initFaq()},error:function(){}})},Kommunicate.typingAreaService={populateText:function(f){$applozic("#mck-text-box").text(f),$applozic("#mck-text-box").focus(),this.setCursorAtTheEndOfInputString()},setCursorAtTheEndOfInputString:function(f){if(0===(f=f||document.getElementById("mck-text-box")).childNodes.length)return!1;if(f.focus(),void 0!==window.getSelection&&void 0!==document.createRange){var T=document.createRange();T.selectNodeContents(f),T.collapse(!1);var L=window.getSelection();L.removeAllRanges(),L.addRange(T)}else if(void 0!==document.body.createTextRange){var K=document.body.createTextRange();K.moveToElementText(f),K.collapse(!1),K.select()}},showMicIfSpeechRecognitionSupported:function(){window.hasOwnProperty("webkitSpeechRecognition")?this.showMicButton():this.hideMicButton()},hideMicButton:function(){kommunicateCommons.modifyClassList({id:["mck-mic-animation-container"]},"n-vis","vis")},showMicButton:function(){var f=KommunicateUtils.getDataFromKmSession("appOptions")||applozic._globals;f&&f.voiceInput&&kommunicateCommons.modifyClassList({id:["mck-mic-animation-container"]},"vis","n-vis")},hideMiceRecordingAnimation:function(){kommunicateCommons.modifyClassList({id:["mck-animation-outer"]},"n-vis","vis")},showMicRcordingAnimation:function(){kommunicateCommons.modifyClassList({id:["mck-animation-outer"]},"vis","n-vis")}},Kommunicate.mediaService={capitalizeFirstCharacter:function(f){return f.replace(/\S/,(function(f){return f.toUpperCase()}))},processMicClickedEvent:function(){if(kmWidgetEvents.eventTracking(eventMapping.onVoiceIconClick),"webkitSpeechRecognition"in window){var f=new webkitSpeechRecognition,T=KommunicateUtils.getDataFromKmSession("appOptions")||applozic._globals;f.continuous=!1,f.interimResults=!0,finalTranscript="",f.lang=T.language||"en-us",f.start(),f.onstart=function(){Kommunicate.typingAreaService.showMicRcordingAnimation()},f.onresult=function(f){for(var T="",L=f.resultIndex;L<f.results.length;++L)f.results[L].isFinal?finalTranscript+=f.results[L][0].transcript:T+=f.results[L][0].transcript;Kommunicate.typingAreaService.populateText(Kommunicate.mediaService.capitalizeFirstCharacter(finalTranscript||T))},f.onerror=function(f){},f.onend=function(){Kommunicate.typingAreaService.hideMiceRecordingAnimation(),window.$applozic.fn.applozic("toggleMediaOptions")}}else alert("browser do not support speech recogization")},voiceOutputIncomingMessage:function(f){var T,L=KommunicateUtils.getDataFromKmSession("appOptions")||applozic._globals;if(L&&Kommunicate.visibleMessage(f)&&L.voiceOutput&&"speechSynthesis"in window){var K="",U=!!window.chrome||navigator.userAgent.indexOf("Chrome")>-1;if(f.hasOwnProperty("fileMeta")?(K+=MCK_LABELS["voice.output"].attachment,K+=f.fileMeta.name):f.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.LOCATION?(coord=JSON.parse(f.message),K+=MCK_LABELS["voice.output"].location.init,K+=MCK_LABELS["voice.output"].location.lat+Math.round(100*coord.lat)/100,K+=MCK_LABELS["voice.output"].location.lon+Math.round(100*coord.lon)/100):f.message&&f.contentType==KommunicateConstants.MESSAGE_CONTENT_TYPE.DEFAULT&&(K+=f.message),K){function s(f){P.voice=f,G=!0}var P=new SpeechSynthesisUtterance(K);P.lang=L.language||"en-US",P.rate=L.voiceRate||1;var G=!1;L.voiceName&&AVAILABLE_VOICES_FOR_TTS.forEach((function(f){G||(Array.isArray(L.voiceName)?L.voiceName.forEach((function(T){f.name!==T.trim()||G||s(f)})):f.name!==L.voiceName.trim()||G||s(f))})),P.onerror=function(f){if("not-allowed"!==f.error)throw new Error("Error while converting the message to voice.",f.error)},U&&(T=setTimeout((function e(){window.speechSynthesis.pause(),window.speechSynthesis.resume(),T=setTimeout(e,1e4)}),1e4),P.onend=function(){clearTimeout(T)}),speechSynthesis.speak(P)}}}},$applozic(document).on("click","#mck-mic-btn",Kommunicate.mediaService.processMicClickedEvent);