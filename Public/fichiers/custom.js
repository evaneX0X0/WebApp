$(document).ready(function(){$(function(){$('input[type=file]').change(function(){var t=$(this).val();var labelText='Fichier : '+t.substr(12,t.length);$(this).prev('label').text(labelText);})});$("#allow").on("input",function(){if($('#allow').is(":checked")){$('#textInfo').removeClass('text-danger');$('#textInfo').addClass('text-success')}else{$('#textInfo').removeClass('text-success');$('#textInfo').addClass('text-danger')}});$('#showPassword').click(function(){if($("#passwordEye").hasClass("fa-eye")){$('#password').attr('type','text');$('#passwordEye').removeClass('fa-eye');$('#passwordEye').addClass('fa-eye-slash')}else{$('#password').attr('type','password');$('#passwordEye').removeClass('fa-eye-slash');$('#passwordEye').addClass('fa-eye')}});$("#typeDemande").on("input",function(){parseInt(this.value)==1?$('#myCni').hide():$('#myCni').show();});$("#haveRecepisse").on("input",function(){$('#ficheIdentification').hide();$('#myRecepisse').hide();switch(parseInt(this.value)){case 0:$('#myRecepisse').show();$("#nextbtn").attr("disabled",false);break;case 1:$('#ficheIdentification').show();$("#nextbtn").attr("disabled",true);break;default:$('#myRecepisse').show();$("#nextbtn").attr("disabled",false);break;}});$("#haveCNI").on("input",function(){$('#ficheIdentification').hide();$('#lostDeclaration').hide();$('#myCni').hide();switch(parseInt(this.value)){case 0:$('#myCni').show();$("#nextbtn").attr("disabled",false);break;case 1:$('#ficheIdentification').show();$("#nextbtn").attr("disabled",true);break;default:$('#myCni').show();$("#nextbtn").attr("disabled",false);break;}});$(".select-mather").select2({language:"fr",theme:'bootstrap4',placeholder:"-",allowClear:true,width:'resolve'});$(".select-father").select2({language:"fr",theme:'bootstrap4',placeholder:"-",allowClear:true,width:'resolve'});$(".select-code_profession").select2({language:"fr",theme:'bootstrap4',placeholder:"Choisissez votre code profession",allowClear:true,width:'resolve'});$(".select-city").select2({language:"fr",theme:'bootstrap4',placeholder:"Choisissez votre ville",allowClear:true,width:'resolve'});$(".select-commune").select2({language:"fr",theme:'bootstrap4',placeholder:"Choisissez votre commune",allowClear:true,width:'resolve'});$(".select-department").select2({language:"fr",theme:'bootstrap4',placeholder:"Choisissez votre departement",allowClear:true,width:'resolve'});$(".select-centres").select2({language:"fr",theme:'bootstrap4',placeholder:"Choisissez un centre pour le retrait",allowClear:true,width:'resolve'});$(".select-situation_matrimoniale").select2({language:"fr",theme:'bootstrap4',placeholder:"Choisissez votre situation matrimoniale",allowClear:true,width:'resolve'});$(".select-childrens").select2({language:"fr",theme:'bootstrap4',placeholder:"Avez-vous des enfants ?",allowClear:true,width:'resolve'}).on('change',function(){if(parseInt(this.value)>0){$(".select-mineur").select2({language:"fr",theme:'bootstrap4',placeholder:"Choissez le nombre d'enfant mineur",allowClear:true,width:'resolve',data:Array.from(Array(parseInt(this.value)),(x,index)=>index+1)});$('#mineur').show();}else{$('#mineur').hide();}}).trigger('change');$(".select-country").select2({language:"fr",theme:'bootstrap4',placeholder:"Choisissez votre Pays de résidence",allowClear:true}).on('change',function(){if(parseInt(this.value)!=1){$('#chooseCity').hide();}else{$('#chooseCity').show();}}).trigger('change');$(".select-region").select2({language:"fr",theme:'bootstrap4',placeholder:"Choisissez votre region",allowClear:true,width:'resolve'});$("#payment").submit(function(event){$("#payBtn").attr("disabled",true);$("#payBtn").html("<div class='spinner'><div class='bounce1'></div><div class='bounce2'></div><div class='bounce3'></div></div>");event.preventDefault();var post_url=$(this).attr("action");var request_method=$(this).attr("method");var form_data=$(this).serialize();$.ajax({url:post_url,type:request_method,data:form_data,dataType:'json',}).done(function(response){if(response.code==0){CinetPay.setConfig({apikey:'5579980505863a3f6aabd82.89189525',site_id:356502,notify_url:'https://web-rnpp.digitalsystem.ci/notify'});var timeStampInMs=window.performance&&window.performance.now&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.now()+window.performance.timing.navigationStart:Date.now();CinetPay.setSignatureData({amount:parseInt(response.data.amount),trans_id:response.data.trans_id,currency:'CFA',designation:'Paiement CNI '+parseInt(response.data.amount)+' FCFA',custom:response.data.trans_id});CinetPay.getSignature();CinetPay.on('signatureCreated',function(token){});CinetPay.on('paymentPending',function(e){});CinetPay.on('error',function(e){});CinetPay.on('paymentSuccessfull',function(paymentInfo){if(typeof paymentInfo.lastTime!='undefined'){if(paymentInfo.cpm_result=='00'){Swal.fire({icon:'success',title:"Paiement effectué avec succès.",text:"Félicitations le paiement de votre CNI a été effectué avec succès. Nous vous enverrons votre reçu de paiement par SMS. Imprimer votre reçu",}).then(function(){location.href="invoice/"+response.crypt;});}}});}else{swal({icon:'error',title:"Oups une erreur est survenue veuillez réessayer dans quelques minutes.",}).then(function(){location.reload(true);});}});});$("#search").submit(function(event){$(".go").attr("disabled",true);$(".go").html("<div class='spinner'><div class='bounce1'></div><div class='bounce2'></div><div class='bounce3'></div></div>");event.preventDefault();var post_url=$(this).attr("action");var request_method=$(this).attr("method");var form_data=$(this).serialize();$.ajax({url:post_url,type:request_method,data:form_data,dataType:'json',}).done(function(response){$("#server-results").html(response);$(".go").attr("disabled",false);$(".go").html("Rechercher");if(response.code==0){if(response.data!=''){document.getElementById('inscriptionContent').innerHTML=response.data;}}else if(response.code==5){Swal.fire({icon:'info',title:'Id de transaction introuvable'})}else{Swal.fire({type:'error',title:response.message,})}});});$(".select2").select2({language:"fr",theme:'bootstrap4',width:'resolve'});function openPrint(lnk,val){$.post("invoice",{lnk:lnk,val:val}).done(function(data){if(data==1){Swal.fire({type:'error',title:"Oups un problème est survenu",}).then(val=>{location.reload(true);},err=>{location.reload(true);})}else{var doc=new jsPDF();console.log(data);doc.innerHTML(data);doc.save('sample-file.pdf');}});}});